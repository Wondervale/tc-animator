import{a as Ut,s as bt,r as s,p as qt,c as Wt,j as _,b as Xt,x as Vt,i as Yt,d as de,e as yt,R as $t,m as Zt,f as Qt,W as Jt}from"./react-CXwaHllq.js";import{W as Kt,R as wt,O as en,P as tn,S as Et,a as Ee,V as nn,b as rn,B as on,C as sn,L as an,c as Ct,N as Pt,A as cn,d as xt,e as N,f as Ze,g as Le,h as ln,U as un,i as fn,T as dn,j as pn,p as mn,k as vn,l as hn,m as gn,M as bn,n as Qe,o as Ge,q as yn,G as Ne,D as wn,r as Ce,s as En,H as jt,t as Je,u as Cn,F as Pn,v as xn,w as jn,x as Ae,Q as Ke,y as Sn,z as Mn,E as Rn,I as Tn,J as On,K as kn,X as In,Y as Fn,Z as Ln,_ as An,$ as _n,a0 as Dn,a1 as zn,a2 as Hn,a3 as et,a4 as Bn,a5 as Gn,a6 as Nn}from"./three-BJdXbyDF.js";const Un="modulepreload",qn=function(e){return"/tc-animator/"+e},tt={},Wr=function(t,n,r){let o=Promise.resolve();if(n&&n.length>0){let i=function(p){return Promise.all(p.map(u=>Promise.resolve(u).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=l?.nonce||l?.getAttribute("nonce");o=i(n.map(p=>{if(p=qn(p),p in tt)return;tt[p]=!0;const u=p.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${f}`))return;const v=document.createElement("link");if(v.rel=u?"stylesheet":Un,u||(v.as="script"),v.crossOrigin="",v.href=p,c&&v.setAttribute("nonce",c),document.head.appendChild(v),u)return new Promise((m,E)=>{v.addEventListener("load",m),v.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${p}`)))})}))}function a(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return o.then(l=>{for(const c of l||[])c.status==="rejected"&&a(c.reason);return t().catch(a)})};var nt=Ut();function St(e){let t=e.root;for(;t.getState().previousRoot;)t=t.getState().previousRoot;return t}const Mt=e=>e&&e.isOrthographicCamera,Wn=e=>e&&e.hasOwnProperty("current"),Xn=e=>e!=null&&(typeof e=="string"||typeof e=="number"||e.isColor),ce=((e,t)=>typeof window<"u"&&(((e=window.document)==null?void 0:e.createElement)||((t=window.navigator)==null?void 0:t.product)==="ReactNative"))()?s.useLayoutEffect:s.useEffect;function Ue(e){const t=s.useRef(e);return ce(()=>void(t.current=e),[e]),t}function Vn(){const e=Xt(),t=Vt();return s.useMemo(()=>({children:n})=>{const o=!!Yt(e,!0,a=>a.type===s.StrictMode)?s.StrictMode:s.Fragment;return _.jsx(o,{children:_.jsx(t,{children:n})})},[e,t])}function Yn({set:e}){return ce(()=>(e(new Promise(()=>null)),()=>e(!1)),[e]),null}const $n=(e=>(e=class extends s.Component{constructor(...n){super(...n),this.state={error:!1}}componentDidCatch(n){this.props.set(n)}render(){return this.state.error?null:this.props.children}},e.getDerivedStateFromError=()=>({error:!0}),e))();function Rt(e){var t;const n=typeof window<"u"?(t=window.devicePixelRatio)!=null?t:2:1;return Array.isArray(e)?Math.min(Math.max(e[0],n),e[1]):e}function J(e){var t;return(t=e.__r3f)==null?void 0:t.root.getState()}const A={obj:e=>e===Object(e)&&!A.arr(e)&&typeof e!="function",fun:e=>typeof e=="function",str:e=>typeof e=="string",num:e=>typeof e=="number",boo:e=>typeof e=="boolean",und:e=>e===void 0,nul:e=>e===null,arr:e=>Array.isArray(e),equ(e,t,{arrays:n="shallow",objects:r="reference",strict:o=!0}={}){if(typeof e!=typeof t||!!e!=!!t)return!1;if(A.str(e)||A.num(e)||A.boo(e))return e===t;const a=A.obj(e);if(a&&r==="reference")return e===t;const l=A.arr(e);if(l&&n==="reference")return e===t;if((l||a)&&e===t)return!0;let c;for(c in e)if(!(c in t))return!1;if(a&&n==="shallow"&&r==="shallow"){for(c in o?t:e)if(!A.equ(e[c],t[c],{strict:o,objects:"reference"}))return!1}else for(c in o?t:e)if(e[c]!==t[c])return!1;if(A.und(c)){if(l&&e.length===0&&t.length===0||a&&Object.keys(e).length===0&&Object.keys(t).length===0)return!0;if(e!==t)return!1}return!0}};function Zn(e){const t={nodes:{},materials:{},meshes:{}};return e&&e.traverse(n=>{n.name&&(t.nodes[n.name]=n),n.material&&!t.materials[n.material.name]&&(t.materials[n.material.name]=n.material),n.isMesh&&!t.meshes[n.name]&&(t.meshes[n.name]=n)}),t}function Qn(e){e.type!=="Scene"&&(e.dispose==null||e.dispose());for(const t in e){const n=e[t];n?.type!=="Scene"&&(n==null||n.dispose==null||n.dispose())}}const Tt=["children","key","ref"];function Jn(e){const t={};for(const n in e)Tt.includes(n)||(t[n]=e[n]);return t}function me(e,t,n,r){const o=e;let a=o?.__r3f;return a||(a={root:t,type:n,parent:null,children:[],props:Jn(r),object:o,eventCount:0,handlers:{},isHidden:!1},o&&(o.__r3f=a)),a}function ae(e,t){let n=e[t];if(!t.includes("-"))return{root:e,key:t,target:n};n=e;for(const o of t.split("-")){var r;t=o,e=n,n=(r=n)==null?void 0:r[t]}return{root:e,key:t,target:n}}const rt=/-\d+$/;function ve(e,t){if(A.str(t.props.attach)){if(rt.test(t.props.attach)){const o=t.props.attach.replace(rt,""),{root:a,key:l}=ae(e.object,o);Array.isArray(a[l])||(a[l]=[])}const{root:n,key:r}=ae(e.object,t.props.attach);t.previousAttach=n[r],n[r]=t.object}else A.fun(t.props.attach)&&(t.previousAttach=t.props.attach(e.object,t.object))}function he(e,t){if(A.str(t.props.attach)){const{root:n,key:r}=ae(e.object,t.props.attach),o=t.previousAttach;o===void 0?delete n[r]:n[r]=o}else t.previousAttach==null||t.previousAttach(e.object,t.object);delete t.previousAttach}const _e=[...Tt,"args","dispose","attach","object","onUpdate","dispose"],ot=new Map;function Kn(e){let t=ot.get(e.constructor);try{t||(t=new e.constructor,ot.set(e.constructor,t))}catch{}return t}function er(e,t){const n={};for(const r in t)if(!_e.includes(r)&&!A.equ(t[r],e.props[r])){n[r]=t[r];for(const o in t)o.startsWith(`${r}-`)&&(n[o]=t[o])}for(const r in e.props){if(_e.includes(r)||t.hasOwnProperty(r))continue;const{root:o,key:a}=ae(e.object,r);if(o.constructor&&o.constructor.length===0){const l=Kn(o);A.und(l)||(n[a]=l[a])}else n[a]=0}return n}const tr=["map","emissiveMap","sheenColorMap","specularColorMap","envMap"],nr=/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/;function $(e,t){var n;const r=e.__r3f,o=r&&St(r).getState(),a=r?.eventCount;for(const c in t){let i=t[c];if(_e.includes(c))continue;if(r&&nr.test(c)){typeof i=="function"?r.handlers[c]=i:delete r.handlers[c],r.eventCount=Object.keys(r.handlers).length;continue}if(i===void 0)continue;let{root:p,key:u,target:f}=ae(e,c);if(f instanceof Ze&&i instanceof Ze)f.mask=i.mask;else if(f instanceof Le&&Xn(i))f.set(i);else if(f!==null&&typeof f=="object"&&typeof f.set=="function"&&typeof f.copy=="function"&&i!=null&&i.constructor&&f.constructor===i.constructor)f.copy(i);else if(f!==null&&typeof f=="object"&&typeof f.set=="function"&&Array.isArray(i))typeof f.fromArray=="function"?f.fromArray(i):f.set(...i);else if(f!==null&&typeof f=="object"&&typeof f.set=="function"&&typeof i=="number")typeof f.setScalar=="function"?f.setScalar(i):f.set(i);else{var l;p[u]=i,o&&!o.linear&&tr.includes(u)&&(l=p[u])!=null&&l.isTexture&&p[u].format===ln&&p[u].type===un&&(p[u].colorSpace=Ct)}}if(r!=null&&r.parent&&o!=null&&o.internal&&(n=r.object)!=null&&n.isObject3D&&a!==r.eventCount){const c=r.object,i=o.internal.interaction.indexOf(c);i>-1&&o.internal.interaction.splice(i,1),r.eventCount&&c.raycast!==null&&o.internal.interaction.push(c)}return r&&r.props.attach===void 0&&(r.object.isBufferGeometry?r.props.attach="geometry":r.object.isMaterial&&(r.props.attach="material")),r&&oe(r),e}function oe(e){var t;if(!e.parent)return;e.props.onUpdate==null||e.props.onUpdate(e.object);const n=(t=e.root)==null||t.getState==null?void 0:t.getState();n&&n.internal.frames===0&&n.invalidate()}function Ot(e,t){e.manual||(Mt(e)?(e.left=t.width/-2,e.right=t.width/2,e.top=t.height/2,e.bottom=t.height/-2):e.aspect=t.width/t.height,e.updateProjectionMatrix())}const B=e=>e?.isObject3D;function le(e){return(e.eventObject||e.object).uuid+"/"+e.index+e.instanceId}function kt(e,t,n,r){const o=n.get(t);o&&(n.delete(t),n.size===0&&(e.delete(r),o.target.releasePointerCapture(r)))}function rr(e,t){const{internal:n}=e.getState();n.interaction=n.interaction.filter(r=>r!==t),n.initialHits=n.initialHits.filter(r=>r!==t),n.hovered.forEach((r,o)=>{(r.eventObject===t||r.object===t)&&n.hovered.delete(o)}),n.capturedMap.forEach((r,o)=>{kt(n.capturedMap,t,r,o)})}function or(e){function t(i){const{internal:p}=e.getState(),u=i.offsetX-p.initialClick[0],f=i.offsetY-p.initialClick[1];return Math.round(Math.sqrt(u*u+f*f))}function n(i){return i.filter(p=>["Move","Over","Enter","Out","Leave"].some(u=>{var f;return(f=p.__r3f)==null?void 0:f.handlers["onPointer"+u]}))}function r(i,p){const u=e.getState(),f=new Set,v=[],m=p?p(u.internal.interaction):u.internal.interaction;for(let h=0;h<m.length;h++){const d=J(m[h]);d&&(d.raycaster.camera=void 0)}u.previousRoot||u.events.compute==null||u.events.compute(i,u);function E(h){const d=J(h);if(!d||!d.events.enabled||d.raycaster.camera===null)return[];if(d.raycaster.camera===void 0){var w;d.events.compute==null||d.events.compute(i,d,(w=d.previousRoot)==null?void 0:w.getState()),d.raycaster.camera===void 0&&(d.raycaster.camera=null)}return d.raycaster.camera?d.raycaster.intersectObject(h,!0):[]}let b=m.flatMap(E).sort((h,d)=>{const w=J(h.object),P=J(d.object);return!w||!P?h.distance-d.distance:P.events.priority-w.events.priority||h.distance-d.distance}).filter(h=>{const d=le(h);return f.has(d)?!1:(f.add(d),!0)});u.events.filter&&(b=u.events.filter(b,u));for(const h of b){let d=h.object;for(;d;){var g;(g=d.__r3f)!=null&&g.eventCount&&v.push({...h,eventObject:d}),d=d.parent}}if("pointerId"in i&&u.internal.capturedMap.has(i.pointerId))for(let h of u.internal.capturedMap.get(i.pointerId).values())f.has(le(h.intersection))||v.push(h.intersection);return v}function o(i,p,u,f){if(i.length){const v={stopped:!1};for(const m of i){let E=J(m.object);if(E||m.object.traverseAncestors(b=>{const g=J(b);if(g)return E=g,!1}),E){const{raycaster:b,pointer:g,camera:h,internal:d}=E,w=new N(g.x,g.y,0).unproject(h),P=j=>{var M,k;return(M=(k=d.capturedMap.get(j))==null?void 0:k.has(m.eventObject))!=null?M:!1},C=j=>{const M={intersection:m,target:p.target};d.capturedMap.has(j)?d.capturedMap.get(j).set(m.eventObject,M):d.capturedMap.set(j,new Map([[m.eventObject,M]])),p.target.setPointerCapture(j)},y=j=>{const M=d.capturedMap.get(j);M&&kt(d.capturedMap,m.eventObject,M,j)};let I={};for(let j in p){let M=p[j];typeof M!="function"&&(I[j]=M)}let S={...m,...I,pointer:g,intersections:i,stopped:v.stopped,delta:u,unprojectedPoint:w,ray:b.ray,camera:h,stopPropagation(){const j="pointerId"in p&&d.capturedMap.get(p.pointerId);if((!j||j.has(m.eventObject))&&(S.stopped=v.stopped=!0,d.hovered.size&&Array.from(d.hovered.values()).find(M=>M.eventObject===m.eventObject))){const M=i.slice(0,i.indexOf(m));a([...M,m])}},target:{hasPointerCapture:P,setPointerCapture:C,releasePointerCapture:y},currentTarget:{hasPointerCapture:P,setPointerCapture:C,releasePointerCapture:y},nativeEvent:p};if(f(S),v.stopped===!0)break}}}return i}function a(i){const{internal:p}=e.getState();for(const u of p.hovered.values())if(!i.length||!i.find(f=>f.object===u.object&&f.index===u.index&&f.instanceId===u.instanceId)){const v=u.eventObject.__r3f;if(p.hovered.delete(le(u)),v!=null&&v.eventCount){const m=v.handlers,E={...u,intersections:i};m.onPointerOut==null||m.onPointerOut(E),m.onPointerLeave==null||m.onPointerLeave(E)}}}function l(i,p){for(let u=0;u<p.length;u++){const f=p[u].__r3f;f==null||f.handlers.onPointerMissed==null||f.handlers.onPointerMissed(i)}}function c(i){switch(i){case"onPointerLeave":case"onPointerCancel":return()=>a([]);case"onLostPointerCapture":return p=>{const{internal:u}=e.getState();"pointerId"in p&&u.capturedMap.has(p.pointerId)&&requestAnimationFrame(()=>{u.capturedMap.has(p.pointerId)&&(u.capturedMap.delete(p.pointerId),a([]))})}}return function(u){const{onPointerMissed:f,internal:v}=e.getState();v.lastEvent.current=u;const m=i==="onPointerMove",E=i==="onClick"||i==="onContextMenu"||i==="onDoubleClick",g=r(u,m?n:void 0),h=E?t(u):0;i==="onPointerDown"&&(v.initialClick=[u.offsetX,u.offsetY],v.initialHits=g.map(w=>w.eventObject)),E&&!g.length&&h<=2&&(l(u,v.interaction),f&&f(u)),m&&a(g);function d(w){const P=w.eventObject,C=P.__r3f;if(!(C!=null&&C.eventCount))return;const y=C.handlers;if(m){if(y.onPointerOver||y.onPointerEnter||y.onPointerOut||y.onPointerLeave){const I=le(w),S=v.hovered.get(I);S?S.stopped&&w.stopPropagation():(v.hovered.set(I,w),y.onPointerOver==null||y.onPointerOver(w),y.onPointerEnter==null||y.onPointerEnter(w))}y.onPointerMove==null||y.onPointerMove(w)}else{const I=y[i];I?(!E||v.initialHits.includes(P))&&(l(u,v.interaction.filter(S=>!v.initialHits.includes(S))),I(w)):E&&v.initialHits.includes(P)&&l(u,v.interaction.filter(S=>!v.initialHits.includes(S)))}}o(g,u,h,d)}}return{handlePointer:c}}const st=e=>!!(e!=null&&e.render),qe=s.createContext(null),sr=(e,t)=>{const n=yt((c,i)=>{const p=new N,u=new N,f=new N;function v(h=i().camera,d=u,w=i().size){const{width:P,height:C,top:y,left:I}=w,S=P/C;d.isVector3?f.copy(d):f.set(...d);const j=h.getWorldPosition(p).distanceTo(f);if(Mt(h))return{width:P/h.zoom,height:C/h.zoom,top:y,left:I,factor:1,distance:j,aspect:S};{const M=h.fov*Math.PI/180,k=2*Math.tan(M/2)*j,H=k*(P/C);return{width:H,height:k,top:y,left:I,factor:P/H,distance:j,aspect:S}}}let m;const E=h=>c(d=>({performance:{...d.performance,current:h}})),b=new xt;return{set:c,get:i,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},scene:null,xr:null,invalidate:(h=1)=>e(i(),h),advance:(h,d)=>t(h,d,i()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new fn,pointer:b,mouse:b,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const h=i();m&&clearTimeout(m),h.performance.current!==h.performance.min&&E(h.performance.min),m=setTimeout(()=>E(i().performance.max),h.performance.debounce)}},size:{width:0,height:0,top:0,left:0},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:v},setEvents:h=>c(d=>({...d,events:{...d.events,...h}})),setSize:(h,d,w=0,P=0)=>{const C=i().camera,y={width:h,height:d,top:w,left:P};c(I=>({size:y,viewport:{...I.viewport,...v(C,u,y)}}))},setDpr:h=>c(d=>{const w=Rt(h);return{viewport:{...d.viewport,dpr:w,initialDpr:d.viewport.initialDpr||w}}}),setFrameloop:(h="always")=>{const d=i().clock;d.stop(),d.elapsedTime=0,h!=="never"&&(d.start(),d.elapsedTime=0),c(()=>({frameloop:h}))},previousRoot:void 0,internal:{interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,lastEvent:s.createRef(),active:!1,frames:0,priority:0,subscribe:(h,d,w)=>{const P=i().internal;return P.priority=P.priority+(d>0?1:0),P.subscribers.push({ref:h,priority:d,store:w}),P.subscribers=P.subscribers.sort((C,y)=>C.priority-y.priority),()=>{const C=i().internal;C!=null&&C.subscribers&&(C.priority=C.priority-(d>0?1:0),C.subscribers=C.subscribers.filter(y=>y.ref!==h))}}}}}),r=n.getState();let o=r.size,a=r.viewport.dpr,l=r.camera;return n.subscribe(()=>{const{camera:c,size:i,viewport:p,gl:u,set:f}=n.getState();if(i.width!==o.width||i.height!==o.height||p.dpr!==a){o=i,a=p.dpr,Ot(c,i),p.dpr>0&&u.setPixelRatio(p.dpr);const v=typeof HTMLCanvasElement<"u"&&u.domElement instanceof HTMLCanvasElement;u.setSize(i.width,i.height,v)}c!==l&&(l=c,f(v=>({viewport:{...v.viewport,...v.viewport.getCurrentViewport(c)}})))}),n.subscribe(c=>e(c)),n};function We(){const e=s.useContext(qe);if(!e)throw new Error("R3F: Hooks can only be used within the Canvas component!");return e}function O(e=n=>n,t){return We()(e,t)}function se(e,t=0){const n=We(),r=n.getState().internal.subscribe,o=Ue(e);return ce(()=>r(o,t,n),[t,r,n]),null}const it=new WeakMap,ir=e=>{var t;return typeof e=="function"&&(e==null||(t=e.prototype)==null?void 0:t.constructor)===e};function It(e,t){return function(n,...r){let o;return ir(n)?(o=it.get(n),o||(o=new n,it.set(n,o))):o=n,e&&e(o),Promise.all(r.map(a=>new Promise((l,c)=>o.load(a,i=>{B(i?.scene)&&Object.assign(i,Zn(i.scene)),l(i)},t,i=>c(new Error(`Could not load ${a}: ${i?.message}`))))))}}function Z(e,t,n,r){const o=Array.isArray(t)?t:[t],a=bt(It(n,r),[e,...o],{equal:A.equ});return Array.isArray(t)?a:a[0]}Z.preload=function(e,t,n){const r=Array.isArray(t)?t:[t];return qt(It(n),[e,...r])};Z.clear=function(e,t){const n=Array.isArray(t)?t:[t];return Wt([e,...n])};function ar(e){const t=$t(e);return t.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:s.version}),t}const Ft=0,re={},cr=/^three(?=[A-Z])/,ye=e=>`${e[0].toUpperCase()}${e.slice(1)}`;let lr=0;const ur=e=>typeof e=="function";function Xe(e){if(ur(e)){const t=`${lr++}`;return re[t]=e,t}else Object.assign(re,e)}function Lt(e,t){const n=ye(e),r=re[n];if(e!=="primitive"&&!r)throw new Error(`R3F: ${n} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(e==="primitive"&&!t.object)throw new Error("R3F: Primitives without 'object' are invalid!");if(t.args!==void 0&&!Array.isArray(t.args))throw new Error("R3F: The args prop must be an array!")}function fr(e,t,n){var r;return e=ye(e)in re?e:e.replace(cr,""),Lt(e,t),e==="primitive"&&(r=t.object)!=null&&r.__r3f&&delete t.object.__r3f,me(t.object,n,e,t)}function dr(e){if(!e.isHidden){var t;e.props.attach&&(t=e.parent)!=null&&t.object?he(e.parent,e):B(e.object)&&(e.object.visible=!1),e.isHidden=!0,oe(e)}}function At(e){if(e.isHidden){var t;e.props.attach&&(t=e.parent)!=null&&t.object?ve(e.parent,e):B(e.object)&&e.props.visible!==!1&&(e.object.visible=!0),e.isHidden=!1,oe(e)}}function Ve(e,t,n){const r=t.root.getState();if(!(!e.parent&&e.object!==r.scene)){if(!t.object){var o,a;const l=re[ye(t.type)];t.object=(o=t.props.object)!=null?o:new l(...(a=t.props.args)!=null?a:[]),t.object.__r3f=t}if($(t.object,t.props),t.props.attach)ve(e,t);else if(B(t.object)&&B(e.object)){const l=e.object.children.indexOf(n?.object);if(n&&l!==-1){const c=e.object.children.indexOf(t.object);if(c!==-1){e.object.children.splice(c,1);const i=c<l?l-1:l;e.object.children.splice(i,0,t.object)}else t.object.parent=e.object,e.object.children.splice(l,0,t.object),t.object.dispatchEvent({type:"added"}),e.object.dispatchEvent({type:"childadded",child:t.object})}else e.object.add(t.object)}for(const l of t.children)Ve(t,l);oe(t)}}function Pe(e,t){t&&(t.parent=e,e.children.push(t),Ve(e,t))}function at(e,t,n){if(!t||!n)return;t.parent=e;const r=e.children.indexOf(n);r!==-1?e.children.splice(r,0,t):e.children.push(t),Ve(e,t,n)}function _t(e){if(typeof e.dispose=="function"){const t=()=>{try{e.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT<"u"?t():nt.unstable_scheduleCallback(nt.unstable_IdlePriority,t)}}function De(e,t,n){if(!t)return;t.parent=null;const r=e.children.indexOf(t);r!==-1&&e.children.splice(r,1),t.props.attach?he(e,t):B(t.object)&&B(e.object)&&(e.object.remove(t.object),rr(St(t),t.object));const o=t.props.dispose!==null&&n!==!1;for(let a=t.children.length-1;a>=0;a--){const l=t.children[a];De(t,l,o)}t.children.length=0,delete t.object.__r3f,o&&t.type!=="primitive"&&t.object.type!=="Scene"&&_t(t.object),n===void 0&&oe(t)}function pr(e,t){for(const n of[e,e.alternate])if(n!==null)if(typeof n.ref=="function"){n.refCleanup==null||n.refCleanup();const r=n.ref(t);typeof r=="function"&&(n.refCleanup=r)}else n.ref&&(n.ref.current=t)}const pe=[];function mr(){for(const[n]of pe){const r=n.parent;if(r){n.props.attach?he(r,n):B(n.object)&&B(r.object)&&r.object.remove(n.object);for(const o of n.children)o.props.attach?he(n,o):B(o.object)&&B(n.object)&&n.object.remove(o.object)}n.isHidden&&At(n),n.object.__r3f&&delete n.object.__r3f,n.type!=="primitive"&&_t(n.object)}for(const[n,r,o]of pe){n.props=r;const a=n.parent;if(a){var e,t;const l=re[ye(n.type)];n.object=(e=n.props.object)!=null?e:new l(...(t=n.props.args)!=null?t:[]),n.object.__r3f=n,pr(o,n.object),$(n.object,n.props),n.props.attach?ve(a,n):B(n.object)&&B(a.object)&&a.object.add(n.object);for(const c of n.children)c.props.attach?ve(n,c):B(c.object)&&B(n.object)&&n.object.add(c.object);oe(n)}}pe.length=0}const xe=()=>{},ct={};let ue=Ft;const vr=0,hr=4,ge=ar({isPrimaryRenderer:!1,warnsIfNotActing:!1,supportsMutation:!0,supportsPersistence:!1,supportsHydration:!1,createInstance:fr,removeChild:De,appendChild:Pe,appendInitialChild:Pe,insertBefore:at,appendChildToContainer(e,t){const n=e.getState().scene.__r3f;!t||!n||Pe(n,t)},removeChildFromContainer(e,t){const n=e.getState().scene.__r3f;!t||!n||De(n,t)},insertInContainerBefore(e,t,n){const r=e.getState().scene.__r3f;!t||!n||!r||at(r,t,n)},getRootHostContext:()=>ct,getChildHostContext:()=>ct,commitUpdate(e,t,n,r,o){var a,l,c;Lt(t,r);let i=!1;if((e.type==="primitive"&&n.object!==r.object||((a=r.args)==null?void 0:a.length)!==((l=n.args)==null?void 0:l.length)||(c=r.args)!=null&&c.some((u,f)=>{var v;return u!==((v=n.args)==null?void 0:v[f])}))&&(i=!0),i)pe.push([e,{...r},o]);else{const u=er(e,r);Object.keys(u).length&&(Object.assign(e.props,u),$(e.object,u))}(o.sibling===null||(o.flags&hr)===vr)&&mr()},finalizeInitialChildren:()=>!1,commitMount(){},getPublicInstance:e=>e?.object,prepareForCommit:()=>null,preparePortalMount:e=>me(e.getState().scene,e,"",{}),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance:dr,unhideInstance:At,createTextInstance:xe,hideTextInstance:xe,unhideTextInstance:xe,scheduleTimeout:typeof setTimeout=="function"?setTimeout:void 0,cancelTimeout:typeof clearTimeout=="function"?clearTimeout:void 0,noTimeout:-1,getInstanceFromNode:()=>null,beforeActiveInstanceBlur(){},afterActiveInstanceBlur(){},detachDeletedInstance(){},prepareScopeUpdate(){},getInstanceFromScope:()=>null,shouldAttemptEagerTransition:()=>!1,trackSchedulerEvent:()=>{},resolveEventType:()=>null,resolveEventTimeStamp:()=>-1.1,requestPostPaintCallback(){},maySuspendCommit:()=>!1,preloadInstance:()=>!0,startSuspendingCommit(){},suspendInstance(){},waitForCommitToBeReady:()=>null,NotPendingTransition:null,HostTransitionContext:s.createContext(null),setCurrentUpdatePriority(e){ue=e},getCurrentUpdatePriority(){return ue},resolveUpdatePriority(){var e;if(ue!==Ft)return ue;switch(typeof window<"u"&&((e=window.event)==null?void 0:e.type)){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return de.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return de.ContinuousEventPriority;default:return de.DefaultEventPriority}},resetFormInstance(){}}),Q=new Map,K={objects:"shallow",strict:!1};function gr(e,t){if(!t&&typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&e.parentElement){const{width:n,height:r,top:o,left:a}=e.parentElement.getBoundingClientRect();return{width:n,height:r,top:o,left:a}}else if(!t&&typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas)return{width:e.width,height:e.height,top:0,left:0};return{width:0,height:0,top:0,left:0,...t}}function br(e){const t=Q.get(e),n=t?.fiber,r=t?.store;t&&console.warn("R3F.createRoot should only be called once!");const o=typeof reportError=="function"?reportError:console.error,a=r||sr(Be,ut),l=n||ge.createContainer(a,de.ConcurrentRoot,null,!1,null,"",o,o,o,null);t||Q.set(e,{fiber:l,store:a});let c,i,p=!1,u=null;return{async configure(f={}){let v;u=new Promise(x=>v=x);let{gl:m,size:E,scene:b,events:g,onCreated:h,shadows:d=!1,linear:w=!1,flat:P=!1,legacy:C=!1,orthographic:y=!1,frameloop:I="always",dpr:S=[1,2],performance:j,raycaster:M,camera:k,onPointerMissed:H}=f,R=a.getState(),L=R.gl;if(!R.gl){const x={canvas:e,powerPreference:"high-performance",antialias:!0,alpha:!0},F=typeof m=="function"?await m(x):m;st(F)?L=F:L=new Kt({...x,...m}),R.set({gl:L})}let T=R.raycaster;T||R.set({raycaster:T=new wt});const{params:V,...q}=M||{};if(A.equ(q,T,K)||$(T,{...q}),A.equ(V,T.params,K)||$(T,{params:{...T.params,...V}}),!R.camera||R.camera===i&&!A.equ(i,k,K)){i=k;const x=k?.isCamera,F=x?k:y?new en(0,0,0,0,.1,1e3):new tn(75,0,.1,1e3);x||(F.position.z=5,k&&($(F,k),F.manual||("aspect"in k||"left"in k||"right"in k||"bottom"in k||"top"in k)&&(F.manual=!0,F.updateProjectionMatrix())),!R.camera&&!(k!=null&&k.rotation)&&F.lookAt(0,0,0)),R.set({camera:F}),T.camera=F}if(!R.scene){let x;b!=null&&b.isScene?(x=b,me(x,a,"",{})):(x=new Et,me(x,a,"",{}),b&&$(x,b)),R.set({scene:x})}g&&!R.events.handlers&&R.set({events:g(a)});const W=gr(e,E);if(A.equ(W,R.size,K)||R.setSize(W.width,W.height,W.top,W.left),S&&R.viewport.dpr!==Rt(S)&&R.setDpr(S),R.frameloop!==I&&R.setFrameloop(I),R.onPointerMissed||R.set({onPointerMissed:H}),j&&!A.equ(j,R.performance,K)&&R.set(x=>({performance:{...x.performance,...j}})),!R.xr){var U;const x=(D,X)=>{const $e=a.getState();$e.frameloop!=="never"&&ut(D,!0,$e,X)},F=()=>{const D=a.getState();D.gl.xr.enabled=D.gl.xr.isPresenting,D.gl.xr.setAnimationLoop(D.gl.xr.isPresenting?x:null),D.gl.xr.isPresenting||Be(D)},G={connect(){const D=a.getState().gl;D.xr.addEventListener("sessionstart",F),D.xr.addEventListener("sessionend",F)},disconnect(){const D=a.getState().gl;D.xr.removeEventListener("sessionstart",F),D.xr.removeEventListener("sessionend",F)}};typeof((U=L.xr)==null?void 0:U.addEventListener)=="function"&&G.connect(),R.set({xr:G})}if(L.shadowMap){const x=L.shadowMap.enabled,F=L.shadowMap.type;if(L.shadowMap.enabled=!!d,A.boo(d))L.shadowMap.type=Ee;else if(A.str(d)){var Y;const G={basic:on,percentage:rn,soft:Ee,variance:nn};L.shadowMap.type=(Y=G[d])!=null?Y:Ee}else A.obj(d)&&Object.assign(L.shadowMap,d);(x!==L.shadowMap.enabled||F!==L.shadowMap.type)&&(L.shadowMap.needsUpdate=!0)}return sn.enabled=!C,p||(L.outputColorSpace=w?an:Ct,L.toneMapping=P?Pt:cn),R.legacy!==C&&R.set(()=>({legacy:C})),R.linear!==w&&R.set(()=>({linear:w})),R.flat!==P&&R.set(()=>({flat:P})),m&&!A.fun(m)&&!st(m)&&!A.equ(m,L,K)&&$(L,m),c=h,p=!0,v(),this},render(f){return!p&&!u&&this.configure(),u.then(()=>{ge.updateContainer(_.jsx(yr,{store:a,children:f,onCreated:c,rootElement:e}),l,null,()=>{})}),a},unmount(){Dt(e)}}}function yr({store:e,children:t,onCreated:n,rootElement:r}){return ce(()=>{const o=e.getState();o.set(a=>({internal:{...a.internal,active:!0}})),n&&n(o),e.getState().events.connected||o.events.connect==null||o.events.connect(r)},[]),_.jsx(qe.Provider,{value:e,children:t})}function Dt(e,t){const n=Q.get(e),r=n?.fiber;if(r){const o=n?.store.getState();o&&(o.internal.active=!1),ge.updateContainer(null,r,null,()=>{o&&setTimeout(()=>{try{var a,l,c,i;o.events.disconnect==null||o.events.disconnect(),(a=o.gl)==null||(l=a.renderLists)==null||l.dispose==null||l.dispose(),(c=o.gl)==null||c.forceContextLoss==null||c.forceContextLoss(),(i=o.gl)!=null&&i.xr&&o.xr.disconnect(),Qn(o.scene),Q.delete(e)}catch{}},500)})}}function wr(e,t,n){return _.jsx(Er,{children:e,container:t,state:n})}function Er({state:e={},children:t,container:n}){const{events:r,size:o,...a}=e,l=We(),[c]=s.useState(()=>new wt),[i]=s.useState(()=>new xt),p=Ue((f,v)=>{let m;if(v.camera&&o){const E=v.camera;m=f.viewport.getCurrentViewport(E,new N,o),E!==f.camera&&Ot(E,o)}return{...f,...v,scene:n,raycaster:c,pointer:i,mouse:i,previousRoot:l,events:{...f.events,...v.events,...r},size:{...f.size,...o},viewport:{...f.viewport,...m},setEvents:E=>v.set(b=>({...b,events:{...b.events,...E}}))}}),u=s.useMemo(()=>{const f=yt((m,E)=>({...a,set:m,get:E})),v=m=>f.setState(E=>p.current(m,E));return v(l.getState()),l.subscribe(v),f},[l,n]);return _.jsx(_.Fragment,{children:ge.createPortal(_.jsx(qe.Provider,{value:u,children:t}),u,null)})}const Cr=new Set,Pr=new Set,xr=new Set;function je(e,t){if(e.size)for(const{callback:n}of e.values())n(t)}function ie(e,t){switch(e){case"before":return je(Cr,t);case"after":return je(Pr,t);case"tail":return je(xr,t)}}let Se,Me;function ze(e,t,n){let r=t.clock.getDelta();t.frameloop==="never"&&typeof e=="number"&&(r=e-t.clock.elapsedTime,t.clock.oldTime=t.clock.elapsedTime,t.clock.elapsedTime=e),Se=t.internal.subscribers;for(let o=0;o<Se.length;o++)Me=Se[o],Me.ref.current(Me.store.getState(),r,n);return!t.internal.priority&&t.gl.render&&t.gl.render(t.scene,t.camera),t.internal.frames=Math.max(0,t.internal.frames-1),t.frameloop==="always"?1:t.internal.frames}let be=!1,He=!1,Re,lt,ee;function zt(e){lt=requestAnimationFrame(zt),be=!0,Re=0,ie("before",e),He=!0;for(const n of Q.values()){var t;ee=n.store.getState(),ee.internal.active&&(ee.frameloop==="always"||ee.internal.frames>0)&&!((t=ee.gl.xr)!=null&&t.isPresenting)&&(Re+=ze(e,ee))}if(He=!1,ie("after",e),Re===0)return ie("tail",e),be=!1,cancelAnimationFrame(lt)}function Be(e,t=1){var n;if(!e)return Q.forEach(r=>Be(r.store.getState(),t));(n=e.gl.xr)!=null&&n.isPresenting||!e.internal.active||e.frameloop==="never"||(t>1?e.internal.frames=Math.min(60,e.internal.frames+t):He?e.internal.frames=2:e.internal.frames=1,be||(be=!0,requestAnimationFrame(zt)))}function ut(e,t=!0,n,r){if(t&&ie("before",e),n)ze(e,n,r);else for(const o of Q.values())ze(e,o.store.getState());t&&ie("after",e)}const Te={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function jr(e){const{handlePointer:t}=or(e);return{priority:1,enabled:!0,compute(n,r,o){r.pointer.set(n.offsetX/r.size.width*2-1,-(n.offsetY/r.size.height)*2+1),r.raycaster.setFromCamera(r.pointer,r.camera)},connected:void 0,handlers:Object.keys(Te).reduce((n,r)=>({...n,[r]:t(r)}),{}),update:()=>{var n;const{events:r,internal:o}=e.getState();(n=o.lastEvent)!=null&&n.current&&r.handlers&&r.handlers.onPointerMove(o.lastEvent.current)},connect:n=>{const{set:r,events:o}=e.getState();if(o.disconnect==null||o.disconnect(),r(a=>({events:{...a.events,connected:n}})),o.handlers)for(const a in o.handlers){const l=o.handlers[a],[c,i]=Te[a];n.addEventListener(c,l,{passive:i})}},disconnect:()=>{const{set:n,events:r}=e.getState();if(r.connected){if(r.handlers)for(const o in r.handlers){const a=r.handlers[o],[l]=Te[o];r.connected.removeEventListener(l,a)}n(o=>({events:{...o.events,connected:void 0}}))}}}}function Sr({ref:e,children:t,fallback:n,resize:r,style:o,gl:a,events:l=jr,eventSource:c,eventPrefix:i,shadows:p,linear:u,flat:f,legacy:v,orthographic:m,frameloop:E,dpr:b,performance:g,raycaster:h,camera:d,scene:w,onPointerMissed:P,onCreated:C,...y}){s.useMemo(()=>Xe(dn),[]);const I=Vn(),[S,j]=Qt({scroll:!0,debounce:{scroll:50,resize:0},...r}),M=s.useRef(null),k=s.useRef(null);s.useImperativeHandle(e,()=>M.current);const H=Ue(P),[R,L]=s.useState(!1),[T,V]=s.useState(!1);if(R)throw R;if(T)throw T;const q=s.useRef(null);ce(()=>{const U=M.current;if(j.width>0&&j.height>0&&U){q.current||(q.current=br(U));async function Y(){await q.current.configure({gl:a,scene:w,events:l,shadows:p,linear:u,flat:f,legacy:v,orthographic:m,frameloop:E,dpr:b,performance:g,raycaster:h,camera:d,size:j,onPointerMissed:(...x)=>H.current==null?void 0:H.current(...x),onCreated:x=>{x.events.connect==null||x.events.connect(c?Wn(c)?c.current:c:k.current),i&&x.setEvents({compute:(F,G)=>{const D=F[i+"X"],X=F[i+"Y"];G.pointer.set(D/G.size.width*2-1,-(X/G.size.height)*2+1),G.raycaster.setFromCamera(G.pointer,G.camera)}}),C?.(x)}}),q.current.render(_.jsx(I,{children:_.jsx($n,{set:V,children:_.jsx(s.Suspense,{fallback:_.jsx(Yn,{set:L}),children:t??null})})}))}Y()}}),s.useEffect(()=>{const U=M.current;if(U)return()=>Dt(U)},[]);const W=c?"none":"auto";return _.jsx("div",{ref:k,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:W,...o},...y,children:_.jsx("div",{ref:S,style:{width:"100%",height:"100%"},children:_.jsx("canvas",{ref:M,style:{display:"block"},children:n})})})}function Vr(e){return _.jsx(Zt,{children:_.jsx(Sr,{...e})})}function z(){return z=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},z.apply(null,arguments)}const Yr=s.forwardRef(({sdfGlyphSize:e=64,anchorX:t="center",anchorY:n="middle",font:r,fontSize:o=1,children:a,characters:l,onSync:c,...i},p)=>{const u=O(({invalidate:E})=>E),[f]=s.useState(()=>new pn),[v,m]=s.useMemo(()=>{const E=[];let b="";return s.Children.forEach(a,g=>{typeof g=="string"||typeof g=="number"?b+=g:E.push(g)}),[E,b]},[a]);return bt(()=>new Promise(E=>mn({font:r,characters:l},E)),["troika-text",r,l]),s.useLayoutEffect(()=>void f.sync(()=>{u(),c&&c(f)})),s.useEffect(()=>()=>f.dispose(),[f]),s.createElement("primitive",z({object:f,ref:p,font:r,text:m,anchorX:t,anchorY:n,fontSize:o,sdfGlyphSize:e},i),v)});function Mr(e,t,n,r){var o;return o=class extends vn{constructor(a){super({vertexShader:t,fragmentShader:n,...a});for(const l in e)this.uniforms[l]=new hn(e[l]),Object.defineProperty(this,l,{get(){return this.uniforms[l].value},set(c){this.uniforms[l].value=c}});this.uniforms=gn.clone(this.uniforms)}},o.key=bn.generateUUID(),o}const Oe=e=>e===Object(e)&&!Array.isArray(e)&&typeof e!="function";function Ht(e,t){const n=O(a=>a.gl),r=Z(Ge,Oe(e)?Object.values(e):e);return s.useLayoutEffect(()=>{t?.(r)},[t]),s.useEffect(()=>{if("initTexture"in n){let a=[];Array.isArray(r)?a=r:r instanceof Qe?a=[r]:Oe(r)&&(a=Object.values(r)),a.forEach(l=>{l instanceof Qe&&n.initTexture(l)})}},[n,r]),s.useMemo(()=>{if(Oe(e)){const a={};let l=0;for(const c in e)a[c]=r[l++];return a}else return r},[e,r])}Ht.preload=e=>Z.preload(Ge,e);Ht.clear=e=>Z.clear(Ge,e);const Rr=()=>parseInt(yn.replace(/\D+/g,"")),Tr=Rr();let fe=null,Bt="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function Gt(e=!0,t=!0,n){return r=>{n&&n(r),e&&(fe||(fe=new wn),fe.setDecoderPath(typeof e=="string"?e:Bt),r.setDRACOLoader(fe)),t&&r.setMeshoptDecoder(typeof Ce=="function"?Ce():Ce)}}const Ye=(e,t,n,r)=>Z(Ne,e,Gt(t,n,r));Ye.preload=(e,t,n,r)=>Z.preload(Ne,e,Gt(t,n,r));Ye.clear=e=>Z.clear(Ne,e);Ye.setDecoderPath=e=>{Bt=e};function Or(e,t,n){const r=O(m=>m.size),o=O(m=>m.viewport),a=typeof e=="number"?e:r.width*o.dpr,l=r.height*o.dpr,c=(typeof e=="number"?n:e)||{},{samples:i=0,depth:p,...u}=c,f=p??c.depthBuffer,v=s.useMemo(()=>{const m=new En(a,l,{minFilter:Je,magFilter:Je,type:jt,...u});return f&&(m.depthTexture=new Cn(a,l,Pn)),m.samples=i,m},[]);return s.useLayoutEffect(()=>{v.setSize(a,l),i&&(v.samples=i)},[i,v,a,l]),s.useEffect(()=>()=>v.dispose(),[]),v}const kr=e=>typeof e=="function",Ir=s.forwardRef(({envMap:e,resolution:t=256,frames:n=1/0,children:r,makeDefault:o,...a},l)=>{const c=O(({set:g})=>g),i=O(({camera:g})=>g),p=O(({size:g})=>g),u=s.useRef(null);s.useImperativeHandle(l,()=>u.current,[]);const f=s.useRef(null),v=Or(t);s.useLayoutEffect(()=>{a.manual||u.current.updateProjectionMatrix()},[p,a]),s.useLayoutEffect(()=>{u.current.updateProjectionMatrix()}),s.useLayoutEffect(()=>{if(o){const g=i;return c(()=>({camera:u.current})),()=>c(()=>({camera:g}))}},[u,o,c]);let m=0,E=null;const b=kr(r);return se(g=>{b&&(n===1/0||m<n)&&(f.current.visible=!1,g.gl.setRenderTarget(v),E=g.scene.background,e&&(g.scene.background=e),g.gl.render(g.scene,u.current),g.scene.background=E,g.gl.setRenderTarget(null),f.current.visible=!0,m++)}),s.createElement(s.Fragment,null,s.createElement("orthographicCamera",z({left:p.width/-2,right:p.width/2,top:p.height/2,bottom:p.height/-2,ref:u},a),!b&&r),s.createElement("group",{ref:f},b&&r(v.texture)))}),$r=s.forwardRef(({makeDefault:e,camera:t,regress:n,domElement:r,enableDamping:o=!0,keyEvents:a=!1,onChange:l,onStart:c,onEnd:i,...p},u)=>{const f=O(y=>y.invalidate),v=O(y=>y.camera),m=O(y=>y.gl),E=O(y=>y.events),b=O(y=>y.setEvents),g=O(y=>y.set),h=O(y=>y.get),d=O(y=>y.performance),w=t||v,P=r||E.connected||m.domElement,C=s.useMemo(()=>new xn(w),[w]);return se(()=>{C.enabled&&C.update()},-1),s.useEffect(()=>(a&&C.connect(a===!0?P:a),C.connect(P),()=>void C.dispose()),[a,P,n,C,f]),s.useEffect(()=>{const y=j=>{f(),n&&d.regress(),l&&l(j)},I=j=>{c&&c(j)},S=j=>{i&&i(j)};return C.addEventListener("change",y),C.addEventListener("start",I),C.addEventListener("end",S),()=>{C.removeEventListener("start",I),C.removeEventListener("end",S),C.removeEventListener("change",y)}},[l,c,i,C,f,b]),s.useEffect(()=>{if(e){const y=h().controls;return g({controls:C}),()=>g({controls:y})}},[e,C]),s.createElement("primitive",z({ref:u,object:C,enableDamping:o},p))}),Zr=s.forwardRef(({children:e,domElement:t,onChange:n,onMouseDown:r,onMouseUp:o,onObjectChange:a,object:l,makeDefault:c,camera:i,enabled:p,axis:u,mode:f,translationSnap:v,rotationSnap:m,scaleSnap:E,space:b,size:g,showX:h,showY:d,showZ:w,...P},C)=>{const y=O(x=>x.controls),I=O(x=>x.gl),S=O(x=>x.events),j=O(x=>x.camera),M=O(x=>x.invalidate),k=O(x=>x.get),H=O(x=>x.set),R=i||j,L=t||S.connected||I.domElement,T=s.useMemo(()=>new jn(R,L),[R,L]),V=s.useRef(null);s.useLayoutEffect(()=>(l?T.attach(l instanceof Ae?l:l.current):V.current instanceof Ae&&T.attach(V.current),()=>void T.detach()),[l,e,T]),s.useEffect(()=>{if(y){const x=F=>y.enabled=!F.value;return T.addEventListener("dragging-changed",x),()=>T.removeEventListener("dragging-changed",x)}},[T,y]);const q=s.useRef(void 0),W=s.useRef(void 0),U=s.useRef(void 0),Y=s.useRef(void 0);return s.useLayoutEffect(()=>void(q.current=n),[n]),s.useLayoutEffect(()=>void(W.current=r),[r]),s.useLayoutEffect(()=>void(U.current=o),[o]),s.useLayoutEffect(()=>void(Y.current=a),[a]),s.useEffect(()=>{const x=X=>{M(),q.current==null||q.current(X)},F=X=>W.current==null?void 0:W.current(X),G=X=>U.current==null?void 0:U.current(X),D=X=>Y.current==null?void 0:Y.current(X);return T.addEventListener("change",x),T.addEventListener("mouseDown",F),T.addEventListener("mouseUp",G),T.addEventListener("objectChange",D),()=>{T.removeEventListener("change",x),T.removeEventListener("mouseDown",F),T.removeEventListener("mouseUp",G),T.removeEventListener("objectChange",D)}},[M,T]),s.useEffect(()=>{if(c){const x=k().controls;return H({controls:T}),()=>H({controls:x})}},[c,T]),s.createElement(s.Fragment,null,s.createElement("primitive",{ref:C,object:T,enabled:p,axis:u,mode:f,translationSnap:v,rotationSnap:m,scaleSnap:E,space:b,size:g,showX:h,showY:d,showZ:w}),s.createElement("group",z({ref:V},P),e))});function Fr({defaultScene:e,defaultCamera:t,renderPriority:n=1}){const{gl:r,scene:o,camera:a}=O();let l;return se(()=>{l=r.autoClear,n===1&&(r.autoClear=!0,r.render(e,t)),r.autoClear=!1,r.clearDepth(),r.render(o,a),r.autoClear=l},n),s.createElement("group",{onPointerOver:()=>null})}function Lr({children:e,renderPriority:t=1}){const{scene:n,camera:r}=O(),[o]=s.useState(()=>new Et);return s.createElement(s.Fragment,null,wr(s.createElement(s.Fragment,null,e,s.createElement(Fr,{defaultScene:n,defaultCamera:r,renderPriority:t})),o,{events:{priority:t+1}}))}const Nt=s.createContext({}),Ar=()=>s.useContext(Nt),_r=2*Math.PI,ke=new Ae,ft=new Sn,[te,Ie]=[new Ke,new Ke],dt=new N,pt=new N,Dr=e=>"minPolarAngle"in e,mt=e=>"getTarget"in e,Qr=({alignment:e="bottom-right",margin:t=[80,80],renderPriority:n=1,onUpdate:r,onTarget:o,children:a})=>{const l=O(y=>y.size),c=O(y=>y.camera),i=O(y=>y.controls),p=O(y=>y.invalidate),u=s.useRef(null),f=s.useRef(null),v=s.useRef(!1),m=s.useRef(0),E=s.useRef(new N(0,0,0)),b=s.useRef(new N(0,0,0));s.useEffect(()=>{b.current.copy(c.up),ke.up.copy(c.up)},[c]);const g=s.useCallback(y=>{v.current=!0,(i||o)&&(E.current=o?.()||(mt(i)?i.getTarget(E.current):i?.target)),m.current=c.position.distanceTo(dt),te.copy(c.quaternion),pt.copy(y).multiplyScalar(m.current).add(dt),ke.lookAt(pt),Ie.copy(ke.quaternion),p()},[i,c,o,p]);se((y,I)=>{if(f.current&&u.current){var S;if(v.current)if(te.angleTo(Ie)<.01)v.current=!1,Dr(i)&&c.up.copy(b.current);else{const j=I*_r;te.rotateTowards(Ie,j),c.position.set(0,0,1).applyQuaternion(te).multiplyScalar(m.current).add(E.current),c.up.set(0,1,0).applyQuaternion(te).normalize(),c.quaternion.copy(te),mt(i)&&i.setPosition(c.position.x,c.position.y,c.position.z),r?r():i&&i.update(I),p()}ft.copy(c.matrix).invert(),(S=u.current)==null||S.quaternion.setFromRotationMatrix(ft)}});const h=s.useMemo(()=>({tweenCamera:g}),[g]),[d,w]=t,P=e.endsWith("-center")?0:e.endsWith("-left")?-l.width/2+d:l.width/2-d,C=e.startsWith("center-")?0:e.startsWith("top-")?l.height/2-w:-l.height/2+w;return s.createElement(Lr,{renderPriority:n},s.createElement(Nt.Provider,{value:h},s.createElement(Ir,{makeDefault:!0,ref:f,position:[0,0,200]}),s.createElement("group",{ref:u,position:[P,C,0]},a)))};function Fe({scale:e=[.8,.05,.05],color:t,rotation:n}){return s.createElement("group",{rotation:n},s.createElement("mesh",{position:[.4,0,0]},s.createElement("boxGeometry",{args:e}),s.createElement("meshBasicMaterial",{color:t,toneMapped:!1})))}function ne({onClick:e,font:t,disabled:n,arcStyle:r,label:o,labelColor:a,axisHeadScale:l=1,...c}){const i=O(b=>b.gl),p=s.useMemo(()=>{const b=document.createElement("canvas");b.width=64,b.height=64;const g=b.getContext("2d");return g.beginPath(),g.arc(32,32,16,0,2*Math.PI),g.closePath(),g.fillStyle=r,g.fill(),o&&(g.font=t,g.textAlign="center",g.fillStyle=a,g.fillText(o,32,41)),new Mn(b)},[r,o,a,t]),[u,f]=s.useState(!1),v=(o?1:.75)*(u?1.2:1)*l,m=b=>{b.stopPropagation(),f(!0)},E=b=>{b.stopPropagation(),f(!1)};return s.createElement("sprite",z({scale:v,onPointerOver:n?void 0:m,onPointerOut:n?void 0:e||E},c),s.createElement("spriteMaterial",{map:p,"map-anisotropy":i.capabilities.getMaxAnisotropy()||1,alphaTest:.3,opacity:o?1:.75,toneMapped:!1}))}const Jr=({hideNegativeAxes:e,hideAxisHeads:t,disabled:n,font:r="18px Inter var, Arial, sans-serif",axisColors:o=["#ff2060","#20df80","#2080ff"],axisHeadScale:a=1,axisScale:l,labels:c=["X","Y","Z"],labelColor:i="#000",onClick:p,...u})=>{const[f,v,m]=o,{tweenCamera:E}=Ar(),b={font:r,disabled:n,labelColor:i,onClick:p,axisHeadScale:a,onPointerDown:n?void 0:g=>{E(g.object.position),g.stopPropagation()}};return s.createElement("group",z({scale:40},u),s.createElement(Fe,{color:f,rotation:[0,0,0],scale:l}),s.createElement(Fe,{color:v,rotation:[0,0,Math.PI/2],scale:l}),s.createElement(Fe,{color:m,rotation:[0,-Math.PI/2,0],scale:l}),!t&&s.createElement(s.Fragment,null,s.createElement(ne,z({arcStyle:f,position:[1,0,0],label:c[0]},b)),s.createElement(ne,z({arcStyle:v,position:[0,1,0],label:c[1]},b)),s.createElement(ne,z({arcStyle:m,position:[0,0,1],label:c[2]},b)),!e&&s.createElement(s.Fragment,null,s.createElement(ne,z({arcStyle:f,position:[-1,0,0]},b)),s.createElement(ne,z({arcStyle:v,position:[0,-1,0]},b)),s.createElement(ne,z({arcStyle:m,position:[0,0,-1]},b)))))},zr=Mr({cellSize:.5,sectionSize:1,fadeDistance:100,fadeStrength:1,fadeFrom:1,cellThickness:.5,sectionThickness:1,cellColor:new Le,sectionColor:new Le,infiniteGrid:!1,followCamera:!1,worldCamProjPosition:new N,worldPlanePosition:new N},`
    varying vec3 localPosition;
    varying vec4 worldPosition;

    uniform vec3 worldCamProjPosition;
    uniform vec3 worldPlanePosition;
    uniform float fadeDistance;
    uniform bool infiniteGrid;
    uniform bool followCamera;

    void main() {
      localPosition = position.xzy;
      if (infiniteGrid) localPosition *= 1.0 + fadeDistance;
      
      worldPosition = modelMatrix * vec4(localPosition, 1.0);
      if (followCamera) {
        worldPosition.xyz += (worldCamProjPosition - worldPlanePosition);
        localPosition = (inverse(modelMatrix) * worldPosition).xyz;
      }

      gl_Position = projectionMatrix * viewMatrix * worldPosition;
    }
  `,`
    varying vec3 localPosition;
    varying vec4 worldPosition;

    uniform vec3 worldCamProjPosition;
    uniform float cellSize;
    uniform float sectionSize;
    uniform vec3 cellColor;
    uniform vec3 sectionColor;
    uniform float fadeDistance;
    uniform float fadeStrength;
    uniform float fadeFrom;
    uniform float cellThickness;
    uniform float sectionThickness;

    float getGrid(float size, float thickness) {
      vec2 r = localPosition.xz / size;
      vec2 grid = abs(fract(r - 0.5) - 0.5) / fwidth(r);
      float line = min(grid.x, grid.y) + 1.0 - thickness;
      return 1.0 - min(line, 1.0);
    }

    void main() {
      float g1 = getGrid(cellSize, cellThickness);
      float g2 = getGrid(sectionSize, sectionThickness);

      vec3 from = worldCamProjPosition*vec3(fadeFrom);
      float dist = distance(from, worldPosition.xyz);
      float d = 1.0 - min(dist / fadeDistance, 1.0);
      vec3 color = mix(cellColor, sectionColor, min(1.0, sectionThickness * g2));

      gl_FragColor = vec4(color, (g1 + g2) * pow(d, fadeStrength));
      gl_FragColor.a = mix(0.75 * gl_FragColor.a, gl_FragColor.a, g2);
      if (gl_FragColor.a <= 0.0) discard;

      #include <tonemapping_fragment>
      #include <${Tr>=154?"colorspace_fragment":"encodings_fragment"}>
    }
  `),Kr=s.forwardRef(({args:e,cellColor:t="#000000",sectionColor:n="#2080ff",cellSize:r=.5,sectionSize:o=1,followCamera:a=!1,infiniteGrid:l=!1,fadeDistance:c=100,fadeStrength:i=1,fadeFrom:p=1,cellThickness:u=.5,sectionThickness:f=1,side:v=Tn,...m},E)=>{Xe({GridMaterial:zr});const b=s.useRef(null);s.useImperativeHandle(E,()=>b.current,[]);const g=new Rn,h=new N(0,1,0),d=new N(0,0,0);se(C=>{g.setFromNormalAndCoplanarPoint(h,d).applyMatrix4(b.current.matrixWorld);const y=b.current.material,I=y.uniforms.worldCamProjPosition,S=y.uniforms.worldPlanePosition;g.projectPoint(C.camera.position,I.value),S.value.set(0,0,0).applyMatrix4(b.current.matrixWorld)});const w={cellSize:r,sectionSize:o,cellColor:t,sectionColor:n,cellThickness:u,sectionThickness:f},P={fadeDistance:c,fadeStrength:i,fadeFrom:p,infiniteGrid:l,followCamera:a};return s.createElement("mesh",z({ref:b,frustumCulled:!1},m),s.createElement("gridMaterial",z({transparent:!0,"extensions-derivatives":!0,side:v},w,P)),s.createElement("planeGeometry",{args:e}))});function Hr(e,t){const n=e+"Geometry";return s.forwardRef(({args:r,children:o,...a},l)=>{const c=s.useRef(null);return s.useImperativeHandle(l,()=>c.current),s.useLayoutEffect(()=>void t?.(c.current)),s.createElement("mesh",z({ref:c},a),s.createElement(n,{attach:"geometry",args:r}),o)})}const eo=Hr("box");function to({all:e,scene:t,camera:n}){const r=O(({gl:l})=>l),o=O(({camera:l})=>l),a=O(({scene:l})=>l);return s.useLayoutEffect(()=>{const l=[];e&&(t||a).traverse(p=>{p.visible===!1&&(l.push(p),p.visible=!0)}),r.compile(t||a,n||o);const c=new On(128);new kn(.01,1e5,c).update(r,t||a),c.dispose(),l.forEach(p=>p.visible=!1)},[]),null}const Br=s.createContext(null),we=s.createContext(null),vt=e=>(e.getAttributes()&2)===2,no=s.memo(s.forwardRef(({children:e,camera:t,scene:n,resolutionScale:r,enabled:o=!0,renderPriority:a=1,autoClear:l=!0,depthBuffer:c,enableNormalPass:i,stencilBuffer:p,multisampling:u=8,frameBufferType:f=jt},v)=>{const{gl:m,scene:E,camera:b,size:g}=O(),h=n||E,d=t||b,[w,P,C]=s.useMemo(()=>{const S=new _n(m,{depthBuffer:c,stencilBuffer:p,multisampling:u,frameBufferType:f});S.addPass(new Dn(h,d));let j=null,M=null;return i&&(M=new zn(h,d),M.enabled=!1,S.addPass(M),r!==void 0&&(j=new Hn({normalBuffer:M.texture,resolutionScale:r}),j.enabled=!1,S.addPass(j))),[S,M,j]},[d,m,c,p,u,f,h,i,r]);s.useEffect(()=>w?.setSize(g.width,g.height),[w,g]),se((S,j)=>{if(o){const M=m.autoClear;m.autoClear=l,p&&!l&&m.clearStencil(),w.render(j),m.autoClear=M}},o?a:0);const y=s.useRef(null);s.useLayoutEffect(()=>{const S=[],j=y.current.__r3f;if(j&&w){const M=j.children;for(let k=0;k<M.length;k++){const H=M[k].object;if(H instanceof et){const R=[H];if(!vt(H)){let T=null;for(;(T=M[k+1]?.object)instanceof et&&!vt(T);)R.push(T),k++}const L=new Bn(d,...R);S.push(L)}else H instanceof Gn&&S.push(H)}for(const k of S)w?.addPass(k);P&&(P.enabled=!0),C&&(C.enabled=!0)}return()=>{for(const M of S)w?.removePass(M);P&&(P.enabled=!1),C&&(C.enabled=!1)}},[w,e,d,P,C]),s.useEffect(()=>{const S=m.toneMapping;return m.toneMapping=Pt,()=>{m.toneMapping=S}},[m]);const I=s.useMemo(()=>({composer:w,normalPass:P,downSamplingPass:C,resolutionScale:r,camera:d,scene:h}),[w,P,C,r,d,h]);return s.useImperativeHandle(v,()=>w,[w]),_.jsx(we.Provider,{value:I,children:_.jsx("group",{ref:y,children:e})})})),ht=e=>typeof e=="object"&&e!=null&&"current"in e?e.current:e;let Gr=0;const gt=new WeakMap,Nr=(e,t)=>function({blendFunction:n=t?.blendFunction,opacity:r=t?.opacity,...o}){let a=gt.get(e);if(!a){const i=`@react-three/postprocessing/${e.name}-${Gr++}`;Xe({[i]:e}),gt.set(e,a=i)}const l=O(i=>i.camera),c=Jt.useMemo(()=>[...t?.args??[],...o.args??[{...t,...o}]],[JSON.stringify(o)]);return _.jsx(a,{camera:l,"blendMode-blendFunction":n,"blendMode-opacity-value":r,...o,args:c})},ro=s.forwardRef(function({blendFunction:e,worldFocusDistance:t,worldFocusRange:n,focusDistance:r,focusRange:o,focalLength:a,bokehScale:l,resolutionScale:c,resolutionX:i,resolutionY:p,width:u,height:f,target:v,depthTexture:m,...E},b){const{camera:g}=s.useContext(we),h=v!=null,d=s.useMemo(()=>{const w=new Fn(g,{blendFunction:e,worldFocusDistance:t,worldFocusRange:n,focusDistance:r,focusRange:o,focalLength:a,bokehScale:l,resolutionScale:c,resolutionX:i,resolutionY:p,width:u,height:f});h&&(w.target=new N),m&&w.setDepthTexture(m.texture,m.packing);const P=w.maskPass;return P.maskFunction=Ln.MULTIPLY_RGB_SET_ALPHA,w},[g,e,t,n,r,o,a,l,c,i,p,u,f,h,m]);return s.useEffect(()=>()=>{d.dispose()},[d]),_.jsx("primitive",{...E,ref:b,object:d,target:v})}),oo=s.forwardRef(function({selection:e=[],selectionLayer:t=10,blendFunction:n,patternTexture:r,edgeStrength:o,pulseSpeed:a,visibleEdgeColor:l,hiddenEdgeColor:c,width:i,height:p,kernelSize:u,blur:f,xRay:v,...m},E){const b=O(P=>P.invalidate),{scene:g,camera:h}=s.useContext(we),d=s.useMemo(()=>new An(g,h,{blendFunction:n,patternTexture:r,edgeStrength:o,pulseSpeed:a,visibleEdgeColor:l,hiddenEdgeColor:c,width:i,height:p,kernelSize:u,blur:f,xRay:v,...m}),[n,f,h,o,p,c,u,r,a,g,l,i,v]),w=s.useContext(Br);return s.useEffect(()=>{if(!w&&e)return d.selection.set(Array.isArray(e)?e.map(ht):[ht(e)]),b(),()=>{d.selection.clear(),b()}},[d,e,w,b]),s.useEffect(()=>{d.selectionLayer=t,b()},[d,b,t]),s.useRef(void 0),s.useEffect(()=>{if(w&&w.enabled&&w.selected?.length)return d.selection.set(w.selected),b(),()=>{d.selection.clear(),b()}},[w,d.selection,b]),s.useEffect(()=>()=>{d.dispose()},[d]),_.jsx("primitive",{ref:E,object:d})}),so=s.forwardRef(function(e,t){const{camera:n,normalPass:r,downSamplingPass:o,resolutionScale:a}=s.useContext(we),l=s.useMemo(()=>r===null&&o===null?(console.error("Please enable the NormalPass in the EffectComposer in order to use SSAO."),{}):new In(n,r&&!o?r.texture:null,{blendFunction:21,samples:30,rings:4,distanceThreshold:1,distanceFalloff:0,rangeThreshold:.5,rangeFalloff:.1,luminanceInfluence:.9,radius:20,bias:.5,intensity:1,color:void 0,normalDepthBuffer:o?o.texture:null,resolutionScale:a??1,depthAwareUpsampling:!0,...e}),[n,o,r,a]);return _.jsx("primitive",{ref:t,object:l,dispose:null})}),io=Nr(Nn);export{eo as B,Vr as C,Kr as G,so as I,io as L,$r as O,to as P,Yr as T,Wr as _,se as a,Ht as b,Ye as c,ro as d,Zr as e,oo as f,no as g,Qr as h,Jr as i,O as u};
