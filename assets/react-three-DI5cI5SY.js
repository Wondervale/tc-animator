import{i as gn,k as _t,r as s,p as yn,m as bn,j as W,n as wn,x as Pn,q as xn,t as Ee,v as En,w as Cn,y as Mn,z as jn,W as Sn}from"./react-Bp6ARjJk.js";import{W as Rn,R as zt,O as Ke,P as et,S as Ht,a as Ie,V as Tn,b as On,B as Fn,C as In,L as kn,c as Wt,N as Bt,A as An,d as tt,e as G,f as vt,g as qe,h as Ln,U as Dn,i as _n,T as zn,D as Hn,j as Wn,p as Bn,k as Nn,l as Gn,m as Un,M as qn,n as ht,o as nt,q as $n,G as rt,r as Vn,s as ke,t as Xn,H as Nt,u as gt,v as Yn,F as Zn,w as Qn,x as Jn,y as $e,Q as yt,z as Kn,E as er,I as tr,J as nr,K as rr,X as or,Y as sr,Z as ir,_ as ar,$ as cr,a0 as lr,a1 as ur,a2 as fr,a3 as bt,a4 as dr,a5 as pr,a6 as mr}from"./three-B8WDGRLw.js";import{c as Gt}from"./zustand-Dy9N9sSW.js";const vr="modulepreload",hr=function(e){return"/tc-animator/"+e},wt={},So=function(t,n,r){let o=Promise.resolve();if(n&&n.length>0){let a=function(d){return Promise.all(d.map(f=>Promise.resolve(f).then(u=>({status:"fulfilled",value:u}),u=>({status:"rejected",reason:u}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=l?.nonce||l?.getAttribute("nonce");o=a(n.map(d=>{if(d=hr(d),d in wt)return;wt[d]=!0;const f=d.endsWith(".css"),u=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${u}`))return;const v=document.createElement("link");if(v.rel=f?"stylesheet":vr,f||(v.as="script"),v.crossOrigin="",v.href=d,c&&v.setAttribute("nonce",c),document.head.appendChild(v),f)return new Promise((m,w)=>{v.addEventListener("load",m),v.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${d}`)))})}))}function i(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return o.then(l=>{for(const c of l||[])c.status==="rejected"&&i(c.reason);return t().catch(i)})};var Pt=gn();function Ut(e){let t=e.root;for(;t.getState().previousRoot;)t=t.getState().previousRoot;return t}const qt=e=>e&&e.isOrthographicCamera,gr=e=>e&&e.hasOwnProperty("current"),yr=e=>e!=null&&(typeof e=="string"||typeof e=="number"||e.isColor),ge=((e,t)=>typeof window<"u"&&(((e=window.document)==null?void 0:e.createElement)||((t=window.navigator)==null?void 0:t.product)==="ReactNative"))()?s.useLayoutEffect:s.useEffect;function ot(e){const t=s.useRef(e);return ge(()=>void(t.current=e),[e]),t}function br(){const e=wn(),t=Pn();return s.useMemo(()=>({children:n})=>{const o=!!xn(e,!0,i=>i.type===s.StrictMode)?s.StrictMode:s.Fragment;return W.jsx(o,{children:W.jsx(t,{children:n})})},[e,t])}function wr({set:e}){return ge(()=>(e(new Promise(()=>null)),()=>e(!1)),[e]),null}const Pr=(e=>(e=class extends s.Component{constructor(...n){super(...n),this.state={error:!1}}componentDidCatch(n){this.props.set(n)}render(){return this.state.error?null:this.props.children}},e.getDerivedStateFromError=()=>({error:!0}),e))();function $t(e){var t;const n=typeof window<"u"?(t=window.devicePixelRatio)!=null?t:2:1;return Array.isArray(e)?Math.min(Math.max(e[0],n),e[1]):e}function ie(e){var t;return(t=e.__r3f)==null?void 0:t.root.getState()}const z={obj:e=>e===Object(e)&&!z.arr(e)&&typeof e!="function",fun:e=>typeof e=="function",str:e=>typeof e=="string",num:e=>typeof e=="number",boo:e=>typeof e=="boolean",und:e=>e===void 0,nul:e=>e===null,arr:e=>Array.isArray(e),equ(e,t,{arrays:n="shallow",objects:r="reference",strict:o=!0}={}){if(typeof e!=typeof t||!!e!=!!t)return!1;if(z.str(e)||z.num(e)||z.boo(e))return e===t;const i=z.obj(e);if(i&&r==="reference")return e===t;const l=z.arr(e);if(l&&n==="reference")return e===t;if((l||i)&&e===t)return!0;let c;for(c in e)if(!(c in t))return!1;if(i&&n==="shallow"&&r==="shallow"){for(c in o?t:e)if(!z.equ(e[c],t[c],{strict:o,objects:"reference"}))return!1}else for(c in o?t:e)if(e[c]!==t[c])return!1;if(z.und(c)){if(l&&e.length===0&&t.length===0||i&&Object.keys(e).length===0&&Object.keys(t).length===0)return!0;if(e!==t)return!1}return!0}};function xr(e){const t={nodes:{},materials:{},meshes:{}};return e&&e.traverse(n=>{n.name&&(t.nodes[n.name]=n),n.material&&!t.materials[n.material.name]&&(t.materials[n.material.name]=n.material),n.isMesh&&!t.meshes[n.name]&&(t.meshes[n.name]=n)}),t}function Er(e){e.type!=="Scene"&&(e.dispose==null||e.dispose());for(const t in e){const n=e[t];n?.type!=="Scene"&&(n==null||n.dispose==null||n.dispose())}}const Vt=["children","key","ref"];function Cr(e){const t={};for(const n in e)Vt.includes(n)||(t[n]=e[n]);return t}function Me(e,t,n,r){const o=e;let i=o?.__r3f;return i||(i={root:t,type:n,parent:null,children:[],props:Cr(r),object:o,eventCount:0,handlers:{},isHidden:!1},o&&(o.__r3f=i)),i}function he(e,t){let n=e[t];if(!t.includes("-"))return{root:e,key:t,target:n};n=e;for(const o of t.split("-")){var r;t=o,e=n,n=(r=n)==null?void 0:r[t]}return{root:e,key:t,target:n}}const xt=/-\d+$/;function je(e,t){if(z.str(t.props.attach)){if(xt.test(t.props.attach)){const o=t.props.attach.replace(xt,""),{root:i,key:l}=he(e.object,o);Array.isArray(i[l])||(i[l]=[])}const{root:n,key:r}=he(e.object,t.props.attach);t.previousAttach=n[r],n[r]=t.object}else z.fun(t.props.attach)&&(t.previousAttach=t.props.attach(e.object,t.object))}function Se(e,t){if(z.str(t.props.attach)){const{root:n,key:r}=he(e.object,t.props.attach),o=t.previousAttach;o===void 0?delete n[r]:n[r]=o}else t.previousAttach==null||t.previousAttach(e.object,t.object);delete t.previousAttach}const Ve=[...Vt,"args","dispose","attach","object","onUpdate","dispose"],Et=new Map;function Mr(e){let t=Et.get(e.constructor);try{t||(t=new e.constructor,Et.set(e.constructor,t))}catch{}return t}function jr(e,t){const n={};for(const r in t)if(!Ve.includes(r)&&!z.equ(t[r],e.props[r])){n[r]=t[r];for(const o in t)o.startsWith(`${r}-`)&&(n[o]=t[o])}for(const r in e.props){if(Ve.includes(r)||t.hasOwnProperty(r))continue;const{root:o,key:i}=he(e.object,r);if(o.constructor&&o.constructor.length===0){const l=Mr(o);z.und(l)||(n[i]=l[i])}else n[i]=0}return n}const Sr=["map","emissiveMap","sheenColorMap","specularColorMap","envMap"],Rr=/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/;function J(e,t){var n;const r=e.__r3f,o=r&&Ut(r).getState(),i=r?.eventCount;for(const c in t){let a=t[c];if(Ve.includes(c))continue;if(r&&Rr.test(c)){typeof a=="function"?r.handlers[c]=a:delete r.handlers[c],r.eventCount=Object.keys(r.handlers).length;continue}if(a===void 0)continue;let{root:d,key:f,target:u}=he(e,c);if(u instanceof vt&&a instanceof vt)u.mask=a.mask;else if(u instanceof qe&&yr(a))u.set(a);else if(u!==null&&typeof u=="object"&&typeof u.set=="function"&&typeof u.copy=="function"&&a!=null&&a.constructor&&u.constructor===a.constructor)u.copy(a);else if(u!==null&&typeof u=="object"&&typeof u.set=="function"&&Array.isArray(a))typeof u.fromArray=="function"?u.fromArray(a):u.set(...a);else if(u!==null&&typeof u=="object"&&typeof u.set=="function"&&typeof a=="number")typeof u.setScalar=="function"?u.setScalar(a):u.set(a);else{var l;d[f]=a,o&&!o.linear&&Sr.includes(f)&&(l=d[f])!=null&&l.isTexture&&d[f].format===Ln&&d[f].type===Dn&&(d[f].colorSpace=Wt)}}if(r!=null&&r.parent&&o!=null&&o.internal&&(n=r.object)!=null&&n.isObject3D&&i!==r.eventCount){const c=r.object,a=o.internal.interaction.indexOf(c);a>-1&&o.internal.interaction.splice(a,1),r.eventCount&&c.raycast!==null&&o.internal.interaction.push(c)}return r&&r.props.attach===void 0&&(r.object.isBufferGeometry?r.props.attach="geometry":r.object.isMaterial&&(r.props.attach="material")),r&&de(r),e}function de(e){var t;if(!e.parent)return;e.props.onUpdate==null||e.props.onUpdate(e.object);const n=(t=e.root)==null||t.getState==null?void 0:t.getState();n&&n.internal.frames===0&&n.invalidate()}function Xt(e,t){e.manual||(qt(e)?(e.left=t.width/-2,e.right=t.width/2,e.top=t.height/2,e.bottom=t.height/-2):e.aspect=t.width/t.height,e.updateProjectionMatrix())}const $=e=>e?.isObject3D;function we(e){return(e.eventObject||e.object).uuid+"/"+e.index+e.instanceId}function Yt(e,t,n,r){const o=n.get(t);o&&(n.delete(t),n.size===0&&(e.delete(r),o.target.releasePointerCapture(r)))}function Tr(e,t){const{internal:n}=e.getState();n.interaction=n.interaction.filter(r=>r!==t),n.initialHits=n.initialHits.filter(r=>r!==t),n.hovered.forEach((r,o)=>{(r.eventObject===t||r.object===t)&&n.hovered.delete(o)}),n.capturedMap.forEach((r,o)=>{Yt(n.capturedMap,t,r,o)})}function Or(e){function t(a){const{internal:d}=e.getState(),f=a.offsetX-d.initialClick[0],u=a.offsetY-d.initialClick[1];return Math.round(Math.sqrt(f*f+u*u))}function n(a){return a.filter(d=>["Move","Over","Enter","Out","Leave"].some(f=>{var u;return(u=d.__r3f)==null?void 0:u.handlers["onPointer"+f]}))}function r(a,d){const f=e.getState(),u=new Set,v=[],m=d?d(f.internal.interaction):f.internal.interaction;for(let g=0;g<m.length;g++){const p=ie(m[g]);p&&(p.raycaster.camera=void 0)}f.previousRoot||f.events.compute==null||f.events.compute(a,f);function w(g){const p=ie(g);if(!p||!p.events.enabled||p.raycaster.camera===null)return[];if(p.raycaster.camera===void 0){var P;p.events.compute==null||p.events.compute(a,p,(P=p.previousRoot)==null?void 0:P.getState()),p.raycaster.camera===void 0&&(p.raycaster.camera=null)}return p.raycaster.camera?p.raycaster.intersectObject(g,!0):[]}let b=m.flatMap(w).sort((g,p)=>{const P=ie(g.object),M=ie(p.object);return!P||!M?g.distance-p.distance:M.events.priority-P.events.priority||g.distance-p.distance}).filter(g=>{const p=we(g);return u.has(p)?!1:(u.add(p),!0)});f.events.filter&&(b=f.events.filter(b,f));for(const g of b){let p=g.object;for(;p;){var y;(y=p.__r3f)!=null&&y.eventCount&&v.push({...g,eventObject:p}),p=p.parent}}if("pointerId"in a&&f.internal.capturedMap.has(a.pointerId))for(let g of f.internal.capturedMap.get(a.pointerId).values())u.has(we(g.intersection))||v.push(g.intersection);return v}function o(a,d,f,u){if(a.length){const v={stopped:!1};for(const m of a){let w=ie(m.object);if(w||m.object.traverseAncestors(b=>{const y=ie(b);if(y)return w=y,!1}),w){const{raycaster:b,pointer:y,camera:g,internal:p}=w,P=new G(y.x,y.y,0).unproject(g),M=E=>{var T,S;return(T=(S=p.capturedMap.get(E))==null?void 0:S.has(m.eventObject))!=null?T:!1},x=E=>{const T={intersection:m,target:d.target};p.capturedMap.has(E)?p.capturedMap.get(E).set(m.eventObject,T):p.capturedMap.set(E,new Map([[m.eventObject,T]])),d.target.setPointerCapture(E)},h=E=>{const T=p.capturedMap.get(E);T&&Yt(p.capturedMap,m.eventObject,T,E)};let I={};for(let E in d){let T=d[E];typeof T!="function"&&(I[E]=T)}let R={...m,...I,pointer:y,intersections:a,stopped:v.stopped,delta:f,unprojectedPoint:P,ray:b.ray,camera:g,stopPropagation(){const E="pointerId"in d&&p.capturedMap.get(d.pointerId);if((!E||E.has(m.eventObject))&&(R.stopped=v.stopped=!0,p.hovered.size&&Array.from(p.hovered.values()).find(T=>T.eventObject===m.eventObject))){const T=a.slice(0,a.indexOf(m));i([...T,m])}},target:{hasPointerCapture:M,setPointerCapture:x,releasePointerCapture:h},currentTarget:{hasPointerCapture:M,setPointerCapture:x,releasePointerCapture:h},nativeEvent:d};if(u(R),v.stopped===!0)break}}}return a}function i(a){const{internal:d}=e.getState();for(const f of d.hovered.values())if(!a.length||!a.find(u=>u.object===f.object&&u.index===f.index&&u.instanceId===f.instanceId)){const v=f.eventObject.__r3f;if(d.hovered.delete(we(f)),v!=null&&v.eventCount){const m=v.handlers,w={...f,intersections:a};m.onPointerOut==null||m.onPointerOut(w),m.onPointerLeave==null||m.onPointerLeave(w)}}}function l(a,d){for(let f=0;f<d.length;f++){const u=d[f].__r3f;u==null||u.handlers.onPointerMissed==null||u.handlers.onPointerMissed(a)}}function c(a){switch(a){case"onPointerLeave":case"onPointerCancel":return()=>i([]);case"onLostPointerCapture":return d=>{const{internal:f}=e.getState();"pointerId"in d&&f.capturedMap.has(d.pointerId)&&requestAnimationFrame(()=>{f.capturedMap.has(d.pointerId)&&(f.capturedMap.delete(d.pointerId),i([]))})}}return function(f){const{onPointerMissed:u,internal:v}=e.getState();v.lastEvent.current=f;const m=a==="onPointerMove",w=a==="onClick"||a==="onContextMenu"||a==="onDoubleClick",y=r(f,m?n:void 0),g=w?t(f):0;a==="onPointerDown"&&(v.initialClick=[f.offsetX,f.offsetY],v.initialHits=y.map(P=>P.eventObject)),w&&!y.length&&g<=2&&(l(f,v.interaction),u&&u(f)),m&&i(y);function p(P){const M=P.eventObject,x=M.__r3f;if(!(x!=null&&x.eventCount))return;const h=x.handlers;if(m){if(h.onPointerOver||h.onPointerEnter||h.onPointerOut||h.onPointerLeave){const I=we(P),R=v.hovered.get(I);R?R.stopped&&P.stopPropagation():(v.hovered.set(I,P),h.onPointerOver==null||h.onPointerOver(P),h.onPointerEnter==null||h.onPointerEnter(P))}h.onPointerMove==null||h.onPointerMove(P)}else{const I=h[a];I?(!w||v.initialHits.includes(M))&&(l(f,v.interaction.filter(R=>!v.initialHits.includes(R))),I(P)):w&&v.initialHits.includes(M)&&l(f,v.interaction.filter(R=>!v.initialHits.includes(R)))}}o(y,f,g,p)}}return{handlePointer:c}}const Ct=e=>!!(e!=null&&e.render),st=s.createContext(null),Fr=(e,t)=>{const n=Gt((c,a)=>{const d=new G,f=new G,u=new G;function v(g=a().camera,p=f,P=a().size){const{width:M,height:x,top:h,left:I}=P,R=M/x;p.isVector3?u.copy(p):u.set(...p);const E=g.getWorldPosition(d).distanceTo(u);if(qt(g))return{width:M/g.zoom,height:x/g.zoom,top:h,left:I,factor:1,distance:E,aspect:R};{const T=g.fov*Math.PI/180,S=2*Math.tan(T/2)*E,B=S*(M/x);return{width:B,height:S,top:h,left:I,factor:M/B,distance:E,aspect:R}}}let m;const w=g=>c(p=>({performance:{...p.performance,current:g}})),b=new tt;return{set:c,get:a,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},scene:null,xr:null,invalidate:(g=1)=>e(a(),g),advance:(g,p)=>t(g,p,a()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new _n,pointer:b,mouse:b,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const g=a();m&&clearTimeout(m),g.performance.current!==g.performance.min&&w(g.performance.min),m=setTimeout(()=>w(a().performance.max),g.performance.debounce)}},size:{width:0,height:0,top:0,left:0},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:v},setEvents:g=>c(p=>({...p,events:{...p.events,...g}})),setSize:(g,p,P=0,M=0)=>{const x=a().camera,h={width:g,height:p,top:P,left:M};c(I=>({size:h,viewport:{...I.viewport,...v(x,f,h)}}))},setDpr:g=>c(p=>{const P=$t(g);return{viewport:{...p.viewport,dpr:P,initialDpr:p.viewport.initialDpr||P}}}),setFrameloop:(g="always")=>{const p=a().clock;p.stop(),p.elapsedTime=0,g!=="never"&&(p.start(),p.elapsedTime=0),c(()=>({frameloop:g}))},previousRoot:void 0,internal:{interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,lastEvent:s.createRef(),active:!1,frames:0,priority:0,subscribe:(g,p,P)=>{const M=a().internal;return M.priority=M.priority+(p>0?1:0),M.subscribers.push({ref:g,priority:p,store:P}),M.subscribers=M.subscribers.sort((x,h)=>x.priority-h.priority),()=>{const x=a().internal;x!=null&&x.subscribers&&(x.priority=x.priority-(p>0?1:0),x.subscribers=x.subscribers.filter(h=>h.ref!==g))}}}}}),r=n.getState();let o=r.size,i=r.viewport.dpr,l=r.camera;return n.subscribe(()=>{const{camera:c,size:a,viewport:d,gl:f,set:u}=n.getState();if(a.width!==o.width||a.height!==o.height||d.dpr!==i){o=a,i=d.dpr,Xt(c,a),d.dpr>0&&f.setPixelRatio(d.dpr);const v=typeof HTMLCanvasElement<"u"&&f.domElement instanceof HTMLCanvasElement;f.setSize(a.width,a.height,v)}c!==l&&(l=c,u(v=>({viewport:{...v.viewport,...v.viewport.getCurrentViewport(c)}})))}),n.subscribe(c=>e(c)),n};function it(){const e=s.useContext(st);if(!e)throw new Error("R3F: Hooks can only be used within the Canvas component!");return e}function F(e=n=>n,t){return it()(e,t)}function oe(e,t=0){const n=it(),r=n.getState().internal.subscribe,o=ot(e);return ge(()=>r(o,t,n),[t,r,n]),null}const Mt=new WeakMap,Ir=e=>{var t;return typeof e=="function"&&(e==null||(t=e.prototype)==null?void 0:t.constructor)===e};function Zt(e,t){return function(n,...r){let o;return Ir(n)?(o=Mt.get(n),o||(o=new n,Mt.set(n,o))):o=n,e&&e(o),Promise.all(r.map(i=>new Promise((l,c)=>o.load(i,a=>{$(a?.scene)&&Object.assign(a,xr(a.scene)),l(a)},t,a=>c(new Error(`Could not load ${i}: ${a?.message}`))))))}}function K(e,t,n,r){const o=Array.isArray(t)?t:[t],i=_t(Zt(n,r),[e,...o],{equal:z.equ});return Array.isArray(t)?i:i[0]}K.preload=function(e,t,n){const r=Array.isArray(t)?t:[t];return yn(Zt(n),[e,...r])};K.clear=function(e,t){const n=Array.isArray(t)?t:[t];return bn([e,...n])};function kr(e){const t=En(e);return t.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:s.version}),t}const Qt=0,fe={},Ar=/^three(?=[A-Z])/,Oe=e=>`${e[0].toUpperCase()}${e.slice(1)}`;let Lr=0;const Dr=e=>typeof e=="function";function at(e){if(Dr(e)){const t=`${Lr++}`;return fe[t]=e,t}else Object.assign(fe,e)}function Jt(e,t){const n=Oe(e),r=fe[n];if(e!=="primitive"&&!r)throw new Error(`R3F: ${n} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(e==="primitive"&&!t.object)throw new Error("R3F: Primitives without 'object' are invalid!");if(t.args!==void 0&&!Array.isArray(t.args))throw new Error("R3F: The args prop must be an array!")}function _r(e,t,n){var r;return e=Oe(e)in fe?e:e.replace(Ar,""),Jt(e,t),e==="primitive"&&(r=t.object)!=null&&r.__r3f&&delete t.object.__r3f,Me(t.object,n,e,t)}function zr(e){if(!e.isHidden){var t;e.props.attach&&(t=e.parent)!=null&&t.object?Se(e.parent,e):$(e.object)&&(e.object.visible=!1),e.isHidden=!0,de(e)}}function Kt(e){if(e.isHidden){var t;e.props.attach&&(t=e.parent)!=null&&t.object?je(e.parent,e):$(e.object)&&e.props.visible!==!1&&(e.object.visible=!0),e.isHidden=!1,de(e)}}function ct(e,t,n){const r=t.root.getState();if(!(!e.parent&&e.object!==r.scene)){if(!t.object){var o,i;const l=fe[Oe(t.type)];t.object=(o=t.props.object)!=null?o:new l(...(i=t.props.args)!=null?i:[]),t.object.__r3f=t}if(J(t.object,t.props),t.props.attach)je(e,t);else if($(t.object)&&$(e.object)){const l=e.object.children.indexOf(n?.object);if(n&&l!==-1){const c=e.object.children.indexOf(t.object);if(c!==-1){e.object.children.splice(c,1);const a=c<l?l-1:l;e.object.children.splice(a,0,t.object)}else t.object.parent=e.object,e.object.children.splice(l,0,t.object),t.object.dispatchEvent({type:"added"}),e.object.dispatchEvent({type:"childadded",child:t.object})}else e.object.add(t.object)}for(const l of t.children)ct(t,l);de(t)}}function Ae(e,t){t&&(t.parent=e,e.children.push(t),ct(e,t))}function jt(e,t,n){if(!t||!n)return;t.parent=e;const r=e.children.indexOf(n);r!==-1?e.children.splice(r,0,t):e.children.push(t),ct(e,t,n)}function en(e){if(typeof e.dispose=="function"){const t=()=>{try{e.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT<"u"?t():Pt.unstable_scheduleCallback(Pt.unstable_IdlePriority,t)}}function Xe(e,t,n){if(!t)return;t.parent=null;const r=e.children.indexOf(t);r!==-1&&e.children.splice(r,1),t.props.attach?Se(e,t):$(t.object)&&$(e.object)&&(e.object.remove(t.object),Tr(Ut(t),t.object));const o=t.props.dispose!==null&&n!==!1;for(let i=t.children.length-1;i>=0;i--){const l=t.children[i];Xe(t,l,o)}t.children.length=0,delete t.object.__r3f,o&&t.type!=="primitive"&&t.object.type!=="Scene"&&en(t.object),n===void 0&&de(t)}function Hr(e,t){for(const n of[e,e.alternate])if(n!==null)if(typeof n.ref=="function"){n.refCleanup==null||n.refCleanup();const r=n.ref(t);typeof r=="function"&&(n.refCleanup=r)}else n.ref&&(n.ref.current=t)}const Ce=[];function Wr(){for(const[n]of Ce){const r=n.parent;if(r){n.props.attach?Se(r,n):$(n.object)&&$(r.object)&&r.object.remove(n.object);for(const o of n.children)o.props.attach?Se(n,o):$(o.object)&&$(n.object)&&n.object.remove(o.object)}n.isHidden&&Kt(n),n.object.__r3f&&delete n.object.__r3f,n.type!=="primitive"&&en(n.object)}for(const[n,r,o]of Ce){n.props=r;const i=n.parent;if(i){var e,t;const l=fe[Oe(n.type)];n.object=(e=n.props.object)!=null?e:new l(...(t=n.props.args)!=null?t:[]),n.object.__r3f=n,Hr(o,n.object),J(n.object,n.props),n.props.attach?je(i,n):$(n.object)&&$(i.object)&&i.object.add(n.object);for(const c of n.children)c.props.attach?je(n,c):$(c.object)&&$(n.object)&&n.object.add(c.object);de(n)}}Ce.length=0}const Le=()=>{},St={};let Pe=Qt;const Br=0,Nr=4,Re=kr({isPrimaryRenderer:!1,warnsIfNotActing:!1,supportsMutation:!0,supportsPersistence:!1,supportsHydration:!1,createInstance:_r,removeChild:Xe,appendChild:Ae,appendInitialChild:Ae,insertBefore:jt,appendChildToContainer(e,t){const n=e.getState().scene.__r3f;!t||!n||Ae(n,t)},removeChildFromContainer(e,t){const n=e.getState().scene.__r3f;!t||!n||Xe(n,t)},insertInContainerBefore(e,t,n){const r=e.getState().scene.__r3f;!t||!n||!r||jt(r,t,n)},getRootHostContext:()=>St,getChildHostContext:()=>St,commitUpdate(e,t,n,r,o){var i,l,c;Jt(t,r);let a=!1;if((e.type==="primitive"&&n.object!==r.object||((i=r.args)==null?void 0:i.length)!==((l=n.args)==null?void 0:l.length)||(c=r.args)!=null&&c.some((f,u)=>{var v;return f!==((v=n.args)==null?void 0:v[u])}))&&(a=!0),a)Ce.push([e,{...r},o]);else{const f=jr(e,r);Object.keys(f).length&&(Object.assign(e.props,f),J(e.object,f))}(o.sibling===null||(o.flags&Nr)===Br)&&Wr()},finalizeInitialChildren:()=>!1,commitMount(){},getPublicInstance:e=>e?.object,prepareForCommit:()=>null,preparePortalMount:e=>Me(e.getState().scene,e,"",{}),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance:zr,unhideInstance:Kt,createTextInstance:Le,hideTextInstance:Le,unhideTextInstance:Le,scheduleTimeout:typeof setTimeout=="function"?setTimeout:void 0,cancelTimeout:typeof clearTimeout=="function"?clearTimeout:void 0,noTimeout:-1,getInstanceFromNode:()=>null,beforeActiveInstanceBlur(){},afterActiveInstanceBlur(){},detachDeletedInstance(){},prepareScopeUpdate(){},getInstanceFromScope:()=>null,shouldAttemptEagerTransition:()=>!1,trackSchedulerEvent:()=>{},resolveEventType:()=>null,resolveEventTimeStamp:()=>-1.1,requestPostPaintCallback(){},maySuspendCommit:()=>!1,preloadInstance:()=>!0,startSuspendingCommit(){},suspendInstance(){},waitForCommitToBeReady:()=>null,NotPendingTransition:null,HostTransitionContext:s.createContext(null),setCurrentUpdatePriority(e){Pe=e},getCurrentUpdatePriority(){return Pe},resolveUpdatePriority(){var e;if(Pe!==Qt)return Pe;switch(typeof window<"u"&&((e=window.event)==null?void 0:e.type)){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return Ee.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return Ee.ContinuousEventPriority;default:return Ee.DefaultEventPriority}},resetFormInstance(){}}),re=new Map,ae={objects:"shallow",strict:!1};function Gr(e,t){if(!t&&typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&e.parentElement){const{width:n,height:r,top:o,left:i}=e.parentElement.getBoundingClientRect();return{width:n,height:r,top:o,left:i}}else if(!t&&typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas)return{width:e.width,height:e.height,top:0,left:0};return{width:0,height:0,top:0,left:0,...t}}function Ur(e){const t=re.get(e),n=t?.fiber,r=t?.store;t&&console.warn("R3F.createRoot should only be called once!");const o=typeof reportError=="function"?reportError:console.error,i=r||Fr(Qe,Tt),l=n||Re.createContainer(i,Ee.ConcurrentRoot,null,!1,null,"",o,o,o,null);t||re.set(e,{fiber:l,store:i});let c,a,d=!1,f=null;return{async configure(u={}){let v;f=new Promise(C=>v=C);let{gl:m,size:w,scene:b,events:y,onCreated:g,shadows:p=!1,linear:P=!1,flat:M=!1,legacy:x=!1,orthographic:h=!1,frameloop:I="always",dpr:R=[1,2],performance:E,raycaster:T,camera:S,onPointerMissed:B}=u,O=i.getState(),A=O.gl;if(!O.gl){const C={canvas:e,powerPreference:"high-performance",antialias:!0,alpha:!0},k=typeof m=="function"?await m(C):m;Ct(k)?A=k:A=new Rn({...C,...m}),O.set({gl:A})}let j=O.raycaster;j||O.set({raycaster:j=new zt});const{params:Z,...D}=T||{};if(z.equ(D,j,ae)||J(j,{...D}),z.equ(Z,j.params,ae)||J(j,{params:{...j.params,...Z}}),!O.camera||O.camera===a&&!z.equ(a,S,ae)){a=S;const C=S?.isCamera,k=C?S:h?new Ke(0,0,0,0,.1,1e3):new et(75,0,.1,1e3);C||(k.position.z=5,S&&(J(k,S),k.manual||("aspect"in S||"left"in S||"right"in S||"bottom"in S||"top"in S)&&(k.manual=!0,k.updateProjectionMatrix())),!O.camera&&!(S!=null&&S.rotation)&&k.lookAt(0,0,0)),O.set({camera:k}),j.camera=k}if(!O.scene){let C;b!=null&&b.isScene?(C=b,Me(C,i,"",{})):(C=new Ht,Me(C,i,"",{}),b&&J(C,b)),O.set({scene:C})}y&&!O.events.handlers&&O.set({events:y(i)});const V=Gr(e,w);if(z.equ(V,O.size,ae)||O.setSize(V.width,V.height,V.top,V.left),R&&O.viewport.dpr!==$t(R)&&O.setDpr(R),O.frameloop!==I&&O.setFrameloop(I),O.onPointerMissed||O.set({onPointerMissed:B}),E&&!z.equ(E,O.performance,ae)&&O.set(C=>({performance:{...C.performance,...E}})),!O.xr){var U;const C=(_,q)=>{const pe=i.getState();pe.frameloop!=="never"&&Tt(_,!0,pe,q)},k=()=>{const _=i.getState();_.gl.xr.enabled=_.gl.xr.isPresenting,_.gl.xr.setAnimationLoop(_.gl.xr.isPresenting?C:null),_.gl.xr.isPresenting||Qe(_)},H={connect(){const _=i.getState().gl;_.xr.addEventListener("sessionstart",k),_.xr.addEventListener("sessionend",k)},disconnect(){const _=i.getState().gl;_.xr.removeEventListener("sessionstart",k),_.xr.removeEventListener("sessionend",k)}};typeof((U=A.xr)==null?void 0:U.addEventListener)=="function"&&H.connect(),O.set({xr:H})}if(A.shadowMap){const C=A.shadowMap.enabled,k=A.shadowMap.type;if(A.shadowMap.enabled=!!p,z.boo(p))A.shadowMap.type=Ie;else if(z.str(p)){var X;const H={basic:Fn,percentage:On,soft:Ie,variance:Tn};A.shadowMap.type=(X=H[p])!=null?X:Ie}else z.obj(p)&&Object.assign(A.shadowMap,p);(C!==A.shadowMap.enabled||k!==A.shadowMap.type)&&(A.shadowMap.needsUpdate=!0)}return In.enabled=!x,d||(A.outputColorSpace=P?kn:Wt,A.toneMapping=M?Bt:An),O.legacy!==x&&O.set(()=>({legacy:x})),O.linear!==P&&O.set(()=>({linear:P})),O.flat!==M&&O.set(()=>({flat:M})),m&&!z.fun(m)&&!Ct(m)&&!z.equ(m,A,ae)&&J(A,m),c=g,d=!0,v(),this},render(u){return!d&&!f&&this.configure(),f.then(()=>{Re.updateContainer(W.jsx(qr,{store:i,children:u,onCreated:c,rootElement:e}),l,null,()=>{})}),i},unmount(){tn(e)}}}function qr({store:e,children:t,onCreated:n,rootElement:r}){return ge(()=>{const o=e.getState();o.set(i=>({internal:{...i.internal,active:!0}})),n&&n(o),e.getState().events.connected||o.events.connect==null||o.events.connect(r)},[]),W.jsx(st.Provider,{value:e,children:t})}function tn(e,t){const n=re.get(e),r=n?.fiber;if(r){const o=n?.store.getState();o&&(o.internal.active=!1),Re.updateContainer(null,r,null,()=>{o&&setTimeout(()=>{try{var i,l,c,a;o.events.disconnect==null||o.events.disconnect(),(i=o.gl)==null||(l=i.renderLists)==null||l.dispose==null||l.dispose(),(c=o.gl)==null||c.forceContextLoss==null||c.forceContextLoss(),(a=o.gl)!=null&&a.xr&&o.xr.disconnect(),Er(o.scene),re.delete(e)}catch{}},500)})}}function $r(e,t,n){return W.jsx(Vr,{children:e,container:t,state:n})}function Vr({state:e={},children:t,container:n}){const{events:r,size:o,...i}=e,l=it(),[c]=s.useState(()=>new zt),[a]=s.useState(()=>new tt),d=ot((u,v)=>{let m;if(v.camera&&o){const w=v.camera;m=u.viewport.getCurrentViewport(w,new G,o),w!==u.camera&&Xt(w,o)}return{...u,...v,scene:n,raycaster:c,pointer:a,mouse:a,previousRoot:l,events:{...u.events,...v.events,...r},size:{...u.size,...o},viewport:{...u.viewport,...m},setEvents:w=>v.set(b=>({...b,events:{...b.events,...w}}))}}),f=s.useMemo(()=>{const u=Gt((m,w)=>({...i,set:m,get:w})),v=m=>u.setState(w=>d.current(m,w));return v(l.getState()),l.subscribe(v),u},[l,n]);return W.jsx(W.Fragment,{children:Re.createPortal(W.jsx(st.Provider,{value:f,children:t}),f,null)})}const Xr=new Set,Yr=new Set,Zr=new Set;function De(e,t){if(e.size)for(const{callback:n}of e.values())n(t)}function ve(e,t){switch(e){case"before":return De(Xr,t);case"after":return De(Yr,t);case"tail":return De(Zr,t)}}let _e,ze;function Ye(e,t,n){let r=t.clock.getDelta();t.frameloop==="never"&&typeof e=="number"&&(r=e-t.clock.elapsedTime,t.clock.oldTime=t.clock.elapsedTime,t.clock.elapsedTime=e),_e=t.internal.subscribers;for(let o=0;o<_e.length;o++)ze=_e[o],ze.ref.current(ze.store.getState(),r,n);return!t.internal.priority&&t.gl.render&&t.gl.render(t.scene,t.camera),t.internal.frames=Math.max(0,t.internal.frames-1),t.frameloop==="always"?1:t.internal.frames}let Te=!1,Ze=!1,He,Rt,ce;function nn(e){Rt=requestAnimationFrame(nn),Te=!0,He=0,ve("before",e),Ze=!0;for(const n of re.values()){var t;ce=n.store.getState(),ce.internal.active&&(ce.frameloop==="always"||ce.internal.frames>0)&&!((t=ce.gl.xr)!=null&&t.isPresenting)&&(He+=Ye(e,ce))}if(Ze=!1,ve("after",e),He===0)return ve("tail",e),Te=!1,cancelAnimationFrame(Rt)}function Qe(e,t=1){var n;if(!e)return re.forEach(r=>Qe(r.store.getState(),t));(n=e.gl.xr)!=null&&n.isPresenting||!e.internal.active||e.frameloop==="never"||(t>1?e.internal.frames=Math.min(60,e.internal.frames+t):Ze?e.internal.frames=2:e.internal.frames=1,Te||(Te=!0,requestAnimationFrame(nn)))}function Tt(e,t=!0,n,r){if(t&&ve("before",e),n)Ye(e,n,r);else for(const o of re.values())Ye(e,o.store.getState());t&&ve("after",e)}const We={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function Qr(e){const{handlePointer:t}=Or(e);return{priority:1,enabled:!0,compute(n,r,o){r.pointer.set(n.offsetX/r.size.width*2-1,-(n.offsetY/r.size.height)*2+1),r.raycaster.setFromCamera(r.pointer,r.camera)},connected:void 0,handlers:Object.keys(We).reduce((n,r)=>({...n,[r]:t(r)}),{}),update:()=>{var n;const{events:r,internal:o}=e.getState();(n=o.lastEvent)!=null&&n.current&&r.handlers&&r.handlers.onPointerMove(o.lastEvent.current)},connect:n=>{const{set:r,events:o}=e.getState();if(o.disconnect==null||o.disconnect(),r(i=>({events:{...i.events,connected:n}})),o.handlers)for(const i in o.handlers){const l=o.handlers[i],[c,a]=We[i];n.addEventListener(c,l,{passive:a})}},disconnect:()=>{const{set:n,events:r}=e.getState();if(r.connected){if(r.handlers)for(const o in r.handlers){const i=r.handlers[o],[l]=We[o];r.connected.removeEventListener(l,i)}n(o=>({events:{...o.events,connected:void 0}}))}}}}function Jr({ref:e,children:t,fallback:n,resize:r,style:o,gl:i,events:l=Qr,eventSource:c,eventPrefix:a,shadows:d,linear:f,flat:u,legacy:v,orthographic:m,frameloop:w,dpr:b,performance:y,raycaster:g,camera:p,scene:P,onPointerMissed:M,onCreated:x,...h}){s.useMemo(()=>at(zn),[]);const I=br(),[R,E]=Mn({scroll:!0,debounce:{scroll:50,resize:0},...r}),T=s.useRef(null),S=s.useRef(null);s.useImperativeHandle(e,()=>T.current);const B=ot(M),[O,A]=s.useState(!1),[j,Z]=s.useState(!1);if(O)throw O;if(j)throw j;const D=s.useRef(null);ge(()=>{const U=T.current;if(E.width>0&&E.height>0&&U){D.current||(D.current=Ur(U));async function X(){await D.current.configure({gl:i,scene:P,events:l,shadows:d,linear:f,flat:u,legacy:v,orthographic:m,frameloop:w,dpr:b,performance:y,raycaster:g,camera:p,size:E,onPointerMissed:(...C)=>B.current==null?void 0:B.current(...C),onCreated:C=>{C.events.connect==null||C.events.connect(c?gr(c)?c.current:c:S.current),a&&C.setEvents({compute:(k,H)=>{const _=k[a+"X"],q=k[a+"Y"];H.pointer.set(_/H.size.width*2-1,-(q/H.size.height)*2+1),H.raycaster.setFromCamera(H.pointer,H.camera)}}),x?.(C)}}),D.current.render(W.jsx(I,{children:W.jsx(Pr,{set:Z,children:W.jsx(s.Suspense,{fallback:W.jsx(wr,{set:A}),children:t??null})})}))}X()}}),s.useEffect(()=>{const U=T.current;if(U)return()=>tn(U)},[]);const V=c?"none":"auto";return W.jsx("div",{ref:S,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:V,...o},...h,children:W.jsx("div",{ref:R,style:{width:"100%",height:"100%"},children:W.jsx("canvas",{ref:T,style:{display:"block"},children:n})})})}function To(e){return W.jsx(Cn,{children:W.jsx(Jr,{...e})})}function N(){return N=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},N.apply(null,arguments)}const ye=new G,lt=new G,Kr=new G,Ot=new tt;function eo(e,t,n){const r=ye.setFromMatrixPosition(e.matrixWorld);r.project(t);const o=n.width/2,i=n.height/2;return[r.x*o+o,-(r.y*i)+i]}function to(e,t){const n=ye.setFromMatrixPosition(e.matrixWorld),r=lt.setFromMatrixPosition(t.matrixWorld),o=n.sub(r),i=t.getWorldDirection(Kr);return o.angleTo(i)>Math.PI/2}function no(e,t,n,r){const o=ye.setFromMatrixPosition(e.matrixWorld),i=o.clone();i.project(t),Ot.set(i.x,i.y),n.setFromCamera(Ot,t);const l=n.intersectObjects(r,!0);if(l.length){const c=l[0].distance;return o.distanceTo(n.ray.origin)<c}return!0}function ro(e,t){if(t instanceof Ke)return t.zoom;if(t instanceof et){const n=ye.setFromMatrixPosition(e.matrixWorld),r=lt.setFromMatrixPosition(t.matrixWorld),o=t.fov*Math.PI/180,i=n.distanceTo(r);return 1/(2*Math.tan(o/2)*i)}else return 1}function oo(e,t,n){if(t instanceof et||t instanceof Ke){const r=ye.setFromMatrixPosition(e.matrixWorld),o=lt.setFromMatrixPosition(t.matrixWorld),i=r.distanceTo(o),l=(n[1]-n[0])/(t.far-t.near),c=n[1]-l*t.far;return Math.round(l*i+c)}}const Je=e=>Math.abs(e)<1e-10?0:e;function rn(e,t,n=""){let r="matrix3d(";for(let o=0;o!==16;o++)r+=Je(t[o]*e.elements[o])+(o!==15?",":")");return n+r}const so=(e=>t=>rn(t,e))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),io=(e=>(t,n)=>rn(t,e(n),"translate(-50%,-50%)"))(e=>[1/e,1/e,1/e,1,-1/e,-1/e,-1/e,-1,1/e,1/e,1/e,1,1,1,1,1]);function ao(e){return e&&typeof e=="object"&&"current"in e}const Oo=s.forwardRef(({children:e,eps:t=.001,style:n,className:r,prepend:o,center:i,fullscreen:l,portal:c,distanceFactor:a,sprite:d=!1,transform:f=!1,occlude:u,onOcclude:v,castShadow:m,receiveShadow:w,material:b,geometry:y,zIndexRange:g=[16777271,0],calculatePosition:p=eo,as:P="div",wrapperClass:M,pointerEvents:x="auto",...h},I)=>{const{gl:R,camera:E,scene:T,size:S,raycaster:B,events:O,viewport:A}=F(),[j]=s.useState(()=>document.createElement(P)),Z=s.useRef(null),D=s.useRef(null),V=s.useRef(0),U=s.useRef([0,0]),X=s.useRef(null),C=s.useRef(null),k=c?.current||O.connected||R.domElement.parentNode,H=s.useRef(null),_=s.useRef(!1),q=s.useMemo(()=>u&&u!=="blending"||Array.isArray(u)&&u.length&&ao(u[0]),[u]);s.useLayoutEffect(()=>{const Y=R.domElement;u&&u==="blending"?(Y.style.zIndex=`${Math.floor(g[0]/2)}`,Y.style.position="absolute",Y.style.pointerEvents="none"):(Y.style.zIndex=null,Y.style.position=null,Y.style.pointerEvents=null)},[u]),s.useLayoutEffect(()=>{if(D.current){const Y=Z.current=jn.createRoot(j);if(T.updateMatrixWorld(),f)j.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const L=p(D.current,E,S);j.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${L[0]}px,${L[1]}px,0);transform-origin:0 0;`}return k&&(o?k.prepend(j):k.appendChild(j)),()=>{k&&k.removeChild(j),Y.unmount()}}},[k,f]),s.useLayoutEffect(()=>{M&&(j.className=M)},[M]);const pe=s.useMemo(()=>f?{position:"absolute",top:0,left:0,width:S.width,height:S.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:i?"translate3d(-50%,-50%,0)":"none",...l&&{top:-S.height/2,left:-S.width/2,width:S.width,height:S.height},...n},[n,i,l,S,f]),ln=s.useMemo(()=>({position:"absolute",pointerEvents:x}),[x]);s.useLayoutEffect(()=>{if(_.current=!1,f){var Y;(Y=Z.current)==null||Y.render(s.createElement("div",{ref:X,style:pe},s.createElement("div",{ref:C,style:ln},s.createElement("div",{ref:I,className:r,style:n,children:e}))))}else{var L;(L=Z.current)==null||L.render(s.createElement("div",{ref:I,style:pe,className:r,children:e}))}});const se=s.useRef(!0);oe(Y=>{if(D.current){E.updateMatrixWorld(),D.current.updateWorldMatrix(!0,!1);const L=f?U.current:p(D.current,E,S);if(f||Math.abs(V.current-E.zoom)>t||Math.abs(U.current[0]-L[0])>t||Math.abs(U.current[1]-L[1])>t){const ee=to(D.current,E);let Q=!1;q&&(Array.isArray(u)?Q=u.map(te=>te.current):u!=="blending"&&(Q=[T]));const me=se.current;if(Q){const te=no(D.current,E,B,Q);se.current=te&&!ee}else se.current=!ee;me!==se.current&&(v?v(!se.current):j.style.display=se.current?"block":"none");const be=Math.floor(g[0]/2),un=u?q?[g[0],be]:[be-1,0]:g;if(j.style.zIndex=`${oo(D.current,E,un)}`,f){const[te,pt]=[S.width/2,S.height/2],Fe=E.projectionMatrix.elements[5]*pt,{isOrthographicCamera:mt,top:fn,left:dn,bottom:pn,right:mn}=E,vn=so(E.matrixWorldInverse),hn=mt?`scale(${Fe})translate(${Je(-(mn+dn)/2)}px,${Je((fn+pn)/2)}px)`:`translateZ(${Fe}px)`;let ne=D.current.matrixWorld;d&&(ne=E.matrixWorldInverse.clone().transpose().copyPosition(ne).scale(D.current.scale),ne.elements[3]=ne.elements[7]=ne.elements[11]=0,ne.elements[15]=1),j.style.width=S.width+"px",j.style.height=S.height+"px",j.style.perspective=mt?"":`${Fe}px`,X.current&&C.current&&(X.current.style.transform=`${hn}${vn}translate(${te}px,${pt}px)`,C.current.style.transform=io(ne,1/((a||10)/400)))}else{const te=a===void 0?1:ro(D.current,E)*a;j.style.transform=`translate3d(${L[0]}px,${L[1]}px,0) scale(${te})`}U.current=L,V.current=E.zoom}}if(!q&&H.current&&!_.current)if(f){if(X.current){const L=X.current.children[0];if(L!=null&&L.clientWidth&&L!=null&&L.clientHeight){const{isOrthographicCamera:ee}=E;if(ee||y)h.scale&&(Array.isArray(h.scale)?h.scale instanceof G?H.current.scale.copy(h.scale.clone().divideScalar(1)):H.current.scale.set(1/h.scale[0],1/h.scale[1],1/h.scale[2]):H.current.scale.setScalar(1/h.scale));else{const Q=(a||10)/400,me=L.clientWidth*Q,be=L.clientHeight*Q;H.current.scale.set(me,be,1)}_.current=!0}}}else{const L=j.children[0];if(L!=null&&L.clientWidth&&L!=null&&L.clientHeight){const ee=1/A.factor,Q=L.clientWidth*ee,me=L.clientHeight*ee;H.current.scale.set(Q,me,1),_.current=!0}H.current.lookAt(Y.camera.position)}});const dt=s.useMemo(()=>({vertexShader:f?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom"
            is false.
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;

            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[f]);return s.createElement("group",N({},h,{ref:D}),u&&!q&&s.createElement("mesh",{castShadow:m,receiveShadow:w,ref:H},y||s.createElement("planeGeometry",null),b||s.createElement("shaderMaterial",{side:Hn,vertexShader:dt.vertexShader,fragmentShader:dt.fragmentShader})))}),Fo=s.forwardRef(({sdfGlyphSize:e=64,anchorX:t="center",anchorY:n="middle",font:r,fontSize:o=1,children:i,characters:l,onSync:c,...a},d)=>{const f=F(({invalidate:w})=>w),[u]=s.useState(()=>new Wn),[v,m]=s.useMemo(()=>{const w=[];let b="";return s.Children.forEach(i,y=>{typeof y=="string"||typeof y=="number"?b+=y:w.push(y)}),[w,b]},[i]);return _t(()=>new Promise(w=>Bn({font:r,characters:l},w)),["troika-text",r,l]),s.useLayoutEffect(()=>void u.sync(()=>{f(),c&&c(u)})),s.useEffect(()=>()=>u.dispose(),[u]),s.createElement("primitive",N({object:u,ref:d,font:r,text:m,anchorX:t,anchorY:n,fontSize:o,sdfGlyphSize:e},a),v)});function co(e,t,n,r){var o;return o=class extends Nn{constructor(i){super({vertexShader:t,fragmentShader:n,...i});for(const l in e)this.uniforms[l]=new Gn(e[l]),Object.defineProperty(this,l,{get(){return this.uniforms[l].value},set(c){this.uniforms[l].value=c}});this.uniforms=Un.clone(this.uniforms)}},o.key=qn.generateUUID(),o}const Be=e=>e===Object(e)&&!Array.isArray(e)&&typeof e!="function";function on(e,t){const n=F(i=>i.gl),r=K(nt,Be(e)?Object.values(e):e);return s.useLayoutEffect(()=>{t?.(r)},[t]),s.useEffect(()=>{if("initTexture"in n){let i=[];Array.isArray(r)?i=r:r instanceof ht?i=[r]:Be(r)&&(i=Object.values(r)),i.forEach(l=>{l instanceof ht&&n.initTexture(l)})}},[n,r]),s.useMemo(()=>{if(Be(e)){const i={};let l=0;for(const c in e)i[c]=r[l++];return i}else return r},[e,r])}on.preload=e=>K.preload(nt,e);on.clear=e=>K.clear(nt,e);const lo=()=>parseInt($n.replace(/\D+/g,"")),uo=lo();let xe=null,sn="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function an(e=!0,t=!0,n){return r=>{n&&n(r),e&&(xe||(xe=new Vn),xe.setDecoderPath(typeof e=="string"?e:sn),r.setDRACOLoader(xe)),t&&r.setMeshoptDecoder(typeof ke=="function"?ke():ke)}}const ut=(e,t,n,r)=>K(rt,e,an(t,n,r));ut.preload=(e,t,n,r)=>K.preload(rt,e,an(t,n,r));ut.clear=e=>K.clear(rt,e);ut.setDecoderPath=e=>{sn=e};function fo(e,t,n){const r=F(m=>m.size),o=F(m=>m.viewport),i=typeof e=="number"?e:r.width*o.dpr,l=r.height*o.dpr,c=(typeof e=="number"?n:e)||{},{samples:a=0,depth:d,...f}=c,u=d??c.depthBuffer,v=s.useMemo(()=>{const m=new Xn(i,l,{minFilter:gt,magFilter:gt,type:Nt,...f});return u&&(m.depthTexture=new Yn(i,l,Zn)),m.samples=a,m},[]);return s.useLayoutEffect(()=>{v.setSize(i,l),a&&(v.samples=a)},[a,v,i,l]),s.useEffect(()=>()=>v.dispose(),[]),v}const po=e=>typeof e=="function",mo=s.forwardRef(({envMap:e,resolution:t=256,frames:n=1/0,children:r,makeDefault:o,...i},l)=>{const c=F(({set:y})=>y),a=F(({camera:y})=>y),d=F(({size:y})=>y),f=s.useRef(null);s.useImperativeHandle(l,()=>f.current,[]);const u=s.useRef(null),v=fo(t);s.useLayoutEffect(()=>{i.manual||f.current.updateProjectionMatrix()},[d,i]),s.useLayoutEffect(()=>{f.current.updateProjectionMatrix()}),s.useLayoutEffect(()=>{if(o){const y=a;return c(()=>({camera:f.current})),()=>c(()=>({camera:y}))}},[f,o,c]);let m=0,w=null;const b=po(r);return oe(y=>{b&&(n===1/0||m<n)&&(u.current.visible=!1,y.gl.setRenderTarget(v),w=y.scene.background,e&&(y.scene.background=e),y.gl.render(y.scene,f.current),y.scene.background=w,y.gl.setRenderTarget(null),u.current.visible=!0,m++)}),s.createElement(s.Fragment,null,s.createElement("orthographicCamera",N({left:d.width/-2,right:d.width/2,top:d.height/2,bottom:d.height/-2,ref:f},i),!b&&r),s.createElement("group",{ref:u},b&&r(v.texture)))}),Io=s.forwardRef(({makeDefault:e,camera:t,regress:n,domElement:r,enableDamping:o=!0,keyEvents:i=!1,onChange:l,onStart:c,onEnd:a,...d},f)=>{const u=F(h=>h.invalidate),v=F(h=>h.camera),m=F(h=>h.gl),w=F(h=>h.events),b=F(h=>h.setEvents),y=F(h=>h.set),g=F(h=>h.get),p=F(h=>h.performance),P=t||v,M=r||w.connected||m.domElement,x=s.useMemo(()=>new Qn(P),[P]);return oe(()=>{x.enabled&&x.update()},-1),s.useEffect(()=>(i&&x.connect(i===!0?M:i),x.connect(M),()=>void x.dispose()),[i,M,n,x,u]),s.useEffect(()=>{const h=E=>{u(),n&&p.regress(),l&&l(E)},I=E=>{c&&c(E)},R=E=>{a&&a(E)};return x.addEventListener("change",h),x.addEventListener("start",I),x.addEventListener("end",R),()=>{x.removeEventListener("start",I),x.removeEventListener("end",R),x.removeEventListener("change",h)}},[l,c,a,x,u,b]),s.useEffect(()=>{if(e){const h=g().controls;return y({controls:x}),()=>y({controls:h})}},[e,x]),s.createElement("primitive",N({ref:f,object:x,enableDamping:o},d))}),ko=s.forwardRef(({children:e,domElement:t,onChange:n,onMouseDown:r,onMouseUp:o,onObjectChange:i,object:l,makeDefault:c,camera:a,enabled:d,axis:f,mode:u,translationSnap:v,rotationSnap:m,scaleSnap:w,space:b,size:y,showX:g,showY:p,showZ:P,...M},x)=>{const h=F(C=>C.controls),I=F(C=>C.gl),R=F(C=>C.events),E=F(C=>C.camera),T=F(C=>C.invalidate),S=F(C=>C.get),B=F(C=>C.set),O=a||E,A=t||R.connected||I.domElement,j=s.useMemo(()=>new Jn(O,A),[O,A]),Z=s.useRef(null);s.useLayoutEffect(()=>(l?j.attach(l instanceof $e?l:l.current):Z.current instanceof $e&&j.attach(Z.current),()=>void j.detach()),[l,e,j]),s.useEffect(()=>{if(h){const C=k=>h.enabled=!k.value;return j.addEventListener("dragging-changed",C),()=>j.removeEventListener("dragging-changed",C)}},[j,h]);const D=s.useRef(void 0),V=s.useRef(void 0),U=s.useRef(void 0),X=s.useRef(void 0);return s.useLayoutEffect(()=>void(D.current=n),[n]),s.useLayoutEffect(()=>void(V.current=r),[r]),s.useLayoutEffect(()=>void(U.current=o),[o]),s.useLayoutEffect(()=>void(X.current=i),[i]),s.useEffect(()=>{const C=q=>{T(),D.current==null||D.current(q)},k=q=>V.current==null?void 0:V.current(q),H=q=>U.current==null?void 0:U.current(q),_=q=>X.current==null?void 0:X.current(q);return j.addEventListener("change",C),j.addEventListener("mouseDown",k),j.addEventListener("mouseUp",H),j.addEventListener("objectChange",_),()=>{j.removeEventListener("change",C),j.removeEventListener("mouseDown",k),j.removeEventListener("mouseUp",H),j.removeEventListener("objectChange",_)}},[T,j]),s.useEffect(()=>{if(c){const C=S().controls;return B({controls:j}),()=>B({controls:C})}},[c,j]),s.createElement(s.Fragment,null,s.createElement("primitive",{ref:x,object:j,enabled:d,axis:f,mode:u,translationSnap:v,rotationSnap:m,scaleSnap:w,space:b,size:y,showX:g,showY:p,showZ:P}),s.createElement("group",N({ref:Z},M),e))});function vo({defaultScene:e,defaultCamera:t,renderPriority:n=1}){const{gl:r,scene:o,camera:i}=F();let l;return oe(()=>{l=r.autoClear,n===1&&(r.autoClear=!0,r.render(e,t)),r.autoClear=!1,r.clearDepth(),r.render(o,i),r.autoClear=l},n),s.createElement("group",{onPointerOver:()=>null})}function ho({children:e,renderPriority:t=1}){const{scene:n,camera:r}=F(),[o]=s.useState(()=>new Ht);return s.createElement(s.Fragment,null,$r(s.createElement(s.Fragment,null,e,s.createElement(vo,{defaultScene:n,defaultCamera:r,renderPriority:t})),o,{events:{priority:t+1}}))}const cn=s.createContext({}),go=()=>s.useContext(cn),yo=2*Math.PI,Ne=new $e,Ft=new Kn,[le,Ge]=[new yt,new yt],It=new G,kt=new G,bo=e=>"minPolarAngle"in e,At=e=>"getTarget"in e,Ao=({alignment:e="bottom-right",margin:t=[80,80],renderPriority:n=1,onUpdate:r,onTarget:o,children:i})=>{const l=F(h=>h.size),c=F(h=>h.camera),a=F(h=>h.controls),d=F(h=>h.invalidate),f=s.useRef(null),u=s.useRef(null),v=s.useRef(!1),m=s.useRef(0),w=s.useRef(new G(0,0,0)),b=s.useRef(new G(0,0,0));s.useEffect(()=>{b.current.copy(c.up),Ne.up.copy(c.up)},[c]);const y=s.useCallback(h=>{v.current=!0,(a||o)&&(w.current=o?.()||(At(a)?a.getTarget(w.current):a?.target)),m.current=c.position.distanceTo(It),le.copy(c.quaternion),kt.copy(h).multiplyScalar(m.current).add(It),Ne.lookAt(kt),Ge.copy(Ne.quaternion),d()},[a,c,o,d]);oe((h,I)=>{if(u.current&&f.current){var R;if(v.current)if(le.angleTo(Ge)<.01)v.current=!1,bo(a)&&c.up.copy(b.current);else{const E=I*yo;le.rotateTowards(Ge,E),c.position.set(0,0,1).applyQuaternion(le).multiplyScalar(m.current).add(w.current),c.up.set(0,1,0).applyQuaternion(le).normalize(),c.quaternion.copy(le),At(a)&&a.setPosition(c.position.x,c.position.y,c.position.z),r?r():a&&a.update(I),d()}Ft.copy(c.matrix).invert(),(R=f.current)==null||R.quaternion.setFromRotationMatrix(Ft)}});const g=s.useMemo(()=>({tweenCamera:y}),[y]),[p,P]=t,M=e.endsWith("-center")?0:e.endsWith("-left")?-l.width/2+p:l.width/2-p,x=e.startsWith("center-")?0:e.startsWith("top-")?l.height/2-P:-l.height/2+P;return s.createElement(ho,{renderPriority:n},s.createElement(cn.Provider,{value:g},s.createElement(mo,{makeDefault:!0,ref:u,position:[0,0,200]}),s.createElement("group",{ref:f,position:[M,x,0]},i)))};function Ue({scale:e=[.8,.05,.05],color:t,rotation:n}){return s.createElement("group",{rotation:n},s.createElement("mesh",{position:[.4,0,0]},s.createElement("boxGeometry",{args:e}),s.createElement("meshBasicMaterial",{color:t,toneMapped:!1})))}function ue({onClick:e,font:t,disabled:n,arcStyle:r,label:o,labelColor:i,axisHeadScale:l=1,...c}){const a=F(b=>b.gl),d=s.useMemo(()=>{const b=document.createElement("canvas");b.width=64,b.height=64;const y=b.getContext("2d");return y.beginPath(),y.arc(32,32,16,0,2*Math.PI),y.closePath(),y.fillStyle=r,y.fill(),o&&(y.font=t,y.textAlign="center",y.fillStyle=i,y.fillText(o,32,41)),new er(b)},[r,o,i,t]),[f,u]=s.useState(!1),v=(o?1:.75)*(f?1.2:1)*l,m=b=>{b.stopPropagation(),u(!0)},w=b=>{b.stopPropagation(),u(!1)};return s.createElement("sprite",N({scale:v,onPointerOver:n?void 0:m,onPointerOut:n?void 0:e||w},c),s.createElement("spriteMaterial",{map:d,"map-anisotropy":a.capabilities.getMaxAnisotropy()||1,alphaTest:.3,opacity:o?1:.75,toneMapped:!1}))}const Lo=({hideNegativeAxes:e,hideAxisHeads:t,disabled:n,font:r="18px Inter var, Arial, sans-serif",axisColors:o=["#ff2060","#20df80","#2080ff"],axisHeadScale:i=1,axisScale:l,labels:c=["X","Y","Z"],labelColor:a="#000",onClick:d,...f})=>{const[u,v,m]=o,{tweenCamera:w}=go(),b={font:r,disabled:n,labelColor:a,onClick:d,axisHeadScale:i,onPointerDown:n?void 0:y=>{w(y.object.position),y.stopPropagation()}};return s.createElement("group",N({scale:40},f),s.createElement(Ue,{color:u,rotation:[0,0,0],scale:l}),s.createElement(Ue,{color:v,rotation:[0,0,Math.PI/2],scale:l}),s.createElement(Ue,{color:m,rotation:[0,-Math.PI/2,0],scale:l}),!t&&s.createElement(s.Fragment,null,s.createElement(ue,N({arcStyle:u,position:[1,0,0],label:c[0]},b)),s.createElement(ue,N({arcStyle:v,position:[0,1,0],label:c[1]},b)),s.createElement(ue,N({arcStyle:m,position:[0,0,1],label:c[2]},b)),!e&&s.createElement(s.Fragment,null,s.createElement(ue,N({arcStyle:u,position:[-1,0,0]},b)),s.createElement(ue,N({arcStyle:v,position:[0,-1,0]},b)),s.createElement(ue,N({arcStyle:m,position:[0,0,-1]},b)))))},wo=co({cellSize:.5,sectionSize:1,fadeDistance:100,fadeStrength:1,fadeFrom:1,cellThickness:.5,sectionThickness:1,cellColor:new qe,sectionColor:new qe,infiniteGrid:!1,followCamera:!1,worldCamProjPosition:new G,worldPlanePosition:new G},`
    varying vec3 localPosition;
    varying vec4 worldPosition;

    uniform vec3 worldCamProjPosition;
    uniform vec3 worldPlanePosition;
    uniform float fadeDistance;
    uniform bool infiniteGrid;
    uniform bool followCamera;

    void main() {
      localPosition = position.xzy;
      if (infiniteGrid) localPosition *= 1.0 + fadeDistance;
      
      worldPosition = modelMatrix * vec4(localPosition, 1.0);
      if (followCamera) {
        worldPosition.xyz += (worldCamProjPosition - worldPlanePosition);
        localPosition = (inverse(modelMatrix) * worldPosition).xyz;
      }

      gl_Position = projectionMatrix * viewMatrix * worldPosition;
    }
  `,`
    varying vec3 localPosition;
    varying vec4 worldPosition;

    uniform vec3 worldCamProjPosition;
    uniform float cellSize;
    uniform float sectionSize;
    uniform vec3 cellColor;
    uniform vec3 sectionColor;
    uniform float fadeDistance;
    uniform float fadeStrength;
    uniform float fadeFrom;
    uniform float cellThickness;
    uniform float sectionThickness;

    float getGrid(float size, float thickness) {
      vec2 r = localPosition.xz / size;
      vec2 grid = abs(fract(r - 0.5) - 0.5) / fwidth(r);
      float line = min(grid.x, grid.y) + 1.0 - thickness;
      return 1.0 - min(line, 1.0);
    }

    void main() {
      float g1 = getGrid(cellSize, cellThickness);
      float g2 = getGrid(sectionSize, sectionThickness);

      vec3 from = worldCamProjPosition*vec3(fadeFrom);
      float dist = distance(from, worldPosition.xyz);
      float d = 1.0 - min(dist / fadeDistance, 1.0);
      vec3 color = mix(cellColor, sectionColor, min(1.0, sectionThickness * g2));

      gl_FragColor = vec4(color, (g1 + g2) * pow(d, fadeStrength));
      gl_FragColor.a = mix(0.75 * gl_FragColor.a, gl_FragColor.a, g2);
      if (gl_FragColor.a <= 0.0) discard;

      #include <tonemapping_fragment>
      #include <${uo>=154?"colorspace_fragment":"encodings_fragment"}>
    }
  `),Do=s.forwardRef(({args:e,cellColor:t="#000000",sectionColor:n="#2080ff",cellSize:r=.5,sectionSize:o=1,followCamera:i=!1,infiniteGrid:l=!1,fadeDistance:c=100,fadeStrength:a=1,fadeFrom:d=1,cellThickness:f=.5,sectionThickness:u=1,side:v=nr,...m},w)=>{at({GridMaterial:wo});const b=s.useRef(null);s.useImperativeHandle(w,()=>b.current,[]);const y=new tr,g=new G(0,1,0),p=new G(0,0,0);oe(x=>{y.setFromNormalAndCoplanarPoint(g,p).applyMatrix4(b.current.matrixWorld);const h=b.current.material,I=h.uniforms.worldCamProjPosition,R=h.uniforms.worldPlanePosition;y.projectPoint(x.camera.position,I.value),R.value.set(0,0,0).applyMatrix4(b.current.matrixWorld)});const P={cellSize:r,sectionSize:o,cellColor:t,sectionColor:n,cellThickness:f,sectionThickness:u},M={fadeDistance:c,fadeStrength:a,fadeFrom:d,infiniteGrid:l,followCamera:i};return s.createElement("mesh",N({ref:b,frustumCulled:!1},m),s.createElement("gridMaterial",N({transparent:!0,"extensions-derivatives":!0,side:v},P,M)),s.createElement("planeGeometry",{args:e}))});function Po(e,t){const n=e+"Geometry";return s.forwardRef(({args:r,children:o,...i},l)=>{const c=s.useRef(null);return s.useImperativeHandle(l,()=>c.current),s.useLayoutEffect(()=>void t?.(c.current)),s.createElement("mesh",N({ref:c},i),s.createElement(n,{attach:"geometry",args:r}),o)})}const _o=Po("box");function zo({all:e,scene:t,camera:n}){const r=F(({gl:l})=>l),o=F(({camera:l})=>l),i=F(({scene:l})=>l);return s.useLayoutEffect(()=>{const l=[];e&&(t||i).traverse(d=>{d.visible===!1&&(l.push(d),d.visible=!0)}),r.compile(t||i,n||o);const c=new rr(128);new or(.01,1e5,c).update(r,t||i),c.dispose(),l.forEach(d=>d.visible=!1)},[]),null}const ft=s.createContext(null),Lt=e=>(e.getAttributes()&2)===2,Ho=s.memo(s.forwardRef(({children:e,camera:t,scene:n,resolutionScale:r,enabled:o=!0,renderPriority:i=1,autoClear:l=!0,depthBuffer:c,enableNormalPass:a,stencilBuffer:d,multisampling:f=8,frameBufferType:u=Nt},v)=>{const{gl:m,scene:w,camera:b,size:y}=F(),g=n||w,p=t||b,[P,M,x]=s.useMemo(()=>{const R=new cr(m,{depthBuffer:c,stencilBuffer:d,multisampling:f,frameBufferType:u});R.addPass(new lr(g,p));let E=null,T=null;return a&&(T=new ur(g,p),T.enabled=!1,R.addPass(T),r!==void 0&&(E=new fr({normalBuffer:T.texture,resolutionScale:r}),E.enabled=!1,R.addPass(E))),[R,T,E]},[p,m,c,d,f,u,g,a,r]);s.useEffect(()=>P?.setSize(y.width,y.height),[P,y]),oe((R,E)=>{if(o){const T=m.autoClear;m.autoClear=l,d&&!l&&m.clearStencil(),P.render(E),m.autoClear=T}},o?i:0);const h=s.useRef(null);s.useLayoutEffect(()=>{const R=[],E=h.current.__r3f;if(E&&P){const T=E.children;for(let S=0;S<T.length;S++){const B=T[S].object;if(B instanceof bt){const O=[B];if(!Lt(B)){let j=null;for(;(j=T[S+1]?.object)instanceof bt&&!Lt(j);)O.push(j),S++}const A=new dr(p,...O);R.push(A)}else B instanceof pr&&R.push(B)}for(const S of R)P?.addPass(S);M&&(M.enabled=!0),x&&(x.enabled=!0)}return()=>{for(const T of R)P?.removePass(T);M&&(M.enabled=!1),x&&(x.enabled=!1)}},[P,e,p,M,x]),s.useEffect(()=>{const R=m.toneMapping;return m.toneMapping=Bt,()=>{m.toneMapping=R}},[m]);const I=s.useMemo(()=>({composer:P,normalPass:M,downSamplingPass:x,resolutionScale:r,camera:p,scene:g}),[P,M,x,r,p,g]);return s.useImperativeHandle(v,()=>P,[P]),W.jsx(ft.Provider,{value:I,children:W.jsx("group",{ref:h,children:e})})}));let xo=0;const Dt=new WeakMap,Eo=(e,t)=>function({blendFunction:n=t?.blendFunction,opacity:r=t?.opacity,...o}){let i=Dt.get(e);if(!i){const a=`@react-three/postprocessing/${e.name}-${xo++}`;at({[a]:e}),Dt.set(e,i=a)}const l=F(a=>a.camera),c=Sn.useMemo(()=>[...t?.args??[],...o.args??[{...t,...o}]],[JSON.stringify(o)]);return W.jsx(i,{camera:l,"blendMode-blendFunction":n,"blendMode-opacity-value":r,...o,args:c})},Wo=s.forwardRef(function({blendFunction:e,worldFocusDistance:t,worldFocusRange:n,focusDistance:r,focusRange:o,focalLength:i,bokehScale:l,resolutionScale:c,resolutionX:a,resolutionY:d,width:f,height:u,target:v,depthTexture:m,...w},b){const{camera:y}=s.useContext(ft),g=v!=null,p=s.useMemo(()=>{const P=new ir(y,{blendFunction:e,worldFocusDistance:t,worldFocusRange:n,focusDistance:r,focusRange:o,focalLength:i,bokehScale:l,resolutionScale:c,resolutionX:a,resolutionY:d,width:f,height:u});g&&(P.target=new G),m&&P.setDepthTexture(m.texture,m.packing);const M=P.maskPass;return M.maskFunction=ar.MULTIPLY_RGB_SET_ALPHA,P},[y,e,t,n,r,o,i,l,c,a,d,f,u,g,m]);return s.useEffect(()=>()=>{p.dispose()},[p]),W.jsx("primitive",{...w,ref:b,object:p,target:v})}),Bo=s.forwardRef(function(e,t){const{camera:n,normalPass:r,downSamplingPass:o,resolutionScale:i}=s.useContext(ft),l=s.useMemo(()=>r===null&&o===null?(console.error("Please enable the NormalPass in the EffectComposer in order to use SSAO."),{}):new sr(n,r&&!o?r.texture:null,{blendFunction:21,samples:30,rings:4,distanceThreshold:1,distanceFalloff:0,rangeThreshold:.5,rangeFalloff:.1,luminanceInfluence:.9,radius:20,bias:.5,intensity:1,color:void 0,normalDepthBuffer:o?o.texture:null,resolutionScale:i??1,depthAwareUpsampling:!0,...e}),[n,o,r,i]);return W.jsx("primitive",{ref:t,object:l,dispose:null})}),No=Eo(mr);export{_o as B,To as C,Do as G,Oo as H,Bo as I,No as L,Io as O,zo as P,Fo as T,So as _,oe as a,on as b,ut as c,Wo as d,ko as e,Ho as f,Ao as g,Lo as h,F as u};
