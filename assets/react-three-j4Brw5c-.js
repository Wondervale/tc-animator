import{a as Nt,s as gt,r as i,p as Ut,c as qt,j as _,b as Xt,x as Vt,i as Wt,d as de,e as bt,f as Yt,m as $t,g as Zt,R as Qt}from"./react-C0oXDeYe.js";import{W as Jt,R as yt,O as Kt,P as en,S as wt,a as Ce,V as tn,b as nn,B as rn,C as on,L as sn,c as Ct,N as Et,A as an,d as Pt,e as N,f as Ze,g as Le,h as cn,U as ln,i as un,T as fn,j as dn,D as pn,M as mn,k as vn,E as hn,H as xt,l as gn,m as bn,n as yn,o as Qe,p as wn,q as Cn,r as En,s as Pn,t as xn,u as jn,v as Mn,w as Sn,x as Rn,y as Je,z as Ge,F as Tn,G as Ne,I as On,J as Ee,K as In,Q as Ke,X as Fn,Y as kn,Z as Ln,_ as An,$ as Ae,a0 as et,a1 as _n,a2 as Dn,a3 as zn,a4 as Hn,a5 as Bn,a6 as Gn}from"./three-COLDv6GA.js";var tt=Nt();function jt(e){let t=e.root;for(;t.getState().previousRoot;)t=t.getState().previousRoot;return t}const Mt=e=>e&&e.isOrthographicCamera,Nn=e=>e&&e.hasOwnProperty("current"),Un=e=>e!=null&&(typeof e=="string"||typeof e=="number"||e.isColor),ce=((e,t)=>typeof window<"u"&&(((e=window.document)==null?void 0:e.createElement)||((t=window.navigator)==null?void 0:t.product)==="ReactNative"))()?i.useLayoutEffect:i.useEffect;function Ue(e){const t=i.useRef(e);return ce(()=>void(t.current=e),[e]),t}function qn(){const e=Xt(),t=Vt();return i.useMemo(()=>({children:n})=>{const o=!!Wt(e,!0,a=>a.type===i.StrictMode)?i.StrictMode:i.Fragment;return _.jsx(o,{children:_.jsx(t,{children:n})})},[e,t])}function Xn({set:e}){return ce(()=>(e(new Promise(()=>null)),()=>e(!1)),[e]),null}const Vn=(e=>(e=class extends i.Component{constructor(...n){super(...n),this.state={error:!1}}componentDidCatch(n){this.props.set(n)}render(){return this.state.error?null:this.props.children}},e.getDerivedStateFromError=()=>({error:!0}),e))();function St(e){var t;const n=typeof window<"u"?(t=window.devicePixelRatio)!=null?t:2:1;return Array.isArray(e)?Math.min(Math.max(e[0],n),e[1]):e}function J(e){var t;return(t=e.__r3f)==null?void 0:t.root.getState()}const A={obj:e=>e===Object(e)&&!A.arr(e)&&typeof e!="function",fun:e=>typeof e=="function",str:e=>typeof e=="string",num:e=>typeof e=="number",boo:e=>typeof e=="boolean",und:e=>e===void 0,nul:e=>e===null,arr:e=>Array.isArray(e),equ(e,t,{arrays:n="shallow",objects:r="reference",strict:o=!0}={}){if(typeof e!=typeof t||!!e!=!!t)return!1;if(A.str(e)||A.num(e)||A.boo(e))return e===t;const a=A.obj(e);if(a&&r==="reference")return e===t;const c=A.arr(e);if(c&&n==="reference")return e===t;if((c||a)&&e===t)return!0;let l;for(l in e)if(!(l in t))return!1;if(a&&n==="shallow"&&r==="shallow"){for(l in o?t:e)if(!A.equ(e[l],t[l],{strict:o,objects:"reference"}))return!1}else for(l in o?t:e)if(e[l]!==t[l])return!1;if(A.und(l)){if(c&&e.length===0&&t.length===0||a&&Object.keys(e).length===0&&Object.keys(t).length===0)return!0;if(e!==t)return!1}return!0}};function Wn(e){const t={nodes:{},materials:{},meshes:{}};return e&&e.traverse(n=>{n.name&&(t.nodes[n.name]=n),n.material&&!t.materials[n.material.name]&&(t.materials[n.material.name]=n.material),n.isMesh&&!t.meshes[n.name]&&(t.meshes[n.name]=n)}),t}function Yn(e){e.type!=="Scene"&&(e.dispose==null||e.dispose());for(const t in e){const n=e[t];n?.type!=="Scene"&&(n==null||n.dispose==null||n.dispose())}}const Rt=["children","key","ref"];function $n(e){const t={};for(const n in e)Rt.includes(n)||(t[n]=e[n]);return t}function me(e,t,n,r){const o=e;let a=o?.__r3f;return a||(a={root:t,type:n,parent:null,children:[],props:$n(r),object:o,eventCount:0,handlers:{},isHidden:!1},o&&(o.__r3f=a)),a}function ae(e,t){let n=e[t];if(!t.includes("-"))return{root:e,key:t,target:n};n=e;for(const o of t.split("-")){var r;t=o,e=n,n=(r=n)==null?void 0:r[t]}return{root:e,key:t,target:n}}const nt=/-\d+$/;function ve(e,t){if(A.str(t.props.attach)){if(nt.test(t.props.attach)){const o=t.props.attach.replace(nt,""),{root:a,key:c}=ae(e.object,o);Array.isArray(a[c])||(a[c]=[])}const{root:n,key:r}=ae(e.object,t.props.attach);t.previousAttach=n[r],n[r]=t.object}else A.fun(t.props.attach)&&(t.previousAttach=t.props.attach(e.object,t.object))}function he(e,t){if(A.str(t.props.attach)){const{root:n,key:r}=ae(e.object,t.props.attach),o=t.previousAttach;o===void 0?delete n[r]:n[r]=o}else t.previousAttach==null||t.previousAttach(e.object,t.object);delete t.previousAttach}const _e=[...Rt,"args","dispose","attach","object","onUpdate","dispose"],rt=new Map;function Zn(e){let t=rt.get(e.constructor);try{t||(t=new e.constructor,rt.set(e.constructor,t))}catch{}return t}function Qn(e,t){const n={};for(const r in t)if(!_e.includes(r)&&!A.equ(t[r],e.props[r])){n[r]=t[r];for(const o in t)o.startsWith(`${r}-`)&&(n[o]=t[o])}for(const r in e.props){if(_e.includes(r)||t.hasOwnProperty(r))continue;const{root:o,key:a}=ae(e.object,r);if(o.constructor&&o.constructor.length===0){const c=Zn(o);A.und(c)||(n[a]=c[a])}else n[a]=0}return n}const Jn=["map","emissiveMap","sheenColorMap","specularColorMap","envMap"],Kn=/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/;function $(e,t){var n;const r=e.__r3f,o=r&&jt(r).getState(),a=r?.eventCount;for(const l in t){let s=t[l];if(_e.includes(l))continue;if(r&&Kn.test(l)){typeof s=="function"?r.handlers[l]=s:delete r.handlers[l],r.eventCount=Object.keys(r.handlers).length;continue}if(s===void 0)continue;let{root:m,key:f,target:u}=ae(e,l);if(u instanceof Ze&&s instanceof Ze)u.mask=s.mask;else if(u instanceof Le&&Un(s))u.set(s);else if(u!==null&&typeof u=="object"&&typeof u.set=="function"&&typeof u.copy=="function"&&s!=null&&s.constructor&&u.constructor===s.constructor)u.copy(s);else if(u!==null&&typeof u=="object"&&typeof u.set=="function"&&Array.isArray(s))typeof u.fromArray=="function"?u.fromArray(s):u.set(...s);else if(u!==null&&typeof u=="object"&&typeof u.set=="function"&&typeof s=="number")typeof u.setScalar=="function"?u.setScalar(s):u.set(s);else{var c;m[f]=s,o&&!o.linear&&Jn.includes(f)&&(c=m[f])!=null&&c.isTexture&&m[f].format===cn&&m[f].type===ln&&(m[f].colorSpace=Ct)}}if(r!=null&&r.parent&&o!=null&&o.internal&&(n=r.object)!=null&&n.isObject3D&&a!==r.eventCount){const l=r.object,s=o.internal.interaction.indexOf(l);s>-1&&o.internal.interaction.splice(s,1),r.eventCount&&l.raycast!==null&&o.internal.interaction.push(l)}return r&&r.props.attach===void 0&&(r.object.isBufferGeometry?r.props.attach="geometry":r.object.isMaterial&&(r.props.attach="material")),r&&oe(r),e}function oe(e){var t;if(!e.parent)return;e.props.onUpdate==null||e.props.onUpdate(e.object);const n=(t=e.root)==null||t.getState==null?void 0:t.getState();n&&n.internal.frames===0&&n.invalidate()}function Tt(e,t){e.manual||(Mt(e)?(e.left=t.width/-2,e.right=t.width/2,e.top=t.height/2,e.bottom=t.height/-2):e.aspect=t.width/t.height,e.updateProjectionMatrix())}const B=e=>e?.isObject3D;function le(e){return(e.eventObject||e.object).uuid+"/"+e.index+e.instanceId}function Ot(e,t,n,r){const o=n.get(t);o&&(n.delete(t),n.size===0&&(e.delete(r),o.target.releasePointerCapture(r)))}function er(e,t){const{internal:n}=e.getState();n.interaction=n.interaction.filter(r=>r!==t),n.initialHits=n.initialHits.filter(r=>r!==t),n.hovered.forEach((r,o)=>{(r.eventObject===t||r.object===t)&&n.hovered.delete(o)}),n.capturedMap.forEach((r,o)=>{Ot(n.capturedMap,t,r,o)})}function tr(e){function t(s){const{internal:m}=e.getState(),f=s.offsetX-m.initialClick[0],u=s.offsetY-m.initialClick[1];return Math.round(Math.sqrt(f*f+u*u))}function n(s){return s.filter(m=>["Move","Over","Enter","Out","Leave"].some(f=>{var u;return(u=m.__r3f)==null?void 0:u.handlers["onPointer"+f]}))}function r(s,m){const f=e.getState(),u=new Set,v=[],p=m?m(f.internal.interaction):f.internal.interaction;for(let h=0;h<p.length;h++){const d=J(p[h]);d&&(d.raycaster.camera=void 0)}f.previousRoot||f.events.compute==null||f.events.compute(s,f);function C(h){const d=J(h);if(!d||!d.events.enabled||d.raycaster.camera===null)return[];if(d.raycaster.camera===void 0){var w;d.events.compute==null||d.events.compute(s,d,(w=d.previousRoot)==null?void 0:w.getState()),d.raycaster.camera===void 0&&(d.raycaster.camera=null)}return d.raycaster.camera?d.raycaster.intersectObject(h,!0):[]}let b=p.flatMap(C).sort((h,d)=>{const w=J(h.object),P=J(d.object);return!w||!P?h.distance-d.distance:P.events.priority-w.events.priority||h.distance-d.distance}).filter(h=>{const d=le(h);return u.has(d)?!1:(u.add(d),!0)});f.events.filter&&(b=f.events.filter(b,f));for(const h of b){let d=h.object;for(;d;){var g;(g=d.__r3f)!=null&&g.eventCount&&v.push({...h,eventObject:d}),d=d.parent}}if("pointerId"in s&&f.internal.capturedMap.has(s.pointerId))for(let h of f.internal.capturedMap.get(s.pointerId).values())u.has(le(h.intersection))||v.push(h.intersection);return v}function o(s,m,f,u){if(s.length){const v={stopped:!1};for(const p of s){let C=J(p.object);if(C||p.object.traverseAncestors(b=>{const g=J(b);if(g)return C=g,!1}),C){const{raycaster:b,pointer:g,camera:h,internal:d}=C,w=new N(g.x,g.y,0).unproject(h),P=j=>{var S,I;return(S=(I=d.capturedMap.get(j))==null?void 0:I.has(p.eventObject))!=null?S:!1},E=j=>{const S={intersection:p,target:m.target};d.capturedMap.has(j)?d.capturedMap.get(j).set(p.eventObject,S):d.capturedMap.set(j,new Map([[p.eventObject,S]])),m.target.setPointerCapture(j)},y=j=>{const S=d.capturedMap.get(j);S&&Ot(d.capturedMap,p.eventObject,S,j)};let F={};for(let j in m){let S=m[j];typeof S!="function"&&(F[j]=S)}let M={...p,...F,pointer:g,intersections:s,stopped:v.stopped,delta:f,unprojectedPoint:w,ray:b.ray,camera:h,stopPropagation(){const j="pointerId"in m&&d.capturedMap.get(m.pointerId);if((!j||j.has(p.eventObject))&&(M.stopped=v.stopped=!0,d.hovered.size&&Array.from(d.hovered.values()).find(S=>S.eventObject===p.eventObject))){const S=s.slice(0,s.indexOf(p));a([...S,p])}},target:{hasPointerCapture:P,setPointerCapture:E,releasePointerCapture:y},currentTarget:{hasPointerCapture:P,setPointerCapture:E,releasePointerCapture:y},nativeEvent:m};if(u(M),v.stopped===!0)break}}}return s}function a(s){const{internal:m}=e.getState();for(const f of m.hovered.values())if(!s.length||!s.find(u=>u.object===f.object&&u.index===f.index&&u.instanceId===f.instanceId)){const v=f.eventObject.__r3f;if(m.hovered.delete(le(f)),v!=null&&v.eventCount){const p=v.handlers,C={...f,intersections:s};p.onPointerOut==null||p.onPointerOut(C),p.onPointerLeave==null||p.onPointerLeave(C)}}}function c(s,m){for(let f=0;f<m.length;f++){const u=m[f].__r3f;u==null||u.handlers.onPointerMissed==null||u.handlers.onPointerMissed(s)}}function l(s){switch(s){case"onPointerLeave":case"onPointerCancel":return()=>a([]);case"onLostPointerCapture":return m=>{const{internal:f}=e.getState();"pointerId"in m&&f.capturedMap.has(m.pointerId)&&requestAnimationFrame(()=>{f.capturedMap.has(m.pointerId)&&(f.capturedMap.delete(m.pointerId),a([]))})}}return function(f){const{onPointerMissed:u,internal:v}=e.getState();v.lastEvent.current=f;const p=s==="onPointerMove",C=s==="onClick"||s==="onContextMenu"||s==="onDoubleClick",g=r(f,p?n:void 0),h=C?t(f):0;s==="onPointerDown"&&(v.initialClick=[f.offsetX,f.offsetY],v.initialHits=g.map(w=>w.eventObject)),C&&!g.length&&h<=2&&(c(f,v.interaction),u&&u(f)),p&&a(g);function d(w){const P=w.eventObject,E=P.__r3f;if(!(E!=null&&E.eventCount))return;const y=E.handlers;if(p){if(y.onPointerOver||y.onPointerEnter||y.onPointerOut||y.onPointerLeave){const F=le(w),M=v.hovered.get(F);M?M.stopped&&w.stopPropagation():(v.hovered.set(F,w),y.onPointerOver==null||y.onPointerOver(w),y.onPointerEnter==null||y.onPointerEnter(w))}y.onPointerMove==null||y.onPointerMove(w)}else{const F=y[s];F?(!C||v.initialHits.includes(P))&&(c(f,v.interaction.filter(M=>!v.initialHits.includes(M))),F(w)):C&&v.initialHits.includes(P)&&c(f,v.interaction.filter(M=>!v.initialHits.includes(M)))}}o(g,f,h,d)}}return{handlePointer:l}}const ot=e=>!!(e!=null&&e.render),qe=i.createContext(null),nr=(e,t)=>{const n=bt((l,s)=>{const m=new N,f=new N,u=new N;function v(h=s().camera,d=f,w=s().size){const{width:P,height:E,top:y,left:F}=w,M=P/E;d.isVector3?u.copy(d):u.set(...d);const j=h.getWorldPosition(m).distanceTo(u);if(Mt(h))return{width:P/h.zoom,height:E/h.zoom,top:y,left:F,factor:1,distance:j,aspect:M};{const S=h.fov*Math.PI/180,I=2*Math.tan(S/2)*j,z=I*(P/E);return{width:z,height:I,top:y,left:F,factor:P/z,distance:j,aspect:M}}}let p;const C=h=>l(d=>({performance:{...d.performance,current:h}})),b=new Pt;return{set:l,get:s,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},scene:null,xr:null,invalidate:(h=1)=>e(s(),h),advance:(h,d)=>t(h,d,s()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new un,pointer:b,mouse:b,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const h=s();p&&clearTimeout(p),h.performance.current!==h.performance.min&&C(h.performance.min),p=setTimeout(()=>C(s().performance.max),h.performance.debounce)}},size:{width:0,height:0,top:0,left:0},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:v},setEvents:h=>l(d=>({...d,events:{...d.events,...h}})),setSize:(h,d,w=0,P=0)=>{const E=s().camera,y={width:h,height:d,top:w,left:P};l(F=>({size:y,viewport:{...F.viewport,...v(E,f,y)}}))},setDpr:h=>l(d=>{const w=St(h);return{viewport:{...d.viewport,dpr:w,initialDpr:d.viewport.initialDpr||w}}}),setFrameloop:(h="always")=>{const d=s().clock;d.stop(),d.elapsedTime=0,h!=="never"&&(d.start(),d.elapsedTime=0),l(()=>({frameloop:h}))},previousRoot:void 0,internal:{interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,lastEvent:i.createRef(),active:!1,frames:0,priority:0,subscribe:(h,d,w)=>{const P=s().internal;return P.priority=P.priority+(d>0?1:0),P.subscribers.push({ref:h,priority:d,store:w}),P.subscribers=P.subscribers.sort((E,y)=>E.priority-y.priority),()=>{const E=s().internal;E!=null&&E.subscribers&&(E.priority=E.priority-(d>0?1:0),E.subscribers=E.subscribers.filter(y=>y.ref!==h))}}}}}),r=n.getState();let o=r.size,a=r.viewport.dpr,c=r.camera;return n.subscribe(()=>{const{camera:l,size:s,viewport:m,gl:f,set:u}=n.getState();if(s.width!==o.width||s.height!==o.height||m.dpr!==a){o=s,a=m.dpr,Tt(l,s),m.dpr>0&&f.setPixelRatio(m.dpr);const v=typeof HTMLCanvasElement<"u"&&f.domElement instanceof HTMLCanvasElement;f.setSize(s.width,s.height,v)}l!==c&&(c=l,u(v=>({viewport:{...v.viewport,...v.viewport.getCurrentViewport(l)}})))}),n.subscribe(l=>e(l)),n};function Xe(){const e=i.useContext(qe);if(!e)throw new Error("R3F: Hooks can only be used within the Canvas component!");return e}function O(e=n=>n,t){return Xe()(e,t)}function se(e,t=0){const n=Xe(),r=n.getState().internal.subscribe,o=Ue(e);return ce(()=>r(o,t,n),[t,r,n]),null}const st=new WeakMap,rr=e=>{var t;return typeof e=="function"&&(e==null||(t=e.prototype)==null?void 0:t.constructor)===e};function It(e,t){return function(n,...r){let o;return rr(n)?(o=st.get(n),o||(o=new n,st.set(n,o))):o=n,e&&e(o),Promise.all(r.map(a=>new Promise((c,l)=>o.load(a,s=>{B(s?.scene)&&Object.assign(s,Wn(s.scene)),c(s)},t,s=>l(new Error(`Could not load ${a}: ${s?.message}`))))))}}function Z(e,t,n,r){const o=Array.isArray(t)?t:[t],a=gt(It(n,r),[e,...o],{equal:A.equ});return Array.isArray(t)?a:a[0]}Z.preload=function(e,t,n){const r=Array.isArray(t)?t:[t];return Ut(It(n),[e,...r])};Z.clear=function(e,t){const n=Array.isArray(t)?t:[t];return qt([e,...n])};function or(e){const t=Yt(e);return t.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:i.version}),t}const Ft=0,re={},sr=/^three(?=[A-Z])/,ye=e=>`${e[0].toUpperCase()}${e.slice(1)}`;let ir=0;const ar=e=>typeof e=="function";function Ve(e){if(ar(e)){const t=`${ir++}`;return re[t]=e,t}else Object.assign(re,e)}function kt(e,t){const n=ye(e),r=re[n];if(e!=="primitive"&&!r)throw new Error(`R3F: ${n} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(e==="primitive"&&!t.object)throw new Error("R3F: Primitives without 'object' are invalid!");if(t.args!==void 0&&!Array.isArray(t.args))throw new Error("R3F: The args prop must be an array!")}function cr(e,t,n){var r;return e=ye(e)in re?e:e.replace(sr,""),kt(e,t),e==="primitive"&&(r=t.object)!=null&&r.__r3f&&delete t.object.__r3f,me(t.object,n,e,t)}function lr(e){if(!e.isHidden){var t;e.props.attach&&(t=e.parent)!=null&&t.object?he(e.parent,e):B(e.object)&&(e.object.visible=!1),e.isHidden=!0,oe(e)}}function Lt(e){if(e.isHidden){var t;e.props.attach&&(t=e.parent)!=null&&t.object?ve(e.parent,e):B(e.object)&&e.props.visible!==!1&&(e.object.visible=!0),e.isHidden=!1,oe(e)}}function We(e,t,n){const r=t.root.getState();if(!(!e.parent&&e.object!==r.scene)){if(!t.object){var o,a;const c=re[ye(t.type)];t.object=(o=t.props.object)!=null?o:new c(...(a=t.props.args)!=null?a:[]),t.object.__r3f=t}if($(t.object,t.props),t.props.attach)ve(e,t);else if(B(t.object)&&B(e.object)){const c=e.object.children.indexOf(n?.object);if(n&&c!==-1){const l=e.object.children.indexOf(t.object);if(l!==-1){e.object.children.splice(l,1);const s=l<c?c-1:c;e.object.children.splice(s,0,t.object)}else t.object.parent=e.object,e.object.children.splice(c,0,t.object),t.object.dispatchEvent({type:"added"}),e.object.dispatchEvent({type:"childadded",child:t.object})}else e.object.add(t.object)}for(const c of t.children)We(t,c);oe(t)}}function Pe(e,t){t&&(t.parent=e,e.children.push(t),We(e,t))}function it(e,t,n){if(!t||!n)return;t.parent=e;const r=e.children.indexOf(n);r!==-1?e.children.splice(r,0,t):e.children.push(t),We(e,t,n)}function At(e){if(typeof e.dispose=="function"){const t=()=>{try{e.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT<"u"?t():tt.unstable_scheduleCallback(tt.unstable_IdlePriority,t)}}function De(e,t,n){if(!t)return;t.parent=null;const r=e.children.indexOf(t);r!==-1&&e.children.splice(r,1),t.props.attach?he(e,t):B(t.object)&&B(e.object)&&(e.object.remove(t.object),er(jt(t),t.object));const o=t.props.dispose!==null&&n!==!1;for(let a=t.children.length-1;a>=0;a--){const c=t.children[a];De(t,c,o)}t.children.length=0,delete t.object.__r3f,o&&t.type!=="primitive"&&t.object.type!=="Scene"&&At(t.object),n===void 0&&oe(t)}function ur(e,t){for(const n of[e,e.alternate])if(n!==null)if(typeof n.ref=="function"){n.refCleanup==null||n.refCleanup();const r=n.ref(t);typeof r=="function"&&(n.refCleanup=r)}else n.ref&&(n.ref.current=t)}const pe=[];function fr(){for(const[n]of pe){const r=n.parent;if(r){n.props.attach?he(r,n):B(n.object)&&B(r.object)&&r.object.remove(n.object);for(const o of n.children)o.props.attach?he(n,o):B(o.object)&&B(n.object)&&n.object.remove(o.object)}n.isHidden&&Lt(n),n.object.__r3f&&delete n.object.__r3f,n.type!=="primitive"&&At(n.object)}for(const[n,r,o]of pe){n.props=r;const a=n.parent;if(a){var e,t;const c=re[ye(n.type)];n.object=(e=n.props.object)!=null?e:new c(...(t=n.props.args)!=null?t:[]),n.object.__r3f=n,ur(o,n.object),$(n.object,n.props),n.props.attach?ve(a,n):B(n.object)&&B(a.object)&&a.object.add(n.object);for(const l of n.children)l.props.attach?ve(n,l):B(l.object)&&B(n.object)&&n.object.add(l.object);oe(n)}}pe.length=0}const xe=()=>{},at={};let ue=Ft;const dr=0,pr=4,ge=or({isPrimaryRenderer:!1,warnsIfNotActing:!1,supportsMutation:!0,supportsPersistence:!1,supportsHydration:!1,createInstance:cr,removeChild:De,appendChild:Pe,appendInitialChild:Pe,insertBefore:it,appendChildToContainer(e,t){const n=e.getState().scene.__r3f;!t||!n||Pe(n,t)},removeChildFromContainer(e,t){const n=e.getState().scene.__r3f;!t||!n||De(n,t)},insertInContainerBefore(e,t,n){const r=e.getState().scene.__r3f;!t||!n||!r||it(r,t,n)},getRootHostContext:()=>at,getChildHostContext:()=>at,commitUpdate(e,t,n,r,o){var a,c,l;kt(t,r);let s=!1;if((e.type==="primitive"&&n.object!==r.object||((a=r.args)==null?void 0:a.length)!==((c=n.args)==null?void 0:c.length)||(l=r.args)!=null&&l.some((f,u)=>{var v;return f!==((v=n.args)==null?void 0:v[u])}))&&(s=!0),s)pe.push([e,{...r},o]);else{const f=Qn(e,r);Object.keys(f).length&&(Object.assign(e.props,f),$(e.object,f))}(o.sibling===null||(o.flags&pr)===dr)&&fr()},finalizeInitialChildren:()=>!1,commitMount(){},getPublicInstance:e=>e?.object,prepareForCommit:()=>null,preparePortalMount:e=>me(e.getState().scene,e,"",{}),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance:lr,unhideInstance:Lt,createTextInstance:xe,hideTextInstance:xe,unhideTextInstance:xe,scheduleTimeout:typeof setTimeout=="function"?setTimeout:void 0,cancelTimeout:typeof clearTimeout=="function"?clearTimeout:void 0,noTimeout:-1,getInstanceFromNode:()=>null,beforeActiveInstanceBlur(){},afterActiveInstanceBlur(){},detachDeletedInstance(){},prepareScopeUpdate(){},getInstanceFromScope:()=>null,shouldAttemptEagerTransition:()=>!1,trackSchedulerEvent:()=>{},resolveEventType:()=>null,resolveEventTimeStamp:()=>-1.1,requestPostPaintCallback(){},maySuspendCommit:()=>!1,preloadInstance:()=>!0,startSuspendingCommit(){},suspendInstance(){},waitForCommitToBeReady:()=>null,NotPendingTransition:null,HostTransitionContext:i.createContext(null),setCurrentUpdatePriority(e){ue=e},getCurrentUpdatePriority(){return ue},resolveUpdatePriority(){var e;if(ue!==Ft)return ue;switch(typeof window<"u"&&((e=window.event)==null?void 0:e.type)){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return de.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return de.ContinuousEventPriority;default:return de.DefaultEventPriority}},resetFormInstance(){}}),Q=new Map,K={objects:"shallow",strict:!1};function mr(e,t){if(!t&&typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&e.parentElement){const{width:n,height:r,top:o,left:a}=e.parentElement.getBoundingClientRect();return{width:n,height:r,top:o,left:a}}else if(!t&&typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas)return{width:e.width,height:e.height,top:0,left:0};return{width:0,height:0,top:0,left:0,...t}}function vr(e){const t=Q.get(e),n=t?.fiber,r=t?.store;t&&console.warn("R3F.createRoot should only be called once!");const o=typeof reportError=="function"?reportError:console.error,a=r||nr(Be,lt),c=n||ge.createContainer(a,de.ConcurrentRoot,null,!1,null,"",o,o,o,null);t||Q.set(e,{fiber:c,store:a});let l,s,m=!1,f=null;return{async configure(u={}){let v;f=new Promise(x=>v=x);let{gl:p,size:C,scene:b,events:g,onCreated:h,shadows:d=!1,linear:w=!1,flat:P=!1,legacy:E=!1,orthographic:y=!1,frameloop:F="always",dpr:M=[1,2],performance:j,raycaster:S,camera:I,onPointerMissed:z}=u,R=a.getState(),L=R.gl;if(!R.gl){const x={canvas:e,powerPreference:"high-performance",antialias:!0,alpha:!0},k=typeof p=="function"?await p(x):p;ot(k)?L=k:L=new Jt({...x,...p}),R.set({gl:L})}let T=R.raycaster;T||R.set({raycaster:T=new yt});const{params:W,...q}=S||{};if(A.equ(q,T,K)||$(T,{...q}),A.equ(W,T.params,K)||$(T,{params:{...T.params,...W}}),!R.camera||R.camera===s&&!A.equ(s,I,K)){s=I;const x=I?.isCamera,k=x?I:y?new Kt(0,0,0,0,.1,1e3):new en(75,0,.1,1e3);x||(k.position.z=5,I&&($(k,I),k.manual||("aspect"in I||"left"in I||"right"in I||"bottom"in I||"top"in I)&&(k.manual=!0,k.updateProjectionMatrix())),!R.camera&&!(I!=null&&I.rotation)&&k.lookAt(0,0,0)),R.set({camera:k}),T.camera=k}if(!R.scene){let x;b!=null&&b.isScene?(x=b,me(x,a,"",{})):(x=new wt,me(x,a,"",{}),b&&$(x,b)),R.set({scene:x})}g&&!R.events.handlers&&R.set({events:g(a)});const X=mr(e,C);if(A.equ(X,R.size,K)||R.setSize(X.width,X.height,X.top,X.left),M&&R.viewport.dpr!==St(M)&&R.setDpr(M),R.frameloop!==F&&R.setFrameloop(F),R.onPointerMissed||R.set({onPointerMissed:z}),j&&!A.equ(j,R.performance,K)&&R.set(x=>({performance:{...x.performance,...j}})),!R.xr){var U;const x=(D,V)=>{const $e=a.getState();$e.frameloop!=="never"&&lt(D,!0,$e,V)},k=()=>{const D=a.getState();D.gl.xr.enabled=D.gl.xr.isPresenting,D.gl.xr.setAnimationLoop(D.gl.xr.isPresenting?x:null),D.gl.xr.isPresenting||Be(D)},G={connect(){const D=a.getState().gl;D.xr.addEventListener("sessionstart",k),D.xr.addEventListener("sessionend",k)},disconnect(){const D=a.getState().gl;D.xr.removeEventListener("sessionstart",k),D.xr.removeEventListener("sessionend",k)}};typeof((U=L.xr)==null?void 0:U.addEventListener)=="function"&&G.connect(),R.set({xr:G})}if(L.shadowMap){const x=L.shadowMap.enabled,k=L.shadowMap.type;if(L.shadowMap.enabled=!!d,A.boo(d))L.shadowMap.type=Ce;else if(A.str(d)){var Y;const G={basic:rn,percentage:nn,soft:Ce,variance:tn};L.shadowMap.type=(Y=G[d])!=null?Y:Ce}else A.obj(d)&&Object.assign(L.shadowMap,d);(x!==L.shadowMap.enabled||k!==L.shadowMap.type)&&(L.shadowMap.needsUpdate=!0)}return on.enabled=!E,m||(L.outputColorSpace=w?sn:Ct,L.toneMapping=P?Et:an),R.legacy!==E&&R.set(()=>({legacy:E})),R.linear!==w&&R.set(()=>({linear:w})),R.flat!==P&&R.set(()=>({flat:P})),p&&!A.fun(p)&&!ot(p)&&!A.equ(p,L,K)&&$(L,p),l=h,m=!0,v(),this},render(u){return!m&&!f&&this.configure(),f.then(()=>{ge.updateContainer(_.jsx(hr,{store:a,children:u,onCreated:l,rootElement:e}),c,null,()=>{})}),a},unmount(){_t(e)}}}function hr({store:e,children:t,onCreated:n,rootElement:r}){return ce(()=>{const o=e.getState();o.set(a=>({internal:{...a.internal,active:!0}})),n&&n(o),e.getState().events.connected||o.events.connect==null||o.events.connect(r)},[]),_.jsx(qe.Provider,{value:e,children:t})}function _t(e,t){const n=Q.get(e),r=n?.fiber;if(r){const o=n?.store.getState();o&&(o.internal.active=!1),ge.updateContainer(null,r,null,()=>{o&&setTimeout(()=>{try{var a,c,l,s;o.events.disconnect==null||o.events.disconnect(),(a=o.gl)==null||(c=a.renderLists)==null||c.dispose==null||c.dispose(),(l=o.gl)==null||l.forceContextLoss==null||l.forceContextLoss(),(s=o.gl)!=null&&s.xr&&o.xr.disconnect(),Yn(o.scene),Q.delete(e)}catch{}},500)})}}function gr(e,t,n){return _.jsx(br,{children:e,container:t,state:n})}function br({state:e={},children:t,container:n}){const{events:r,size:o,...a}=e,c=Xe(),[l]=i.useState(()=>new yt),[s]=i.useState(()=>new Pt),m=Ue((u,v)=>{let p;if(v.camera&&o){const C=v.camera;p=u.viewport.getCurrentViewport(C,new N,o),C!==u.camera&&Tt(C,o)}return{...u,...v,scene:n,raycaster:l,pointer:s,mouse:s,previousRoot:c,events:{...u.events,...v.events,...r},size:{...u.size,...o},viewport:{...u.viewport,...p},setEvents:C=>v.set(b=>({...b,events:{...b.events,...C}}))}}),f=i.useMemo(()=>{const u=bt((p,C)=>({...a,set:p,get:C})),v=p=>u.setState(C=>m.current(p,C));return v(c.getState()),c.subscribe(v),u},[c,n]);return _.jsx(_.Fragment,{children:ge.createPortal(_.jsx(qe.Provider,{value:f,children:t}),f,null)})}const yr=new Set,wr=new Set,Cr=new Set;function je(e,t){if(e.size)for(const{callback:n}of e.values())n(t)}function ie(e,t){switch(e){case"before":return je(yr,t);case"after":return je(wr,t);case"tail":return je(Cr,t)}}let Me,Se;function ze(e,t,n){let r=t.clock.getDelta();t.frameloop==="never"&&typeof e=="number"&&(r=e-t.clock.elapsedTime,t.clock.oldTime=t.clock.elapsedTime,t.clock.elapsedTime=e),Me=t.internal.subscribers;for(let o=0;o<Me.length;o++)Se=Me[o],Se.ref.current(Se.store.getState(),r,n);return!t.internal.priority&&t.gl.render&&t.gl.render(t.scene,t.camera),t.internal.frames=Math.max(0,t.internal.frames-1),t.frameloop==="always"?1:t.internal.frames}let be=!1,He=!1,Re,ct,ee;function Dt(e){ct=requestAnimationFrame(Dt),be=!0,Re=0,ie("before",e),He=!0;for(const n of Q.values()){var t;ee=n.store.getState(),ee.internal.active&&(ee.frameloop==="always"||ee.internal.frames>0)&&!((t=ee.gl.xr)!=null&&t.isPresenting)&&(Re+=ze(e,ee))}if(He=!1,ie("after",e),Re===0)return ie("tail",e),be=!1,cancelAnimationFrame(ct)}function Be(e,t=1){var n;if(!e)return Q.forEach(r=>Be(r.store.getState(),t));(n=e.gl.xr)!=null&&n.isPresenting||!e.internal.active||e.frameloop==="never"||(t>1?e.internal.frames=Math.min(60,e.internal.frames+t):He?e.internal.frames=2:e.internal.frames=1,be||(be=!0,requestAnimationFrame(Dt)))}function lt(e,t=!0,n,r){if(t&&ie("before",e),n)ze(e,n,r);else for(const o of Q.values())ze(e,o.store.getState());t&&ie("after",e)}const Te={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function Er(e){const{handlePointer:t}=tr(e);return{priority:1,enabled:!0,compute(n,r,o){r.pointer.set(n.offsetX/r.size.width*2-1,-(n.offsetY/r.size.height)*2+1),r.raycaster.setFromCamera(r.pointer,r.camera)},connected:void 0,handlers:Object.keys(Te).reduce((n,r)=>({...n,[r]:t(r)}),{}),update:()=>{var n;const{events:r,internal:o}=e.getState();(n=o.lastEvent)!=null&&n.current&&r.handlers&&r.handlers.onPointerMove(o.lastEvent.current)},connect:n=>{const{set:r,events:o}=e.getState();if(o.disconnect==null||o.disconnect(),r(a=>({events:{...a.events,connected:n}})),o.handlers)for(const a in o.handlers){const c=o.handlers[a],[l,s]=Te[a];n.addEventListener(l,c,{passive:s})}},disconnect:()=>{const{set:n,events:r}=e.getState();if(r.connected){if(r.handlers)for(const o in r.handlers){const a=r.handlers[o],[c]=Te[o];r.connected.removeEventListener(c,a)}n(o=>({events:{...o.events,connected:void 0}}))}}}}function Pr({ref:e,children:t,fallback:n,resize:r,style:o,gl:a,events:c=Er,eventSource:l,eventPrefix:s,shadows:m,linear:f,flat:u,legacy:v,orthographic:p,frameloop:C,dpr:b,performance:g,raycaster:h,camera:d,scene:w,onPointerMissed:P,onCreated:E,...y}){i.useMemo(()=>Ve(fn),[]);const F=qn(),[M,j]=Zt({scroll:!0,debounce:{scroll:50,resize:0},...r}),S=i.useRef(null),I=i.useRef(null);i.useImperativeHandle(e,()=>S.current);const z=Ue(P),[R,L]=i.useState(!1),[T,W]=i.useState(!1);if(R)throw R;if(T)throw T;const q=i.useRef(null);ce(()=>{const U=S.current;if(j.width>0&&j.height>0&&U){q.current||(q.current=vr(U));async function Y(){await q.current.configure({gl:a,scene:w,events:c,shadows:m,linear:f,flat:u,legacy:v,orthographic:p,frameloop:C,dpr:b,performance:g,raycaster:h,camera:d,size:j,onPointerMissed:(...x)=>z.current==null?void 0:z.current(...x),onCreated:x=>{x.events.connect==null||x.events.connect(l?Nn(l)?l.current:l:I.current),s&&x.setEvents({compute:(k,G)=>{const D=k[s+"X"],V=k[s+"Y"];G.pointer.set(D/G.size.width*2-1,-(V/G.size.height)*2+1),G.raycaster.setFromCamera(G.pointer,G.camera)}}),E?.(x)}}),q.current.render(_.jsx(F,{children:_.jsx(Vn,{set:W,children:_.jsx(i.Suspense,{fallback:_.jsx(Xn,{set:L}),children:t??null})})}))}Y()}}),i.useEffect(()=>{const U=S.current;if(U)return()=>_t(U)},[]);const X=l?"none":"auto";return _.jsx("div",{ref:I,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:X,...o},...y,children:_.jsx("div",{ref:M,style:{width:"100%",height:"100%"},children:_.jsx("canvas",{ref:S,style:{display:"block"},children:n})})})}function Nr(e){return _.jsx($t,{children:_.jsx(Pr,{...e})})}const xr=i.createContext(null),we=i.createContext(null),ut=e=>(e.getAttributes()&2)===2,Ur=i.memo(i.forwardRef(({children:e,camera:t,scene:n,resolutionScale:r,enabled:o=!0,renderPriority:a=1,autoClear:c=!0,depthBuffer:l,enableNormalPass:s,stencilBuffer:m,multisampling:f=8,frameBufferType:u=xt},v)=>{const{gl:p,scene:C,camera:b,size:g}=O(),h=n||C,d=t||b,[w,P,E]=i.useMemo(()=>{const M=new hn(p,{depthBuffer:l,stencilBuffer:m,multisampling:f,frameBufferType:u});M.addPass(new gn(h,d));let j=null,S=null;return s&&(S=new bn(h,d),S.enabled=!1,M.addPass(S),r!==void 0&&(j=new yn({normalBuffer:S.texture,resolutionScale:r}),j.enabled=!1,M.addPass(j))),[M,S,j]},[d,p,l,m,f,u,h,s,r]);i.useEffect(()=>w?.setSize(g.width,g.height),[w,g]),se((M,j)=>{if(o){const S=p.autoClear;p.autoClear=c,m&&!c&&p.clearStencil(),w.render(j),p.autoClear=S}},o?a:0);const y=i.useRef(null);i.useLayoutEffect(()=>{const M=[],j=y.current.__r3f;if(j&&w){const S=j.children;for(let I=0;I<S.length;I++){const z=S[I].object;if(z instanceof Qe){const R=[z];if(!ut(z)){let T=null;for(;(T=S[I+1]?.object)instanceof Qe&&!ut(T);)R.push(T),I++}const L=new wn(d,...R);M.push(L)}else z instanceof Cn&&M.push(z)}for(const I of M)w?.addPass(I);P&&(P.enabled=!0),E&&(E.enabled=!0)}return()=>{for(const S of M)w?.removePass(S);P&&(P.enabled=!1),E&&(E.enabled=!1)}},[w,e,d,P,E]),i.useEffect(()=>{const M=p.toneMapping;return p.toneMapping=Et,()=>{p.toneMapping=M}},[p]);const F=i.useMemo(()=>({composer:w,normalPass:P,downSamplingPass:E,resolutionScale:r,camera:d,scene:h}),[w,P,E,r,d,h]);return i.useImperativeHandle(v,()=>w,[w]),_.jsx(we.Provider,{value:F,children:_.jsx("group",{ref:y,children:e})})})),ft=e=>typeof e=="object"&&e!=null&&"current"in e?e.current:e;let jr=0;const dt=new WeakMap,Mr=(e,t)=>function({blendFunction:n=t?.blendFunction,opacity:r=t?.opacity,...o}){let a=dt.get(e);if(!a){const s=`@react-three/postprocessing/${e.name}-${jr++}`;Ve({[s]:e}),dt.set(e,a=s)}const c=O(s=>s.camera),l=Qt.useMemo(()=>[...t?.args??[],...o.args??[{...t,...o}]],[JSON.stringify(o)]);return _.jsx(a,{camera:c,"blendMode-blendFunction":n,"blendMode-opacity-value":r,...o,args:l})},qr=i.forwardRef(function({blendFunction:e,worldFocusDistance:t,worldFocusRange:n,focusDistance:r,focusRange:o,focalLength:a,bokehScale:c,resolutionScale:l,resolutionX:s,resolutionY:m,width:f,height:u,target:v,depthTexture:p,...C},b){const{camera:g}=i.useContext(we),h=v!=null,d=i.useMemo(()=>{const w=new pn(g,{blendFunction:e,worldFocusDistance:t,worldFocusRange:n,focusDistance:r,focusRange:o,focalLength:a,bokehScale:c,resolutionScale:l,resolutionX:s,resolutionY:m,width:f,height:u});h&&(w.target=new N),p&&w.setDepthTexture(p.texture,p.packing);const P=w.maskPass;return P.maskFunction=mn.MULTIPLY_RGB_SET_ALPHA,w},[g,e,t,n,r,o,a,c,l,s,m,f,u,h,p]);return i.useEffect(()=>()=>{d.dispose()},[d]),_.jsx("primitive",{...C,ref:b,object:d,target:v})}),Xr=i.forwardRef(function({selection:e=[],selectionLayer:t=10,blendFunction:n,patternTexture:r,edgeStrength:o,pulseSpeed:a,visibleEdgeColor:c,hiddenEdgeColor:l,width:s,height:m,kernelSize:f,blur:u,xRay:v,...p},C){const b=O(P=>P.invalidate),{scene:g,camera:h}=i.useContext(we),d=i.useMemo(()=>new vn(g,h,{blendFunction:n,patternTexture:r,edgeStrength:o,pulseSpeed:a,visibleEdgeColor:c,hiddenEdgeColor:l,width:s,height:m,kernelSize:f,blur:u,xRay:v,...p}),[n,u,h,o,m,l,f,r,a,g,c,s,v]),w=i.useContext(xr);return i.useEffect(()=>{if(!w&&e)return d.selection.set(Array.isArray(e)?e.map(ft):[ft(e)]),b(),()=>{d.selection.clear(),b()}},[d,e,w,b]),i.useEffect(()=>{d.selectionLayer=t,b()},[d,b,t]),i.useRef(void 0),i.useEffect(()=>{if(w&&w.enabled&&w.selected?.length)return d.selection.set(w.selected),b(),()=>{d.selection.clear(),b()}},[w,d.selection,b]),i.useEffect(()=>()=>{d.dispose()},[d]),_.jsx("primitive",{ref:C,object:d})}),Vr=i.forwardRef(function(e,t){const{camera:n,normalPass:r,downSamplingPass:o,resolutionScale:a}=i.useContext(we),c=i.useMemo(()=>r===null&&o===null?(console.error("Please enable the NormalPass in the EffectComposer in order to use SSAO."),{}):new dn(n,r&&!o?r.texture:null,{blendFunction:21,samples:30,rings:4,distanceThreshold:1,distanceFalloff:0,rangeThreshold:.5,rangeFalloff:.1,luminanceInfluence:.9,radius:20,bias:.5,intensity:1,color:void 0,normalDepthBuffer:o?o.texture:null,resolutionScale:a??1,depthAwareUpsampling:!0,...e}),[n,o,r,a]);return _.jsx("primitive",{ref:t,object:c,dispose:null})}),Wr=Mr(En);function H(){return H=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},H.apply(null,arguments)}const Yr=i.forwardRef(({sdfGlyphSize:e=64,anchorX:t="center",anchorY:n="middle",font:r,fontSize:o=1,children:a,characters:c,onSync:l,...s},m)=>{const f=O(({invalidate:C})=>C),[u]=i.useState(()=>new Pn),[v,p]=i.useMemo(()=>{const C=[];let b="";return i.Children.forEach(a,g=>{typeof g=="string"||typeof g=="number"?b+=g:C.push(g)}),[C,b]},[a]);return gt(()=>new Promise(C=>xn({font:r,characters:c},C)),["troika-text",r,c]),i.useLayoutEffect(()=>void u.sync(()=>{f(),l&&l(u)})),i.useEffect(()=>()=>u.dispose(),[u]),i.createElement("primitive",H({object:u,ref:m,font:r,text:p,anchorX:t,anchorY:n,fontSize:o,sdfGlyphSize:e},s),v)});function Sr(e,t,n,r){var o;return o=class extends jn{constructor(a){super({vertexShader:t,fragmentShader:n,...a});for(const c in e)this.uniforms[c]=new Mn(e[c]),Object.defineProperty(this,c,{get(){return this.uniforms[c].value},set(l){this.uniforms[c].value=l}});this.uniforms=Sn.clone(this.uniforms)}},o.key=Rn.generateUUID(),o}const Oe=e=>e===Object(e)&&!Array.isArray(e)&&typeof e!="function";function zt(e,t){const n=O(a=>a.gl),r=Z(Ge,Oe(e)?Object.values(e):e);return i.useLayoutEffect(()=>{t?.(r)},[t]),i.useEffect(()=>{if("initTexture"in n){let a=[];Array.isArray(r)?a=r:r instanceof Je?a=[r]:Oe(r)&&(a=Object.values(r)),a.forEach(c=>{c instanceof Je&&n.initTexture(c)})}},[n,r]),i.useMemo(()=>{if(Oe(e)){const a={};let c=0;for(const l in e)a[l]=r[c++];return a}else return r},[e,r])}zt.preload=e=>Z.preload(Ge,e);zt.clear=e=>Z.clear(Ge,e);const Rr=()=>parseInt(Tn.replace(/\D+/g,"")),Tr=Rr();let fe=null,Ht="https://www.gstatic.com/draco/versioned/decoders/1.5.5/";function Bt(e=!0,t=!0,n){return r=>{n&&n(r),e&&(fe||(fe=new On),fe.setDecoderPath(typeof e=="string"?e:Ht),r.setDRACOLoader(fe)),t&&r.setMeshoptDecoder(typeof Ee=="function"?Ee():Ee)}}const Ye=(e,t,n,r)=>Z(Ne,e,Bt(t,n,r));Ye.preload=(e,t,n,r)=>Z.preload(Ne,e,Bt(t,n,r));Ye.clear=e=>Z.clear(Ne,e);Ye.setDecoderPath=e=>{Ht=e};function Or(e,t,n){const r=O(p=>p.size),o=O(p=>p.viewport),a=typeof e=="number"?e:r.width*o.dpr,c=r.height*o.dpr,l=(typeof e=="number"?n:e)||{},{samples:s=0,depth:m,...f}=l,u=m??l.depthBuffer,v=i.useMemo(()=>{const p=new In(a,c,{minFilter:Ke,magFilter:Ke,type:xt,...f});return u&&(p.depthTexture=new Fn(a,c,kn)),p.samples=s,p},[]);return i.useLayoutEffect(()=>{v.setSize(a,c),s&&(v.samples=s)},[s,v,a,c]),i.useEffect(()=>()=>v.dispose(),[]),v}const Ir=e=>typeof e=="function",Fr=i.forwardRef(({envMap:e,resolution:t=256,frames:n=1/0,children:r,makeDefault:o,...a},c)=>{const l=O(({set:g})=>g),s=O(({camera:g})=>g),m=O(({size:g})=>g),f=i.useRef(null);i.useImperativeHandle(c,()=>f.current,[]);const u=i.useRef(null),v=Or(t);i.useLayoutEffect(()=>{a.manual||f.current.updateProjectionMatrix()},[m,a]),i.useLayoutEffect(()=>{f.current.updateProjectionMatrix()}),i.useLayoutEffect(()=>{if(o){const g=s;return l(()=>({camera:f.current})),()=>l(()=>({camera:g}))}},[f,o,l]);let p=0,C=null;const b=Ir(r);return se(g=>{b&&(n===1/0||p<n)&&(u.current.visible=!1,g.gl.setRenderTarget(v),C=g.scene.background,e&&(g.scene.background=e),g.gl.render(g.scene,f.current),g.scene.background=C,g.gl.setRenderTarget(null),u.current.visible=!0,p++)}),i.createElement(i.Fragment,null,i.createElement("orthographicCamera",H({left:m.width/-2,right:m.width/2,top:m.height/2,bottom:m.height/-2,ref:f},a),!b&&r),i.createElement("group",{ref:u},b&&r(v.texture)))}),$r=i.forwardRef(({makeDefault:e,camera:t,regress:n,domElement:r,enableDamping:o=!0,keyEvents:a=!1,onChange:c,onStart:l,onEnd:s,...m},f)=>{const u=O(y=>y.invalidate),v=O(y=>y.camera),p=O(y=>y.gl),C=O(y=>y.events),b=O(y=>y.setEvents),g=O(y=>y.set),h=O(y=>y.get),d=O(y=>y.performance),w=t||v,P=r||C.connected||p.domElement,E=i.useMemo(()=>new Ln(w),[w]);return se(()=>{E.enabled&&E.update()},-1),i.useEffect(()=>(a&&E.connect(a===!0?P:a),E.connect(P),()=>void E.dispose()),[a,P,n,E,u]),i.useEffect(()=>{const y=j=>{u(),n&&d.regress(),c&&c(j)},F=j=>{l&&l(j)},M=j=>{s&&s(j)};return E.addEventListener("change",y),E.addEventListener("start",F),E.addEventListener("end",M),()=>{E.removeEventListener("start",F),E.removeEventListener("end",M),E.removeEventListener("change",y)}},[c,l,s,E,u,b]),i.useEffect(()=>{if(e){const y=h().controls;return g({controls:E}),()=>g({controls:y})}},[e,E]),i.createElement("primitive",H({ref:f,object:E,enableDamping:o},m))}),Zr=i.forwardRef(({children:e,domElement:t,onChange:n,onMouseDown:r,onMouseUp:o,onObjectChange:a,object:c,makeDefault:l,camera:s,enabled:m,axis:f,mode:u,translationSnap:v,rotationSnap:p,scaleSnap:C,space:b,size:g,showX:h,showY:d,showZ:w,...P},E)=>{const y=O(x=>x.controls),F=O(x=>x.gl),M=O(x=>x.events),j=O(x=>x.camera),S=O(x=>x.invalidate),I=O(x=>x.get),z=O(x=>x.set),R=s||j,L=t||M.connected||F.domElement,T=i.useMemo(()=>new An(R,L),[R,L]),W=i.useRef(null);i.useLayoutEffect(()=>(c?T.attach(c instanceof Ae?c:c.current):W.current instanceof Ae&&T.attach(W.current),()=>void T.detach()),[c,e,T]),i.useEffect(()=>{if(y){const x=k=>y.enabled=!k.value;return T.addEventListener("dragging-changed",x),()=>T.removeEventListener("dragging-changed",x)}},[T,y]);const q=i.useRef(void 0),X=i.useRef(void 0),U=i.useRef(void 0),Y=i.useRef(void 0);return i.useLayoutEffect(()=>void(q.current=n),[n]),i.useLayoutEffect(()=>void(X.current=r),[r]),i.useLayoutEffect(()=>void(U.current=o),[o]),i.useLayoutEffect(()=>void(Y.current=a),[a]),i.useEffect(()=>{const x=V=>{S(),q.current==null||q.current(V)},k=V=>X.current==null?void 0:X.current(V),G=V=>U.current==null?void 0:U.current(V),D=V=>Y.current==null?void 0:Y.current(V);return T.addEventListener("change",x),T.addEventListener("mouseDown",k),T.addEventListener("mouseUp",G),T.addEventListener("objectChange",D),()=>{T.removeEventListener("change",x),T.removeEventListener("mouseDown",k),T.removeEventListener("mouseUp",G),T.removeEventListener("objectChange",D)}},[S,T]),i.useEffect(()=>{if(l){const x=I().controls;return z({controls:T}),()=>z({controls:x})}},[l,T]),i.createElement(i.Fragment,null,i.createElement("primitive",{ref:E,object:T,enabled:m,axis:f,mode:u,translationSnap:v,rotationSnap:p,scaleSnap:C,space:b,size:g,showX:h,showY:d,showZ:w}),i.createElement("group",H({ref:W},P),e))});function kr({defaultScene:e,defaultCamera:t,renderPriority:n=1}){const{gl:r,scene:o,camera:a}=O();let c;return se(()=>{c=r.autoClear,n===1&&(r.autoClear=!0,r.render(e,t)),r.autoClear=!1,r.clearDepth(),r.render(o,a),r.autoClear=c},n),i.createElement("group",{onPointerOver:()=>null})}function Lr({children:e,renderPriority:t=1}){const{scene:n,camera:r}=O(),[o]=i.useState(()=>new wt);return i.createElement(i.Fragment,null,gr(i.createElement(i.Fragment,null,e,i.createElement(kr,{defaultScene:n,defaultCamera:r,renderPriority:t})),o,{events:{priority:t+1}}))}const Gt=i.createContext({}),Ar=()=>i.useContext(Gt),_r=2*Math.PI,Ie=new Ae,pt=new _n,[te,Fe]=[new et,new et],mt=new N,vt=new N,Dr=e=>"minPolarAngle"in e,ht=e=>"getTarget"in e,Qr=({alignment:e="bottom-right",margin:t=[80,80],renderPriority:n=1,onUpdate:r,onTarget:o,children:a})=>{const c=O(y=>y.size),l=O(y=>y.camera),s=O(y=>y.controls),m=O(y=>y.invalidate),f=i.useRef(null),u=i.useRef(null),v=i.useRef(!1),p=i.useRef(0),C=i.useRef(new N(0,0,0)),b=i.useRef(new N(0,0,0));i.useEffect(()=>{b.current.copy(l.up),Ie.up.copy(l.up)},[l]);const g=i.useCallback(y=>{v.current=!0,(s||o)&&(C.current=o?.()||(ht(s)?s.getTarget(C.current):s?.target)),p.current=l.position.distanceTo(mt),te.copy(l.quaternion),vt.copy(y).multiplyScalar(p.current).add(mt),Ie.lookAt(vt),Fe.copy(Ie.quaternion),m()},[s,l,o,m]);se((y,F)=>{if(u.current&&f.current){var M;if(v.current)if(te.angleTo(Fe)<.01)v.current=!1,Dr(s)&&l.up.copy(b.current);else{const j=F*_r;te.rotateTowards(Fe,j),l.position.set(0,0,1).applyQuaternion(te).multiplyScalar(p.current).add(C.current),l.up.set(0,1,0).applyQuaternion(te).normalize(),l.quaternion.copy(te),ht(s)&&s.setPosition(l.position.x,l.position.y,l.position.z),r?r():s&&s.update(F),m()}pt.copy(l.matrix).invert(),(M=f.current)==null||M.quaternion.setFromRotationMatrix(pt)}});const h=i.useMemo(()=>({tweenCamera:g}),[g]),[d,w]=t,P=e.endsWith("-center")?0:e.endsWith("-left")?-c.width/2+d:c.width/2-d,E=e.startsWith("center-")?0:e.startsWith("top-")?c.height/2-w:-c.height/2+w;return i.createElement(Lr,{renderPriority:n},i.createElement(Gt.Provider,{value:h},i.createElement(Fr,{makeDefault:!0,ref:u,position:[0,0,200]}),i.createElement("group",{ref:f,position:[P,E,0]},a)))};function ke({scale:e=[.8,.05,.05],color:t,rotation:n}){return i.createElement("group",{rotation:n},i.createElement("mesh",{position:[.4,0,0]},i.createElement("boxGeometry",{args:e}),i.createElement("meshBasicMaterial",{color:t,toneMapped:!1})))}function ne({onClick:e,font:t,disabled:n,arcStyle:r,label:o,labelColor:a,axisHeadScale:c=1,...l}){const s=O(b=>b.gl),m=i.useMemo(()=>{const b=document.createElement("canvas");b.width=64,b.height=64;const g=b.getContext("2d");return g.beginPath(),g.arc(32,32,16,0,2*Math.PI),g.closePath(),g.fillStyle=r,g.fill(),o&&(g.font=t,g.textAlign="center",g.fillStyle=a,g.fillText(o,32,41)),new Dn(b)},[r,o,a,t]),[f,u]=i.useState(!1),v=(o?1:.75)*(f?1.2:1)*c,p=b=>{b.stopPropagation(),u(!0)},C=b=>{b.stopPropagation(),u(!1)};return i.createElement("sprite",H({scale:v,onPointerOver:n?void 0:p,onPointerOut:n?void 0:e||C},l),i.createElement("spriteMaterial",{map:m,"map-anisotropy":s.capabilities.getMaxAnisotropy()||1,alphaTest:.3,opacity:o?1:.75,toneMapped:!1}))}const Jr=({hideNegativeAxes:e,hideAxisHeads:t,disabled:n,font:r="18px Inter var, Arial, sans-serif",axisColors:o=["#ff2060","#20df80","#2080ff"],axisHeadScale:a=1,axisScale:c,labels:l=["X","Y","Z"],labelColor:s="#000",onClick:m,...f})=>{const[u,v,p]=o,{tweenCamera:C}=Ar(),b={font:r,disabled:n,labelColor:s,onClick:m,axisHeadScale:a,onPointerDown:n?void 0:g=>{C(g.object.position),g.stopPropagation()}};return i.createElement("group",H({scale:40},f),i.createElement(ke,{color:u,rotation:[0,0,0],scale:c}),i.createElement(ke,{color:v,rotation:[0,0,Math.PI/2],scale:c}),i.createElement(ke,{color:p,rotation:[0,-Math.PI/2,0],scale:c}),!t&&i.createElement(i.Fragment,null,i.createElement(ne,H({arcStyle:u,position:[1,0,0],label:l[0]},b)),i.createElement(ne,H({arcStyle:v,position:[0,1,0],label:l[1]},b)),i.createElement(ne,H({arcStyle:p,position:[0,0,1],label:l[2]},b)),!e&&i.createElement(i.Fragment,null,i.createElement(ne,H({arcStyle:u,position:[-1,0,0]},b)),i.createElement(ne,H({arcStyle:v,position:[0,-1,0]},b)),i.createElement(ne,H({arcStyle:p,position:[0,0,-1]},b)))))},zr=Sr({cellSize:.5,sectionSize:1,fadeDistance:100,fadeStrength:1,fadeFrom:1,cellThickness:.5,sectionThickness:1,cellColor:new Le,sectionColor:new Le,infiniteGrid:!1,followCamera:!1,worldCamProjPosition:new N,worldPlanePosition:new N},`
    varying vec3 localPosition;
    varying vec4 worldPosition;

    uniform vec3 worldCamProjPosition;
    uniform vec3 worldPlanePosition;
    uniform float fadeDistance;
    uniform bool infiniteGrid;
    uniform bool followCamera;

    void main() {
      localPosition = position.xzy;
      if (infiniteGrid) localPosition *= 1.0 + fadeDistance;
      
      worldPosition = modelMatrix * vec4(localPosition, 1.0);
      if (followCamera) {
        worldPosition.xyz += (worldCamProjPosition - worldPlanePosition);
        localPosition = (inverse(modelMatrix) * worldPosition).xyz;
      }

      gl_Position = projectionMatrix * viewMatrix * worldPosition;
    }
  `,`
    varying vec3 localPosition;
    varying vec4 worldPosition;

    uniform vec3 worldCamProjPosition;
    uniform float cellSize;
    uniform float sectionSize;
    uniform vec3 cellColor;
    uniform vec3 sectionColor;
    uniform float fadeDistance;
    uniform float fadeStrength;
    uniform float fadeFrom;
    uniform float cellThickness;
    uniform float sectionThickness;

    float getGrid(float size, float thickness) {
      vec2 r = localPosition.xz / size;
      vec2 grid = abs(fract(r - 0.5) - 0.5) / fwidth(r);
      float line = min(grid.x, grid.y) + 1.0 - thickness;
      return 1.0 - min(line, 1.0);
    }

    void main() {
      float g1 = getGrid(cellSize, cellThickness);
      float g2 = getGrid(sectionSize, sectionThickness);

      vec3 from = worldCamProjPosition*vec3(fadeFrom);
      float dist = distance(from, worldPosition.xyz);
      float d = 1.0 - min(dist / fadeDistance, 1.0);
      vec3 color = mix(cellColor, sectionColor, min(1.0, sectionThickness * g2));

      gl_FragColor = vec4(color, (g1 + g2) * pow(d, fadeStrength));
      gl_FragColor.a = mix(0.75 * gl_FragColor.a, gl_FragColor.a, g2);
      if (gl_FragColor.a <= 0.0) discard;

      #include <tonemapping_fragment>
      #include <${Tr>=154?"colorspace_fragment":"encodings_fragment"}>
    }
  `),Kr=i.forwardRef(({args:e,cellColor:t="#000000",sectionColor:n="#2080ff",cellSize:r=.5,sectionSize:o=1,followCamera:a=!1,infiniteGrid:c=!1,fadeDistance:l=100,fadeStrength:s=1,fadeFrom:m=1,cellThickness:f=.5,sectionThickness:u=1,side:v=Hn,...p},C)=>{Ve({GridMaterial:zr});const b=i.useRef(null);i.useImperativeHandle(C,()=>b.current,[]);const g=new zn,h=new N(0,1,0),d=new N(0,0,0);se(E=>{g.setFromNormalAndCoplanarPoint(h,d).applyMatrix4(b.current.matrixWorld);const y=b.current.material,F=y.uniforms.worldCamProjPosition,M=y.uniforms.worldPlanePosition;g.projectPoint(E.camera.position,F.value),M.value.set(0,0,0).applyMatrix4(b.current.matrixWorld)});const w={cellSize:r,sectionSize:o,cellColor:t,sectionColor:n,cellThickness:f,sectionThickness:u},P={fadeDistance:l,fadeStrength:s,fadeFrom:m,infiniteGrid:c,followCamera:a};return i.createElement("mesh",H({ref:b,frustumCulled:!1},p),i.createElement("gridMaterial",H({transparent:!0,"extensions-derivatives":!0,side:v},w,P)),i.createElement("planeGeometry",{args:e}))});function eo({all:e,scene:t,camera:n}){const r=O(({gl:c})=>c),o=O(({camera:c})=>c),a=O(({scene:c})=>c);return i.useLayoutEffect(()=>{const c=[];e&&(t||a).traverse(m=>{m.visible===!1&&(c.push(m),m.visible=!0)}),r.compile(t||a,n||o);const l=new Bn(128);new Gn(.01,1e5,l).update(r,t||a),l.dispose(),c.forEach(m=>m.visible=!1)},[]),null}export{Xr as B,Nr as C,Kr as G,Vr as I,Wr as L,$r as O,eo as P,Yr as T,se as a,zt as b,Ye as c,qr as d,Ur as e,Zr as f,Qr as g,Jr as h,O as u};
