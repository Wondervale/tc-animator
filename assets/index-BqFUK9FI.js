const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/monaco-B23_F8Sm.js","assets/react-B_9-s9rb.js","assets/lodash-DfTyGjEf.js"])))=>i.map(i=>d[i]);
import{B as $,j as d,P as Fu,C as Bu,D as Uu,r as F,E as Zu,S as Vu,F as yn,G as Wu,W as qu,z as Yu,T as Gu}from"./react-B_9-s9rb.js";import{t as Ku}from"./tailwind-D6B6e0vX.js";import{G as Hu,X as vl,C as Xu,a as xl,b as Qu,M as Ju,c as ef,I as qs,d as tf,B as nf,e as sf,R as rf,P as of,f as af,Z as lf,g as cf,h as uf,F as ff,E as hf,i as df}from"./lucide-Do7wxD3a.js";import{T as pf,C as mf,D as gf,R as yf,P as bf,a as wf,O as vf,b as xf,I as _f,S as Ef,M as Sf,c as kf,d as Tf,e as Af,f as Nf,g as Of,h as Cf,i as If,j as Mf,V as jf,k as Rf,l as Pf,G as $f,L as Df,m as Lf,n as zf,o as Ff,p as Bf,q as Uf,r as Zf,s as Vf,t as Wf,u as qf,A as Yf,v as Gf,w as Kf,x as Hf,y as Xf,z as Qf,B as Jf,E as eh,F as th,H as nh,J as sh,K as rh,N as ih,Q as oh,U as ah,W as lh,X as ch,Y as uh,Z as fh,_ as hh,$ as dh}from"./radix-C4CdcsWx.js";import{a as oo,p as ph,b as mh}from"./zustand-BYbfCjW4.js";import{N as gh}from"./nbt-dlIGLSUp.js";import{g as yh}from"./lodash-DfTyGjEf.js";import{_ as bh,u as zr,a as ao,b as wh,c as lo,T as vh,B as xh,I as _h,d as Eh,e as Sh,O as kh,L as Th,f as Ah,P as Nh,H as Oh,G as Ch,g as Ih,h as Mh,C as jh}from"./react-three-O7h1Lid-.js";import{a7 as qo,a8 as _l,a9 as kr,e as Ce,aa as Rh,Q as El,ab as co,ac as Yo,ad as Go,ae as Ph,af as $h,D as Dh}from"./three-B8WDGRLw.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();function Sl(t){var e,n,s="";if(typeof t=="string"||typeof t=="number")s+=t;else if(typeof t=="object")if(Array.isArray(t)){var r=t.length;for(e=0;e<r;e++)t[e]&&(n=Sl(t[e]))&&(s&&(s+=" "),s+=n)}else for(n in t)t[n]&&(s&&(s+=" "),s+=n);return s}function kl(){for(var t,e,n=0,s="",r=arguments.length;n<r;n++)(t=arguments[n])&&(e=Sl(t))&&(s&&(s+=" "),s+=e);return s}function V(...t){return Ku(kl(t))}function Ot(t){return-t*(Math.PI/180)}function Tl(t){const e=new ArrayBuffer(t.byteLength);return new Uint8Array(e).set(new Uint8Array(t)),e}function Ko(t){const e=$.c(8);let n,s;e[0]!==t?({className:n,...s}=t,e[0]=t,e[1]=n,e[2]=s):(n=e[1],s=e[2]);let r;e[3]!==n?(r=V("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",n),e[3]=n,e[4]=r):r=e[4];let i;return e[5]!==s||e[6]!==r?(i=d.jsx(Uu,{"data-slot":"resizable-panel-group",className:r,...s}),e[5]=s,e[6]=r,e[7]=i):i=e[7],i}function Ys(t){const e=$.c(4);let n;e[0]!==t?({...n}=t,e[0]=t,e[1]=n):n=e[1];let s;return e[2]!==n?(s=d.jsx(Fu,{"data-slot":"resizable-panel",...n}),e[2]=n,e[3]=s):s=e[3],s}function Ho(t){const e=$.c(12);let n,s,r;e[0]!==t?({withHandle:r,className:n,...s}=t,e[0]=t,e[1]=n,e[2]=s,e[3]=r):(n=e[1],s=e[2],r=e[3]);let i;e[4]!==n?(i=V("bg-border focus-visible:ring-ring relative flex w-px items-center justify-center after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:ring-1 focus-visible:ring-offset-1 focus-visible:outline-hidden data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:translate-x-0 data-[panel-group-direction=vertical]:after:-translate-y-1/2 [&[data-panel-group-direction=vertical]>div]:rotate-90 hover:bg-primary",n),e[4]=n,e[5]=i):i=e[5];let o;e[6]!==r?(o=r&&d.jsx("div",{className:"bg-border z-10 flex h-4 w-3 items-center justify-center rounded-xs border",children:d.jsx(Hu,{className:"size-2.5"})}),e[6]=r,e[7]=o):o=e[7];let a;return e[8]!==s||e[9]!==i||e[10]!==o?(a=d.jsx(Bu,{"data-slot":"resizable-handle",className:i,...s,children:o}),e[8]=s,e[9]=i,e[10]=o,e[11]=a):a=e[11],a}function Lh(t){const e=$.c(4);let n;e[0]!==t?({...n}=t,e[0]=t,e[1]=n):n=e[1];let s;return e[2]!==n?(s=d.jsx(yf,{"data-slot":"dialog",...n}),e[2]=n,e[3]=s):s=e[3],s}function zh(t){const e=$.c(4);let n;e[0]!==t?({...n}=t,e[0]=t,e[1]=n):n=e[1];let s;return e[2]!==n?(s=d.jsx(bf,{"data-slot":"dialog-portal",...n}),e[2]=n,e[3]=s):s=e[3],s}function Fh(t){const e=$.c(8);let n,s;e[0]!==t?({className:n,...s}=t,e[0]=t,e[1]=n,e[2]=s):(n=e[1],s=e[2]);let r;e[3]!==n?(r=V("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50 backdrop-blur",n),e[3]=n,e[4]=r):r=e[4];let i;return e[5]!==s||e[6]!==r?(i=d.jsx(vf,{"data-slot":"dialog-overlay",className:r,...s}),e[5]=s,e[6]=r,e[7]=i):i=e[7],i}function Bh(t){const e=$.c(15);let n,s,r,i;e[0]!==t?({className:s,children:n,showCloseButton:i,...r}=t,e[0]=t,e[1]=n,e[2]=s,e[3]=r,e[4]=i):(n=e[1],s=e[2],r=e[3],i=e[4]);const o=i===void 0?!0:i;let a;e[5]===Symbol.for("react.memo_cache_sentinel")?(a=d.jsx(Fh,{}),e[5]=a):a=e[5];let l;e[6]!==s?(l=V("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",s),e[6]=s,e[7]=l):l=e[7];let c;e[8]!==o?(c=o&&d.jsxs(wf,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[d.jsx(vl,{}),d.jsx("span",{className:"sr-only",children:"Close"})]}),e[8]=o,e[9]=c):c=e[9];let u;return e[10]!==n||e[11]!==r||e[12]!==l||e[13]!==c?(u=d.jsxs(zh,{"data-slot":"dialog-portal",children:[a,d.jsxs(mf,{"data-slot":"dialog-content",className:l,...r,children:[n,c]})]}),e[10]=n,e[11]=r,e[12]=l,e[13]=c,e[14]=u):u=e[14],u}function Uh(t){const e=$.c(8);let n,s;e[0]!==t?({className:n,...s}=t,e[0]=t,e[1]=n,e[2]=s):(n=e[1],s=e[2]);let r;e[3]!==n?(r=V("flex flex-col gap-2 text-center sm:text-left",n),e[3]=n,e[4]=r):r=e[4];let i;return e[5]!==s||e[6]!==r?(i=d.jsx("div",{"data-slot":"dialog-header",className:r,...s}),e[5]=s,e[6]=r,e[7]=i):i=e[7],i}function Zh(t){const e=$.c(8);let n,s;e[0]!==t?({className:n,...s}=t,e[0]=t,e[1]=n,e[2]=s):(n=e[1],s=e[2]);let r;e[3]!==n?(r=V("text-lg leading-none font-semibold",n),e[3]=n,e[4]=r):r=e[4];let i;return e[5]!==s||e[6]!==r?(i=d.jsx(pf,{"data-slot":"dialog-title",className:r,...s}),e[5]=s,e[6]=r,e[7]=i):i=e[7],i}function Vh(t){const e=$.c(8);let n,s;e[0]!==t?({className:n,...s}=t,e[0]=t,e[1]=n,e[2]=s):(n=e[1],s=e[2]);let r;e[3]!==n?(r=V("text-muted-foreground text-sm",n),e[3]=n,e[4]=r):r=e[4];let i;return e[5]!==s||e[6]!==r?(i=d.jsx(gf,{"data-slot":"dialog-description",className:r,...s}),e[5]=s,e[6]=r,e[7]=i):i=e[7],i}function Wh(t){const e=$.c(8);let n,s;e[0]!==t?({className:n,...s}=t,e[0]=t,e[1]=n,e[2]=s):(n=e[1],s=e[2]);let r;e[3]!==n?(r=V("bg-background flex h-9 items-center gap-1 rounded-md border p-1 shadow-xs",n),e[3]=n,e[4]=r):r=e[4];let i;return e[5]!==s||e[6]!==r?(i=d.jsx(Tf,{"data-slot":"menubar",className:r,...s}),e[5]=s,e[6]=r,e[7]=i):i=e[7],i}function Xo(t){const e=$.c(4);let n;e[0]!==t?({...n}=t,e[0]=t,e[1]=n):n=e[1];let s;return e[2]!==n?(s=d.jsx(Sf,{"data-slot":"menubar-menu",...n}),e[2]=n,e[3]=s):s=e[3],s}function qh(t){const e=$.c(4);let n;e[0]!==t?({...n}=t,e[0]=t,e[1]=n):n=e[1];let s;return e[2]!==n?(s=d.jsx(Af,{"data-slot":"menubar-portal",...n}),e[2]=n,e[3]=s):s=e[3],s}function Yh(t){const e=$.c(8);let n,s;e[0]!==t?({className:n,...s}=t,e[0]=t,e[1]=n,e[2]=s):(n=e[1],s=e[2]);let r;e[3]!==n?(r=V("focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground flex items-center rounded-sm px-2 py-1 text-sm font-medium outline-hidden select-none",n),e[3]=n,e[4]=r):r=e[4];let i;return e[5]!==s||e[6]!==r?(i=d.jsx(xf,{"data-slot":"menubar-trigger",className:r,...s}),e[5]=s,e[6]=r,e[7]=i):i=e[7],i}function Gh(t){const e=$.c(14);let n,s,r,i,o;e[0]!==t?({className:n,align:r,alignOffset:i,sideOffset:o,...s}=t,e[0]=t,e[1]=n,e[2]=s,e[3]=r,e[4]=i,e[5]=o):(n=e[1],s=e[2],r=e[3],i=e[4],o=e[5]);const a=r===void 0?"start":r,l=i===void 0?-4:i,c=o===void 0?8:o;let u;e[6]!==n?(u=V("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 min-w-[12rem] origin-(--radix-menubar-content-transform-origin) overflow-hidden rounded-md border p-1 shadow-md",n),e[6]=n,e[7]=u):u=e[7];let f;return e[8]!==a||e[9]!==l||e[10]!==s||e[11]!==c||e[12]!==u?(f=d.jsx(qh,{children:d.jsx(kf,{"data-slot":"menubar-content",align:a,alignOffset:l,sideOffset:c,className:u,...s})}),e[8]=a,e[9]=l,e[10]=s,e[11]=c,e[12]=u,e[13]=f):f=e[13],f}function Pn(t){const e=$.c(12);let n,s,r,i;e[0]!==t?({className:n,inset:s,variant:i,...r}=t,e[0]=t,e[1]=n,e[2]=s,e[3]=r,e[4]=i):(n=e[1],s=e[2],r=e[3],i=e[4]);const o=i===void 0?"default":i;let a;e[5]!==n?(a=V("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",n),e[5]=n,e[6]=a):a=e[6];let l;return e[7]!==s||e[8]!==r||e[9]!==a||e[10]!==o?(l=d.jsx(_f,{"data-slot":"menubar-item","data-inset":s,"data-variant":o,className:a,...r}),e[7]=s,e[8]=r,e[9]=a,e[10]=o,e[11]=l):l=e[11],l}function li(t){const e=$.c(8);let n,s;e[0]!==t?({className:n,...s}=t,e[0]=t,e[1]=n,e[2]=s):(n=e[1],s=e[2]);let r;e[3]!==n?(r=V("bg-border -mx-1 my-1 h-px",n),e[3]=n,e[4]=r):r=e[4];let i;return e[5]!==s||e[6]!==r?(i=d.jsx(Ef,{"data-slot":"menubar-separator",className:r,...s}),e[5]=s,e[6]=r,e[7]=i):i=e[7],i}function Qo(t){const e=$.c(8);let n,s;e[0]!==t?({className:n,...s}=t,e[0]=t,e[1]=n,e[2]=s):(n=e[1],s=e[2]);let r;e[3]!==n?(r=V("text-muted-foreground ml-auto text-xs tracking-widest",n),e[3]=n,e[4]=r):r=e[4];let i;return e[5]!==s||e[6]!==r?(i=d.jsx("span",{"data-slot":"menubar-shortcut",className:r,...s}),e[5]=s,e[6]=r,e[7]=i):i=e[7],i}function ki(t){const e=$.c(4);let n;e[0]!==t?({...n}=t,e[0]=t,e[1]=n):n=e[1];let s;return e[2]!==n?(s=d.jsx(If,{"data-slot":"select",...n}),e[2]=n,e[3]=s):s=e[3],s}function Ti(t){const e=$.c(4);let n;e[0]!==t?({...n}=t,e[0]=t,e[1]=n):n=e[1];let s;return e[2]!==n?(s=d.jsx($f,{"data-slot":"select-group",...n}),e[2]=n,e[3]=s):s=e[3],s}function Ai(t){const e=$.c(4);let n;e[0]!==t?({...n}=t,e[0]=t,e[1]=n):n=e[1];let s;return e[2]!==n?(s=d.jsx(jf,{"data-slot":"select-value",...n}),e[2]=n,e[3]=s):s=e[3],s}function Ni(t){const e=$.c(13);let n,s,r,i;e[0]!==t?({className:s,size:i,children:n,...r}=t,e[0]=t,e[1]=n,e[2]=s,e[3]=r,e[4]=i):(n=e[1],s=e[2],r=e[3],i=e[4]);const o=i===void 0?"default":i;let a;e[5]!==s?(a=V("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 mt-2",s),e[5]=s,e[6]=a):a=e[6];let l;e[7]===Symbol.for("react.memo_cache_sentinel")?(l=d.jsx(Lf,{asChild:!0,children:d.jsx(xl,{className:"size-4 opacity-50"})}),e[7]=l):l=e[7];let c;return e[8]!==n||e[9]!==r||e[10]!==o||e[11]!==a?(c=d.jsxs(Mf,{"data-slot":"select-trigger","data-size":o,className:a,...r,children:[n,l]}),e[8]=n,e[9]=r,e[10]=o,e[11]=a,e[12]=c):c=e[12],c}function Oi(t){const e=$.c(20);let n,s,r,i;e[0]!==t?({className:s,children:n,position:i,...r}=t,e[0]=t,e[1]=n,e[2]=s,e[3]=r,e[4]=i):(n=e[1],s=e[2],r=e[3],i=e[4]);const o=i===void 0?"popper":i,a=o==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1";let l;e[5]!==s||e[6]!==a?(l=V("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",a,s),e[5]=s,e[6]=a,e[7]=l):l=e[7];let c;e[8]===Symbol.for("react.memo_cache_sentinel")?(c=d.jsx(Kh,{}),e[8]=c):c=e[8];const u=o==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1";let f;e[9]!==u?(f=V("p-1",u),e[9]=u,e[10]=f):f=e[10];let h;e[11]!==n||e[12]!==f?(h=d.jsx(zf,{className:f,children:n}),e[11]=n,e[12]=f,e[13]=h):h=e[13];let p;e[14]===Symbol.for("react.memo_cache_sentinel")?(p=d.jsx(Hh,{}),e[14]=p):p=e[14];let y;return e[15]!==o||e[16]!==r||e[17]!==l||e[18]!==h?(y=d.jsx(Rf,{children:d.jsxs(Pf,{"data-slot":"select-content",className:l,position:o,...r,children:[c,h,p]})}),e[15]=o,e[16]=r,e[17]=l,e[18]=h,e[19]=y):y=e[19],y}function Ci(t){const e=$.c(8);let n,s;e[0]!==t?({className:n,...s}=t,e[0]=t,e[1]=n,e[2]=s):(n=e[1],s=e[2]);let r;e[3]!==n?(r=V("text-muted-foreground px-2 py-1.5 text-xs",n),e[3]=n,e[4]=r):r=e[4];let i;return e[5]!==s||e[6]!==r?(i=d.jsx(Df,{"data-slot":"select-label",className:r,...s}),e[5]=s,e[6]=r,e[7]=i):i=e[7],i}function Tr(t){const e=$.c(13);let n,s,r;e[0]!==t?({className:s,children:n,...r}=t,e[0]=t,e[1]=n,e[2]=s,e[3]=r):(n=e[1],s=e[2],r=e[3]);let i;e[4]!==s?(i=V("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",s),e[4]=s,e[5]=i):i=e[5];let o;e[6]===Symbol.for("react.memo_cache_sentinel")?(o=d.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:d.jsx(Of,{children:d.jsx(Xu,{className:"size-4"})})}),e[6]=o):o=e[6];let a;e[7]!==n?(a=d.jsx(Cf,{children:n}),e[7]=n,e[8]=a):a=e[8];let l;return e[9]!==r||e[10]!==i||e[11]!==a?(l=d.jsxs(Nf,{"data-slot":"select-item",className:i,...r,children:[o,a]}),e[9]=r,e[10]=i,e[11]=a,e[12]=l):l=e[12],l}function Kh(t){const e=$.c(9);let n,s;e[0]!==t?({className:n,...s}=t,e[0]=t,e[1]=n,e[2]=s):(n=e[1],s=e[2]);let r;e[3]!==n?(r=V("flex cursor-default items-center justify-center py-1",n),e[3]=n,e[4]=r):r=e[4];let i;e[5]===Symbol.for("react.memo_cache_sentinel")?(i=d.jsx(Qu,{className:"size-4"}),e[5]=i):i=e[5];let o;return e[6]!==s||e[7]!==r?(o=d.jsx(Ff,{"data-slot":"select-scroll-up-button",className:r,...s,children:i}),e[6]=s,e[7]=r,e[8]=o):o=e[8],o}function Hh(t){const e=$.c(9);let n,s;e[0]!==t?({className:n,...s}=t,e[0]=t,e[1]=n,e[2]=s):(n=e[1],s=e[2]);let r;e[3]!==n?(r=V("flex cursor-default items-center justify-center py-1",n),e[3]=n,e[4]=r):r=e[4];let i;e[5]===Symbol.for("react.memo_cache_sentinel")?(i=d.jsx(xl,{className:"size-4"}),e[5]=i):i=e[5];let o;return e[6]!==s||e[7]!==r?(o=d.jsx(Bf,{"data-slot":"select-scroll-down-button",className:r,...s,children:i}),e[6]=s,e[7]=r,e[8]=o):o=e[8],o}function Xh(t){const e=$.c(6);let n,s;e[0]!==t?({delayDuration:s,...n}=t,e[0]=t,e[1]=n,e[2]=s):(n=e[1],s=e[2]);const r=s===void 0?0:s;let i;return e[3]!==r||e[4]!==n?(i=d.jsx(qf,{"data-slot":"tooltip-provider",delayDuration:r,...n}),e[3]=r,e[4]=n,e[5]=i):i=e[5],i}function Gt(t){const e=$.c(4);let n;e[0]!==t?({...n}=t,e[0]=t,e[1]=n):n=e[1];let s;return e[2]!==n?(s=d.jsx(Xh,{children:d.jsx(Zf,{"data-slot":"tooltip",...n})}),e[2]=n,e[3]=s):s=e[3],s}function Kt(t){const e=$.c(4);let n;e[0]!==t?({...n}=t,e[0]=t,e[1]=n):n=e[1];let s;return e[2]!==n?(s=d.jsx(Uf,{"data-slot":"tooltip-trigger",...n}),e[2]=n,e[3]=s):s=e[3],s}function Ht(t){const e=$.c(13);let n,s,r,i;e[0]!==t?({className:s,sideOffset:i,children:n,...r}=t,e[0]=t,e[1]=n,e[2]=s,e[3]=r,e[4]=i):(n=e[1],s=e[2],r=e[3],i=e[4]);const o=i===void 0?0:i;let a;e[5]!==s?(a=V("bg-secondary text-secondary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",s),e[5]=s,e[6]=a):a=e[6];let l;e[7]===Symbol.for("react.memo_cache_sentinel")?(l=d.jsx(Yf,{className:"bg-secondary fill-secondary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"}),e[7]=l):l=e[7];let c;return e[8]!==n||e[9]!==r||e[10]!==o||e[11]!==a?(c=d.jsx(Vf,{children:d.jsxs(Wf,{"data-slot":"tooltip-content",sideOffset:o,className:a,...r,children:[n,l]})}),e[8]=n,e[9]=r,e[10]=o,e[11]=a,e[12]=c):c=e[12],c}const Jo=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,ea=kl,Al=(t,e)=>n=>{var s;if(e?.variants==null)return ea(t,n?.class,n?.className);const{variants:r,defaultVariants:i}=e,o=Object.keys(r).map(c=>{const u=n?.[c],f=i?.[c];if(u===null)return null;const h=Jo(u)||Jo(f);return r[c][h]}),a=n&&Object.entries(n).reduce((c,u)=>{let[f,h]=u;return h===void 0||(c[f]=h),c},{}),l=e==null||(s=e.compoundVariants)===null||s===void 0?void 0:s.reduce((c,u)=>{let{class:f,className:h,...p}=u;return Object.entries(p).every(y=>{let[g,w]=y;return Array.isArray(w)?w.includes({...i,...a}[g]):{...i,...a}[g]===w})?[...c,f,h]:c},[]);return ea(t,o,l,n?.class,n?.className)},Nl=Al("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function nt(t){const e=$.c(14);let n,s,r,i,o;e[0]!==t?({className:n,variant:o,size:r,asChild:i,...s}=t,e[0]=t,e[1]=n,e[2]=s,e[3]=r,e[4]=i,e[5]=o):(n=e[1],s=e[2],r=e[3],i=e[4],o=e[5]);const l=(i===void 0?!1:i)?Gf:"button";let c;e[6]!==n||e[7]!==r||e[8]!==o?(c=V(Nl({variant:o,size:r,className:n})),e[6]=n,e[7]=r,e[8]=o,e[9]=c):c=e[9];let u;return e[10]!==l||e[11]!==s||e[12]!==c?(u=d.jsx(l,{"data-slot":"button",className:c,...s}),e[10]=l,e[11]=s,e[12]=c,e[13]=u):u=e[13],u}const Ol={r:146,g:163,b:187,a:1},Qh=t=>{if(typeof t=="string"){const e=t.match(/^#([0-9a-f]{3,8})$/i);if(e){const n=e[1],s=parseInt(n.slice(0,2),16),r=parseInt(n.slice(2,4),16),i=parseInt(n.slice(4,6),16),o=n.length>6?parseInt(n.slice(6,8),16)/255:1;return{r:s,g:r,b:i,a:o}}}return Ol},Jh=t=>{const e=$.c(24),{defaultColor:n,onChangeComplete:s}=t,r=n===void 0?Ol:n,[i,o]=F.useState(!1);let a;e[0]!==r?(a=typeof r=="string"?Qh(r):r,e[0]=r,e[1]=a):a=e[1];const[l,c]=F.useState(a);let u;e[2]!==s?(u=Zu(R=>s(R),{wait:500}),e[2]=s,e[3]=u):u=e[3];const f=u;let h;e[4]===Symbol.for("react.memo_cache_sentinel")?(h=()=>o(ed),e[4]=h):h=e[4];const p=h;let y;e[5]===Symbol.for("react.memo_cache_sentinel")?(y=()=>o(!1),e[5]=y):y=e[5];const g=y;let w;e[6]!==f?(w=R=>{c(R.rgb),f(R)},e[6]=f,e[7]=w):w=e[7];const m=w,S=`rgba(${l.r}, ${l.g}, ${l.b}, ${l.a})`;let x;e[8]!==S?(x={width:"100%",height:"100%",background:S,borderRadius:"1px",border:"1px solid #ccc"},e[8]=S,e[9]=x):x=e[9];const _=x;let E;e[10]===Symbol.for("react.memo_cache_sentinel")?(E={position:"absolute",zIndex:2,left:"50%",transform:"translateX(-50%)"},e[10]=E):E=e[10];const k=E;let b;e[11]===Symbol.for("react.memo_cache_sentinel")?(b={position:"fixed",top:0,right:0,bottom:0,left:0},e[11]=b):b=e[11];const v=b;let T,A;e[12]!==i?(T=()=>{const R=j=>{i&&!j.target.closest(".color-picker")&&g()};return document.addEventListener("mousedown",R),()=>{document.removeEventListener("mousedown",R)}},A=[i],e[12]=i,e[13]=T,e[14]=A):(T=e[13],A=e[14]),F.useEffect(T,A);let O;e[15]!==_?(O=d.jsx(nt,{onClick:p,variant:"secondary",className:"w-full",children:d.jsx("div",{style:_})}),e[15]=_,e[16]=O):O=e[16];let N;e[17]!==l||e[18]!==i||e[19]!==m?(N=i&&d.jsxs("div",{style:k,className:"color-picker",children:[d.jsx("div",{style:v,onClick:g}),d.jsx(Vu,{color:l,onChange:m,presetColors:["#92A3BB","#B80000","#DB3E00","#FCCB00","#008B02","#006B76","#1273DE","#004DCF","#5300EB","#EB9694","#FAD0C3","#FEF3BD","#C1E1C5","#BEDADC","#C4DEF6","#BED3F3","#D4C4FB"],disableAlpha:!0})]}),e[17]=l,e[18]=i,e[19]=m,e[20]=N):N=e[20];let M;return e[21]!==O||e[22]!==N?(M=d.jsxs("div",{children:[O,N]}),e[21]=O,e[22]=N,e[23]=M):M=e[23],M};function ed(t){return!t}function Cl(t){const e=$.c(10);let n,s,r;e[0]!==t?({className:n,type:r,...s}=t,e[0]=t,e[1]=n,e[2]=s,e[3]=r):(n=e[1],s=e[2],r=e[3]);let i;e[4]!==n?(i=V("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm mt-2","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",n),e[4]=n,e[5]=i):i=e[5];let o;return e[6]!==s||e[7]!==i||e[8]!==r?(o=d.jsx("input",{type:r,"data-slot":"input",className:i,...s}),e[6]=s,e[7]=i,e[8]=r,e[9]=o):o=e[9],o}function yt(t){const e=$.c(8);let n,s;e[0]!==t?({className:n,...s}=t,e[0]=t,e[1]=n,e[2]=s):(n=e[1],s=e[2]);let r;e[3]!==n?(r=V("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",n),e[3]=n,e[4]=r):r=e[4];let i;return e[5]!==s||e[6]!==r?(i=d.jsx(Kf,{"data-slot":"label",className:r,...s}),e[5]=s,e[6]=r,e[7]=i):i=e[7],i}function Gs(t){const e=$.c(9);let n,s;e[0]!==t?({className:n,...s}=t,e[0]=t,e[1]=n,e[2]=s):(n=e[1],s=e[2]);let r;e[3]!==n?(r=V("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",n),e[3]=n,e[4]=r):r=e[4];let i;e[5]===Symbol.for("react.memo_cache_sentinel")?(i=d.jsx(Hf,{"data-slot":"switch-thumb",className:V("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")}),e[5]=i):i=e[5];let o;return e[6]!==s||e[7]!==r?(o=d.jsx(Xf,{"data-slot":"switch",className:r,...s,children:i}),e[6]=s,e[7]=r,e[8]=o):o=e[8],o}const Ct={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},Il=Object.create(null);for(const t in Ct)Object.hasOwn(Ct,t)&&(Il[Ct[t]]=t);const Oe={to:{},get:{}};Oe.get=function(t){const e=t.slice(0,3).toLowerCase();let n,s;switch(e){case"hsl":{n=Oe.get.hsl(t),s="hsl";break}case"hwb":{n=Oe.get.hwb(t),s="hwb";break}default:{n=Oe.get.rgb(t),s="rgb";break}}return n?{model:s,value:n}:null};Oe.get.rgb=function(t){if(!t)return null;const e=/^#([a-f\d]{3,4})$/i,n=/^#([a-f\d]{6})([a-f\d]{2})?$/i,s=/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[\s,|/]\s*([+-]?[\d.]+)(%?)\s*)?\)$/,r=/^rgba?\(\s*([+-]?[\d.]+)%\s*,?\s*([+-]?[\d.]+)%\s*,?\s*([+-]?[\d.]+)%\s*(?:[\s,|/]\s*([+-]?[\d.]+)(%?)\s*)?\)$/,i=/^(\w+)$/;let o=[0,0,0,1],a,l,c;if(a=t.match(n)){for(c=a[2],a=a[1],l=0;l<3;l++){const u=l*2;o[l]=Number.parseInt(a.slice(u,u+2),16)}c&&(o[3]=Number.parseInt(c,16)/255)}else if(a=t.match(e)){for(a=a[1],c=a[3],l=0;l<3;l++)o[l]=Number.parseInt(a[l]+a[l],16);c&&(o[3]=Number.parseInt(c+c,16)/255)}else if(a=t.match(s)){for(l=0;l<3;l++)o[l]=Number.parseInt(a[l+1],10);a[4]&&(o[3]=a[5]?Number.parseFloat(a[4])*.01:Number.parseFloat(a[4]))}else if(a=t.match(r)){for(l=0;l<3;l++)o[l]=Math.round(Number.parseFloat(a[l+1])*2.55);a[4]&&(o[3]=a[5]?Number.parseFloat(a[4])*.01:Number.parseFloat(a[4]))}else return(a=t.match(i))?a[1]==="transparent"?[0,0,0,0]:Object.hasOwn(Ct,a[1])?(o=Ct[a[1]],o[3]=1,o):null:null;for(l=0;l<3;l++)o[l]=Qt(o[l],0,255);return o[3]=Qt(o[3],0,1),o};Oe.get.hsl=function(t){if(!t)return null;const e=/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d.]+)%\s*,?\s*([+-]?[\d.]+)%\s*(?:[,|/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,n=t.match(e);if(n){const s=Number.parseFloat(n[4]),r=(Number.parseFloat(n[1])%360+360)%360,i=Qt(Number.parseFloat(n[2]),0,100),o=Qt(Number.parseFloat(n[3]),0,100),a=Qt(Number.isNaN(s)?1:s,0,1);return[r,i,o,a]}return null};Oe.get.hwb=function(t){if(!t)return null;const e=/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*[\s,]\s*([+-]?[\d.]+)%\s*[\s,]\s*([+-]?[\d.]+)%\s*(?:[\s,]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/,n=t.match(e);if(n){const s=Number.parseFloat(n[4]),r=(Number.parseFloat(n[1])%360+360)%360,i=Qt(Number.parseFloat(n[2]),0,100),o=Qt(Number.parseFloat(n[3]),0,100),a=Qt(Number.isNaN(s)?1:s,0,1);return[r,i,o,a]}return null};Oe.to.hex=function(...t){return"#"+Ks(t[0])+Ks(t[1])+Ks(t[2])+(t[3]<1?Ks(Math.round(t[3]*255)):"")};Oe.to.rgb=function(...t){return t.length<4||t[3]===1?"rgb("+Math.round(t[0])+", "+Math.round(t[1])+", "+Math.round(t[2])+")":"rgba("+Math.round(t[0])+", "+Math.round(t[1])+", "+Math.round(t[2])+", "+t[3]+")"};Oe.to.rgb.percent=function(...t){const e=Math.round(t[0]/255*100),n=Math.round(t[1]/255*100),s=Math.round(t[2]/255*100);return t.length<4||t[3]===1?"rgb("+e+"%, "+n+"%, "+s+"%)":"rgba("+e+"%, "+n+"%, "+s+"%, "+t[3]+")"};Oe.to.hsl=function(...t){return t.length<4||t[3]===1?"hsl("+t[0]+", "+t[1]+"%, "+t[2]+"%)":"hsla("+t[0]+", "+t[1]+"%, "+t[2]+"%, "+t[3]+")"};Oe.to.hwb=function(...t){let e="";return t.length>=4&&t[3]!==1&&(e=", "+t[3]),"hwb("+t[0]+", "+t[1]+"%, "+t[2]+"%"+e+")"};Oe.to.keyword=function(...t){return Il[t.slice(0,3)]};function Qt(t,e,n){return Math.min(Math.max(e,t),n)}function Ks(t){const e=Math.round(t).toString(16).toUpperCase();return e.length<2?"0"+e:e}const Ml={};for(const t of Object.keys(Ct))Ml[Ct[t]]=t;const D={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},oklab:{channels:3,labels:["okl","oka","okb"]},lch:{channels:3,labels:"lch"},oklch:{channels:3,labels:["okl","okc","okh"]},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}},Dt=(6/29)**3;function qn(t){const e=t>.0031308?1.055*t**.4166666666666667-.055:t*12.92;return Math.min(Math.max(0,e),1)}function Yn(t){return t>.04045?((t+.055)/1.055)**2.4:t/12.92}for(const t of Object.keys(D)){if(!("channels"in D[t]))throw new Error("missing channels property: "+t);if(!("labels"in D[t]))throw new Error("missing channel labels property: "+t);if(D[t].labels.length!==D[t].channels)throw new Error("channel and label counts mismatch: "+t);const{channels:e,labels:n}=D[t];delete D[t].channels,delete D[t].labels,Object.defineProperty(D[t],"channels",{value:e}),Object.defineProperty(D[t],"labels",{value:n})}D.rgb.hsl=function(t){const e=t[0]/255,n=t[1]/255,s=t[2]/255,r=Math.min(e,n,s),i=Math.max(e,n,s),o=i-r;let a,l;switch(i){case r:{a=0;break}case e:{a=(n-s)/o;break}case n:{a=2+(s-e)/o;break}case s:{a=4+(e-n)/o;break}}a=Math.min(a*60,360),a<0&&(a+=360);const c=(r+i)/2;return i===r?l=0:c<=.5?l=o/(i+r):l=o/(2-i-r),[a,l*100,c*100]};D.rgb.hsv=function(t){let e,n,s,r,i;const o=t[0]/255,a=t[1]/255,l=t[2]/255,c=Math.max(o,a,l),u=c-Math.min(o,a,l),f=function(h){return(c-h)/6/u+1/2};if(u===0)r=0,i=0;else{switch(i=u/c,e=f(o),n=f(a),s=f(l),c){case o:{r=s-n;break}case a:{r=1/3+e-s;break}case l:{r=2/3+n-e;break}}r<0?r+=1:r>1&&(r-=1)}return[r*360,i*100,c*100]};D.rgb.hwb=function(t){const e=t[0],n=t[1];let s=t[2];const r=D.rgb.hsl(t)[0],i=1/255*Math.min(e,Math.min(n,s));return s=1-1/255*Math.max(e,Math.max(n,s)),[r,i*100,s*100]};D.rgb.oklab=function(t){const e=Yn(t[0]/255),n=Yn(t[1]/255),s=Yn(t[2]/255),r=Math.cbrt(.4122214708*e+.5363325363*n+.0514459929*s),i=Math.cbrt(.2119034982*e+.6806995451*n+.1073969566*s),o=Math.cbrt(.0883024619*e+.2817188376*n+.6299787005*s),a=.2104542553*r+.793617785*i-.0040720468*o,l=1.9779984951*r-2.428592205*i+.4505937099*o,c=.0259040371*r+.7827717662*i-.808675766*o;return[a*100,l*100,c*100]};D.rgb.cmyk=function(t){const e=t[0]/255,n=t[1]/255,s=t[2]/255,r=Math.min(1-e,1-n,1-s),i=(1-e-r)/(1-r)||0,o=(1-n-r)/(1-r)||0,a=(1-s-r)/(1-r)||0;return[i*100,o*100,a*100,r*100]};function td(t,e){return(t[0]-e[0])**2+(t[1]-e[1])**2+(t[2]-e[2])**2}D.rgb.keyword=function(t){const e=Ml[t];if(e)return e;let n=Number.POSITIVE_INFINITY,s;for(const r of Object.keys(Ct)){const i=Ct[r],o=td(t,i);o<n&&(n=o,s=r)}return s};D.keyword.rgb=function(t){return Ct[t]};D.rgb.xyz=function(t){const e=Yn(t[0]/255),n=Yn(t[1]/255),s=Yn(t[2]/255),r=e*.4124564+n*.3575761+s*.1804375,i=e*.2126729+n*.7151522+s*.072175,o=e*.0193339+n*.119192+s*.9503041;return[r*100,i*100,o*100]};D.rgb.lab=function(t){const e=D.rgb.xyz(t);let n=e[0],s=e[1],r=e[2];n/=95.047,s/=100,r/=108.883,n=n>Dt?n**(1/3):7.787*n+16/116,s=s>Dt?s**(1/3):7.787*s+16/116,r=r>Dt?r**(1/3):7.787*r+16/116;const i=116*s-16,o=500*(n-s),a=200*(s-r);return[i,o,a]};D.hsl.rgb=function(t){const e=t[0]/360,n=t[1]/100,s=t[2]/100;let r,i;if(n===0)return i=s*255,[i,i,i];const o=s<.5?s*(1+n):s+n-s*n,a=2*s-o,l=[0,0,0];for(let c=0;c<3;c++)r=e+1/3*-(c-1),r<0&&r++,r>1&&r--,6*r<1?i=a+(o-a)*6*r:2*r<1?i=o:3*r<2?i=a+(o-a)*(2/3-r)*6:i=a,l[c]=i*255;return l};D.hsl.hsv=function(t){const e=t[0];let n=t[1]/100,s=t[2]/100,r=n;const i=Math.max(s,.01);s*=2,n*=s<=1?s:2-s,r*=i<=1?i:2-i;const o=(s+n)/2,a=s===0?2*r/(i+r):2*n/(s+n);return[e,a*100,o*100]};D.hsv.rgb=function(t){const e=t[0]/60,n=t[1]/100;let s=t[2]/100;const r=Math.floor(e)%6,i=e-Math.floor(e),o=255*s*(1-n),a=255*s*(1-n*i),l=255*s*(1-n*(1-i));switch(s*=255,r){case 0:return[s,l,o];case 1:return[a,s,o];case 2:return[o,s,l];case 3:return[o,a,s];case 4:return[l,o,s];case 5:return[s,o,a]}};D.hsv.hsl=function(t){const e=t[0],n=t[1]/100,s=t[2]/100,r=Math.max(s,.01);let i,o;o=(2-n)*s;const a=(2-n)*r;return i=n*r,i/=a<=1?a:2-a,i=i||0,o/=2,[e,i*100,o*100]};D.hwb.rgb=function(t){const e=t[0]/360;let n=t[1]/100,s=t[2]/100;const r=n+s;let i;r>1&&(n/=r,s/=r);const o=Math.floor(6*e),a=1-s;i=6*e-o,(o&1)!==0&&(i=1-i);const l=n+i*(a-n);let c,u,f;switch(o){default:case 6:case 0:{c=a,u=l,f=n;break}case 1:{c=l,u=a,f=n;break}case 2:{c=n,u=a,f=l;break}case 3:{c=n,u=l,f=a;break}case 4:{c=l,u=n,f=a;break}case 5:{c=a,u=n,f=l;break}}return[c*255,u*255,f*255]};D.cmyk.rgb=function(t){const e=t[0]/100,n=t[1]/100,s=t[2]/100,r=t[3]/100,i=1-Math.min(1,e*(1-r)+r),o=1-Math.min(1,n*(1-r)+r),a=1-Math.min(1,s*(1-r)+r);return[i*255,o*255,a*255]};D.xyz.rgb=function(t){const e=t[0]/100,n=t[1]/100,s=t[2]/100;let r,i,o;return r=e*3.2404542+n*-1.5371385+s*-.4985314,i=e*-.969266+n*1.8760108+s*.041556,o=e*.0556434+n*-.2040259+s*1.0572252,r=qn(r),i=qn(i),o=qn(o),[r*255,i*255,o*255]};D.xyz.lab=function(t){let e=t[0],n=t[1],s=t[2];e/=95.047,n/=100,s/=108.883,e=e>Dt?e**(1/3):7.787*e+16/116,n=n>Dt?n**(1/3):7.787*n+16/116,s=s>Dt?s**(1/3):7.787*s+16/116;const r=116*n-16,i=500*(e-n),o=200*(n-s);return[r,i,o]};D.xyz.oklab=function(t){const e=t[0]/100,n=t[1]/100,s=t[2]/100,r=Math.cbrt(.8189330101*e+.3618667424*n-.1288597137*s),i=Math.cbrt(.0329845436*e+.9293118715*n+.0361456387*s),o=Math.cbrt(.0482003018*e+.2643662691*n+.633851707*s),a=.2104542553*r+.793617785*i-.0040720468*o,l=1.9779984951*r-2.428592205*i+.4505937099*o,c=.0259040371*r+.7827717662*i-.808675766*o;return[a*100,l*100,c*100]};D.oklab.oklch=function(t){return D.lab.lch(t)};D.oklab.xyz=function(t){const e=t[0]/100,n=t[1]/100,s=t[2]/100,r=(.999999998*e+.396337792*n+.215803758*s)**3,i=(1.000000008*e-.105561342*n-.063854175*s)**3,o=(1.000000055*e-.089484182*n-1.291485538*s)**3,a=1.227013851*r-.55779998*i+.281256149*o,l=-.040580178*r+1.11225687*i-.071676679*o,c=-.076381285*r-.421481978*i+1.58616322*o;return[a*100,l*100,c*100]};D.oklab.rgb=function(t){const e=t[0]/100,n=t[1]/100,s=t[2]/100,r=(e+.3963377774*n+.2158037573*s)**3,i=(e-.1055613458*n-.0638541728*s)**3,o=(e-.0894841775*n-1.291485548*s)**3,a=qn(4.0767416621*r-3.3077115913*i+.2309699292*o),l=qn(-1.2684380046*r+2.6097574011*i-.3413193965*o),c=qn(-.0041960863*r-.7034186147*i+1.707614701*o);return[a*255,l*255,c*255]};D.oklch.oklab=function(t){return D.lch.lab(t)};D.lab.xyz=function(t){const e=t[0],n=t[1],s=t[2];let r,i,o;i=(e+16)/116,r=n/500+i,o=i-s/200;const a=i**3,l=r**3,c=o**3;return i=a>Dt?a:(i-16/116)/7.787,r=l>Dt?l:(r-16/116)/7.787,o=c>Dt?c:(o-16/116)/7.787,r*=95.047,i*=100,o*=108.883,[r,i,o]};D.lab.lch=function(t){const e=t[0],n=t[1],s=t[2];let r;r=Math.atan2(s,n)*360/2/Math.PI,r<0&&(r+=360);const o=Math.sqrt(n*n+s*s);return[e,o,r]};D.lch.lab=function(t){const e=t[0],n=t[1],r=t[2]/360*2*Math.PI,i=n*Math.cos(r),o=n*Math.sin(r);return[e,i,o]};D.rgb.ansi16=function(t,e=null){const[n,s,r]=t;let i=e===null?D.rgb.hsv(t)[2]:e;if(i=Math.round(i/50),i===0)return 30;let o=30+(Math.round(r/255)<<2|Math.round(s/255)<<1|Math.round(n/255));return i===2&&(o+=60),o};D.hsv.ansi16=function(t){return D.rgb.ansi16(D.hsv.rgb(t),t[2])};D.rgb.ansi256=function(t){const e=t[0],n=t[1],s=t[2];return e>>4===n>>4&&n>>4===s>>4?e<8?16:e>248?231:Math.round((e-8)/247*24)+232:16+36*Math.round(e/255*5)+6*Math.round(n/255*5)+Math.round(s/255*5)};D.ansi16.rgb=function(t){t=t[0];let e=t%10;if(e===0||e===7)return t>50&&(e+=3.5),e=e/10.5*255,[e,e,e];const n=(Math.trunc(t>50)+1)*.5,s=(e&1)*n*255,r=(e>>1&1)*n*255,i=(e>>2&1)*n*255;return[s,r,i]};D.ansi256.rgb=function(t){if(t=t[0],t>=232){const i=(t-232)*10+8;return[i,i,i]}t-=16;let e;const n=Math.floor(t/36)/5*255,s=Math.floor((e=t%36)/6)/5*255,r=e%6/5*255;return[n,s,r]};D.rgb.hex=function(t){const n=(((Math.round(t[0])&255)<<16)+((Math.round(t[1])&255)<<8)+(Math.round(t[2])&255)).toString(16).toUpperCase();return"000000".slice(n.length)+n};D.hex.rgb=function(t){const e=t.toString(16).match(/[a-f\d]{6}|[a-f\d]{3}/i);if(!e)return[0,0,0];let n=e[0];e[0].length===3&&(n=[...n].map(a=>a+a).join(""));const s=Number.parseInt(n,16),r=s>>16&255,i=s>>8&255,o=s&255;return[r,i,o]};D.rgb.hcg=function(t){const e=t[0]/255,n=t[1]/255,s=t[2]/255,r=Math.max(Math.max(e,n),s),i=Math.min(Math.min(e,n),s),o=r-i;let a;const l=o<1?i/(1-o):0;return o<=0?a=0:r===e?a=(n-s)/o%6:r===n?a=2+(s-e)/o:a=4+(e-n)/o,a/=6,a%=1,[a*360,o*100,l*100]};D.hsl.hcg=function(t){const e=t[1]/100,n=t[2]/100,s=n<.5?2*e*n:2*e*(1-n);let r=0;return s<1&&(r=(n-.5*s)/(1-s)),[t[0],s*100,r*100]};D.hsv.hcg=function(t){const e=t[1]/100,n=t[2]/100,s=e*n;let r=0;return s<1&&(r=(n-s)/(1-s)),[t[0],s*100,r*100]};D.hcg.rgb=function(t){const e=t[0]/360,n=t[1]/100,s=t[2]/100;if(n===0)return[s*255,s*255,s*255];const r=[0,0,0],i=e%1*6,o=i%1,a=1-o;let l=0;switch(Math.floor(i)){case 0:{r[0]=1,r[1]=o,r[2]=0;break}case 1:{r[0]=a,r[1]=1,r[2]=0;break}case 2:{r[0]=0,r[1]=1,r[2]=o;break}case 3:{r[0]=0,r[1]=a,r[2]=1;break}case 4:{r[0]=o,r[1]=0,r[2]=1;break}default:r[0]=1,r[1]=0,r[2]=a}return l=(1-n)*s,[(n*r[0]+l)*255,(n*r[1]+l)*255,(n*r[2]+l)*255]};D.hcg.hsv=function(t){const e=t[1]/100,n=t[2]/100,s=e+n*(1-e);let r=0;return s>0&&(r=e/s),[t[0],r*100,s*100]};D.hcg.hsl=function(t){const e=t[1]/100,s=t[2]/100*(1-e)+.5*e;let r=0;return s>0&&s<.5?r=e/(2*s):s>=.5&&s<1&&(r=e/(2*(1-s))),[t[0],r*100,s*100]};D.hcg.hwb=function(t){const e=t[1]/100,n=t[2]/100,s=e+n*(1-e);return[t[0],(s-e)*100,(1-s)*100]};D.hwb.hcg=function(t){const e=t[1]/100,s=1-t[2]/100,r=s-e;let i=0;return r<1&&(i=(s-r)/(1-r)),[t[0],r*100,i*100]};D.apple.rgb=function(t){return[t[0]/65535*255,t[1]/65535*255,t[2]/65535*255]};D.rgb.apple=function(t){return[t[0]/255*65535,t[1]/255*65535,t[2]/255*65535]};D.gray.rgb=function(t){return[t[0]/100*255,t[0]/100*255,t[0]/100*255]};D.gray.hsl=function(t){return[0,0,t[0]]};D.gray.hsv=D.gray.hsl;D.gray.hwb=function(t){return[0,100,t[0]]};D.gray.cmyk=function(t){return[0,0,0,t[0]]};D.gray.lab=function(t){return[t[0],0,0]};D.gray.hex=function(t){const e=Math.round(t[0]/100*255)&255,s=((e<<16)+(e<<8)+e).toString(16).toUpperCase();return"000000".slice(s.length)+s};D.rgb.gray=function(t){return[(t[0]+t[1]+t[2])/3/255*100]};function nd(){const t={},e=Object.keys(D);for(let{length:n}=e,s=0;s<n;s++)t[e[s]]={distance:-1,parent:null};return t}function sd(t){const e=nd(),n=[t];for(e[t].distance=0;n.length>0;){const s=n.pop(),r=Object.keys(D[s]);for(let{length:i}=r,o=0;o<i;o++){const a=r[o],l=e[a];l.distance===-1&&(l.distance=e[s].distance+1,l.parent=s,n.unshift(a))}}return e}function rd(t,e){return function(n){return e(t(n))}}function id(t,e){const n=[e[t].parent,t];let s=D[e[t].parent][t],r=e[t].parent;for(;e[r].parent;)n.unshift(e[r].parent),s=rd(D[e[r].parent][r],s),r=e[r].parent;return s.conversion=n,s}function od(t){const e=sd(t),n={},s=Object.keys(e);for(let{length:r}=s,i=0;i<r;i++){const o=s[i];e[o].parent!==null&&(n[o]=id(o,e))}return n}const Pe={},ad=Object.keys(D);function ld(t){const e=function(...n){const s=n[0];return s==null?s:(s.length>1&&(n=s),t(n))};return"conversion"in t&&(e.conversion=t.conversion),e}function cd(t){const e=function(...n){const s=n[0];if(s==null)return s;s.length>1&&(n=s);const r=t(n);if(typeof r=="object")for(let{length:i}=r,o=0;o<i;o++)r[o]=Math.round(r[o]);return r};return"conversion"in t&&(e.conversion=t.conversion),e}for(const t of ad){Pe[t]={},Object.defineProperty(Pe[t],"channels",{value:D[t].channels}),Object.defineProperty(Pe[t],"labels",{value:D[t].labels});const e=od(t),n=Object.keys(e);for(const s of n){const r=e[s];Pe[t][s]=cd(r),Pe[t][s].raw=ld(r)}}const jl=["keyword","gray","hex"],Ii={};for(const t of Object.keys(Pe))Ii[[...Pe[t].labels].sort().join("")]=t;const Mi={};function Re(t,e){if(!(this instanceof Re))return new Re(t,e);if(e&&e in jl&&(e=null),e&&!(e in Pe))throw new Error("Unknown model: "+e);let n,s;if(t==null)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(t instanceof Re)this.model=t.model,this.color=[...t.color],this.valpha=t.valpha;else if(typeof t=="string"){const r=Oe.get(t);if(r===null)throw new Error("Unable to parse color from string: "+t);this.model=r.model,s=Pe[this.model].channels,this.color=r.value.slice(0,s),this.valpha=typeof r.value[s]=="number"?r.value[s]:1}else if(t.length>0){this.model=e||"rgb",s=Pe[this.model].channels;const r=Array.prototype.slice.call(t,0,s);this.color=ji(r,s),this.valpha=typeof t[s]=="number"?t[s]:1}else if(typeof t=="number")this.model="rgb",this.color=[t>>16&255,t>>8&255,t&255],this.valpha=1;else{this.valpha=1;const r=Object.keys(t);"alpha"in t&&(r.splice(r.indexOf("alpha"),1),this.valpha=typeof t.alpha=="number"?t.alpha:0);const i=r.sort().join("");if(!(i in Ii))throw new Error("Unable to parse color from object: "+JSON.stringify(t));this.model=Ii[i];const{labels:o}=Pe[this.model],a=[];for(n=0;n<o.length;n++)a.push(t[o[n]]);this.color=ji(a)}if(Mi[this.model])for(s=Pe[this.model].channels,n=0;n<s;n++){const r=Mi[this.model][n];r&&(this.color[n]=r(this.color[n]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}Re.prototype={toString(){return this.string()},toJSON(){return this[this.model]()},string(t){let e=this.model in Oe.to?this:this.rgb();e=e.round(typeof t=="number"?t:1);const n=e.valpha===1?e.color:[...e.color,this.valpha];return Oe.to[e.model](...n)},percentString(t){const e=this.rgb().round(typeof t=="number"?t:1),n=e.valpha===1?e.color:[...e.color,this.valpha];return Oe.to.rgb.percent(...n)},array(){return this.valpha===1?[...this.color]:[...this.color,this.valpha]},object(){const t={},{channels:e}=Pe[this.model],{labels:n}=Pe[this.model];for(let s=0;s<e;s++)t[n[s]]=this.color[s];return this.valpha!==1&&(t.alpha=this.valpha),t},unitArray(){const t=this.rgb().color;return t[0]/=255,t[1]/=255,t[2]/=255,this.valpha!==1&&t.push(this.valpha),t},unitObject(){const t=this.rgb().object();return t.r/=255,t.g/=255,t.b/=255,this.valpha!==1&&(t.alpha=this.valpha),t},round(t){return t=Math.max(t||0,0),new Re([...this.color.map(fd(t)),this.valpha],this.model)},alpha(t){return t!==void 0?new Re([...this.color,Math.max(0,Math.min(1,t))],this.model):this.valpha},red:_e("rgb",0,Ne(255)),green:_e("rgb",1,Ne(255)),blue:_e("rgb",2,Ne(255)),hue:_e(["hsl","hsv","hsl","hwb","hcg"],0,t=>(t%360+360)%360),saturationl:_e("hsl",1,Ne(100)),lightness:_e("hsl",2,Ne(100)),saturationv:_e("hsv",1,Ne(100)),value:_e("hsv",2,Ne(100)),chroma:_e("hcg",1,Ne(100)),gray:_e("hcg",2,Ne(100)),white:_e("hwb",1,Ne(100)),wblack:_e("hwb",2,Ne(100)),cyan:_e("cmyk",0,Ne(100)),magenta:_e("cmyk",1,Ne(100)),yellow:_e("cmyk",2,Ne(100)),black:_e("cmyk",3,Ne(100)),x:_e("xyz",0,Ne(95.047)),y:_e("xyz",1,Ne(100)),z:_e("xyz",2,Ne(108.833)),l:_e("lab",0,Ne(100)),a:_e("lab",1),b:_e("lab",2),keyword(t){return t!==void 0?new Re(t):Pe[this.model].keyword(this.color)},hex(t){return t!==void 0?new Re(t):Oe.to.hex(...this.rgb().round().color)},hexa(t){if(t!==void 0)return new Re(t);const e=this.rgb().round().color;let n=Math.round(this.valpha*255).toString(16).toUpperCase();return n.length===1&&(n="0"+n),Oe.to.hex(...e)+n},rgbNumber(){const t=this.rgb().color;return(t[0]&255)<<16|(t[1]&255)<<8|t[2]&255},luminosity(){const t=this.rgb().color,e=[];for(const[n,s]of t.entries()){const r=s/255;e[n]=r<=.04045?r/12.92:((r+.055)/1.055)**2.4}return .2126*e[0]+.7152*e[1]+.0722*e[2]},contrast(t){const e=this.luminosity(),n=t.luminosity();return e>n?(e+.05)/(n+.05):(n+.05)/(e+.05)},level(t){const e=this.contrast(t);return e>=7?"AAA":e>=4.5?"AA":""},isDark(){const t=this.rgb().color;return(t[0]*2126+t[1]*7152+t[2]*722)/1e4<128},isLight(){return!this.isDark()},negate(){const t=this.rgb();for(let e=0;e<3;e++)t.color[e]=255-t.color[e];return t},lighten(t){const e=this.hsl();return e.color[2]+=e.color[2]*t,e},darken(t){const e=this.hsl();return e.color[2]-=e.color[2]*t,e},saturate(t){const e=this.hsl();return e.color[1]+=e.color[1]*t,e},desaturate(t){const e=this.hsl();return e.color[1]-=e.color[1]*t,e},whiten(t){const e=this.hwb();return e.color[1]+=e.color[1]*t,e},blacken(t){const e=this.hwb();return e.color[2]+=e.color[2]*t,e},grayscale(){const t=this.rgb().color,e=t[0]*.3+t[1]*.59+t[2]*.11;return Re.rgb(e,e,e)},fade(t){return this.alpha(this.valpha-this.valpha*t)},opaquer(t){return this.alpha(this.valpha+this.valpha*t)},rotate(t){const e=this.hsl();let n=e.color[0];return n=(n+t)%360,n=n<0?360+n:n,e.color[0]=n,e},mix(t,e){if(!t||!t.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof t);const n=t.rgb(),s=this.rgb(),r=e===void 0?.5:e,i=2*r-1,o=n.alpha()-s.alpha(),a=((i*o===-1?i:(i+o)/(1+i*o))+1)/2,l=1-a;return Re.rgb(a*n.red()+l*s.red(),a*n.green()+l*s.green(),a*n.blue()+l*s.blue(),n.alpha()*r+s.alpha()*(1-r))}};for(const t of Object.keys(Pe)){if(jl.includes(t))continue;const{channels:e}=Pe[t];Re.prototype[t]=function(...n){return this.model===t?new Re(this):n.length>0?new Re(n,t):new Re([...hd(Pe[this.model][t].raw(this.color)),this.valpha],t)},Re[t]=function(...n){let s=n[0];return typeof s=="number"&&(s=ji(n,e)),new Re(s,t)}}function ud(t,e){return Number(t.toFixed(e))}function fd(t){return function(e){return ud(e,t)}}function _e(t,e,n){t=Array.isArray(t)?t:[t];for(const s of t)(Mi[s]||=[])[e]=n;return t=t[0],function(s){let r;return s!==void 0?(n&&(s=n(s)),r=this[t](),r.color[e]=s,r):(r=this[t]().color[e],n&&(r=n(r)),r)}}function Ne(t){return function(e){return Math.max(0,Math.min(t,e))}}function hd(t){return Array.isArray(t)?t:[t]}function ji(t,e){for(let n=0;n<e;n++)typeof t[n]!="number"&&(t[n]=0);return t}const $s=oo()(ph((t,e)=>({theme:"dark",saveInterval:300,debugText:!1,gridColor:"#92a3bb",SSAOEnabled:!0,DOFEnabled:!0,controlDamping:!1,angleSnap:11.25,distanceSnap:.25,setTheme:n=>t({theme:n}),setSaveInterval:n=>t({saveInterval:n}),setDebugText:n=>t({debugText:n}),setGridColor:n=>t({gridColor:n}),setSSAOEnabled:n=>t({SSAOEnabled:n}),setDOFEnabled:n=>t({DOFEnabled:n}),setControlDamping:n=>t({controlDamping:n}),setAngleSnap:n=>t({angleSnap:n}),setDistanceSnap:n=>t({distanceSnap:n}),getComplementaryGridColor:()=>Re(e().gridColor).darken(.5).hex()}),{version:0,name:"preferences",storage:mh(()=>localStorage)})),Gn=(()=>{if(typeof self>"u")return!1;if("top"in self&&self!==top)try{top.window.document._=0}catch{return!1}return"showOpenFilePicker"in self})(),dd=Gn?Promise.resolve().then(function(){return bd}):Promise.resolve().then(function(){return Sd});async function uo(...t){return(await dd).default(...t)}Gn?Promise.resolve().then(function(){return vd}):Promise.resolve().then(function(){return Td});const pd=Gn?Promise.resolve().then(function(){return _d}):Promise.resolve().then(function(){return Nd});async function md(...t){return(await pd).default(...t)}const gd=async t=>{const e=await t.getFile();return e.handle=t,e};var yd=async(t=[{}])=>{Array.isArray(t)||(t=[t]);const e=[];t.forEach((r,i)=>{e[i]={description:r.description||"Files",accept:{}},r.mimeTypes?r.mimeTypes.map(o=>{e[i].accept[o]=r.extensions||[]}):e[i].accept["*/*"]=r.extensions||[]});const n=await window.showOpenFilePicker({id:t[0].id,startIn:t[0].startIn,types:e,multiple:t[0].multiple||!1,excludeAcceptAllOption:t[0].excludeAcceptAllOption||!1}),s=await Promise.all(n.map(gd));return t[0].multiple?s:s[0]},bd={__proto__:null,default:yd};function mr(t){function e(n){if(Object(n)!==n)return Promise.reject(new TypeError(n+" is not an object."));var s=n.done;return Promise.resolve(n.value).then(function(r){return{value:r,done:s}})}return mr=function(n){this.s=n,this.n=n.next},mr.prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(n){var s=this.s.return;return s===void 0?Promise.resolve({value:n,done:!0}):e(s.apply(this.s,arguments))},throw:function(n){var s=this.s.return;return s===void 0?Promise.reject(n):e(s.apply(this.s,arguments))}},new mr(t)}const Rl=async(t,e,n=t.name,s)=>{const r=[],i=[];var o,a=!1,l=!1;try{for(var c,u=(function(f){var h,p,y,g=2;for(typeof Symbol<"u"&&(p=Symbol.asyncIterator,y=Symbol.iterator);g--;){if(p&&(h=f[p])!=null)return h.call(f);if(y&&(h=f[y])!=null)return new mr(h.call(f));p="@@asyncIterator",y="@@iterator"}throw new TypeError("Object is not async iterable")})(t.values());a=!(c=await u.next()).done;a=!1){const f=c.value,h=`${n}/${f.name}`;f.kind==="file"?i.push(f.getFile().then(p=>(p.directoryHandle=t,p.handle=f,Object.defineProperty(p,"webkitRelativePath",{configurable:!0,enumerable:!0,get:()=>h})))):f.kind!=="directory"||!e||s&&s(f)||r.push(Rl(f,e,h,s))}}catch(f){l=!0,o=f}finally{try{a&&u.return!=null&&await u.return()}finally{if(l)throw o}}return[...(await Promise.all(r)).flat(),...await Promise.all(i)]};var wd=async(t={})=>{t.recursive=t.recursive||!1,t.mode=t.mode||"read";const e=await window.showDirectoryPicker({id:t.id,startIn:t.startIn,mode:t.mode});return(await(await e.values()).next()).done?[e]:Rl(e,t.recursive,void 0,t.skipDirectory)},vd={__proto__:null,default:wd},xd=async(t,e=[{}],n=null,s=!1,r=null)=>{Array.isArray(e)||(e=[e]),e[0].fileName=e[0].fileName||"Untitled";const i=[];let o=null;if(t instanceof Blob&&t.type?o=t.type:t.headers&&t.headers.get("content-type")&&(o=t.headers.get("content-type")),e.forEach((c,u)=>{i[u]={description:c.description||"Files",accept:{}},c.mimeTypes?(u===0&&o&&c.mimeTypes.push(o),c.mimeTypes.map(f=>{i[u].accept[f]=c.extensions||[]})):o?i[u].accept[o]=c.extensions||[]:i[u].accept["*/*"]=c.extensions||[]}),n)try{await n.getFile()}catch(c){if(n=null,s)throw c}const a=n||await window.showSaveFilePicker({suggestedName:e[0].fileName,id:e[0].id,startIn:e[0].startIn,types:i,excludeAcceptAllOption:e[0].excludeAcceptAllOption||!1});!n&&r&&r(a);const l=await a.createWritable();return"stream"in t?(await t.stream().pipeTo(l),a):"body"in t?(await t.body.pipeTo(l),a):(await l.write(await t),await l.close(),a)},_d={__proto__:null,default:xd},Ed=async(t=[{}])=>(Array.isArray(t)||(t=[t]),new Promise((e,n)=>{const s=document.createElement("input");s.type="file";const r=[...t.map(i=>i.mimeTypes||[]),...t.map(i=>i.extensions||[])].join();s.multiple=t[0].multiple||!1,s.accept=r||"",s.style.display="none",document.body.append(s),s.addEventListener("cancel",()=>{s.remove(),n(new DOMException("The user aborted a request.","AbortError"))}),s.addEventListener("change",()=>{s.remove(),e(s.multiple?Array.from(s.files):s.files[0])}),"showPicker"in HTMLInputElement.prototype?s.showPicker():s.click()})),Sd={__proto__:null,default:Ed},kd=async(t=[{}])=>(Array.isArray(t)||(t=[t]),t[0].recursive=t[0].recursive||!1,new Promise((e,n)=>{const s=document.createElement("input");s.type="file",s.webkitdirectory=!0,s.style.display="none",document.body.append(s),s.addEventListener("cancel",()=>{s.remove(),n(new DOMException("The user aborted a request.","AbortError"))}),s.addEventListener("change",()=>{s.remove();let r=Array.from(s.files);t[0].recursive?t[0].recursive&&t[0].skipDirectory&&(r=r.filter(i=>i.webkitRelativePath.split("/").every(o=>!t[0].skipDirectory({name:o,kind:"directory"})))):r=r.filter(i=>i.webkitRelativePath.split("/").length===2),e(r)}),"showPicker"in HTMLInputElement.prototype?s.showPicker():s.click()})),Td={__proto__:null,default:kd},Ad=async(t,e={})=>{Array.isArray(e)&&(e=e[0]);const n=document.createElement("a");let s=t;"body"in t&&(s=await(async function(o,a){const l=o.getReader(),c=new ReadableStream({start:h=>(async function p(){return l.read().then(({done:y,value:g})=>{if(!y)return h.enqueue(g),p();h.close()})})()}),u=new Response(c),f=await u.blob();return l.releaseLock(),new Blob([f],{type:a})})(t.body,t.headers.get("content-type"))),n.download=e.fileName||"Untitled",n.href=URL.createObjectURL(await s);const r=()=>{typeof i=="function"&&i()},i=e.legacySetup&&e.legacySetup(r,()=>i(),n);return n.addEventListener("click",()=>{setTimeout(()=>URL.revokeObjectURL(n.href),3e4),r()}),n.click(),null},Nd={__proto__:null,default:Ad},Ee=Uint8Array,tt=Uint16Array,fo=Int32Array,Fr=new Ee([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Br=new Ee([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Ri=new Ee([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Pl=function(t,e){for(var n=new tt(31),s=0;s<31;++s)n[s]=e+=1<<t[s-1];for(var r=new fo(n[30]),s=1;s<30;++s)for(var i=n[s];i<n[s+1];++i)r[i]=i-n[s]<<5|s;return{b:n,r}},$l=Pl(Fr,2),Dl=$l.b,Pi=$l.r;Dl[28]=258,Pi[258]=28;var Ll=Pl(Br,0),Od=Ll.b,ta=Ll.r,$i=new tt(32768);for(var ge=0;ge<32768;++ge){var Vt=(ge&43690)>>1|(ge&21845)<<1;Vt=(Vt&52428)>>2|(Vt&13107)<<2,Vt=(Vt&61680)>>4|(Vt&3855)<<4,$i[ge]=((Vt&65280)>>8|(Vt&255)<<8)>>1}var It=(function(t,e,n){for(var s=t.length,r=0,i=new tt(e);r<s;++r)t[r]&&++i[t[r]-1];var o=new tt(e);for(r=1;r<e;++r)o[r]=o[r-1]+i[r-1]<<1;var a;if(n){a=new tt(1<<e);var l=15-e;for(r=0;r<s;++r)if(t[r])for(var c=r<<4|t[r],u=e-t[r],f=o[t[r]-1]++<<u,h=f|(1<<u)-1;f<=h;++f)a[$i[f]>>l]=c}else for(a=new tt(s),r=0;r<s;++r)t[r]&&(a[r]=$i[o[t[r]-1]++]>>15-t[r]);return a}),tn=new Ee(288);for(var ge=0;ge<144;++ge)tn[ge]=8;for(var ge=144;ge<256;++ge)tn[ge]=9;for(var ge=256;ge<280;++ge)tn[ge]=7;for(var ge=280;ge<288;++ge)tn[ge]=8;var Ss=new Ee(32);for(var ge=0;ge<32;++ge)Ss[ge]=5;var Cd=It(tn,9,0),Id=It(tn,9,1),Md=It(Ss,5,0),jd=It(Ss,5,1),ci=function(t){for(var e=t[0],n=1;n<t.length;++n)t[n]>e&&(e=t[n]);return e},pt=function(t,e,n){var s=e/8|0;return(t[s]|t[s+1]<<8)>>(e&7)&n},ui=function(t,e){var n=e/8|0;return(t[n]|t[n+1]<<8|t[n+2]<<16)>>(e&7)},ho=function(t){return(t+7)/8|0},Ds=function(t,e,n){return(e==null||e<0)&&(e=0),(n==null||n>t.length)&&(n=t.length),new Ee(t.subarray(e,n))},Rd=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Ze=function(t,e,n){var s=new Error(e||Rd[t]);if(s.code=t,Error.captureStackTrace&&Error.captureStackTrace(s,Ze),!n)throw s;return s},Pd=function(t,e,n,s){var r=t.length,i=s?s.length:0;if(!r||e.f&&!e.l)return n||new Ee(0);var o=!n,a=o||e.i!=2,l=e.i;o&&(n=new Ee(r*3));var c=function(Ae){var ze=n.length;if(Ae>ze){var Fe=new Ee(Math.max(ze*2,Ae));Fe.set(n),n=Fe}},u=e.f||0,f=e.p||0,h=e.b||0,p=e.l,y=e.d,g=e.m,w=e.n,m=r*8;do{if(!p){u=pt(t,f,1);var S=pt(t,f+1,3);if(f+=3,S)if(S==1)p=Id,y=jd,g=9,w=5;else if(S==2){var k=pt(t,f,31)+257,b=pt(t,f+10,15)+4,v=k+pt(t,f+5,31)+1;f+=14;for(var T=new Ee(v),A=new Ee(19),O=0;O<b;++O)A[Ri[O]]=pt(t,f+O*3,7);f+=b*3;for(var N=ci(A),M=(1<<N)-1,R=It(A,N,1),O=0;O<v;){var j=R[pt(t,f,M)];f+=j&15;var x=j>>4;if(x<16)T[O++]=x;else{var P=0,L=0;for(x==16?(L=3+pt(t,f,3),f+=2,P=T[O-1]):x==17?(L=3+pt(t,f,7),f+=3):x==18&&(L=11+pt(t,f,127),f+=7);L--;)T[O++]=P}}var U=T.subarray(0,k),z=T.subarray(k);g=ci(U),w=ci(z),p=It(U,g,1),y=It(z,w,1)}else Ze(1);else{var x=ho(f)+4,_=t[x-4]|t[x-3]<<8,E=x+_;if(E>r){l&&Ze(0);break}a&&c(h+_),n.set(t.subarray(x,E),h),e.b=h+=_,e.p=f=E*8,e.f=u;continue}if(f>m){l&&Ze(0);break}}a&&c(h+131072);for(var ne=(1<<g)-1,G=(1<<w)-1,ee=f;;ee=f){var P=p[ui(t,f)&ne],Y=P>>4;if(f+=P&15,f>m){l&&Ze(0);break}if(P||Ze(2),Y<256)n[h++]=Y;else if(Y==256){ee=f,p=null;break}else{var Q=Y-254;if(Y>264){var O=Y-257,J=Fr[O];Q=pt(t,f,(1<<J)-1)+Dl[O],f+=J}var he=y[ui(t,f)&G],Ie=he>>4;he||Ze(3),f+=he&15;var z=Od[Ie];if(Ie>3){var J=Br[Ie];z+=ui(t,f)&(1<<J)-1,f+=J}if(f>m){l&&Ze(0);break}a&&c(h+131072);var Be=h+Q;if(h<z){var Ue=i-z,Me=Math.min(z,Be);for(Ue+h<0&&Ze(3);h<Me;++h)n[h]=s[Ue+h]}for(;h<Be;++h)n[h]=n[h-z]}}e.l=p,e.p=ee,e.b=h,e.f=u,p&&(u=1,e.m=g,e.d=y,e.n=w)}while(!u);return h!=n.length&&o?Ds(n,0,h):n.subarray(0,h)},Pt=function(t,e,n){n<<=e&7;var s=e/8|0;t[s]|=n,t[s+1]|=n>>8},hs=function(t,e,n){n<<=e&7;var s=e/8|0;t[s]|=n,t[s+1]|=n>>8,t[s+2]|=n>>16},fi=function(t,e){for(var n=[],s=0;s<t.length;++s)t[s]&&n.push({s,f:t[s]});var r=n.length,i=n.slice();if(!r)return{t:Fl,l:0};if(r==1){var o=new Ee(n[0].s+1);return o[n[0].s]=1,{t:o,l:1}}n.sort(function(E,k){return E.f-k.f}),n.push({s:-1,f:25001});var a=n[0],l=n[1],c=0,u=1,f=2;for(n[0]={s:-1,f:a.f+l.f,l:a,r:l};u!=r-1;)a=n[n[c].f<n[f].f?c++:f++],l=n[c!=u&&n[c].f<n[f].f?c++:f++],n[u++]={s:-1,f:a.f+l.f,l:a,r:l};for(var h=i[0].s,s=1;s<r;++s)i[s].s>h&&(h=i[s].s);var p=new tt(h+1),y=Di(n[u-1],p,0);if(y>e){var s=0,g=0,w=y-e,m=1<<w;for(i.sort(function(k,b){return p[b.s]-p[k.s]||k.f-b.f});s<r;++s){var S=i[s].s;if(p[S]>e)g+=m-(1<<y-p[S]),p[S]=e;else break}for(g>>=w;g>0;){var x=i[s].s;p[x]<e?g-=1<<e-p[x]++-1:++s}for(;s>=0&&g;--s){var _=i[s].s;p[_]==e&&(--p[_],++g)}y=e}return{t:new Ee(p),l:y}},Di=function(t,e,n){return t.s==-1?Math.max(Di(t.l,e,n+1),Di(t.r,e,n+1)):e[t.s]=n},na=function(t){for(var e=t.length;e&&!t[--e];);for(var n=new tt(++e),s=0,r=t[0],i=1,o=function(l){n[s++]=l},a=1;a<=e;++a)if(t[a]==r&&a!=e)++i;else{if(!r&&i>2){for(;i>138;i-=138)o(32754);i>2&&(o(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(o(r),--i;i>6;i-=6)o(8304);i>2&&(o(i-3<<5|8208),i=0)}for(;i--;)o(r);i=1,r=t[a]}return{c:n.subarray(0,s),n:e}},ds=function(t,e){for(var n=0,s=0;s<e.length;++s)n+=t[s]*e[s];return n},zl=function(t,e,n){var s=n.length,r=ho(e+2);t[r]=s&255,t[r+1]=s>>8,t[r+2]=t[r]^255,t[r+3]=t[r+1]^255;for(var i=0;i<s;++i)t[r+i+4]=n[i];return(r+4+s)*8},sa=function(t,e,n,s,r,i,o,a,l,c,u){Pt(e,u++,n),++r[256];for(var f=fi(r,15),h=f.t,p=f.l,y=fi(i,15),g=y.t,w=y.l,m=na(h),S=m.c,x=m.n,_=na(g),E=_.c,k=_.n,b=new tt(19),v=0;v<S.length;++v)++b[S[v]&31];for(var v=0;v<E.length;++v)++b[E[v]&31];for(var T=fi(b,7),A=T.t,O=T.l,N=19;N>4&&!A[Ri[N-1]];--N);var M=c+5<<3,R=ds(r,tn)+ds(i,Ss)+o,j=ds(r,h)+ds(i,g)+o+14+3*N+ds(b,A)+2*b[16]+3*b[17]+7*b[18];if(l>=0&&M<=R&&M<=j)return zl(e,u,t.subarray(l,l+c));var P,L,U,z;if(Pt(e,u,1+(j<R)),u+=2,j<R){P=It(h,p,0),L=h,U=It(g,w,0),z=g;var ne=It(A,O,0);Pt(e,u,x-257),Pt(e,u+5,k-1),Pt(e,u+10,N-4),u+=14;for(var v=0;v<N;++v)Pt(e,u+3*v,A[Ri[v]]);u+=3*N;for(var G=[S,E],ee=0;ee<2;++ee)for(var Y=G[ee],v=0;v<Y.length;++v){var Q=Y[v]&31;Pt(e,u,ne[Q]),u+=A[Q],Q>15&&(Pt(e,u,Y[v]>>5&127),u+=Y[v]>>12)}}else P=Cd,L=tn,U=Md,z=Ss;for(var v=0;v<a;++v){var J=s[v];if(J>255){var Q=J>>18&31;hs(e,u,P[Q+257]),u+=L[Q+257],Q>7&&(Pt(e,u,J>>23&31),u+=Fr[Q]);var he=J&31;hs(e,u,U[he]),u+=z[he],he>3&&(hs(e,u,J>>5&8191),u+=Br[he])}else hs(e,u,P[J]),u+=L[J]}return hs(e,u,P[256]),u+L[256]},$d=new fo([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Fl=new Ee(0),Dd=function(t,e,n,s,r,i){var o=i.z||t.length,a=new Ee(s+o+5*(1+Math.ceil(o/7e3))+r),l=a.subarray(s,a.length-r),c=i.l,u=(i.r||0)&7;if(e){u&&(l[0]=i.r>>3);for(var f=$d[e-1],h=f>>13,p=f&8191,y=(1<<n)-1,g=i.p||new tt(32768),w=i.h||new tt(y+1),m=Math.ceil(n/3),S=2*m,x=function($e){return(t[$e]^t[$e+1]<<m^t[$e+2]<<S)&y},_=new fo(25e3),E=new tt(288),k=new tt(32),b=0,v=0,T=i.i||0,A=0,O=i.w||0,N=0;T+2<o;++T){var M=x(T),R=T&32767,j=w[M];if(g[R]=j,w[M]=R,O<=T){var P=o-T;if((b>7e3||A>24576)&&(P>423||!c)){u=sa(t,l,0,_,E,k,v,A,N,T-N,u),A=b=v=0,N=T;for(var L=0;L<286;++L)E[L]=0;for(var L=0;L<30;++L)k[L]=0}var U=2,z=0,ne=p,G=R-j&32767;if(P>2&&M==x(T-G))for(var ee=Math.min(h,P)-1,Y=Math.min(32767,T),Q=Math.min(258,P);G<=Y&&--ne&&R!=j;){if(t[T+U]==t[T+U-G]){for(var J=0;J<Q&&t[T+J]==t[T+J-G];++J);if(J>U){if(U=J,z=G,J>ee)break;for(var he=Math.min(G,J-2),Ie=0,L=0;L<he;++L){var Be=T-G+L&32767,Ue=g[Be],Me=Be-Ue&32767;Me>Ie&&(Ie=Me,j=Be)}}}R=j,j=g[R],G+=R-j&32767}if(z){_[A++]=268435456|Pi[U]<<18|ta[z];var Ae=Pi[U]&31,ze=ta[z]&31;v+=Fr[Ae]+Br[ze],++E[257+Ae],++k[ze],O=T+U,++b}else _[A++]=t[T],++E[t[T]]}}for(T=Math.max(T,O);T<o;++T)_[A++]=t[T],++E[t[T]];u=sa(t,l,c,_,E,k,v,A,N,T-N,u),c||(i.r=u&7|l[u/8|0]<<3,u-=7,i.h=w,i.p=g,i.i=T,i.w=O)}else{for(var T=i.w||0;T<o+c;T+=65535){var Fe=T+65535;Fe>=o&&(l[u/8|0]=c,Fe=o),u=zl(l,u+1,t.subarray(T,Fe))}i.i=o}return Ds(a,0,s+ho(u)+r)},Ld=(function(){for(var t=new Int32Array(256),e=0;e<256;++e){for(var n=e,s=9;--s;)n=(n&1&&-306674912)^n>>>1;t[e]=n}return t})(),zd=function(){var t=-1;return{p:function(e){for(var n=t,s=0;s<e.length;++s)n=Ld[n&255^e[s]]^n>>>8;t=n},d:function(){return~t}}},Fd=function(t,e,n,s,r){if(!r&&(r={l:1},e.dictionary)){var i=e.dictionary.subarray(-32768),o=new Ee(i.length+t.length);o.set(i),o.set(t,i.length),t=o,r.w=i.length}return Dd(t,e.level==null?6:e.level,e.mem==null?r.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,n,s,r)},Bl=function(t,e){var n={};for(var s in t)n[s]=t[s];for(var s in e)n[s]=e[s];return n},At=function(t,e){return t[e]|t[e+1]<<8},bt=function(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0},hi=function(t,e){return bt(t,e)+bt(t,e+4)*4294967296},De=function(t,e,n){for(;n;++e)t[e]=n,n>>>=8};function Bd(t,e){return Fd(t,e||{},0,0)}function Ud(t,e){return Pd(t,{i:2},e&&e.out,e&&e.dictionary)}var Ul=function(t,e,n,s){for(var r in t){var i=t[r],o=e+r,a=s;Array.isArray(i)&&(a=Bl(s,i[1]),i=i[0]),i instanceof Ee?n[o]=[i,a]:(n[o+="/"]=[new Ee(0),a],Ul(i,o,n,s))}},ra=typeof TextEncoder<"u"&&new TextEncoder,Li=typeof TextDecoder<"u"&&new TextDecoder,Zd=0;try{Li.decode(Fl,{stream:!0}),Zd=1}catch{}var Vd=function(t){for(var e="",n=0;;){var s=t[n++],r=(s>127)+(s>223)+(s>239);if(n+r>t.length)return{s:e,r:Ds(t,n-1)};r?r==3?(s=((s&15)<<18|(t[n++]&63)<<12|(t[n++]&63)<<6|t[n++]&63)-65536,e+=String.fromCharCode(55296|s>>10,56320|s&1023)):r&1?e+=String.fromCharCode((s&31)<<6|t[n++]&63):e+=String.fromCharCode((s&15)<<12|(t[n++]&63)<<6|t[n++]&63):e+=String.fromCharCode(s)}};function ks(t,e){var n;if(ra)return ra.encode(t);for(var s=t.length,r=new Ee(t.length+(t.length>>1)),i=0,o=function(c){r[i++]=c},n=0;n<s;++n){if(i+5>r.length){var a=new Ee(i+8+(s-n<<1));a.set(r),r=a}var l=t.charCodeAt(n);l<128||e?o(l):l<2048?(o(192|l>>6),o(128|l&63)):l>55295&&l<57344?(l=65536+(l&1047552)|t.charCodeAt(++n)&1023,o(240|l>>18),o(128|l>>12&63),o(128|l>>6&63),o(128|l&63)):(o(224|l>>12),o(128|l>>6&63),o(128|l&63))}return Ds(r,0,i)}function zi(t,e){if(e){for(var n="",s=0;s<t.length;s+=16384)n+=String.fromCharCode.apply(null,t.subarray(s,s+16384));return n}else{if(Li)return Li.decode(t);var r=Vd(t),i=r.s,n=r.r;return n.length&&Ze(8),i}}var Wd=function(t,e){return e+30+At(t,e+26)+At(t,e+28)},qd=function(t,e,n){var s=At(t,e+28),r=zi(t.subarray(e+46,e+46+s),!(At(t,e+8)&2048)),i=e+46+s,o=bt(t,e+20),a=n&&o==4294967295?Yd(t,i):[o,bt(t,e+24),bt(t,e+42)],l=a[0],c=a[1],u=a[2];return[At(t,e+10),l,c,r,i+At(t,e+30)+At(t,e+32),u]},Yd=function(t,e){for(;At(t,e)!=1;e+=4+At(t,e+2));return[hi(t,e+12),hi(t,e+4),hi(t,e+20)]},Fi=function(t){var e=0;if(t)for(var n in t){var s=t[n].length;s>65535&&Ze(9),e+=s+4}return e},ia=function(t,e,n,s,r,i,o,a){var l=s.length,c=n.extra,u=a&&a.length,f=Fi(c);De(t,e,o!=null?33639248:67324752),e+=4,o!=null&&(t[e++]=20,t[e++]=n.os),t[e]=20,e+=2,t[e++]=n.flag<<1|(i<0&&8),t[e++]=r&&8,t[e++]=n.compression&255,t[e++]=n.compression>>8;var h=new Date(n.mtime==null?Date.now():n.mtime),p=h.getFullYear()-1980;if((p<0||p>119)&&Ze(10),De(t,e,p<<25|h.getMonth()+1<<21|h.getDate()<<16|h.getHours()<<11|h.getMinutes()<<5|h.getSeconds()>>1),e+=4,i!=-1&&(De(t,e,n.crc),De(t,e+4,i<0?-i-2:i),De(t,e+8,n.size)),De(t,e+12,l),De(t,e+14,f),e+=16,o!=null&&(De(t,e,u),De(t,e+6,n.attrs),De(t,e+10,o),e+=14),t.set(s,e),e+=l,f)for(var y in c){var g=c[y],w=g.length;De(t,e,+y),De(t,e+2,w),t.set(g,e+4),e+=4+w}return u&&(t.set(a,e),e+=u),e},Gd=function(t,e,n,s,r){De(t,e,101010256),De(t,e+8,n),De(t,e+10,n),De(t,e+12,s),De(t,e+16,r)};function Kd(t,e){e||(e={});var n={},s=[];Ul(t,"",n,e);var r=0,i=0;for(var o in n){var a=n[o],l=a[0],c=a[1],u=c.level==0?0:8,f=ks(o),h=f.length,p=c.comment,y=p&&ks(p),g=y&&y.length,w=Fi(c.extra);h>65535&&Ze(11);var m=u?Bd(l,c):l,S=m.length,x=zd();x.p(l),s.push(Bl(c,{size:l.length,crc:x.d(),c:m,f,m:y,u:h!=o.length||y&&p.length!=g,o:r,compression:u})),r+=30+h+w+S,i+=76+2*(h+w)+(g||0)+S}for(var _=new Ee(i+22),E=r,k=i-r,b=0;b<s.length;++b){var f=s[b];ia(_,f.o,f,f.f,f.u,f.c.length);var v=30+f.f.length+Fi(f.extra);_.set(f.c,f.o+v),ia(_,r,f,f.f,f.u,f.c.length,f.o,f.m),r+=16+v+(f.m?f.m.length:0)}return Gd(_,r,s.length,k,E),_}function Hd(t,e){for(var n={},s=t.length-22;bt(t,s)!=101010256;--s)(!s||t.length-s>65558)&&Ze(13);var r=At(t,s+8);if(!r)return{};var i=bt(t,s+16),o=i==4294967295||r==65535;if(o){var a=bt(t,s-12);o=bt(t,a)==101075792,o&&(r=bt(t,a+32),i=bt(t,a+48))}for(var l=0;l<r;++l){var c=qd(t,i,o),u=c[0],f=c[1],h=c[2],p=c[3],y=c[4],g=c[5],w=Wd(t,g);i=y,u?u==8?n[p]=Ud(t.subarray(w,w+f),{out:new Ee(h)}):Ze(14,"unknown compression type "+u):n[p]=Ds(t,w,w+f)}return n}function I(t,e,n){function s(a,l){var c;Object.defineProperty(a,"_zod",{value:a._zod??{},enumerable:!1}),(c=a._zod).traits??(c.traits=new Set),a._zod.traits.add(t),e(a,l);for(const u in o.prototype)u in a||Object.defineProperty(a,u,{value:o.prototype[u].bind(a)});a._zod.constr=o,a._zod.def=l}const r=n?.Parent??Object;class i extends r{}Object.defineProperty(i,"name",{value:t});function o(a){var l;const c=n?.Parent?new i:this;s(c,a),(l=c._zod).deferred??(l.deferred=[]);for(const u of c._zod.deferred)u();return c}return Object.defineProperty(o,"init",{value:s}),Object.defineProperty(o,Symbol.hasInstance,{value:a=>n?.Parent&&a instanceof n.Parent?!0:a?._zod?.traits?.has(t)}),Object.defineProperty(o,"name",{value:t}),o}class Kn extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class Zl extends Error{constructor(e){super(`Encountered unidirectional transform during encode: ${e}`),this.name="ZodEncodeError"}}const Vl={};function nn(t){return Vl}function Xd(t){const e=Object.values(t).filter(s=>typeof s=="number");return Object.entries(t).filter(([s,r])=>e.indexOf(+s)===-1).map(([s,r])=>r)}function Bi(t,e){return typeof e=="bigint"?e.toString():e}function po(t){return{get value(){{const e=t();return Object.defineProperty(this,"value",{value:e}),e}}}}function mo(t){return t==null}function go(t){const e=t.startsWith("^")?1:0,n=t.endsWith("$")?t.length-1:t.length;return t.slice(e,n)}function Qd(t,e){const n=(t.toString().split(".")[1]||"").length,s=e.toString();let r=(s.split(".")[1]||"").length;if(r===0&&/\d?e-\d?/.test(s)){const l=s.match(/\d?e-(\d?)/);l?.[1]&&(r=Number.parseInt(l[1]))}const i=n>r?n:r,o=Number.parseInt(t.toFixed(i).replace(".","")),a=Number.parseInt(e.toFixed(i).replace(".",""));return o%a/10**i}const oa=Symbol("evaluating");function ae(t,e,n){let s;Object.defineProperty(t,e,{get(){if(s!==oa)return s===void 0&&(s=oa,s=n()),s},set(r){Object.defineProperty(t,e,{value:r})},configurable:!0})}function Nn(t,e,n){Object.defineProperty(t,e,{value:n,writable:!0,enumerable:!0,configurable:!0})}function On(...t){const e={};for(const n of t){const s=Object.getOwnPropertyDescriptors(n);Object.assign(e,s)}return Object.defineProperties({},e)}function aa(t){return JSON.stringify(t)}const Wl="captureStackTrace"in Error?Error.captureStackTrace:(...t)=>{};function Ar(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}const Jd=po(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{const t=Function;return new t(""),!0}catch{return!1}});function Qn(t){if(Ar(t)===!1)return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(Ar(n)===!1||Object.prototype.hasOwnProperty.call(n,"isPrototypeOf")===!1)}function ql(t){return Qn(t)?{...t}:Array.isArray(t)?[...t]:t}const ep=new Set(["string","number","symbol"]);function Jn(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function un(t,e,n){const s=new t._zod.constr(e??t._zod.def);return(!e||n?.parent)&&(s._zod.parent=t),s}function B(t){const e=t;if(!e)return{};if(typeof e=="string")return{error:()=>e};if(e?.message!==void 0){if(e?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");e.error=e.message}return delete e.message,typeof e.error=="string"?{...e,error:()=>e.error}:e}function tp(t){return Object.keys(t).filter(e=>t[e]._zod.optin==="optional"&&t[e]._zod.optout==="optional")}const np={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function sp(t,e){const n=t._zod.def,s=On(t._zod.def,{get shape(){const r={};for(const i in e){if(!(i in n.shape))throw new Error(`Unrecognized key: "${i}"`);e[i]&&(r[i]=n.shape[i])}return Nn(this,"shape",r),r},checks:[]});return un(t,s)}function rp(t,e){const n=t._zod.def,s=On(t._zod.def,{get shape(){const r={...t._zod.def.shape};for(const i in e){if(!(i in n.shape))throw new Error(`Unrecognized key: "${i}"`);e[i]&&delete r[i]}return Nn(this,"shape",r),r},checks:[]});return un(t,s)}function ip(t,e){if(!Qn(e))throw new Error("Invalid input to extend: expected a plain object");const n=t._zod.def.checks;if(n&&n.length>0)throw new Error("Object schemas containing refinements cannot be extended. Use `.safeExtend()` instead.");const r=On(t._zod.def,{get shape(){const i={...t._zod.def.shape,...e};return Nn(this,"shape",i),i},checks:[]});return un(t,r)}function op(t,e){if(!Qn(e))throw new Error("Invalid input to safeExtend: expected a plain object");const n={...t._zod.def,get shape(){const s={...t._zod.def.shape,...e};return Nn(this,"shape",s),s},checks:t._zod.def.checks};return un(t,n)}function ap(t,e){const n=On(t._zod.def,{get shape(){const s={...t._zod.def.shape,...e._zod.def.shape};return Nn(this,"shape",s),s},get catchall(){return e._zod.def.catchall},checks:[]});return un(t,n)}function lp(t,e,n){const s=On(e._zod.def,{get shape(){const r=e._zod.def.shape,i={...r};if(n)for(const o in n){if(!(o in r))throw new Error(`Unrecognized key: "${o}"`);n[o]&&(i[o]=t?new t({type:"optional",innerType:r[o]}):r[o])}else for(const o in r)i[o]=t?new t({type:"optional",innerType:r[o]}):r[o];return Nn(this,"shape",i),i},checks:[]});return un(e,s)}function cp(t,e,n){const s=On(e._zod.def,{get shape(){const r=e._zod.def.shape,i={...r};if(n)for(const o in n){if(!(o in i))throw new Error(`Unrecognized key: "${o}"`);n[o]&&(i[o]=new t({type:"nonoptional",innerType:r[o]}))}else for(const o in r)i[o]=new t({type:"nonoptional",innerType:r[o]});return Nn(this,"shape",i),i},checks:[]});return un(e,s)}function Fn(t,e=0){if(t.aborted===!0)return!0;for(let n=e;n<t.issues.length;n++)if(t.issues[n]?.continue!==!0)return!0;return!1}function bn(t,e){return e.map(n=>{var s;return(s=n).path??(s.path=[]),n.path.unshift(t),n})}function Hs(t){return typeof t=="string"?t:t?.message}function sn(t,e,n){const s={...t,path:t.path??[]};if(!t.message){const r=Hs(t.inst?._zod.def?.error?.(t))??Hs(e?.error?.(t))??Hs(n.customError?.(t))??Hs(n.localeError?.(t))??"Invalid input";s.message=r}return delete s.inst,delete s.continue,e?.reportInput||delete s.input,s}function yo(t){return Array.isArray(t)?"array":typeof t=="string"?"string":"unknown"}function Ts(...t){const[e,n,s]=t;return typeof e=="string"?{message:e,code:"custom",input:n,inst:s}:{...e}}const Yl=(t,e)=>{t.name="$ZodError",Object.defineProperty(t,"_zod",{value:t._zod,enumerable:!1}),Object.defineProperty(t,"issues",{value:e,enumerable:!1}),t.message=JSON.stringify(e,Bi,2),Object.defineProperty(t,"toString",{value:()=>t.message,enumerable:!1})},Gl=I("$ZodError",Yl),Kl=I("$ZodError",Yl,{Parent:Error});function up(t,e=n=>n.message){const n={},s=[];for(const r of t.issues)r.path.length>0?(n[r.path[0]]=n[r.path[0]]||[],n[r.path[0]].push(e(r))):s.push(e(r));return{formErrors:s,fieldErrors:n}}function fp(t,e){const n=e||function(i){return i.message},s={_errors:[]},r=i=>{for(const o of i.issues)if(o.code==="invalid_union"&&o.errors.length)o.errors.map(a=>r({issues:a}));else if(o.code==="invalid_key")r({issues:o.issues});else if(o.code==="invalid_element")r({issues:o.issues});else if(o.path.length===0)s._errors.push(n(o));else{let a=s,l=0;for(;l<o.path.length;){const c=o.path[l];l===o.path.length-1?(a[c]=a[c]||{_errors:[]},a[c]._errors.push(n(o))):a[c]=a[c]||{_errors:[]},a=a[c],l++}}};return r(t),s}const bo=t=>(e,n,s,r)=>{const i=s?Object.assign(s,{async:!1}):{async:!1},o=e._zod.run({value:n,issues:[]},i);if(o instanceof Promise)throw new Kn;if(o.issues.length){const a=new(r?.Err??t)(o.issues.map(l=>sn(l,i,nn())));throw Wl(a,r?.callee),a}return o.value},wo=t=>async(e,n,s,r)=>{const i=s?Object.assign(s,{async:!0}):{async:!0};let o=e._zod.run({value:n,issues:[]},i);if(o instanceof Promise&&(o=await o),o.issues.length){const a=new(r?.Err??t)(o.issues.map(l=>sn(l,i,nn())));throw Wl(a,r?.callee),a}return o.value},Ur=t=>(e,n,s)=>{const r=s?{...s,async:!1}:{async:!1},i=e._zod.run({value:n,issues:[]},r);if(i instanceof Promise)throw new Kn;return i.issues.length?{success:!1,error:new(t??Gl)(i.issues.map(o=>sn(o,r,nn())))}:{success:!0,data:i.value}},hp=Ur(Kl),Zr=t=>async(e,n,s)=>{const r=s?Object.assign(s,{async:!0}):{async:!0};let i=e._zod.run({value:n,issues:[]},r);return i instanceof Promise&&(i=await i),i.issues.length?{success:!1,error:new t(i.issues.map(o=>sn(o,r,nn())))}:{success:!0,data:i.value}},dp=Zr(Kl),pp=t=>(e,n,s)=>{const r=s?Object.assign(s,{direction:"backward"}):{direction:"backward"};return bo(t)(e,n,r)},mp=t=>(e,n,s)=>bo(t)(e,n,s),gp=t=>async(e,n,s)=>{const r=s?Object.assign(s,{direction:"backward"}):{direction:"backward"};return wo(t)(e,n,r)},yp=t=>async(e,n,s)=>wo(t)(e,n,s),bp=t=>(e,n,s)=>{const r=s?Object.assign(s,{direction:"backward"}):{direction:"backward"};return Ur(t)(e,n,r)},wp=t=>(e,n,s)=>Ur(t)(e,n,s),vp=t=>async(e,n,s)=>{const r=s?Object.assign(s,{direction:"backward"}):{direction:"backward"};return Zr(t)(e,n,r)},xp=t=>async(e,n,s)=>Zr(t)(e,n,s),_p=/^[cC][^\s-]{8,}$/,Ep=/^[0-9a-z]+$/,Sp=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,kp=/^[0-9a-vA-V]{20}$/,Tp=/^[A-Za-z0-9]{27}$/,Ap=/^[a-zA-Z0-9_-]{21}$/,Np=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,Op=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,la=t=>t?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${t}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,Cp=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,Ip="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function Mp(){return new RegExp(Ip,"u")}const jp=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Rp=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,Pp=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,$p=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,Dp=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,Hl=/^[A-Za-z0-9_-]*$/,Lp=/^(?=.{1,253}\.?$)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[-0-9a-zA-Z]{0,61}[0-9a-zA-Z])?)*\.?$/,zp=/^\+(?:[0-9]){6,14}[0-9]$/,Xl="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",Fp=new RegExp(`^${Xl}$`);function Ql(t){const e="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof t.precision=="number"?t.precision===-1?`${e}`:t.precision===0?`${e}:[0-5]\\d`:`${e}:[0-5]\\d\\.\\d{${t.precision}}`:`${e}(?::[0-5]\\d(?:\\.\\d+)?)?`}function Bp(t){return new RegExp(`^${Ql(t)}$`)}function Up(t){const e=Ql({precision:t.precision}),n=["Z"];t.local&&n.push(""),t.offset&&n.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const s=`${e}(?:${n.join("|")})`;return new RegExp(`^${Xl}T(?:${s})$`)}const Zp=t=>{const e=t?`[\\s\\S]{${t?.minimum??0},${t?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${e}$`)},Vp=/^-?\d+$/,Wp=/^-?\d+(?:\.\d+)?/,qp=/^(?:true|false)$/i,Yp=/^[^A-Z]*$/,Gp=/^[^a-z]*$/,Ke=I("$ZodCheck",(t,e)=>{var n;t._zod??(t._zod={}),t._zod.def=e,(n=t._zod).onattach??(n.onattach=[])}),Jl={number:"number",bigint:"bigint",object:"date"},ec=I("$ZodCheckLessThan",(t,e)=>{Ke.init(t,e);const n=Jl[typeof e.value];t._zod.onattach.push(s=>{const r=s._zod.bag,i=(e.inclusive?r.maximum:r.exclusiveMaximum)??Number.POSITIVE_INFINITY;e.value<i&&(e.inclusive?r.maximum=e.value:r.exclusiveMaximum=e.value)}),t._zod.check=s=>{(e.inclusive?s.value<=e.value:s.value<e.value)||s.issues.push({origin:n,code:"too_big",maximum:e.value,input:s.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),tc=I("$ZodCheckGreaterThan",(t,e)=>{Ke.init(t,e);const n=Jl[typeof e.value];t._zod.onattach.push(s=>{const r=s._zod.bag,i=(e.inclusive?r.minimum:r.exclusiveMinimum)??Number.NEGATIVE_INFINITY;e.value>i&&(e.inclusive?r.minimum=e.value:r.exclusiveMinimum=e.value)}),t._zod.check=s=>{(e.inclusive?s.value>=e.value:s.value>e.value)||s.issues.push({origin:n,code:"too_small",minimum:e.value,input:s.value,inclusive:e.inclusive,inst:t,continue:!e.abort})}}),Kp=I("$ZodCheckMultipleOf",(t,e)=>{Ke.init(t,e),t._zod.onattach.push(n=>{var s;(s=n._zod.bag).multipleOf??(s.multipleOf=e.value)}),t._zod.check=n=>{if(typeof n.value!=typeof e.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof n.value=="bigint"?n.value%e.value===BigInt(0):Qd(n.value,e.value)===0)||n.issues.push({origin:typeof n.value,code:"not_multiple_of",divisor:e.value,input:n.value,inst:t,continue:!e.abort})}}),Hp=I("$ZodCheckNumberFormat",(t,e)=>{Ke.init(t,e),e.format=e.format||"float64";const n=e.format?.includes("int"),s=n?"int":"number",[r,i]=np[e.format];t._zod.onattach.push(o=>{const a=o._zod.bag;a.format=e.format,a.minimum=r,a.maximum=i,n&&(a.pattern=Vp)}),t._zod.check=o=>{const a=o.value;if(n){if(!Number.isInteger(a)){o.issues.push({expected:s,format:e.format,code:"invalid_type",continue:!1,input:a,inst:t});return}if(!Number.isSafeInteger(a)){a>0?o.issues.push({input:a,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:s,continue:!e.abort}):o.issues.push({input:a,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:s,continue:!e.abort});return}}a<r&&o.issues.push({origin:"number",input:a,code:"too_small",minimum:r,inclusive:!0,inst:t,continue:!e.abort}),a>i&&o.issues.push({origin:"number",input:a,code:"too_big",maximum:i,inst:t})}}),Xp=I("$ZodCheckMaxLength",(t,e)=>{var n;Ke.init(t,e),(n=t._zod.def).when??(n.when=s=>{const r=s.value;return!mo(r)&&r.length!==void 0}),t._zod.onattach.push(s=>{const r=s._zod.bag.maximum??Number.POSITIVE_INFINITY;e.maximum<r&&(s._zod.bag.maximum=e.maximum)}),t._zod.check=s=>{const r=s.value;if(r.length<=e.maximum)return;const o=yo(r);s.issues.push({origin:o,code:"too_big",maximum:e.maximum,inclusive:!0,input:r,inst:t,continue:!e.abort})}}),Qp=I("$ZodCheckMinLength",(t,e)=>{var n;Ke.init(t,e),(n=t._zod.def).when??(n.when=s=>{const r=s.value;return!mo(r)&&r.length!==void 0}),t._zod.onattach.push(s=>{const r=s._zod.bag.minimum??Number.NEGATIVE_INFINITY;e.minimum>r&&(s._zod.bag.minimum=e.minimum)}),t._zod.check=s=>{const r=s.value;if(r.length>=e.minimum)return;const o=yo(r);s.issues.push({origin:o,code:"too_small",minimum:e.minimum,inclusive:!0,input:r,inst:t,continue:!e.abort})}}),Jp=I("$ZodCheckLengthEquals",(t,e)=>{var n;Ke.init(t,e),(n=t._zod.def).when??(n.when=s=>{const r=s.value;return!mo(r)&&r.length!==void 0}),t._zod.onattach.push(s=>{const r=s._zod.bag;r.minimum=e.length,r.maximum=e.length,r.length=e.length}),t._zod.check=s=>{const r=s.value,i=r.length;if(i===e.length)return;const o=yo(r),a=i>e.length;s.issues.push({origin:o,...a?{code:"too_big",maximum:e.length}:{code:"too_small",minimum:e.length},inclusive:!0,exact:!0,input:s.value,inst:t,continue:!e.abort})}}),Vr=I("$ZodCheckStringFormat",(t,e)=>{var n,s;Ke.init(t,e),t._zod.onattach.push(r=>{const i=r._zod.bag;i.format=e.format,e.pattern&&(i.patterns??(i.patterns=new Set),i.patterns.add(e.pattern))}),e.pattern?(n=t._zod).check??(n.check=r=>{e.pattern.lastIndex=0,!e.pattern.test(r.value)&&r.issues.push({origin:"string",code:"invalid_format",format:e.format,input:r.value,...e.pattern?{pattern:e.pattern.toString()}:{},inst:t,continue:!e.abort})}):(s=t._zod).check??(s.check=()=>{})}),em=I("$ZodCheckRegex",(t,e)=>{Vr.init(t,e),t._zod.check=n=>{e.pattern.lastIndex=0,!e.pattern.test(n.value)&&n.issues.push({origin:"string",code:"invalid_format",format:"regex",input:n.value,pattern:e.pattern.toString(),inst:t,continue:!e.abort})}}),tm=I("$ZodCheckLowerCase",(t,e)=>{e.pattern??(e.pattern=Yp),Vr.init(t,e)}),nm=I("$ZodCheckUpperCase",(t,e)=>{e.pattern??(e.pattern=Gp),Vr.init(t,e)}),sm=I("$ZodCheckIncludes",(t,e)=>{Ke.init(t,e);const n=Jn(e.includes),s=new RegExp(typeof e.position=="number"?`^.{${e.position}}${n}`:n);e.pattern=s,t._zod.onattach.push(r=>{const i=r._zod.bag;i.patterns??(i.patterns=new Set),i.patterns.add(s)}),t._zod.check=r=>{r.value.includes(e.includes,e.position)||r.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:e.includes,input:r.value,inst:t,continue:!e.abort})}}),rm=I("$ZodCheckStartsWith",(t,e)=>{Ke.init(t,e);const n=new RegExp(`^${Jn(e.prefix)}.*`);e.pattern??(e.pattern=n),t._zod.onattach.push(s=>{const r=s._zod.bag;r.patterns??(r.patterns=new Set),r.patterns.add(n)}),t._zod.check=s=>{s.value.startsWith(e.prefix)||s.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:e.prefix,input:s.value,inst:t,continue:!e.abort})}}),im=I("$ZodCheckEndsWith",(t,e)=>{Ke.init(t,e);const n=new RegExp(`.*${Jn(e.suffix)}$`);e.pattern??(e.pattern=n),t._zod.onattach.push(s=>{const r=s._zod.bag;r.patterns??(r.patterns=new Set),r.patterns.add(n)}),t._zod.check=s=>{s.value.endsWith(e.suffix)||s.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:e.suffix,input:s.value,inst:t,continue:!e.abort})}}),om=I("$ZodCheckOverwrite",(t,e)=>{Ke.init(t,e),t._zod.check=n=>{n.value=e.tx(n.value)}});class am{constructor(e=[]){this.content=[],this.indent=0,this&&(this.args=e)}indented(e){this.indent+=1,e(this),this.indent-=1}write(e){if(typeof e=="function"){e(this,{execution:"sync"}),e(this,{execution:"async"});return}const s=e.split(`
`).filter(o=>o),r=Math.min(...s.map(o=>o.length-o.trimStart().length)),i=s.map(o=>o.slice(r)).map(o=>" ".repeat(this.indent*2)+o);for(const o of i)this.content.push(o)}compile(){const e=Function,n=this?.args,r=[...(this?.content??[""]).map(i=>`  ${i}`)];return new e(...n,r.join(`
`))}}const lm={major:4,minor:1,patch:11},fe=I("$ZodType",(t,e)=>{var n;t??(t={}),t._zod.def=e,t._zod.bag=t._zod.bag||{},t._zod.version=lm;const s=[...t._zod.def.checks??[]];t._zod.traits.has("$ZodCheck")&&s.unshift(t);for(const r of s)for(const i of r._zod.onattach)i(t);if(s.length===0)(n=t._zod).deferred??(n.deferred=[]),t._zod.deferred?.push(()=>{t._zod.run=t._zod.parse});else{const r=(o,a,l)=>{let c=Fn(o),u;for(const f of a){if(f._zod.def.when){if(!f._zod.def.when(o))continue}else if(c)continue;const h=o.issues.length,p=f._zod.check(o);if(p instanceof Promise&&l?.async===!1)throw new Kn;if(u||p instanceof Promise)u=(u??Promise.resolve()).then(async()=>{await p,o.issues.length!==h&&(c||(c=Fn(o,h)))});else{if(o.issues.length===h)continue;c||(c=Fn(o,h))}}return u?u.then(()=>o):o},i=(o,a,l)=>{if(Fn(o))return o.aborted=!0,o;const c=r(a,s,l);if(c instanceof Promise){if(l.async===!1)throw new Kn;return c.then(u=>t._zod.parse(u,l))}return t._zod.parse(c,l)};t._zod.run=(o,a)=>{if(a.skipChecks)return t._zod.parse(o,a);if(a.direction==="backward"){const c=t._zod.parse({value:o.value,issues:[]},{...a,skipChecks:!0});return c instanceof Promise?c.then(u=>i(u,o,a)):i(c,o,a)}const l=t._zod.parse(o,a);if(l instanceof Promise){if(a.async===!1)throw new Kn;return l.then(c=>r(c,s,a))}return r(l,s,a)}}t["~standard"]={validate:r=>{try{const i=hp(t,r);return i.success?{value:i.data}:{issues:i.error?.issues}}catch{return dp(t,r).then(o=>o.success?{value:o.data}:{issues:o.error?.issues})}},vendor:"zod",version:1}}),vo=I("$ZodString",(t,e)=>{fe.init(t,e),t._zod.pattern=[...t?._zod.bag?.patterns??[]].pop()??Zp(t._zod.bag),t._zod.parse=(n,s)=>{if(e.coerce)try{n.value=String(n.value)}catch{}return typeof n.value=="string"||n.issues.push({expected:"string",code:"invalid_type",input:n.value,inst:t}),n}}),we=I("$ZodStringFormat",(t,e)=>{Vr.init(t,e),vo.init(t,e)}),cm=I("$ZodGUID",(t,e)=>{e.pattern??(e.pattern=Op),we.init(t,e)}),um=I("$ZodUUID",(t,e)=>{if(e.version){const s={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[e.version];if(s===void 0)throw new Error(`Invalid UUID version: "${e.version}"`);e.pattern??(e.pattern=la(s))}else e.pattern??(e.pattern=la());we.init(t,e)}),fm=I("$ZodEmail",(t,e)=>{e.pattern??(e.pattern=Cp),we.init(t,e)}),hm=I("$ZodURL",(t,e)=>{we.init(t,e),t._zod.check=n=>{try{const s=n.value.trim(),r=new URL(s);e.hostname&&(e.hostname.lastIndex=0,e.hostname.test(r.hostname)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:Lp.source,input:n.value,inst:t,continue:!e.abort})),e.protocol&&(e.protocol.lastIndex=0,e.protocol.test(r.protocol.endsWith(":")?r.protocol.slice(0,-1):r.protocol)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:e.protocol.source,input:n.value,inst:t,continue:!e.abort})),e.normalize?n.value=r.href:n.value=s;return}catch{n.issues.push({code:"invalid_format",format:"url",input:n.value,inst:t,continue:!e.abort})}}}),dm=I("$ZodEmoji",(t,e)=>{e.pattern??(e.pattern=Mp()),we.init(t,e)}),pm=I("$ZodNanoID",(t,e)=>{e.pattern??(e.pattern=Ap),we.init(t,e)}),mm=I("$ZodCUID",(t,e)=>{e.pattern??(e.pattern=_p),we.init(t,e)}),gm=I("$ZodCUID2",(t,e)=>{e.pattern??(e.pattern=Ep),we.init(t,e)}),ym=I("$ZodULID",(t,e)=>{e.pattern??(e.pattern=Sp),we.init(t,e)}),bm=I("$ZodXID",(t,e)=>{e.pattern??(e.pattern=kp),we.init(t,e)}),wm=I("$ZodKSUID",(t,e)=>{e.pattern??(e.pattern=Tp),we.init(t,e)}),vm=I("$ZodISODateTime",(t,e)=>{e.pattern??(e.pattern=Up(e)),we.init(t,e)}),xm=I("$ZodISODate",(t,e)=>{e.pattern??(e.pattern=Fp),we.init(t,e)}),_m=I("$ZodISOTime",(t,e)=>{e.pattern??(e.pattern=Bp(e)),we.init(t,e)}),Em=I("$ZodISODuration",(t,e)=>{e.pattern??(e.pattern=Np),we.init(t,e)}),Sm=I("$ZodIPv4",(t,e)=>{e.pattern??(e.pattern=jp),we.init(t,e),t._zod.onattach.push(n=>{const s=n._zod.bag;s.format="ipv4"})}),km=I("$ZodIPv6",(t,e)=>{e.pattern??(e.pattern=Rp),we.init(t,e),t._zod.onattach.push(n=>{const s=n._zod.bag;s.format="ipv6"}),t._zod.check=n=>{try{new URL(`http://[${n.value}]`)}catch{n.issues.push({code:"invalid_format",format:"ipv6",input:n.value,inst:t,continue:!e.abort})}}}),Tm=I("$ZodCIDRv4",(t,e)=>{e.pattern??(e.pattern=Pp),we.init(t,e)}),Am=I("$ZodCIDRv6",(t,e)=>{e.pattern??(e.pattern=$p),we.init(t,e),t._zod.check=n=>{const s=n.value.split("/");try{if(s.length!==2)throw new Error;const[r,i]=s;if(!i)throw new Error;const o=Number(i);if(`${o}`!==i)throw new Error;if(o<0||o>128)throw new Error;new URL(`http://[${r}]`)}catch{n.issues.push({code:"invalid_format",format:"cidrv6",input:n.value,inst:t,continue:!e.abort})}}});function nc(t){if(t==="")return!0;if(t.length%4!==0)return!1;try{return atob(t),!0}catch{return!1}}const Nm=I("$ZodBase64",(t,e)=>{e.pattern??(e.pattern=Dp),we.init(t,e),t._zod.onattach.push(n=>{n._zod.bag.contentEncoding="base64"}),t._zod.check=n=>{nc(n.value)||n.issues.push({code:"invalid_format",format:"base64",input:n.value,inst:t,continue:!e.abort})}});function Om(t){if(!Hl.test(t))return!1;const e=t.replace(/[-_]/g,s=>s==="-"?"+":"/"),n=e.padEnd(Math.ceil(e.length/4)*4,"=");return nc(n)}const Cm=I("$ZodBase64URL",(t,e)=>{e.pattern??(e.pattern=Hl),we.init(t,e),t._zod.onattach.push(n=>{n._zod.bag.contentEncoding="base64url"}),t._zod.check=n=>{Om(n.value)||n.issues.push({code:"invalid_format",format:"base64url",input:n.value,inst:t,continue:!e.abort})}}),Im=I("$ZodE164",(t,e)=>{e.pattern??(e.pattern=zp),we.init(t,e)});function Mm(t,e=null){try{const n=t.split(".");if(n.length!==3)return!1;const[s]=n;if(!s)return!1;const r=JSON.parse(atob(s));return!("typ"in r&&r?.typ!=="JWT"||!r.alg||e&&(!("alg"in r)||r.alg!==e))}catch{return!1}}const jm=I("$ZodJWT",(t,e)=>{we.init(t,e),t._zod.check=n=>{Mm(n.value,e.alg)||n.issues.push({code:"invalid_format",format:"jwt",input:n.value,inst:t,continue:!e.abort})}}),sc=I("$ZodNumber",(t,e)=>{fe.init(t,e),t._zod.pattern=t._zod.bag.pattern??Wp,t._zod.parse=(n,s)=>{if(e.coerce)try{n.value=Number(n.value)}catch{}const r=n.value;if(typeof r=="number"&&!Number.isNaN(r)&&Number.isFinite(r))return n;const i=typeof r=="number"?Number.isNaN(r)?"NaN":Number.isFinite(r)?void 0:"Infinity":void 0;return n.issues.push({expected:"number",code:"invalid_type",input:r,inst:t,...i?{received:i}:{}}),n}}),Rm=I("$ZodNumber",(t,e)=>{Hp.init(t,e),sc.init(t,e)}),Pm=I("$ZodBoolean",(t,e)=>{fe.init(t,e),t._zod.pattern=qp,t._zod.parse=(n,s)=>{if(e.coerce)try{n.value=!!n.value}catch{}const r=n.value;return typeof r=="boolean"||n.issues.push({expected:"boolean",code:"invalid_type",input:r,inst:t}),n}}),$m=I("$ZodUnknown",(t,e)=>{fe.init(t,e),t._zod.parse=n=>n}),Dm=I("$ZodNever",(t,e)=>{fe.init(t,e),t._zod.parse=(n,s)=>(n.issues.push({expected:"never",code:"invalid_type",input:n.value,inst:t}),n)}),Lm=I("$ZodDate",(t,e)=>{fe.init(t,e),t._zod.parse=(n,s)=>{if(e.coerce)try{n.value=new Date(n.value)}catch{}const r=n.value,i=r instanceof Date;return i&&!Number.isNaN(r.getTime())||n.issues.push({expected:"date",code:"invalid_type",input:r,...i?{received:"Invalid Date"}:{},inst:t}),n}});function ca(t,e,n){t.issues.length&&e.issues.push(...bn(n,t.issues)),e.value[n]=t.value}const zm=I("$ZodArray",(t,e)=>{fe.init(t,e),t._zod.parse=(n,s)=>{const r=n.value;if(!Array.isArray(r))return n.issues.push({expected:"array",code:"invalid_type",input:r,inst:t}),n;n.value=Array(r.length);const i=[];for(let o=0;o<r.length;o++){const a=r[o],l=e.element._zod.run({value:a,issues:[]},s);l instanceof Promise?i.push(l.then(c=>ca(c,n,o))):ca(l,n,o)}return i.length?Promise.all(i).then(()=>n):n}});function Nr(t,e,n,s){t.issues.length&&e.issues.push(...bn(n,t.issues)),t.value===void 0?n in s&&(e.value[n]=void 0):e.value[n]=t.value}function rc(t){const e=Object.keys(t.shape);for(const s of e)if(!t.shape?.[s]?._zod?.traits?.has("$ZodType"))throw new Error(`Invalid element at key "${s}": expected a Zod schema`);const n=tp(t.shape);return{...t,keys:e,keySet:new Set(e),numKeys:e.length,optionalKeys:new Set(n)}}function ic(t,e,n,s,r,i){const o=[],a=r.keySet,l=r.catchall._zod,c=l.def.type;for(const u of Object.keys(e)){if(a.has(u))continue;if(c==="never"){o.push(u);continue}const f=l.run({value:e[u],issues:[]},s);f instanceof Promise?t.push(f.then(h=>Nr(h,n,u,e))):Nr(f,n,u,e)}return o.length&&n.issues.push({code:"unrecognized_keys",keys:o,input:e,inst:i}),t.length?Promise.all(t).then(()=>n):n}const Fm=I("$ZodObject",(t,e)=>{if(fe.init(t,e),!Object.getOwnPropertyDescriptor(e,"shape")?.get){const a=e.shape;Object.defineProperty(e,"shape",{get:()=>{const l={...a};return Object.defineProperty(e,"shape",{value:l}),l}})}const s=po(()=>rc(e));ae(t._zod,"propValues",()=>{const a=e.shape,l={};for(const c in a){const u=a[c]._zod;if(u.values){l[c]??(l[c]=new Set);for(const f of u.values)l[c].add(f)}}return l});const r=Ar,i=e.catchall;let o;t._zod.parse=(a,l)=>{o??(o=s.value);const c=a.value;if(!r(c))return a.issues.push({expected:"object",code:"invalid_type",input:c,inst:t}),a;a.value={};const u=[],f=o.shape;for(const h of o.keys){const y=f[h]._zod.run({value:c[h],issues:[]},l);y instanceof Promise?u.push(y.then(g=>Nr(g,a,h,c))):Nr(y,a,h,c)}return i?ic(u,c,a,l,s.value,t):u.length?Promise.all(u).then(()=>a):a}}),Bm=I("$ZodObjectJIT",(t,e)=>{Fm.init(t,e);const n=t._zod.parse,s=po(()=>rc(e)),r=h=>{const p=new am(["shape","payload","ctx"]),y=s.value,g=x=>{const _=aa(x);return`shape[${_}]._zod.run({ value: input[${_}], issues: [] }, ctx)`};p.write("const input = payload.value;");const w=Object.create(null);let m=0;for(const x of y.keys)w[x]=`key_${m++}`;p.write("const newResult = {};");for(const x of y.keys){const _=w[x],E=aa(x);p.write(`const ${_} = ${g(x)};`),p.write(`
        if (${_}.issues.length) {
          payload.issues = payload.issues.concat(${_}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${E}, ...iss.path] : [${E}]
          })));
        }
        
        
        if (${_}.value === undefined) {
          if (${E} in input) {
            newResult[${E}] = undefined;
          }
        } else {
          newResult[${E}] = ${_}.value;
        }
        
      `)}p.write("payload.value = newResult;"),p.write("return payload;");const S=p.compile();return(x,_)=>S(h,x,_)};let i;const o=Ar,a=!Vl.jitless,c=a&&Jd.value,u=e.catchall;let f;t._zod.parse=(h,p)=>{f??(f=s.value);const y=h.value;return o(y)?a&&c&&p?.async===!1&&p.jitless!==!0?(i||(i=r(e.shape)),h=i(h,p),u?ic([],y,h,p,f,t):h):n(h,p):(h.issues.push({expected:"object",code:"invalid_type",input:y,inst:t}),h)}});function ua(t,e,n,s){for(const i of t)if(i.issues.length===0)return e.value=i.value,e;const r=t.filter(i=>!Fn(i));return r.length===1?(e.value=r[0].value,r[0]):(e.issues.push({code:"invalid_union",input:e.value,inst:n,errors:t.map(i=>i.issues.map(o=>sn(o,s,nn())))}),e)}const Um=I("$ZodUnion",(t,e)=>{fe.init(t,e),ae(t._zod,"optin",()=>e.options.some(r=>r._zod.optin==="optional")?"optional":void 0),ae(t._zod,"optout",()=>e.options.some(r=>r._zod.optout==="optional")?"optional":void 0),ae(t._zod,"values",()=>{if(e.options.every(r=>r._zod.values))return new Set(e.options.flatMap(r=>Array.from(r._zod.values)))}),ae(t._zod,"pattern",()=>{if(e.options.every(r=>r._zod.pattern)){const r=e.options.map(i=>i._zod.pattern);return new RegExp(`^(${r.map(i=>go(i.source)).join("|")})$`)}});const n=e.options.length===1,s=e.options[0]._zod.run;t._zod.parse=(r,i)=>{if(n)return s(r,i);let o=!1;const a=[];for(const l of e.options){const c=l._zod.run({value:r.value,issues:[]},i);if(c instanceof Promise)a.push(c),o=!0;else{if(c.issues.length===0)return c;a.push(c)}}return o?Promise.all(a).then(l=>ua(l,r,t,i)):ua(a,r,t,i)}}),Zm=I("$ZodIntersection",(t,e)=>{fe.init(t,e),t._zod.parse=(n,s)=>{const r=n.value,i=e.left._zod.run({value:r,issues:[]},s),o=e.right._zod.run({value:r,issues:[]},s);return i instanceof Promise||o instanceof Promise?Promise.all([i,o]).then(([l,c])=>fa(n,l,c)):fa(n,i,o)}});function Ui(t,e){if(t===e)return{valid:!0,data:t};if(t instanceof Date&&e instanceof Date&&+t==+e)return{valid:!0,data:t};if(Qn(t)&&Qn(e)){const n=Object.keys(e),s=Object.keys(t).filter(i=>n.indexOf(i)!==-1),r={...t,...e};for(const i of s){const o=Ui(t[i],e[i]);if(!o.valid)return{valid:!1,mergeErrorPath:[i,...o.mergeErrorPath]};r[i]=o.data}return{valid:!0,data:r}}if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return{valid:!1,mergeErrorPath:[]};const n=[];for(let s=0;s<t.length;s++){const r=t[s],i=e[s],o=Ui(r,i);if(!o.valid)return{valid:!1,mergeErrorPath:[s,...o.mergeErrorPath]};n.push(o.data)}return{valid:!0,data:n}}return{valid:!1,mergeErrorPath:[]}}function fa(t,e,n){if(e.issues.length&&t.issues.push(...e.issues),n.issues.length&&t.issues.push(...n.issues),Fn(t))return t;const s=Ui(e.value,n.value);if(!s.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(s.mergeErrorPath)}`);return t.value=s.data,t}const Vm=I("$ZodTuple",(t,e)=>{fe.init(t,e);const n=e.items,s=n.length-[...n].reverse().findIndex(r=>r._zod.optin!=="optional");t._zod.parse=(r,i)=>{const o=r.value;if(!Array.isArray(o))return r.issues.push({input:o,inst:t,expected:"tuple",code:"invalid_type"}),r;r.value=[];const a=[];if(!e.rest){const c=o.length>n.length,u=o.length<s-1;if(c||u)return r.issues.push({...c?{code:"too_big",maximum:n.length}:{code:"too_small",minimum:n.length},input:o,inst:t,origin:"array"}),r}let l=-1;for(const c of n){if(l++,l>=o.length&&l>=s)continue;const u=c._zod.run({value:o[l],issues:[]},i);u instanceof Promise?a.push(u.then(f=>Xs(f,r,l))):Xs(u,r,l)}if(e.rest){const c=o.slice(n.length);for(const u of c){l++;const f=e.rest._zod.run({value:u,issues:[]},i);f instanceof Promise?a.push(f.then(h=>Xs(h,r,l))):Xs(f,r,l)}}return a.length?Promise.all(a).then(()=>r):r}});function Xs(t,e,n){t.issues.length&&e.issues.push(...bn(n,t.issues)),e.value[n]=t.value}const Wm=I("$ZodRecord",(t,e)=>{fe.init(t,e),t._zod.parse=(n,s)=>{const r=n.value;if(!Qn(r))return n.issues.push({expected:"record",code:"invalid_type",input:r,inst:t}),n;const i=[];if(e.keyType._zod.values){const o=e.keyType._zod.values;n.value={};for(const l of o)if(typeof l=="string"||typeof l=="number"||typeof l=="symbol"){const c=e.valueType._zod.run({value:r[l],issues:[]},s);c instanceof Promise?i.push(c.then(u=>{u.issues.length&&n.issues.push(...bn(l,u.issues)),n.value[l]=u.value})):(c.issues.length&&n.issues.push(...bn(l,c.issues)),n.value[l]=c.value)}let a;for(const l in r)o.has(l)||(a=a??[],a.push(l));a&&a.length>0&&n.issues.push({code:"unrecognized_keys",input:r,inst:t,keys:a})}else{n.value={};for(const o of Reflect.ownKeys(r)){if(o==="__proto__")continue;const a=e.keyType._zod.run({value:o,issues:[]},s);if(a instanceof Promise)throw new Error("Async schemas not supported in object keys currently");if(a.issues.length){n.issues.push({code:"invalid_key",origin:"record",issues:a.issues.map(c=>sn(c,s,nn())),input:o,path:[o],inst:t}),n.value[a.value]=a.value;continue}const l=e.valueType._zod.run({value:r[o],issues:[]},s);l instanceof Promise?i.push(l.then(c=>{c.issues.length&&n.issues.push(...bn(o,c.issues)),n.value[a.value]=c.value})):(l.issues.length&&n.issues.push(...bn(o,l.issues)),n.value[a.value]=l.value)}}return i.length?Promise.all(i).then(()=>n):n}}),qm=I("$ZodEnum",(t,e)=>{fe.init(t,e);const n=Xd(e.entries),s=new Set(n);t._zod.values=s,t._zod.pattern=new RegExp(`^(${n.filter(r=>ep.has(typeof r)).map(r=>typeof r=="string"?Jn(r):r.toString()).join("|")})$`),t._zod.parse=(r,i)=>{const o=r.value;return s.has(o)||r.issues.push({code:"invalid_value",values:n,input:o,inst:t}),r}}),Ym=I("$ZodLiteral",(t,e)=>{if(fe.init(t,e),e.values.length===0)throw new Error("Cannot create literal schema with no valid values");t._zod.values=new Set(e.values),t._zod.pattern=new RegExp(`^(${e.values.map(n=>typeof n=="string"?Jn(n):n?Jn(n.toString()):String(n)).join("|")})$`),t._zod.parse=(n,s)=>{const r=n.value;return t._zod.values.has(r)||n.issues.push({code:"invalid_value",values:e.values,input:r,inst:t}),n}}),Gm=I("$ZodTransform",(t,e)=>{fe.init(t,e),t._zod.parse=(n,s)=>{if(s.direction==="backward")throw new Zl(t.constructor.name);const r=e.transform(n.value,n);if(s.async)return(r instanceof Promise?r:Promise.resolve(r)).then(o=>(n.value=o,n));if(r instanceof Promise)throw new Kn;return n.value=r,n}});function ha(t,e){return t.issues.length&&e===void 0?{issues:[],value:void 0}:t}const Km=I("$ZodOptional",(t,e)=>{fe.init(t,e),t._zod.optin="optional",t._zod.optout="optional",ae(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,void 0]):void 0),ae(t._zod,"pattern",()=>{const n=e.innerType._zod.pattern;return n?new RegExp(`^(${go(n.source)})?$`):void 0}),t._zod.parse=(n,s)=>{if(e.innerType._zod.optin==="optional"){const r=e.innerType._zod.run(n,s);return r instanceof Promise?r.then(i=>ha(i,n.value)):ha(r,n.value)}return n.value===void 0?n:e.innerType._zod.run(n,s)}}),Hm=I("$ZodNullable",(t,e)=>{fe.init(t,e),ae(t._zod,"optin",()=>e.innerType._zod.optin),ae(t._zod,"optout",()=>e.innerType._zod.optout),ae(t._zod,"pattern",()=>{const n=e.innerType._zod.pattern;return n?new RegExp(`^(${go(n.source)}|null)$`):void 0}),ae(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,null]):void 0),t._zod.parse=(n,s)=>n.value===null?n:e.innerType._zod.run(n,s)}),Xm=I("$ZodDefault",(t,e)=>{fe.init(t,e),t._zod.optin="optional",ae(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(n,s)=>{if(s.direction==="backward")return e.innerType._zod.run(n,s);if(n.value===void 0)return n.value=e.defaultValue,n;const r=e.innerType._zod.run(n,s);return r instanceof Promise?r.then(i=>da(i,e)):da(r,e)}});function da(t,e){return t.value===void 0&&(t.value=e.defaultValue),t}const Qm=I("$ZodPrefault",(t,e)=>{fe.init(t,e),t._zod.optin="optional",ae(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(n,s)=>(s.direction==="backward"||n.value===void 0&&(n.value=e.defaultValue),e.innerType._zod.run(n,s))}),Jm=I("$ZodNonOptional",(t,e)=>{fe.init(t,e),ae(t._zod,"values",()=>{const n=e.innerType._zod.values;return n?new Set([...n].filter(s=>s!==void 0)):void 0}),t._zod.parse=(n,s)=>{const r=e.innerType._zod.run(n,s);return r instanceof Promise?r.then(i=>pa(i,t)):pa(r,t)}});function pa(t,e){return!t.issues.length&&t.value===void 0&&t.issues.push({code:"invalid_type",expected:"nonoptional",input:t.value,inst:e}),t}const eg=I("$ZodCatch",(t,e)=>{fe.init(t,e),ae(t._zod,"optin",()=>e.innerType._zod.optin),ae(t._zod,"optout",()=>e.innerType._zod.optout),ae(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(n,s)=>{if(s.direction==="backward")return e.innerType._zod.run(n,s);const r=e.innerType._zod.run(n,s);return r instanceof Promise?r.then(i=>(n.value=i.value,i.issues.length&&(n.value=e.catchValue({...n,error:{issues:i.issues.map(o=>sn(o,s,nn()))},input:n.value}),n.issues=[]),n)):(n.value=r.value,r.issues.length&&(n.value=e.catchValue({...n,error:{issues:r.issues.map(i=>sn(i,s,nn()))},input:n.value}),n.issues=[]),n)}}),tg=I("$ZodPipe",(t,e)=>{fe.init(t,e),ae(t._zod,"values",()=>e.in._zod.values),ae(t._zod,"optin",()=>e.in._zod.optin),ae(t._zod,"optout",()=>e.out._zod.optout),ae(t._zod,"propValues",()=>e.in._zod.propValues),t._zod.parse=(n,s)=>{if(s.direction==="backward"){const i=e.out._zod.run(n,s);return i instanceof Promise?i.then(o=>Qs(o,e.in,s)):Qs(i,e.in,s)}const r=e.in._zod.run(n,s);return r instanceof Promise?r.then(i=>Qs(i,e.out,s)):Qs(r,e.out,s)}});function Qs(t,e,n){return t.issues.length?(t.aborted=!0,t):e._zod.run({value:t.value,issues:t.issues},n)}const ng=I("$ZodReadonly",(t,e)=>{fe.init(t,e),ae(t._zod,"propValues",()=>e.innerType._zod.propValues),ae(t._zod,"values",()=>e.innerType._zod.values),ae(t._zod,"optin",()=>e.innerType._zod.optin),ae(t._zod,"optout",()=>e.innerType._zod.optout),t._zod.parse=(n,s)=>{if(s.direction==="backward")return e.innerType._zod.run(n,s);const r=e.innerType._zod.run(n,s);return r instanceof Promise?r.then(ma):ma(r)}});function ma(t){return t.value=Object.freeze(t.value),t}const sg=I("$ZodLazy",(t,e)=>{fe.init(t,e),ae(t._zod,"innerType",()=>e.getter()),ae(t._zod,"pattern",()=>t._zod.innerType._zod.pattern),ae(t._zod,"propValues",()=>t._zod.innerType._zod.propValues),ae(t._zod,"optin",()=>t._zod.innerType._zod.optin??void 0),ae(t._zod,"optout",()=>t._zod.innerType._zod.optout??void 0),t._zod.parse=(n,s)=>t._zod.innerType._zod.run(n,s)}),rg=I("$ZodCustom",(t,e)=>{Ke.init(t,e),fe.init(t,e),t._zod.parse=(n,s)=>n,t._zod.check=n=>{const s=n.value,r=e.fn(s);if(r instanceof Promise)return r.then(i=>ga(i,n,s,t));ga(r,n,s,t)}});function ga(t,e,n,s){if(!t){const r={code:"custom",input:n,inst:s,path:[...s._zod.def.path??[]],continue:!s._zod.def.abort};s._zod.def.params&&(r.params=s._zod.def.params),e.issues.push(Ts(r))}}class ig{constructor(){this._map=new WeakMap,this._idmap=new Map}add(e,...n){const s=n[0];if(this._map.set(e,s),s&&typeof s=="object"&&"id"in s){if(this._idmap.has(s.id))throw new Error(`ID ${s.id} already exists in the registry`);this._idmap.set(s.id,e)}return this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(e){const n=this._map.get(e);return n&&typeof n=="object"&&"id"in n&&this._idmap.delete(n.id),this._map.delete(e),this}get(e){const n=e._zod.parent;if(n){const s={...this.get(n)??{}};delete s.id;const r={...s,...this._map.get(e)};return Object.keys(r).length?r:void 0}return this._map.get(e)}has(e){return this._map.has(e)}}function og(){return new ig}const Js=og();function ag(t,e){return new t({type:"string",...B(e)})}function lg(t,e){return new t({type:"string",format:"email",check:"string_format",abort:!1,...B(e)})}function ya(t,e){return new t({type:"string",format:"guid",check:"string_format",abort:!1,...B(e)})}function cg(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,...B(e)})}function ug(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...B(e)})}function fg(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...B(e)})}function hg(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...B(e)})}function dg(t,e){return new t({type:"string",format:"url",check:"string_format",abort:!1,...B(e)})}function pg(t,e){return new t({type:"string",format:"emoji",check:"string_format",abort:!1,...B(e)})}function mg(t,e){return new t({type:"string",format:"nanoid",check:"string_format",abort:!1,...B(e)})}function gg(t,e){return new t({type:"string",format:"cuid",check:"string_format",abort:!1,...B(e)})}function yg(t,e){return new t({type:"string",format:"cuid2",check:"string_format",abort:!1,...B(e)})}function bg(t,e){return new t({type:"string",format:"ulid",check:"string_format",abort:!1,...B(e)})}function wg(t,e){return new t({type:"string",format:"xid",check:"string_format",abort:!1,...B(e)})}function vg(t,e){return new t({type:"string",format:"ksuid",check:"string_format",abort:!1,...B(e)})}function xg(t,e){return new t({type:"string",format:"ipv4",check:"string_format",abort:!1,...B(e)})}function _g(t,e){return new t({type:"string",format:"ipv6",check:"string_format",abort:!1,...B(e)})}function Eg(t,e){return new t({type:"string",format:"cidrv4",check:"string_format",abort:!1,...B(e)})}function Sg(t,e){return new t({type:"string",format:"cidrv6",check:"string_format",abort:!1,...B(e)})}function kg(t,e){return new t({type:"string",format:"base64",check:"string_format",abort:!1,...B(e)})}function Tg(t,e){return new t({type:"string",format:"base64url",check:"string_format",abort:!1,...B(e)})}function Ag(t,e){return new t({type:"string",format:"e164",check:"string_format",abort:!1,...B(e)})}function Ng(t,e){return new t({type:"string",format:"jwt",check:"string_format",abort:!1,...B(e)})}function Og(t,e){return new t({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...B(e)})}function Cg(t,e){return new t({type:"string",format:"date",check:"string_format",...B(e)})}function Ig(t,e){return new t({type:"string",format:"time",check:"string_format",precision:null,...B(e)})}function Mg(t,e){return new t({type:"string",format:"duration",check:"string_format",...B(e)})}function jg(t,e){return new t({type:"number",checks:[],...B(e)})}function Rg(t,e){return new t({type:"number",check:"number_format",abort:!1,format:"safeint",...B(e)})}function Pg(t,e){return new t({type:"boolean",...B(e)})}function $g(t){return new t({type:"unknown"})}function Dg(t,e){return new t({type:"never",...B(e)})}function Lg(t,e){return new t({type:"date",...B(e)})}function ba(t,e){return new ec({check:"less_than",...B(e),value:t,inclusive:!1})}function gr(t,e){return new ec({check:"less_than",...B(e),value:t,inclusive:!0})}function wa(t,e){return new tc({check:"greater_than",...B(e),value:t,inclusive:!1})}function yr(t,e){return new tc({check:"greater_than",...B(e),value:t,inclusive:!0})}function va(t,e){return new Kp({check:"multiple_of",...B(e),value:t})}function oc(t,e){return new Xp({check:"max_length",...B(e),maximum:t})}function Or(t,e){return new Qp({check:"min_length",...B(e),minimum:t})}function ac(t,e){return new Jp({check:"length_equals",...B(e),length:t})}function zg(t,e){return new em({check:"string_format",format:"regex",...B(e),pattern:t})}function Fg(t){return new tm({check:"string_format",format:"lowercase",...B(t)})}function Bg(t){return new nm({check:"string_format",format:"uppercase",...B(t)})}function Ug(t,e){return new sm({check:"string_format",format:"includes",...B(e),includes:t})}function Zg(t,e){return new rm({check:"string_format",format:"starts_with",...B(e),prefix:t})}function Vg(t,e){return new im({check:"string_format",format:"ends_with",...B(e),suffix:t})}function Ls(t){return new om({check:"overwrite",tx:t})}function Wg(t){return Ls(e=>e.normalize(t))}function qg(){return Ls(t=>t.trim())}function Yg(){return Ls(t=>t.toLowerCase())}function Gg(){return Ls(t=>t.toUpperCase())}function Kg(t,e,n){return new t({type:"array",element:e,...B(n)})}function Hg(t,e,n){return new t({type:"custom",check:"custom",fn:e,...B(n)})}function Xg(t){const e=Qg(n=>(n.addIssue=s=>{if(typeof s=="string")n.issues.push(Ts(s,n.value,e._zod.def));else{const r=s;r.fatal&&(r.continue=!1),r.code??(r.code="custom"),r.input??(r.input=n.value),r.inst??(r.inst=e),r.continue??(r.continue=!e._zod.def.abort),n.issues.push(Ts(r))}},t(n.value,n)));return e}function Qg(t,e){const n=new Ke({check:"custom",...B(e)});return n._zod.check=t,n}const Jg=I("ZodISODateTime",(t,e)=>{vm.init(t,e),xe.init(t,e)});function e0(t){return Og(Jg,t)}const t0=I("ZodISODate",(t,e)=>{xm.init(t,e),xe.init(t,e)});function n0(t){return Cg(t0,t)}const s0=I("ZodISOTime",(t,e)=>{_m.init(t,e),xe.init(t,e)});function r0(t){return Ig(s0,t)}const i0=I("ZodISODuration",(t,e)=>{Em.init(t,e),xe.init(t,e)});function o0(t){return Mg(i0,t)}const a0=(t,e)=>{Gl.init(t,e),t.name="ZodError",Object.defineProperties(t,{format:{value:n=>fp(t,n)},flatten:{value:n=>up(t,n)},addIssue:{value:n=>{t.issues.push(n),t.message=JSON.stringify(t.issues,Bi,2)}},addIssues:{value:n=>{t.issues.push(...n),t.message=JSON.stringify(t.issues,Bi,2)}},isEmpty:{get(){return t.issues.length===0}}})},lt=I("ZodError",a0,{Parent:Error}),l0=bo(lt),c0=wo(lt),u0=Ur(lt),f0=Zr(lt),h0=pp(lt),d0=mp(lt),p0=gp(lt),m0=yp(lt),g0=bp(lt),y0=wp(lt),b0=vp(lt),w0=xp(lt),ye=I("ZodType",(t,e)=>(fe.init(t,e),t.def=e,t.type=e.type,Object.defineProperty(t,"_def",{value:e}),t.check=(...n)=>t.clone(On(e,{checks:[...e.checks??[],...n.map(s=>typeof s=="function"?{_zod:{check:s,def:{check:"custom"},onattach:[]}}:s)]})),t.clone=(n,s)=>un(t,n,s),t.brand=()=>t,t.register=((n,s)=>(n.add(t,s),t)),t.parse=(n,s)=>l0(t,n,s,{callee:t.parse}),t.safeParse=(n,s)=>u0(t,n,s),t.parseAsync=async(n,s)=>c0(t,n,s,{callee:t.parseAsync}),t.safeParseAsync=async(n,s)=>f0(t,n,s),t.spa=t.safeParseAsync,t.encode=(n,s)=>h0(t,n,s),t.decode=(n,s)=>d0(t,n,s),t.encodeAsync=async(n,s)=>p0(t,n,s),t.decodeAsync=async(n,s)=>m0(t,n,s),t.safeEncode=(n,s)=>g0(t,n,s),t.safeDecode=(n,s)=>y0(t,n,s),t.safeEncodeAsync=async(n,s)=>b0(t,n,s),t.safeDecodeAsync=async(n,s)=>w0(t,n,s),t.refine=(n,s)=>t.check(p1(n,s)),t.superRefine=n=>t.check(m1(n)),t.overwrite=n=>t.check(Ls(n)),t.optional=()=>Ta(t),t.nullable=()=>Aa(t),t.nullish=()=>Ta(Aa(t)),t.nonoptional=n=>i1(t,n),t.array=()=>es(t),t.or=n=>fc([t,n]),t.and=n=>Y0(t,n),t.transform=n=>Na(t,J0(n)),t.default=n=>n1(t,n),t.prefault=n=>r1(t,n),t.catch=n=>a1(t,n),t.pipe=n=>Na(t,n),t.readonly=()=>u1(t),t.describe=n=>{const s=t.clone();return Js.add(s,{description:n}),s},Object.defineProperty(t,"description",{get(){return Js.get(t)?.description},configurable:!0}),t.meta=(...n)=>{if(n.length===0)return Js.get(t);const s=t.clone();return Js.add(s,n[0]),s},t.isOptional=()=>t.safeParse(void 0).success,t.isNullable=()=>t.safeParse(null).success,t)),lc=I("_ZodString",(t,e)=>{vo.init(t,e),ye.init(t,e);const n=t._zod.bag;t.format=n.format??null,t.minLength=n.minimum??null,t.maxLength=n.maximum??null,t.regex=(...s)=>t.check(zg(...s)),t.includes=(...s)=>t.check(Ug(...s)),t.startsWith=(...s)=>t.check(Zg(...s)),t.endsWith=(...s)=>t.check(Vg(...s)),t.min=(...s)=>t.check(Or(...s)),t.max=(...s)=>t.check(oc(...s)),t.length=(...s)=>t.check(ac(...s)),t.nonempty=(...s)=>t.check(Or(1,...s)),t.lowercase=s=>t.check(Fg(s)),t.uppercase=s=>t.check(Bg(s)),t.trim=()=>t.check(qg()),t.normalize=(...s)=>t.check(Wg(...s)),t.toLowerCase=()=>t.check(Yg()),t.toUpperCase=()=>t.check(Gg())}),v0=I("ZodString",(t,e)=>{vo.init(t,e),lc.init(t,e),t.email=n=>t.check(lg(x0,n)),t.url=n=>t.check(dg(_0,n)),t.jwt=n=>t.check(Ng(D0,n)),t.emoji=n=>t.check(pg(E0,n)),t.guid=n=>t.check(ya(xa,n)),t.uuid=n=>t.check(cg(er,n)),t.uuidv4=n=>t.check(ug(er,n)),t.uuidv6=n=>t.check(fg(er,n)),t.uuidv7=n=>t.check(hg(er,n)),t.nanoid=n=>t.check(mg(S0,n)),t.guid=n=>t.check(ya(xa,n)),t.cuid=n=>t.check(gg(k0,n)),t.cuid2=n=>t.check(yg(T0,n)),t.ulid=n=>t.check(bg(A0,n)),t.base64=n=>t.check(kg(R0,n)),t.base64url=n=>t.check(Tg(P0,n)),t.xid=n=>t.check(wg(N0,n)),t.ksuid=n=>t.check(vg(O0,n)),t.ipv4=n=>t.check(xg(C0,n)),t.ipv6=n=>t.check(_g(I0,n)),t.cidrv4=n=>t.check(Eg(M0,n)),t.cidrv6=n=>t.check(Sg(j0,n)),t.e164=n=>t.check(Ag($0,n)),t.datetime=n=>t.check(e0(n)),t.date=n=>t.check(n0(n)),t.time=n=>t.check(r0(n)),t.duration=n=>t.check(o0(n))});function se(t){return ag(v0,t)}const xe=I("ZodStringFormat",(t,e)=>{we.init(t,e),lc.init(t,e)}),x0=I("ZodEmail",(t,e)=>{fm.init(t,e),xe.init(t,e)}),xa=I("ZodGUID",(t,e)=>{cm.init(t,e),xe.init(t,e)}),er=I("ZodUUID",(t,e)=>{um.init(t,e),xe.init(t,e)}),_0=I("ZodURL",(t,e)=>{hm.init(t,e),xe.init(t,e)}),E0=I("ZodEmoji",(t,e)=>{dm.init(t,e),xe.init(t,e)}),S0=I("ZodNanoID",(t,e)=>{pm.init(t,e),xe.init(t,e)}),k0=I("ZodCUID",(t,e)=>{mm.init(t,e),xe.init(t,e)}),T0=I("ZodCUID2",(t,e)=>{gm.init(t,e),xe.init(t,e)}),A0=I("ZodULID",(t,e)=>{ym.init(t,e),xe.init(t,e)}),N0=I("ZodXID",(t,e)=>{bm.init(t,e),xe.init(t,e)}),O0=I("ZodKSUID",(t,e)=>{wm.init(t,e),xe.init(t,e)}),C0=I("ZodIPv4",(t,e)=>{Sm.init(t,e),xe.init(t,e)}),I0=I("ZodIPv6",(t,e)=>{km.init(t,e),xe.init(t,e)}),M0=I("ZodCIDRv4",(t,e)=>{Tm.init(t,e),xe.init(t,e)}),j0=I("ZodCIDRv6",(t,e)=>{Am.init(t,e),xe.init(t,e)}),R0=I("ZodBase64",(t,e)=>{Nm.init(t,e),xe.init(t,e)}),P0=I("ZodBase64URL",(t,e)=>{Cm.init(t,e),xe.init(t,e)}),$0=I("ZodE164",(t,e)=>{Im.init(t,e),xe.init(t,e)}),D0=I("ZodJWT",(t,e)=>{jm.init(t,e),xe.init(t,e)}),cc=I("ZodNumber",(t,e)=>{sc.init(t,e),ye.init(t,e),t.gt=(s,r)=>t.check(wa(s,r)),t.gte=(s,r)=>t.check(yr(s,r)),t.min=(s,r)=>t.check(yr(s,r)),t.lt=(s,r)=>t.check(ba(s,r)),t.lte=(s,r)=>t.check(gr(s,r)),t.max=(s,r)=>t.check(gr(s,r)),t.int=s=>t.check(_a(s)),t.safe=s=>t.check(_a(s)),t.positive=s=>t.check(wa(0,s)),t.nonnegative=s=>t.check(yr(0,s)),t.negative=s=>t.check(ba(0,s)),t.nonpositive=s=>t.check(gr(0,s)),t.multipleOf=(s,r)=>t.check(va(s,r)),t.step=(s,r)=>t.check(va(s,r)),t.finite=()=>t;const n=t._zod.bag;t.minValue=Math.max(n.minimum??Number.NEGATIVE_INFINITY,n.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,t.maxValue=Math.min(n.maximum??Number.POSITIVE_INFINITY,n.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,t.isInt=(n.format??"").includes("int")||Number.isSafeInteger(n.multipleOf??.5),t.isFinite=!0,t.format=n.format??null});function te(t){return jg(cc,t)}const L0=I("ZodNumberFormat",(t,e)=>{Rm.init(t,e),cc.init(t,e)});function _a(t){return Rg(L0,t)}const z0=I("ZodBoolean",(t,e)=>{Pm.init(t,e),ye.init(t,e)});function kn(t){return Pg(z0,t)}const F0=I("ZodUnknown",(t,e)=>{$m.init(t,e),ye.init(t,e)});function Cr(){return $g(F0)}const B0=I("ZodNever",(t,e)=>{Dm.init(t,e),ye.init(t,e)});function U0(t){return Dg(B0,t)}const Z0=I("ZodDate",(t,e)=>{Lm.init(t,e),ye.init(t,e),t.min=(s,r)=>t.check(yr(s,r)),t.max=(s,r)=>t.check(gr(s,r));const n=t._zod.bag;t.minDate=n.minimum?new Date(n.minimum):null,t.maxDate=n.maximum?new Date(n.maximum):null});function Ea(t){return Lg(Z0,t)}const V0=I("ZodArray",(t,e)=>{zm.init(t,e),ye.init(t,e),t.element=e.element,t.min=(n,s)=>t.check(Or(n,s)),t.nonempty=n=>t.check(Or(1,n)),t.max=(n,s)=>t.check(oc(n,s)),t.length=(n,s)=>t.check(ac(n,s)),t.unwrap=()=>t.element});function es(t,e){return Kg(V0,t,e)}const uc=I("ZodObject",(t,e)=>{Bm.init(t,e),ye.init(t,e),ae(t,"shape",()=>e.shape),t.keyof=()=>H0(Object.keys(t._zod.def.shape)),t.catchall=n=>t.clone({...t._zod.def,catchall:n}),t.passthrough=()=>t.clone({...t._zod.def,catchall:Cr()}),t.loose=()=>t.clone({...t._zod.def,catchall:Cr()}),t.strict=()=>t.clone({...t._zod.def,catchall:U0()}),t.strip=()=>t.clone({...t._zod.def,catchall:void 0}),t.extend=n=>ip(t,n),t.safeExtend=n=>op(t,n),t.merge=n=>ap(t,n),t.pick=n=>sp(t,n),t.omit=n=>rp(t,n),t.partial=(...n)=>lp(hc,t,n[0]),t.required=(...n)=>cp(dc,t,n[0])});function _n(t,e){const n={type:"object",shape:t??{},...B(e)};return new uc(n)}function rn(t,e){return new uc({type:"object",shape:t,catchall:Cr(),...B(e)})}const W0=I("ZodUnion",(t,e)=>{Um.init(t,e),ye.init(t,e),t.options=e.options});function fc(t,e){return new W0({type:"union",options:t,...B(e)})}const q0=I("ZodIntersection",(t,e)=>{Zm.init(t,e),ye.init(t,e)});function Y0(t,e){return new q0({type:"intersection",left:t,right:e})}const G0=I("ZodTuple",(t,e)=>{Vm.init(t,e),ye.init(t,e),t.rest=n=>t.clone({...t._zod.def,rest:n})});function Sa(t,e,n){const s=e instanceof fe,r=s?n:e,i=s?e:null;return new G0({type:"tuple",items:t,rest:i,...B(r)})}const K0=I("ZodRecord",(t,e)=>{Wm.init(t,e),ye.init(t,e),t.keyType=e.keyType,t.valueType=e.valueType});function on(t,e,n){return new K0({type:"record",keyType:t,valueType:e,...B(n)})}const Zi=I("ZodEnum",(t,e)=>{qm.init(t,e),ye.init(t,e),t.enum=e.entries,t.options=Object.values(e.entries);const n=new Set(Object.keys(e.entries));t.extract=(s,r)=>{const i={};for(const o of s)if(n.has(o))i[o]=e.entries[o];else throw new Error(`Key ${o} not found in enum`);return new Zi({...e,checks:[],...B(r),entries:i})},t.exclude=(s,r)=>{const i={...e.entries};for(const o of s)if(n.has(o))delete i[o];else throw new Error(`Key ${o} not found in enum`);return new Zi({...e,checks:[],...B(r),entries:i})}});function H0(t,e){const n=Array.isArray(t)?Object.fromEntries(t.map(s=>[s,s])):t;return new Zi({type:"enum",entries:n,...B(e)})}const X0=I("ZodLiteral",(t,e)=>{Ym.init(t,e),ye.init(t,e),t.values=new Set(e.values),Object.defineProperty(t,"value",{get(){if(e.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return e.values[0]}})});function ka(t,e){return new X0({type:"literal",values:Array.isArray(t)?t:[t],...B(e)})}const Q0=I("ZodTransform",(t,e)=>{Gm.init(t,e),ye.init(t,e),t._zod.parse=(n,s)=>{if(s.direction==="backward")throw new Zl(t.constructor.name);n.addIssue=i=>{if(typeof i=="string")n.issues.push(Ts(i,n.value,e));else{const o=i;o.fatal&&(o.continue=!1),o.code??(o.code="custom"),o.input??(o.input=n.value),o.inst??(o.inst=t),n.issues.push(Ts(o))}};const r=e.transform(n.value,n);return r instanceof Promise?r.then(i=>(n.value=i,n)):(n.value=r,n)}});function J0(t){return new Q0({type:"transform",transform:t})}const hc=I("ZodOptional",(t,e)=>{Km.init(t,e),ye.init(t,e),t.unwrap=()=>t._zod.def.innerType});function Ta(t){return new hc({type:"optional",innerType:t})}const e1=I("ZodNullable",(t,e)=>{Hm.init(t,e),ye.init(t,e),t.unwrap=()=>t._zod.def.innerType});function Aa(t){return new e1({type:"nullable",innerType:t})}const t1=I("ZodDefault",(t,e)=>{Xm.init(t,e),ye.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeDefault=t.unwrap});function n1(t,e){return new t1({type:"default",innerType:t,get defaultValue(){return typeof e=="function"?e():ql(e)}})}const s1=I("ZodPrefault",(t,e)=>{Qm.init(t,e),ye.init(t,e),t.unwrap=()=>t._zod.def.innerType});function r1(t,e){return new s1({type:"prefault",innerType:t,get defaultValue(){return typeof e=="function"?e():ql(e)}})}const dc=I("ZodNonOptional",(t,e)=>{Jm.init(t,e),ye.init(t,e),t.unwrap=()=>t._zod.def.innerType});function i1(t,e){return new dc({type:"nonoptional",innerType:t,...B(e)})}const o1=I("ZodCatch",(t,e)=>{eg.init(t,e),ye.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeCatch=t.unwrap});function a1(t,e){return new o1({type:"catch",innerType:t,catchValue:typeof e=="function"?e:()=>e})}const l1=I("ZodPipe",(t,e)=>{tg.init(t,e),ye.init(t,e),t.in=e.in,t.out=e.out});function Na(t,e){return new l1({type:"pipe",in:t,out:e})}const c1=I("ZodReadonly",(t,e)=>{ng.init(t,e),ye.init(t,e),t.unwrap=()=>t._zod.def.innerType});function u1(t){return new c1({type:"readonly",innerType:t})}const f1=I("ZodLazy",(t,e)=>{sg.init(t,e),ye.init(t,e),t.unwrap=()=>t._zod.def.getter()});function h1(t){return new f1({type:"lazy",getter:t})}const d1=I("ZodCustom",(t,e)=>{rg.init(t,e),ye.init(t,e)});function p1(t,e={}){return Hg(d1,t,e)}function m1(t){return Xg(t)}const g1=_n({schemaVersion:te().min(0).default(0),projectName:se(),createdAt:Ea().optional().nullable(),lastModifiedAt:Ea().optional().nullable(),orbitControls:_n({position:Sa([te(),te(),te()]),target:Sa([te(),te(),te()]),zoom:te().optional()}).optional()}),pc=rn({transform:se().optional(),posX:te(),posY:te(),posZ:te(),rotX:te(),rotY:te(),rotZ:te(),sizeX:te().optional(),sizeY:te().optional(),sizeZ:te().optional(),anchor:se().optional()}),y1=rn({enabled:kn()}),mc=fc([rn({"==":ka("org.bukkit.inventory.ItemStack"),DataVersion:te(),id:se(),count:te(),components:on(se(),se()).transform(t=>{const e={};for(const[n,s]of Object.entries(t))try{e[n]=gh.parseSNBT(s).toJSON()}catch{e[n]=s}return e}).optional(),schema_version:te()}),rn({"==":ka("org.bukkit.inventory.ItemStack"),DataVersion:te(),id:se(),count:te(),components:on(se(),Cr()).optional(),schema_version:te()})]),gc=h1(()=>_n({type:se(),item:mc.optional(),position:pc,attachments:on(se(),gc).optional(),displayItem:y1.optional(),shulkerColor:se().optional(),schematic:se().optional(),displayMode:se().optional(),firstPersonViewMode:se().optional(),firstPersonViewLockMode:se().optional(),lockRotation:kn().optional(),names:es(se()).optional(),text:se().optional(),animations:on(se(),rn({nodes:es(se()),looped:kn().optional(),speed:te().optional()})).optional(),brightness:_n({block:te(),sky:te()}).optional()})),b1=rn({type:se(),entityType:se(),attachments:on(se(),gc),position:pc.optional(),item:mc.optional(),shulkerColor:se().optional(),editor:_n({selectedIndex:te().optional(),animNodeSelectedOption:te().optional(),scrollOffset:te().optional(),expanded:kn().optional()}).passthrough().optional(),animations:on(se(),_n({nodes:es(se()),looped:kn().optional(),speed:te().optional()}).passthrough()).optional(),physical:_n({cartLength:te().optional(),wheelCenter:te().optional(),wheelDistance:te().optional(),cartCouplerLength:te().optional()}).passthrough().optional()}),yc=rn({model:b1.optional(),entityType:se(),flipped:kn().optional()}),w1=rn({savedName:se(),name:se().optional(),carts:on(se(),yc).optional(),claims:es(se()).optional(),spawnPattern:se().optional(),flipped:kn().optional(),spawnLimit:te().optional(),usedModels:es(se()).optional()}),bc=on(se(),w1);function v1(t){const e=bc.safeParse(t);return e.success?{valid:!0}:{valid:!1,errors:e.error.issues.map(n=>`${n.path.join(".")}: ${n.message}`)}}class x1{constructor(){this.keyToValue=new Map,this.valueToKey=new Map}set(e,n){this.keyToValue.set(e,n),this.valueToKey.set(n,e)}getByKey(e){return this.keyToValue.get(e)}getByValue(e){return this.valueToKey.get(e)}clear(){this.keyToValue.clear(),this.valueToKey.clear()}}class wc{constructor(e){this.generateIdentifier=e,this.kv=new x1}register(e,n){this.kv.getByValue(e)||(n||(n=this.generateIdentifier(e)),this.kv.set(n,e))}clear(){this.kv.clear()}getIdentifier(e){return this.kv.getByValue(e)}getValue(e){return this.kv.getByKey(e)}}class _1 extends wc{constructor(){super(e=>e.name),this.classToAllowedProps=new Map}register(e,n){typeof n=="object"?(n.allowProps&&this.classToAllowedProps.set(e,n.allowProps),super.register(e,n.identifier)):super.register(e,n)}getAllowedProps(e){return this.classToAllowedProps.get(e)}}function E1(t){if("values"in Object)return Object.values(t);const e=[];for(const n in t)t.hasOwnProperty(n)&&e.push(t[n]);return e}function S1(t,e){const n=E1(t);if("find"in n)return n.find(e);const s=n;for(let r=0;r<s.length;r++){const i=s[r];if(e(i))return i}}function ts(t,e){Object.entries(t).forEach(([n,s])=>e(s,n))}function br(t,e){return t.indexOf(e)!==-1}function Oa(t,e){for(let n=0;n<t.length;n++){const s=t[n];if(e(s))return s}}class k1{constructor(){this.transfomers={}}register(e){this.transfomers[e.name]=e}findApplicable(e){return S1(this.transfomers,n=>n.isApplicable(e))}findByName(e){return this.transfomers[e]}}const T1=t=>Object.prototype.toString.call(t).slice(8,-1),vc=t=>typeof t>"u",A1=t=>t===null,As=t=>typeof t!="object"||t===null||t===Object.prototype?!1:Object.getPrototypeOf(t)===null?!0:Object.getPrototypeOf(t)===Object.prototype,Vi=t=>As(t)&&Object.keys(t).length===0,an=t=>Array.isArray(t),N1=t=>typeof t=="string",O1=t=>typeof t=="number"&&!isNaN(t),C1=t=>typeof t=="boolean",I1=t=>t instanceof RegExp,Ns=t=>t instanceof Map,Os=t=>t instanceof Set,xc=t=>T1(t)==="Symbol",M1=t=>t instanceof Date&&!isNaN(t.valueOf()),j1=t=>t instanceof Error,Ca=t=>typeof t=="number"&&isNaN(t),R1=t=>C1(t)||A1(t)||vc(t)||O1(t)||N1(t)||xc(t),P1=t=>typeof t=="bigint",$1=t=>t===1/0||t===-1/0,D1=t=>ArrayBuffer.isView(t)&&!(t instanceof DataView),L1=t=>t instanceof URL,_c=t=>t.replace(/\./g,"\\."),di=t=>t.map(String).map(_c).join("."),ws=t=>{const e=[];let n="";for(let r=0;r<t.length;r++){let i=t.charAt(r);if(i==="\\"&&t.charAt(r+1)==="."){n+=".",r++;continue}if(i==="."){e.push(n),n="";continue}n+=i}const s=n;return e.push(s),e};function Tt(t,e,n,s){return{isApplicable:t,annotation:e,transform:n,untransform:s}}const Ec=[Tt(vc,"undefined",()=>null,()=>{}),Tt(P1,"bigint",t=>t.toString(),t=>typeof BigInt<"u"?BigInt(t):(console.error("Please add a BigInt polyfill."),t)),Tt(M1,"Date",t=>t.toISOString(),t=>new Date(t)),Tt(j1,"Error",(t,e)=>{const n={name:t.name,message:t.message};return e.allowedErrorProps.forEach(s=>{n[s]=t[s]}),n},(t,e)=>{const n=new Error(t.message);return n.name=t.name,n.stack=t.stack,e.allowedErrorProps.forEach(s=>{n[s]=t[s]}),n}),Tt(I1,"regexp",t=>""+t,t=>{const e=t.slice(1,t.lastIndexOf("/")),n=t.slice(t.lastIndexOf("/")+1);return new RegExp(e,n)}),Tt(Os,"set",t=>[...t.values()],t=>new Set(t)),Tt(Ns,"map",t=>[...t.entries()],t=>new Map(t)),Tt(t=>Ca(t)||$1(t),"number",t=>Ca(t)?"NaN":t>0?"Infinity":"-Infinity",Number),Tt(t=>t===0&&1/t===-1/0,"number",()=>"-0",Number),Tt(L1,"URL",t=>t.toString(),t=>new URL(t))];function Wr(t,e,n,s){return{isApplicable:t,annotation:e,transform:n,untransform:s}}const Sc=Wr((t,e)=>xc(t)?!!e.symbolRegistry.getIdentifier(t):!1,(t,e)=>["symbol",e.symbolRegistry.getIdentifier(t)],t=>t.description,(t,e,n)=>{const s=n.symbolRegistry.getValue(e[1]);if(!s)throw new Error("Trying to deserialize unknown symbol");return s}),z1=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,Uint8ClampedArray].reduce((t,e)=>(t[e.name]=e,t),{}),kc=Wr(D1,t=>["typed-array",t.constructor.name],t=>[...t],(t,e)=>{const n=z1[e[1]];if(!n)throw new Error("Trying to deserialize unknown typed array");return new n(t)});function Tc(t,e){return t?.constructor?!!e.classRegistry.getIdentifier(t.constructor):!1}const Ac=Wr(Tc,(t,e)=>["class",e.classRegistry.getIdentifier(t.constructor)],(t,e)=>{const n=e.classRegistry.getAllowedProps(t.constructor);if(!n)return{...t};const s={};return n.forEach(r=>{s[r]=t[r]}),s},(t,e,n)=>{const s=n.classRegistry.getValue(e[1]);if(!s)throw new Error(`Trying to deserialize unknown class '${e[1]}' - check https://github.com/blitz-js/superjson/issues/116#issuecomment-773996564`);return Object.assign(Object.create(s.prototype),t)}),Nc=Wr((t,e)=>!!e.customTransformerRegistry.findApplicable(t),(t,e)=>["custom",e.customTransformerRegistry.findApplicable(t).name],(t,e)=>e.customTransformerRegistry.findApplicable(t).serialize(t),(t,e,n)=>{const s=n.customTransformerRegistry.findByName(e[1]);if(!s)throw new Error("Trying to deserialize unknown custom value");return s.deserialize(t)}),F1=[Ac,Sc,Nc,kc],Ia=(t,e)=>{const n=Oa(F1,r=>r.isApplicable(t,e));if(n)return{value:n.transform(t,e),type:n.annotation(t,e)};const s=Oa(Ec,r=>r.isApplicable(t,e));if(s)return{value:s.transform(t,e),type:s.annotation}},Oc={};Ec.forEach(t=>{Oc[t.annotation]=t});const B1=(t,e,n)=>{if(an(e))switch(e[0]){case"symbol":return Sc.untransform(t,e,n);case"class":return Ac.untransform(t,e,n);case"custom":return Nc.untransform(t,e,n);case"typed-array":return kc.untransform(t,e,n);default:throw new Error("Unknown transformation: "+e)}else{const s=Oc[e];if(!s)throw new Error("Unknown transformation: "+e);return s.untransform(t,n)}},Bn=(t,e)=>{if(e>t.size)throw new Error("index out of bounds");const n=t.keys();for(;e>0;)n.next(),e--;return n.next().value};function Cc(t){if(br(t,"__proto__"))throw new Error("__proto__ is not allowed as a property");if(br(t,"prototype"))throw new Error("prototype is not allowed as a property");if(br(t,"constructor"))throw new Error("constructor is not allowed as a property")}const U1=(t,e)=>{Cc(e);for(let n=0;n<e.length;n++){const s=e[n];if(Os(t))t=Bn(t,+s);else if(Ns(t)){const r=+s,i=+e[++n]==0?"key":"value",o=Bn(t,r);switch(i){case"key":t=o;break;case"value":t=t.get(o);break}}else t=t[s]}return t},Wi=(t,e,n)=>{if(Cc(e),e.length===0)return n(t);let s=t;for(let i=0;i<e.length-1;i++){const o=e[i];if(an(s)){const a=+o;s=s[a]}else if(As(s))s=s[o];else if(Os(s)){const a=+o;s=Bn(s,a)}else if(Ns(s)){if(i===e.length-2)break;const l=+o,c=+e[++i]==0?"key":"value",u=Bn(s,l);switch(c){case"key":s=u;break;case"value":s=s.get(u);break}}}const r=e[e.length-1];if(an(s)?s[+r]=n(s[+r]):As(s)&&(s[r]=n(s[r])),Os(s)){const i=Bn(s,+r),o=n(i);i!==o&&(s.delete(i),s.add(o))}if(Ns(s)){const i=+e[e.length-2],o=Bn(s,i);switch(+r==0?"key":"value"){case"key":{const l=n(o);s.set(l,s.get(o)),l!==o&&s.delete(o);break}case"value":{s.set(o,n(s.get(o)));break}}}return t};function qi(t,e,n=[]){if(!t)return;if(!an(t)){ts(t,(i,o)=>qi(i,e,[...n,...ws(o)]));return}const[s,r]=t;r&&ts(r,(i,o)=>{qi(i,e,[...n,...ws(o)])}),e(s,n)}function Z1(t,e,n){return qi(e,(s,r)=>{t=Wi(t,r,i=>B1(i,s,n))}),t}function V1(t,e){function n(s,r){const i=U1(t,ws(r));s.map(ws).forEach(o=>{t=Wi(t,o,()=>i)})}if(an(e)){const[s,r]=e;s.forEach(i=>{t=Wi(t,ws(i),()=>t)}),r&&ts(r,n)}else ts(e,n);return t}const W1=(t,e)=>As(t)||an(t)||Ns(t)||Os(t)||Tc(t,e);function q1(t,e,n){const s=n.get(t);s?s.push(e):n.set(t,[e])}function Y1(t,e){const n={};let s;return t.forEach(r=>{if(r.length<=1)return;e||(r=r.map(a=>a.map(String)).sort((a,l)=>a.length-l.length));const[i,...o]=r;i.length===0?s=o.map(di):n[di(i)]=o.map(di)}),s?Vi(n)?[s]:[s,n]:Vi(n)?void 0:n}const Ic=(t,e,n,s,r=[],i=[],o=new Map)=>{const a=R1(t);if(!a){q1(t,r,e);const p=o.get(t);if(p)return s?{transformedValue:null}:p}if(!W1(t,n)){const p=Ia(t,n),y=p?{transformedValue:p.value,annotations:[p.type]}:{transformedValue:t};return a||o.set(t,y),y}if(br(i,t))return{transformedValue:null};const l=Ia(t,n),c=l?.value??t,u=an(c)?[]:{},f={};ts(c,(p,y)=>{if(y==="__proto__"||y==="constructor"||y==="prototype")throw new Error(`Detected property ${y}. This is a prototype pollution risk, please remove it from your object.`);const g=Ic(p,e,n,s,[...r,y],[...i,t],o);u[y]=g.transformedValue,an(g.annotations)?f[y]=g.annotations:As(g.annotations)&&ts(g.annotations,(w,m)=>{f[_c(y)+"."+m]=w})});const h=Vi(f)?{transformedValue:u,annotations:l?[l.type]:void 0}:{transformedValue:u,annotations:l?[l.type,f]:f};return a||o.set(t,h),h};function Mc(t){return Object.prototype.toString.call(t).slice(8,-1)}function Ma(t){return Mc(t)==="Array"}function G1(t){if(Mc(t)!=="Object")return!1;const e=Object.getPrototypeOf(t);return!!e&&e.constructor===Object&&e===Object.prototype}function K1(t,e,n,s,r){const i={}.propertyIsEnumerable.call(s,e)?"enumerable":"nonenumerable";i==="enumerable"&&(t[e]=n),r&&i==="nonenumerable"&&Object.defineProperty(t,e,{value:n,enumerable:!1,writable:!0,configurable:!0})}function Yi(t,e={}){if(Ma(t))return t.map(r=>Yi(r,e));if(!G1(t))return t;const n=Object.getOwnPropertyNames(t),s=Object.getOwnPropertySymbols(t);return[...n,...s].reduce((r,i)=>{if(Ma(e.props)&&!e.props.includes(i))return r;const o=t[i],a=Yi(o,e);return K1(r,i,a,t,e.nonenumerable),r},{})}class X{constructor({dedupe:e=!1}={}){this.classRegistry=new _1,this.symbolRegistry=new wc(n=>n.description??""),this.customTransformerRegistry=new k1,this.allowedErrorProps=[],this.dedupe=e}serialize(e){const n=new Map,s=Ic(e,n,this,this.dedupe),r={json:s.transformedValue};s.annotations&&(r.meta={...r.meta,values:s.annotations});const i=Y1(n,this.dedupe);return i&&(r.meta={...r.meta,referentialEqualities:i}),r}deserialize(e){const{json:n,meta:s}=e;let r=Yi(n);return s?.values&&(r=Z1(r,s.values,this)),s?.referentialEqualities&&(r=V1(r,s.referentialEqualities)),r}stringify(e){return JSON.stringify(this.serialize(e))}parse(e){return this.deserialize(JSON.parse(e))}registerClass(e,n){this.classRegistry.register(e,n)}registerSymbol(e,n){this.symbolRegistry.register(e,n)}registerCustom(e,n){this.customTransformerRegistry.register({name:n,...e})}allowErrorProps(...e){this.allowedErrorProps.push(...e)}}X.defaultInstance=new X;X.serialize=X.defaultInstance.serialize.bind(X.defaultInstance);X.deserialize=X.defaultInstance.deserialize.bind(X.defaultInstance);X.stringify=X.defaultInstance.stringify.bind(X.defaultInstance);X.parse=X.defaultInstance.parse.bind(X.defaultInstance);X.registerClass=X.defaultInstance.registerClass.bind(X.defaultInstance);X.registerSymbol=X.defaultInstance.registerSymbol.bind(X.defaultInstance);X.registerCustom=X.defaultInstance.registerCustom.bind(X.defaultInstance);X.allowErrorProps=X.defaultInstance.allowErrorProps.bind(X.defaultInstance);X.serialize;X.deserialize;X.stringify;X.parse;X.registerClass;X.registerCustom;X.registerSymbol;X.allowErrorProps;class jc{constructor(){this._listeners={}}addEventListener(e,n){const s=this._listeners;return s[e]===void 0&&(s[e]=[]),s[e].indexOf(n)===-1&&s[e].push(n),this}removeEventListener(e,n){const r=this._listeners[e];if(r!==void 0){const i=r.indexOf(n);i!==-1&&r.splice(i,1)}return this}dispatchEvent(e){const s=this._listeners[e.type];if(s!==void 0){const r=s.slice(0);for(let i=0,o=r.length;i<o;i++)r[i].call(this,e)}return this}dispose(){for(const e in this._listeners)delete this._listeners[e]}}class Un{constructor(e,n,s,r={}){if(this._name=void 0,this._parent=void 0,this._child=void 0,this._attributes=void 0,this._disposed=!1,this._name=e,this._parent=n,this._child=s,this._attributes=r,!n.isOnGraph(s))throw new Error("Cannot connect disconnected graphs.")}getName(){return this._name}getParent(){return this._parent}getChild(){return this._child}setChild(e){return this._child=e,this}getAttributes(){return this._attributes}dispose(){this._disposed||(this._parent._destroyRef(this),this._disposed=!0)}isDisposed(){return this._disposed}}class H1 extends jc{constructor(...e){super(...e),this._emptySet=new Set,this._edges=new Set,this._parentEdges=new Map,this._childEdges=new Map}listEdges(){return Array.from(this._edges)}listParentEdges(e){return Array.from(this._childEdges.get(e)||this._emptySet)}listParents(e){const n=new Set;for(const s of this.listParentEdges(e))n.add(s.getParent());return Array.from(n)}listChildEdges(e){return Array.from(this._parentEdges.get(e)||this._emptySet)}listChildren(e){const n=new Set;for(const s of this.listChildEdges(e))n.add(s.getChild());return Array.from(n)}disconnectParents(e,n){for(const s of this.listParentEdges(e))(!n||n(s.getParent()))&&s.dispose();return this}_createEdge(e,n,s,r){const i=new Un(e,n,s,r);this._edges.add(i);const o=i.getParent();this._parentEdges.has(o)||this._parentEdges.set(o,new Set),this._parentEdges.get(o).add(i);const a=i.getChild();return this._childEdges.has(a)||this._childEdges.set(a,new Set),this._childEdges.get(a).add(i),i}_destroyEdge(e){return this._edges.delete(e),this._parentEdges.get(e.getParent()).delete(e),this._childEdges.get(e.getChild()).delete(e),this}}function vs(){return vs=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},vs.apply(this,arguments)}class Xt{constructor(e){if(this.list=[],e)for(const n of e)this.list.push(n)}add(e){this.list.push(e)}remove(e){const n=this.list.indexOf(e);n>=0&&this.list.splice(n,1)}removeChild(e){const n=[];for(const s of this.list)s.getChild()===e&&n.push(s);for(const s of n)this.remove(s);return n}listRefsByChild(e){const n=[];for(const s of this.list)s.getChild()===e&&n.push(s);return n}values(){return this.list}}class be{constructor(e){if(this.set=new Set,this.map=new Map,e)for(const n of e)this.add(n)}add(e){const n=e.getChild();this.removeChild(n),this.set.add(e),this.map.set(n,e)}remove(e){this.set.delete(e),this.map.delete(e.getChild())}removeChild(e){const n=this.map.get(e)||null;return n&&this.remove(n),n}getRefByChild(e){return this.map.get(e)||null}values(){return Array.from(this.set)}}class Nt{constructor(e){this.map={},e&&Object.assign(this.map,e)}set(e,n){this.map[e]=n}delete(e){delete this.map[e]}get(e){return this.map[e]||null}keys(){return Object.keys(this.map)}values(){return Object.values(this.map)}}const oe=Symbol("attributes"),gn=Symbol("immutableKeys");class xo extends jc{constructor(e){super(),this._disposed=!1,this.graph=void 0,this[oe]=void 0,this[gn]=void 0,this.graph=e,this[gn]=new Set,this[oe]=this._createAttributes()}getDefaults(){return{}}_createAttributes(){const e=this.getDefaults(),n={};for(const s in e){const r=e[s];if(r instanceof xo){const i=this.graph._createEdge(s,this,r);this[gn].add(s),n[s]=i}else n[s]=r}return n}isOnGraph(e){return this.graph===e.graph}isDisposed(){return this._disposed}dispose(){this._disposed||(this.graph.listChildEdges(this).forEach(e=>e.dispose()),this.graph.disconnectParents(this),this._disposed=!0,this.dispatchEvent({type:"dispose"}))}detach(){return this.graph.disconnectParents(this),this}swap(e,n){for(const s in this[oe]){const r=this[oe][s];if(r instanceof Un){const i=r;i.getChild()===e&&this.setRef(s,n,i.getAttributes())}else if(r instanceof Xt)for(const i of r.listRefsByChild(e)){const o=i.getAttributes();this.removeRef(s,e),this.addRef(s,n,o)}else if(r instanceof be){const i=r.getRefByChild(e);if(i){const o=i.getAttributes();this.removeRef(s,e),this.addRef(s,n,o)}}else if(r instanceof Nt)for(const i of r.keys()){const o=r.get(i);o.getChild()===e&&this.setRefMap(s,i,n,o.getAttributes())}}return this}get(e){return this[oe][e]}set(e,n){return this[oe][e]=n,this.dispatchEvent({type:"change",attribute:e})}getRef(e){const n=this[oe][e];return n?n.getChild():null}setRef(e,n,s){if(this[gn].has(e))throw new Error(`Cannot overwrite immutable attribute, "${e}".`);const r=this[oe][e];if(r&&r.dispose(),!n)return this;const i=this.graph._createEdge(e,this,n,s);return this[oe][e]=i,this.dispatchEvent({type:"change",attribute:e})}listRefs(e){return this.assertRefList(e).values().map(s=>s.getChild())}addRef(e,n,s){const r=this.graph._createEdge(e,this,n,s);return this.assertRefList(e).add(r),this.dispatchEvent({type:"change",attribute:e})}removeRef(e,n){const s=this.assertRefList(e);if(s instanceof Xt)for(const r of s.listRefsByChild(n))r.dispose();else{const r=s.getRefByChild(n);r&&r.dispose()}return this}assertRefList(e){const n=this[oe][e];if(n instanceof Xt||n instanceof be)return n;throw new Error(`Expected RefList or RefSet for attribute "${e}"`)}listRefMapKeys(e){return this.assertRefMap(e).keys()}listRefMapValues(e){return this.assertRefMap(e).values().map(n=>n.getChild())}getRefMap(e,n){const r=this.assertRefMap(e).get(n);return r?r.getChild():null}setRefMap(e,n,s,r){const i=this.assertRefMap(e),o=i.get(n);if(o&&o.dispose(),!s)return this;r=Object.assign(r||{},{key:n});const a=this.graph._createEdge(e,this,s,vs({},r,{key:n}));return i.set(n,a),this.dispatchEvent({type:"change",attribute:e,key:n})}assertRefMap(e){const n=this[oe][e];if(n instanceof Nt)return n;throw new Error(`Expected RefMap for attribute "${e}"`)}dispatchEvent(e){return super.dispatchEvent(vs({},e,{target:this})),this.graph.dispatchEvent(vs({},e,{target:this,type:`node:${e.type}`})),this}_destroyRef(e){const n=e.getName();if(this[oe][n]===e)this[oe][n]=null,this[gn].has(n)&&e.getChild().dispose();else if(this[oe][n]instanceof Xt)this[oe][n].remove(e);else if(this[oe][n]instanceof be)this[oe][n].remove(e);else if(this[oe][n]instanceof Nt){const s=this[oe][n];for(const r of s.keys())s.get(r)===e&&s.delete(r)}else return;this.graph._destroyEdge(e),this.dispatchEvent({type:"change",attribute:n})}}const Rc="v4.2.1",Ir="@glb.bin";var Z;(function(t){t.ACCESSOR="Accessor",t.ANIMATION="Animation",t.ANIMATION_CHANNEL="AnimationChannel",t.ANIMATION_SAMPLER="AnimationSampler",t.BUFFER="Buffer",t.CAMERA="Camera",t.MATERIAL="Material",t.MESH="Mesh",t.PRIMITIVE="Primitive",t.PRIMITIVE_TARGET="PrimitiveTarget",t.NODE="Node",t.ROOT="Root",t.SCENE="Scene",t.SKIN="Skin",t.TEXTURE="Texture",t.TEXTURE_INFO="TextureInfo"})(Z||(Z={}));var Mr;(function(t){t.INTERLEAVED="interleaved",t.SEPARATE="separate"})(Mr||(Mr={}));var st;(function(t){t.ARRAY_BUFFER="ARRAY_BUFFER",t.ELEMENT_ARRAY_BUFFER="ELEMENT_ARRAY_BUFFER",t.INVERSE_BIND_MATRICES="INVERSE_BIND_MATRICES",t.OTHER="OTHER",t.SPARSE="SPARSE"})(st||(st={}));var Gi;(function(t){t[t.R=4096]="R",t[t.G=256]="G",t[t.B=16]="B",t[t.A=1]="A"})(Gi||(Gi={}));var Jt;(function(t){t.GLTF="GLTF",t.GLB="GLB"})(Jt||(Jt={}));const qr={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};class ie{static createBufferFromDataURI(e){if(typeof Buffer>"u"){const n=atob(e.split(",")[1]),s=new Uint8Array(n.length);for(let r=0;r<n.length;r++)s[r]=n.charCodeAt(r);return s}else{const n=e.split(",")[1],s=e.indexOf("base64")>=0;return Buffer.from(n,s?"base64":"utf8")}}static encodeText(e){return new TextEncoder().encode(e)}static decodeText(e){return new TextDecoder().decode(e)}static concat(e){let n=0;for(const i of e)n+=i.byteLength;const s=new Uint8Array(n);let r=0;for(const i of e)s.set(i,r),r+=i.byteLength;return s}static pad(e,n=0){const s=this.padNumber(e.byteLength);if(s===e.byteLength)return e;const r=new Uint8Array(s);if(r.set(e),n!==0)for(let i=e.byteLength;i<s;i++)r[i]=n;return r}static padNumber(e){return Math.ceil(e/4)*4}static equals(e,n){if(e===n)return!0;if(e.byteLength!==n.byteLength)return!1;let s=e.byteLength;for(;s--;)if(e[s]!==n[s])return!1;return!0}static toView(e,n=0,s=1/0){return new Uint8Array(e.buffer,e.byteOffset+n,Math.min(e.byteLength,s))}static assertView(e){if(e&&!ArrayBuffer.isView(e))throw new Error(`Method requires Uint8Array parameter; received "${typeof e}".`);return e}}class X1{match(e){return e.length>=3&&e[0]===255&&e[1]===216&&e[2]===255}getSize(e){let n=new DataView(e.buffer,e.byteOffset+4),s,r;for(;n.byteLength;){if(s=n.getUint16(0,!1),Q1(n,s),r=n.getUint8(s+1),r===192||r===193||r===194)return[n.getUint16(s+7,!1),n.getUint16(s+5,!1)];n=new DataView(e.buffer,n.byteOffset+s+2)}throw new TypeError("Invalid JPG, no size found")}getChannels(e){return 3}}class Yr{match(e){return e.length>=8&&e[0]===137&&e[1]===80&&e[2]===78&&e[3]===71&&e[4]===13&&e[5]===10&&e[6]===26&&e[7]===10}getSize(e){const n=new DataView(e.buffer,e.byteOffset);return ie.decodeText(e.slice(12,16))===Yr.PNG_FRIED_CHUNK_NAME?[n.getUint32(32,!1),n.getUint32(36,!1)]:[n.getUint32(16,!1),n.getUint32(20,!1)]}getChannels(e){return 4}}Yr.PNG_FRIED_CHUNK_NAME="CgBI";class En{static registerFormat(e,n){this.impls[e]=n}static getMimeType(e){for(const n in this.impls)if(this.impls[n].match(e))return n;return null}static getSize(e,n){return this.impls[n]?this.impls[n].getSize(e):null}static getChannels(e,n){return this.impls[n]?this.impls[n].getChannels(e):null}static getVRAMByteLength(e,n){if(!this.impls[n])return null;if(this.impls[n].getVRAMByteLength)return this.impls[n].getVRAMByteLength(e);let s=0;const r=4,i=this.getSize(e,n);if(!i)return null;for(;i[0]>1||i[1]>1;)s+=i[0]*i[1]*r,i[0]=Math.max(Math.floor(i[0]/2),1),i[1]=Math.max(Math.floor(i[1]/2),1);return s+=1*r,s}static mimeTypeToExtension(e){return e==="image/jpeg"?"jpg":e.split("/").pop()}static extensionToMimeType(e){return e==="jpg"?"image/jpeg":e?`image/${e}`:""}}En.impls={"image/jpeg":new X1,"image/png":new Yr};function Q1(t,e){if(e>t.byteLength)throw new TypeError("Corrupt JPG, exceeded buffer limits");if(t.getUint8(e)!==255)throw new TypeError("Invalid JPG, marker table corrupted");return t}class ns{static basename(e){const n=e.split(/[\\/]/).pop();return n.substring(0,n.lastIndexOf("."))}static extension(e){if(e.startsWith("data:image/")){const n=e.match(/data:(image\/\w+)/)[1];return En.mimeTypeToExtension(n)}else{if(e.startsWith("data:model/gltf+json"))return"gltf";if(e.startsWith("data:model/gltf-binary"))return"glb";if(e.startsWith("data:application/"))return"bin"}return e.split(/[\\/]/).pop().split(/[.]/).pop()}}var Ki=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function J1(){var t=new Ki(3);return Ki!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function pi(t){var e=t[0],n=t[1],s=t[2];return Math.hypot(e,n,s)}(function(){var t=J1();return function(e,n,s,r,i,o){var a,l;for(n||(n=3),s||(s=0),r?l=Math.min(r*n+s,e.length):l=e.length,a=s;a<l;a+=n)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],i(t,t,o),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2];return e}})();const ja="https://null.example";class xs{static dirname(e){const n=e.lastIndexOf("/");return n===-1?"./":e.substring(0,n+1)}static basename(e){return ns.basename(new URL(e,ja).pathname)}static extension(e){return ns.extension(new URL(e,ja).pathname)}static resolve(e,n){if(!this.isRelativePath(n))return n;const s=e.split("/"),r=n.split("/");s.pop();for(let i=0;i<r.length;i++)r[i]!=="."&&(r[i]===".."?s.pop():s.push(r[i]));return s.join("/")}static isAbsoluteURL(e){return this.PROTOCOL_REGEXP.test(e)}static isRelativePath(e){return!/^(?:[a-zA-Z]+:)?\//.test(e)}}xs.DEFAULT_INIT={};xs.PROTOCOL_REGEXP=/^[a-zA-Z]+:\/\//;function Ra(t){return Object.prototype.toString.call(t)==="[object Object]"}function wn(t){if(Ra(t)===!1)return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(Ra(n)===!1||Object.hasOwn(n,"isPrototypeOf")===!1)}var Hi,Xi;(function(t){t[t.SILENT=4]="SILENT",t[t.ERROR=3]="ERROR",t[t.WARN=2]="WARN",t[t.INFO=1]="INFO",t[t.DEBUG=0]="DEBUG"})(Xi||(Xi={}));class it{constructor(e){this.verbosity=void 0,this.verbosity=e}debug(e){this.verbosity<=it.Verbosity.DEBUG&&console.debug(e)}info(e){this.verbosity<=it.Verbosity.INFO&&console.info(e)}warn(e){this.verbosity<=it.Verbosity.WARN&&console.warn(e)}error(e){this.verbosity<=it.Verbosity.ERROR&&console.error(e)}}Hi=it;it.Verbosity=Xi;it.DEFAULT_INSTANCE=new Hi(Hi.Verbosity.INFO);function ey(t){var e=t[0],n=t[1],s=t[2],r=t[3],i=t[4],o=t[5],a=t[6],l=t[7],c=t[8],u=t[9],f=t[10],h=t[11],p=t[12],y=t[13],g=t[14],w=t[15],m=e*o-n*i,S=e*a-s*i,x=e*l-r*i,_=n*a-s*o,E=n*l-r*o,k=s*l-r*a,b=c*y-u*p,v=c*g-f*p,T=c*w-h*p,A=u*g-f*y,O=u*w-h*y,N=f*w-h*g;return m*N-S*O+x*A+_*T-E*v+k*b}function ty(t,e,n){var s=e[0],r=e[1],i=e[2],o=e[3],a=e[4],l=e[5],c=e[6],u=e[7],f=e[8],h=e[9],p=e[10],y=e[11],g=e[12],w=e[13],m=e[14],S=e[15],x=n[0],_=n[1],E=n[2],k=n[3];return t[0]=x*s+_*a+E*f+k*g,t[1]=x*r+_*l+E*h+k*w,t[2]=x*i+_*c+E*p+k*m,t[3]=x*o+_*u+E*y+k*S,x=n[4],_=n[5],E=n[6],k=n[7],t[4]=x*s+_*a+E*f+k*g,t[5]=x*r+_*l+E*h+k*w,t[6]=x*i+_*c+E*p+k*m,t[7]=x*o+_*u+E*y+k*S,x=n[8],_=n[9],E=n[10],k=n[11],t[8]=x*s+_*a+E*f+k*g,t[9]=x*r+_*l+E*h+k*w,t[10]=x*i+_*c+E*p+k*m,t[11]=x*o+_*u+E*y+k*S,x=n[12],_=n[13],E=n[14],k=n[15],t[12]=x*s+_*a+E*f+k*g,t[13]=x*r+_*l+E*h+k*w,t[14]=x*i+_*c+E*p+k*m,t[15]=x*o+_*u+E*y+k*S,t}function ny(t,e){var n=e[0],s=e[1],r=e[2],i=e[4],o=e[5],a=e[6],l=e[8],c=e[9],u=e[10];return t[0]=Math.hypot(n,s,r),t[1]=Math.hypot(i,o,a),t[2]=Math.hypot(l,c,u),t}function sy(t,e){var n=new Ki(3);ny(n,e);var s=1/n[0],r=1/n[1],i=1/n[2],o=e[0]*s,a=e[1]*r,l=e[2]*i,c=e[4]*s,u=e[5]*r,f=e[6]*i,h=e[8]*s,p=e[9]*r,y=e[10]*i,g=o+u+y,w=0;return g>0?(w=Math.sqrt(g+1)*2,t[3]=.25*w,t[0]=(f-p)/w,t[1]=(h-l)/w,t[2]=(a-c)/w):o>u&&o>y?(w=Math.sqrt(1+o-u-y)*2,t[3]=(f-p)/w,t[0]=.25*w,t[1]=(a+c)/w,t[2]=(h+l)/w):u>y?(w=Math.sqrt(1+u-o-y)*2,t[3]=(h-l)/w,t[0]=(a+c)/w,t[1]=.25*w,t[2]=(f+p)/w):(w=Math.sqrt(1+y-o-u)*2,t[3]=(a-c)/w,t[0]=(h+l)/w,t[1]=(f+p)/w,t[2]=.25*w),t}class ve{static identity(e){return e}static eq(e,n,s=1e-5){if(e.length!==n.length)return!1;for(let r=0;r<e.length;r++)if(Math.abs(e[r]-n[r])>s)return!1;return!0}static clamp(e,n,s){return e<n?n:e>s?s:e}static decodeNormalizedInt(e,n){switch(n){case 5126:return e;case 5123:return e/65535;case 5121:return e/255;case 5122:return Math.max(e/32767,-1);case 5120:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}static encodeNormalizedInt(e,n){switch(n){case 5126:return e;case 5123:return Math.round(ve.clamp(e,0,1)*65535);case 5121:return Math.round(ve.clamp(e,0,1)*255);case 5122:return Math.round(ve.clamp(e,-1,1)*32767);case 5120:return Math.round(ve.clamp(e,-1,1)*127);default:throw new Error("Invalid component type.")}}static decompose(e,n,s,r){let i=pi([e[0],e[1],e[2]]);const o=pi([e[4],e[5],e[6]]),a=pi([e[8],e[9],e[10]]);ey(e)<0&&(i=-i),n[0]=e[12],n[1]=e[13],n[2]=e[14];const c=e.slice(),u=1/i,f=1/o,h=1/a;c[0]*=u,c[1]*=u,c[2]*=u,c[4]*=f,c[5]*=f,c[6]*=f,c[8]*=h,c[9]*=h,c[10]*=h,sy(s,c),r[0]=i,r[1]=o,r[2]=a}static compose(e,n,s,r){const i=r,o=n[0],a=n[1],l=n[2],c=n[3],u=o+o,f=a+a,h=l+l,p=o*u,y=o*f,g=o*h,w=a*f,m=a*h,S=l*h,x=c*u,_=c*f,E=c*h,k=s[0],b=s[1],v=s[2];return i[0]=(1-(w+S))*k,i[1]=(y+E)*k,i[2]=(g-_)*k,i[3]=0,i[4]=(y-E)*b,i[5]=(1-(p+S))*b,i[6]=(m+x)*b,i[7]=0,i[8]=(g+_)*v,i[9]=(m-x)*v,i[10]=(1-(p+w))*v,i[11]=0,i[12]=e[0],i[13]=e[1],i[14]=e[2],i[15]=1,i}}function ry(t,e){if(!!t!=!!e)return!1;const n=t.getChild(),s=e.getChild();return n===s||n.equals(s)}function iy(t,e){if(!!t!=!!e)return!1;const n=t.values(),s=e.values();if(n.length!==s.length)return!1;for(let r=0;r<n.length;r++){const i=n[r],o=s[r];if(i.getChild()!==o.getChild()&&!i.getChild().equals(o.getChild()))return!1}return!0}function oy(t,e){if(!!t!=!!e)return!1;const n=t.keys(),s=e.keys();if(n.length!==s.length)return!1;for(const r of n){const i=t.get(r),o=e.get(r);if(!!i!=!!o)return!1;const a=i.getChild(),l=o.getChild();if(a!==l&&!a.equals(l))return!1}return!0}function Pc(t,e){if(t===e)return!0;if(!!t!=!!e||!t||!e||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function $c(t,e){if(t===e)return!0;if(!!t!=!!e)return!1;if(!wn(t)||!wn(e))return t===e;const n=t,s=e;let r=0,i=0,o;for(o in n)r++;for(o in s)i++;if(r!==i)return!1;for(o in n){const a=n[o],l=s[o];if(jr(a)&&jr(l)){if(!Pc(a,l))return!1}else if(wn(a)&&wn(l)){if(!$c(a,l))return!1}else if(a!==l)return!1}return!0}function jr(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const Pa="23456789abdegjkmnpqrvwxyzABDEGJKMNPQRVWXYZ",ay=999,ly=6,$a=new Set,cy=function(){let e="";for(let n=0;n<ly;n++)e+=Pa.charAt(Math.floor(Math.random()*Pa.length));return e},uy=function(){for(let e=0;e<ay;e++){const n=cy();if(!$a.has(n))return $a.add(n),n}return""},ln=t=>t,fy=new Set;class _o extends xo{constructor(e,n=""){super(e),this[oe].name=n,this.init(),this.dispatchEvent({type:"create"})}getGraph(){return this.graph}getDefaults(){return Object.assign(super.getDefaults(),{name:"",extras:{}})}set(e,n){return Array.isArray(n)&&(n=n.slice()),super.set(e,n)}getName(){return this.get("name")}setName(e){return this.set("name",e)}getExtras(){return this.get("extras")}setExtras(e){return this.set("extras",e)}clone(){const e=this.constructor;return new e(this.graph).copy(this,ln)}copy(e,n=ln){for(const s in this[oe]){const r=this[oe][s];if(r instanceof Un)this[gn].has(s)||r.dispose();else if(r instanceof Xt||r instanceof be)for(const i of r.values())i.dispose();else if(r instanceof Nt)for(const i of r.values())i.dispose()}for(const s in e[oe]){const r=this[oe][s],i=e[oe][s];if(i instanceof Un)this[gn].has(s)?r.getChild().copy(n(i.getChild()),n):this.setRef(s,n(i.getChild()),i.getAttributes());else if(i instanceof be||i instanceof Xt)for(const o of i.values())this.addRef(s,n(o.getChild()),o.getAttributes());else if(i instanceof Nt)for(const o of i.keys()){const a=i.get(o);this.setRefMap(s,o,n(a.getChild()),a.getAttributes())}else wn(i)?this[oe][s]=JSON.parse(JSON.stringify(i)):Array.isArray(i)||i instanceof ArrayBuffer||ArrayBuffer.isView(i)?this[oe][s]=i.slice():this[oe][s]=i}return this}equals(e,n=fy){if(this===e)return!0;if(this.propertyType!==e.propertyType)return!1;for(const s in this[oe]){if(n.has(s))continue;const r=this[oe][s],i=e[oe][s];if(r instanceof Un||i instanceof Un){if(!ry(r,i))return!1}else if(r instanceof be||i instanceof be||r instanceof Xt||i instanceof Xt){if(!iy(r,i))return!1}else if(r instanceof Nt||i instanceof Nt){if(!oy(r,i))return!1}else if(wn(r)||wn(i)){if(!$c(r,i))return!1}else if(jr(r)||jr(i)){if(!Pc(r,i))return!1}else if(r!==i)return!1}return!0}detach(){return this.graph.disconnectParents(this,e=>e.propertyType!=="Root"),this}listParents(){return this.graph.listParents(this)}}class Ye extends _o{getDefaults(){return Object.assign(super.getDefaults(),{extensions:new Nt})}getExtension(e){return this.getRefMap("extensions",e)}setExtension(e,n){return n&&n._validateParent(this),this.setRefMap("extensions",e,n)}listExtensions(){return this.listRefMapValues("extensions")}}class W extends Ye{init(){this.propertyType=Z.ACCESSOR}getDefaults(){return Object.assign(super.getDefaults(),{array:null,type:W.Type.SCALAR,componentType:W.ComponentType.FLOAT,normalized:!1,sparse:!1,buffer:null})}static getElementSize(e){switch(e){case W.Type.SCALAR:return 1;case W.Type.VEC2:return 2;case W.Type.VEC3:return 3;case W.Type.VEC4:return 4;case W.Type.MAT2:return 4;case W.Type.MAT3:return 9;case W.Type.MAT4:return 16;default:throw new Error("Unexpected type: "+e)}}static getComponentSize(e){switch(e){case W.ComponentType.BYTE:return 1;case W.ComponentType.UNSIGNED_BYTE:return 1;case W.ComponentType.SHORT:return 2;case W.ComponentType.UNSIGNED_SHORT:return 2;case W.ComponentType.UNSIGNED_INT:return 4;case W.ComponentType.FLOAT:return 4;default:throw new Error("Unexpected component type: "+e)}}getMinNormalized(e){const n=this.getNormalized(),s=this.getElementSize(),r=this.getComponentType();if(this.getMin(e),n)for(let i=0;i<s;i++)e[i]=ve.decodeNormalizedInt(e[i],r);return e}getMin(e){const n=this.getArray(),s=this.getCount(),r=this.getElementSize();for(let i=0;i<r;i++)e[i]=1/0;for(let i=0;i<s*r;i+=r)for(let o=0;o<r;o++){const a=n[i+o];Number.isFinite(a)&&(e[o]=Math.min(e[o],a))}return e}getMaxNormalized(e){const n=this.getNormalized(),s=this.getElementSize(),r=this.getComponentType();if(this.getMax(e),n)for(let i=0;i<s;i++)e[i]=ve.decodeNormalizedInt(e[i],r);return e}getMax(e){const n=this.get("array"),s=this.getCount(),r=this.getElementSize();for(let i=0;i<r;i++)e[i]=-1/0;for(let i=0;i<s*r;i+=r)for(let o=0;o<r;o++){const a=n[i+o];Number.isFinite(a)&&(e[o]=Math.max(e[o],a))}return e}getCount(){const e=this.get("array");return e?e.length/this.getElementSize():0}getType(){return this.get("type")}setType(e){return this.set("type",e)}getElementSize(){return W.getElementSize(this.get("type"))}getComponentSize(){return this.get("array").BYTES_PER_ELEMENT}getComponentType(){return this.get("componentType")}getNormalized(){return this.get("normalized")}setNormalized(e){return this.set("normalized",e)}getScalar(e){const n=this.getElementSize(),s=this.getComponentType(),r=this.getArray();return this.getNormalized()?ve.decodeNormalizedInt(r[e*n],s):r[e*n]}setScalar(e,n){const s=this.getElementSize(),r=this.getComponentType(),i=this.getArray();return this.getNormalized()?i[e*s]=ve.encodeNormalizedInt(n,r):i[e*s]=n,this}getElement(e,n){const s=this.getNormalized(),r=this.getElementSize(),i=this.getComponentType(),o=this.getArray();for(let a=0;a<r;a++)s?n[a]=ve.decodeNormalizedInt(o[e*r+a],i):n[a]=o[e*r+a];return n}setElement(e,n){const s=this.getNormalized(),r=this.getElementSize(),i=this.getComponentType(),o=this.getArray();for(let a=0;a<r;a++)s?o[e*r+a]=ve.encodeNormalizedInt(n[a],i):o[e*r+a]=n[a];return this}getSparse(){return this.get("sparse")}setSparse(e){return this.set("sparse",e)}getBuffer(){return this.getRef("buffer")}setBuffer(e){return this.setRef("buffer",e)}getArray(){return this.get("array")}setArray(e){return this.set("componentType",e?hy(e):W.ComponentType.FLOAT),this.set("array",e),this}getByteLength(){const e=this.get("array");return e?e.byteLength:0}}W.Type={SCALAR:"SCALAR",VEC2:"VEC2",VEC3:"VEC3",VEC4:"VEC4",MAT2:"MAT2",MAT3:"MAT3",MAT4:"MAT4"};W.ComponentType={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,UNSIGNED_INT:5125,FLOAT:5126};function hy(t){switch(t.constructor){case Float32Array:return W.ComponentType.FLOAT;case Uint32Array:return W.ComponentType.UNSIGNED_INT;case Uint16Array:return W.ComponentType.UNSIGNED_SHORT;case Uint8Array:return W.ComponentType.UNSIGNED_BYTE;case Int16Array:return W.ComponentType.SHORT;case Int8Array:return W.ComponentType.BYTE;default:throw new Error("Unknown accessor componentType.")}}class Dc extends Ye{init(){this.propertyType=Z.ANIMATION}getDefaults(){return Object.assign(super.getDefaults(),{channels:new be,samplers:new be})}addChannel(e){return this.addRef("channels",e)}removeChannel(e){return this.removeRef("channels",e)}listChannels(){return this.listRefs("channels")}addSampler(e){return this.addRef("samplers",e)}removeSampler(e){return this.removeRef("samplers",e)}listSamplers(){return this.listRefs("samplers")}}class Lc extends Ye{init(){this.propertyType=Z.ANIMATION_CHANNEL}getDefaults(){return Object.assign(super.getDefaults(),{targetPath:null,targetNode:null,sampler:null})}getTargetPath(){return this.get("targetPath")}setTargetPath(e){return this.set("targetPath",e)}getTargetNode(){return this.getRef("targetNode")}setTargetNode(e){return this.setRef("targetNode",e)}getSampler(){return this.getRef("sampler")}setSampler(e){return this.setRef("sampler",e)}}Lc.TargetPath={TRANSLATION:"translation",ROTATION:"rotation",SCALE:"scale",WEIGHTS:"weights"};class zs extends Ye{init(){this.propertyType=Z.ANIMATION_SAMPLER}getDefaultAttributes(){return Object.assign(super.getDefaults(),{interpolation:zs.Interpolation.LINEAR,input:null,output:null})}getInterpolation(){return this.get("interpolation")}setInterpolation(e){return this.set("interpolation",e)}getInput(){return this.getRef("input")}setInput(e){return this.setRef("input",e,{usage:st.OTHER})}getOutput(){return this.getRef("output")}setOutput(e){return this.setRef("output",e,{usage:st.OTHER})}}zs.Interpolation={LINEAR:"LINEAR",STEP:"STEP",CUBICSPLINE:"CUBICSPLINE"};class zc extends Ye{init(){this.propertyType=Z.BUFFER}getDefaults(){return Object.assign(super.getDefaults(),{uri:""})}getURI(){return this.get("uri")}setURI(e){return this.set("uri",e)}}class Cn extends Ye{init(){this.propertyType=Z.CAMERA}getDefaults(){return Object.assign(super.getDefaults(),{type:Cn.Type.PERSPECTIVE,znear:.1,zfar:100,aspectRatio:null,yfov:Math.PI*2*50/360,xmag:1,ymag:1})}getType(){return this.get("type")}setType(e){return this.set("type",e)}getZNear(){return this.get("znear")}setZNear(e){return this.set("znear",e)}getZFar(){return this.get("zfar")}setZFar(e){return this.set("zfar",e)}getAspectRatio(){return this.get("aspectRatio")}setAspectRatio(e){return this.set("aspectRatio",e)}getYFov(){return this.get("yfov")}setYFov(e){return this.set("yfov",e)}getXMag(){return this.get("xmag")}setXMag(e){return this.set("xmag",e)}getYMag(){return this.get("ymag")}setYMag(e){return this.set("ymag",e)}}Cn.Type={PERSPECTIVE:"perspective",ORTHOGRAPHIC:"orthographic"};class dy extends _o{_validateParent(e){if(!this.parentTypes.includes(e.propertyType))throw new Error(`Parent "${e.propertyType}" invalid for child "${this.propertyType}".`)}}dy.EXTENSION_NAME=void 0;class wt extends Ye{init(){this.propertyType=Z.TEXTURE_INFO}getDefaults(){return Object.assign(super.getDefaults(),{texCoord:0,magFilter:null,minFilter:null,wrapS:wt.WrapMode.REPEAT,wrapT:wt.WrapMode.REPEAT})}getTexCoord(){return this.get("texCoord")}setTexCoord(e){return this.set("texCoord",e)}getMagFilter(){return this.get("magFilter")}setMagFilter(e){return this.set("magFilter",e)}getMinFilter(){return this.get("minFilter")}setMinFilter(e){return this.set("minFilter",e)}getWrapS(){return this.get("wrapS")}setWrapS(e){return this.set("wrapS",e)}getWrapT(){return this.get("wrapT")}setWrapT(e){return this.set("wrapT",e)}}wt.WrapMode={CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,REPEAT:10497};wt.MagFilter={NEAREST:9728,LINEAR:9729};wt.MinFilter={NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987};const{R:tr,G:nr,B:sr,A:py}=Gi;class Tn extends Ye{init(){this.propertyType=Z.MATERIAL}getDefaults(){return Object.assign(super.getDefaults(),{alphaMode:Tn.AlphaMode.OPAQUE,alphaCutoff:.5,doubleSided:!1,baseColorFactor:[1,1,1,1],baseColorTexture:null,baseColorTextureInfo:new wt(this.graph,"baseColorTextureInfo"),emissiveFactor:[0,0,0],emissiveTexture:null,emissiveTextureInfo:new wt(this.graph,"emissiveTextureInfo"),normalScale:1,normalTexture:null,normalTextureInfo:new wt(this.graph,"normalTextureInfo"),occlusionStrength:1,occlusionTexture:null,occlusionTextureInfo:new wt(this.graph,"occlusionTextureInfo"),roughnessFactor:1,metallicFactor:1,metallicRoughnessTexture:null,metallicRoughnessTextureInfo:new wt(this.graph,"metallicRoughnessTextureInfo")})}getDoubleSided(){return this.get("doubleSided")}setDoubleSided(e){return this.set("doubleSided",e)}getAlpha(){return this.get("baseColorFactor")[3]}setAlpha(e){const n=this.get("baseColorFactor").slice();return n[3]=e,this.set("baseColorFactor",n)}getAlphaMode(){return this.get("alphaMode")}setAlphaMode(e){return this.set("alphaMode",e)}getAlphaCutoff(){return this.get("alphaCutoff")}setAlphaCutoff(e){return this.set("alphaCutoff",e)}getBaseColorFactor(){return this.get("baseColorFactor")}setBaseColorFactor(e){return this.set("baseColorFactor",e)}getBaseColorTexture(){return this.getRef("baseColorTexture")}getBaseColorTextureInfo(){return this.getRef("baseColorTexture")?this.getRef("baseColorTextureInfo"):null}setBaseColorTexture(e){return this.setRef("baseColorTexture",e,{channels:tr|nr|sr|py,isColor:!0})}getEmissiveFactor(){return this.get("emissiveFactor")}setEmissiveFactor(e){return this.set("emissiveFactor",e)}getEmissiveTexture(){return this.getRef("emissiveTexture")}getEmissiveTextureInfo(){return this.getRef("emissiveTexture")?this.getRef("emissiveTextureInfo"):null}setEmissiveTexture(e){return this.setRef("emissiveTexture",e,{channels:tr|nr|sr,isColor:!0})}getNormalScale(){return this.get("normalScale")}setNormalScale(e){return this.set("normalScale",e)}getNormalTexture(){return this.getRef("normalTexture")}getNormalTextureInfo(){return this.getRef("normalTexture")?this.getRef("normalTextureInfo"):null}setNormalTexture(e){return this.setRef("normalTexture",e,{channels:tr|nr|sr})}getOcclusionStrength(){return this.get("occlusionStrength")}setOcclusionStrength(e){return this.set("occlusionStrength",e)}getOcclusionTexture(){return this.getRef("occlusionTexture")}getOcclusionTextureInfo(){return this.getRef("occlusionTexture")?this.getRef("occlusionTextureInfo"):null}setOcclusionTexture(e){return this.setRef("occlusionTexture",e,{channels:tr})}getRoughnessFactor(){return this.get("roughnessFactor")}setRoughnessFactor(e){return this.set("roughnessFactor",e)}getMetallicFactor(){return this.get("metallicFactor")}setMetallicFactor(e){return this.set("metallicFactor",e)}getMetallicRoughnessTexture(){return this.getRef("metallicRoughnessTexture")}getMetallicRoughnessTextureInfo(){return this.getRef("metallicRoughnessTexture")?this.getRef("metallicRoughnessTextureInfo"):null}setMetallicRoughnessTexture(e){return this.setRef("metallicRoughnessTexture",e,{channels:nr|sr})}}Tn.AlphaMode={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};class Fc extends Ye{init(){this.propertyType=Z.MESH}getDefaults(){return Object.assign(super.getDefaults(),{weights:[],primitives:new be})}addPrimitive(e){return this.addRef("primitives",e)}removePrimitive(e){return this.removeRef("primitives",e)}listPrimitives(){return this.listRefs("primitives")}getWeights(){return this.get("weights")}setWeights(e){return this.set("weights",e)}}let Bc=class extends Ye{init(){this.propertyType=Z.NODE}getDefaults(){return Object.assign(super.getDefaults(),{translation:[0,0,0],rotation:[0,0,0,1],scale:[1,1,1],weights:[],camera:null,mesh:null,skin:null,children:new be})}copy(e,n=ln){if(n===ln)throw new Error("Node cannot be copied.");return super.copy(e,n)}getTranslation(){return this.get("translation")}getRotation(){return this.get("rotation")}getScale(){return this.get("scale")}setTranslation(e){return this.set("translation",e)}setRotation(e){return this.set("rotation",e)}setScale(e){return this.set("scale",e)}getMatrix(){return ve.compose(this.get("translation"),this.get("rotation"),this.get("scale"),[])}setMatrix(e){const n=this.get("translation").slice(),s=this.get("rotation").slice(),r=this.get("scale").slice();return ve.decompose(e,n,s,r),this.set("translation",n).set("rotation",s).set("scale",r)}getWorldTranslation(){const e=[0,0,0];return ve.decompose(this.getWorldMatrix(),e,[0,0,0,1],[1,1,1]),e}getWorldRotation(){const e=[0,0,0,1];return ve.decompose(this.getWorldMatrix(),[0,0,0],e,[1,1,1]),e}getWorldScale(){const e=[1,1,1];return ve.decompose(this.getWorldMatrix(),[0,0,0],[0,0,0,1],e),e}getWorldMatrix(){const e=[];for(let r=this;r!=null;r=r.getParentNode())e.push(r);let n;const s=e.pop().getMatrix();for(;n=e.pop();)ty(s,s,n.getMatrix());return s}addChild(e){const n=e.getParentNode();n&&n.removeChild(e);for(const s of e.listParents())s.propertyType===Z.SCENE&&s.removeChild(e);return this.addRef("children",e)}removeChild(e){return this.removeRef("children",e)}listChildren(){return this.listRefs("children")}getParentNode(){for(const e of this.listParents())if(e.propertyType===Z.NODE)return e;return null}getMesh(){return this.getRef("mesh")}setMesh(e){return this.setRef("mesh",e)}getCamera(){return this.getRef("camera")}setCamera(e){return this.setRef("camera",e)}getSkin(){return this.getRef("skin")}setSkin(e){return this.setRef("skin",e)}getWeights(){return this.get("weights")}setWeights(e){return this.set("weights",e)}traverse(e){e(this);for(const n of this.listChildren())n.traverse(e);return this}};class Gr extends Ye{init(){this.propertyType=Z.PRIMITIVE}getDefaults(){return Object.assign(super.getDefaults(),{mode:Gr.Mode.TRIANGLES,material:null,indices:null,attributes:new Nt,targets:new be})}getIndices(){return this.getRef("indices")}setIndices(e){return this.setRef("indices",e,{usage:st.ELEMENT_ARRAY_BUFFER})}getAttribute(e){return this.getRefMap("attributes",e)}setAttribute(e,n){return this.setRefMap("attributes",e,n,{usage:st.ARRAY_BUFFER})}listAttributes(){return this.listRefMapValues("attributes")}listSemantics(){return this.listRefMapKeys("attributes")}getMaterial(){return this.getRef("material")}setMaterial(e){return this.setRef("material",e)}getMode(){return this.get("mode")}setMode(e){return this.set("mode",e)}listTargets(){return this.listRefs("targets")}addTarget(e){return this.addRef("targets",e)}removeTarget(e){return this.removeRef("targets",e)}}Gr.Mode={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class my extends _o{init(){this.propertyType=Z.PRIMITIVE_TARGET}getDefaults(){return Object.assign(super.getDefaults(),{attributes:new Nt})}getAttribute(e){return this.getRefMap("attributes",e)}setAttribute(e,n){return this.setRefMap("attributes",e,n,{usage:st.ARRAY_BUFFER})}listAttributes(){return this.listRefMapValues("attributes")}listSemantics(){return this.listRefMapKeys("attributes")}}function We(){return We=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)({}).hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},We.apply(null,arguments)}class Uc extends Ye{init(){this.propertyType=Z.SCENE}getDefaults(){return Object.assign(super.getDefaults(),{children:new be})}copy(e,n=ln){if(n===ln)throw new Error("Scene cannot be copied.");return super.copy(e,n)}addChild(e){const n=e.getParentNode();return n&&n.removeChild(e),this.addRef("children",e)}removeChild(e){return this.removeRef("children",e)}listChildren(){return this.listRefs("children")}traverse(e){for(const n of this.listChildren())n.traverse(e);return this}}class Zc extends Ye{init(){this.propertyType=Z.SKIN}getDefaults(){return Object.assign(super.getDefaults(),{skeleton:null,inverseBindMatrices:null,joints:new be})}getSkeleton(){return this.getRef("skeleton")}setSkeleton(e){return this.setRef("skeleton",e)}getInverseBindMatrices(){return this.getRef("inverseBindMatrices")}setInverseBindMatrices(e){return this.setRef("inverseBindMatrices",e,{usage:st.INVERSE_BIND_MATRICES})}addJoint(e){return this.addRef("joints",e)}removeJoint(e){return this.removeRef("joints",e)}listJoints(){return this.listRefs("joints")}}class Vc extends Ye{init(){this.propertyType=Z.TEXTURE}getDefaults(){return Object.assign(super.getDefaults(),{image:null,mimeType:"",uri:""})}getMimeType(){return this.get("mimeType")||En.extensionToMimeType(ns.extension(this.get("uri")))}setMimeType(e){return this.set("mimeType",e)}getURI(){return this.get("uri")}setURI(e){this.set("uri",e);const n=En.extensionToMimeType(ns.extension(e));return n&&this.set("mimeType",n),this}getImage(){return this.get("image")}setImage(e){return this.set("image",ie.assertView(e))}getSize(){const e=this.get("image");return e?En.getSize(e,this.getMimeType()):null}}class gy extends Ye{init(){this.propertyType=Z.ROOT}getDefaults(){return Object.assign(super.getDefaults(),{asset:{generator:`glTF-Transform ${Rc}`,version:"2.0"},defaultScene:null,accessors:new be,animations:new be,buffers:new be,cameras:new be,materials:new be,meshes:new be,nodes:new be,scenes:new be,skins:new be,textures:new be})}constructor(e){super(e),this._extensions=new Set,e.addEventListener("node:create",n=>{this._addChildOfRoot(n.target)})}clone(){throw new Error("Root cannot be cloned.")}copy(e,n=ln){if(n===ln)throw new Error("Root cannot be copied.");this.set("asset",We({},e.get("asset"))),this.setName(e.getName()),this.setExtras(We({},e.getExtras())),this.setDefaultScene(e.getDefaultScene()?n(e.getDefaultScene()):null);for(const s of e.listRefMapKeys("extensions")){const r=e.getExtension(s);this.setExtension(s,n(r))}return this}_addChildOfRoot(e){return e instanceof Uc?this.addRef("scenes",e):e instanceof Bc?this.addRef("nodes",e):e instanceof Cn?this.addRef("cameras",e):e instanceof Zc?this.addRef("skins",e):e instanceof Fc?this.addRef("meshes",e):e instanceof Tn?this.addRef("materials",e):e instanceof Vc?this.addRef("textures",e):e instanceof Dc?this.addRef("animations",e):e instanceof W?this.addRef("accessors",e):e instanceof zc&&this.addRef("buffers",e),this}getAsset(){return this.get("asset")}listExtensionsUsed(){return Array.from(this._extensions)}listExtensionsRequired(){return this.listExtensionsUsed().filter(e=>e.isRequired())}_enableExtension(e){return this._extensions.add(e),this}_disableExtension(e){return this._extensions.delete(e),this}listScenes(){return this.listRefs("scenes")}setDefaultScene(e){return this.setRef("defaultScene",e)}getDefaultScene(){return this.getRef("defaultScene")}listNodes(){return this.listRefs("nodes")}listCameras(){return this.listRefs("cameras")}listSkins(){return this.listRefs("skins")}listMeshes(){return this.listRefs("meshes")}listMaterials(){return this.listRefs("materials")}listTextures(){return this.listRefs("textures")}listAnimations(){return this.listRefs("animations")}listAccessors(){return this.listRefs("accessors")}listBuffers(){return this.listRefs("buffers")}}let Wc=class Qi{static fromGraph(e){return Qi._GRAPH_DOCUMENTS.get(e)||null}constructor(){this._graph=new H1,this._root=new gy(this._graph),this._logger=it.DEFAULT_INSTANCE,Qi._GRAPH_DOCUMENTS.set(this._graph,this)}getRoot(){return this._root}getGraph(){return this._graph}getLogger(){return this._logger}setLogger(e){return this._logger=e,this}clone(){throw new Error("Use 'cloneDocument(source)' from '@gltf-transform/functions'.")}merge(e){throw new Error("Use 'mergeDocuments(target, source)' from '@gltf-transform/functions'.")}async transform(...e){const n=e.map(s=>s.name);for(const s of e)await s(this,{stack:n});return this}createExtension(e){const n=e.EXTENSION_NAME;return this.getRoot().listExtensionsUsed().find(r=>r.extensionName===n)||new e(this)}createScene(e=""){return new Uc(this._graph,e)}createNode(e=""){return new Bc(this._graph,e)}createCamera(e=""){return new Cn(this._graph,e)}createSkin(e=""){return new Zc(this._graph,e)}createMesh(e=""){return new Fc(this._graph,e)}createPrimitive(){return new Gr(this._graph)}createPrimitiveTarget(e=""){return new my(this._graph,e)}createMaterial(e=""){return new Tn(this._graph,e)}createTexture(e=""){return new Vc(this._graph,e)}createAnimation(e=""){return new Dc(this._graph,e)}createAnimationChannel(e=""){return new Lc(this._graph,e)}createAnimationSampler(e=""){return new zs(this._graph,e)}createAccessor(e="",n=null){return n||(n=this.getRoot().listBuffers()[0]),new W(this._graph,e).setBuffer(n)}createBuffer(e=""){return new zc(this._graph,e)}};Wc._GRAPH_DOCUMENTS=new WeakMap;class yy{constructor(e){this.jsonDoc=void 0,this.buffers=[],this.bufferViews=[],this.bufferViewBuffers=[],this.accessors=[],this.textures=[],this.textureInfos=new Map,this.materials=[],this.meshes=[],this.cameras=[],this.nodes=[],this.skins=[],this.animations=[],this.scenes=[],this.jsonDoc=e}setTextureInfo(e,n){this.textureInfos.set(e,n),n.texCoord!==void 0&&e.setTexCoord(n.texCoord),n.extras!==void 0&&e.setExtras(n.extras);const s=this.jsonDoc.json.textures[n.index];if(s.sampler===void 0)return;const r=this.jsonDoc.json.samplers[s.sampler];r.magFilter!==void 0&&e.setMagFilter(r.magFilter),r.minFilter!==void 0&&e.setMinFilter(r.minFilter),r.wrapS!==void 0&&e.setWrapS(r.wrapS),r.wrapT!==void 0&&e.setWrapT(r.wrapT)}}const Da={logger:it.DEFAULT_INSTANCE,extensions:[],dependencies:{}},by=new Set([Z.BUFFER,Z.TEXTURE,Z.MATERIAL,Z.MESH,Z.PRIMITIVE,Z.NODE,Z.SCENE]);class wy{static read(e,n=Da){const s=We({},Da,n),{json:r}=e,i=new Wc().setLogger(s.logger);this.validate(e,s);const o=new yy(e),a=r.asset,l=i.getRoot().getAsset();a.copyright&&(l.copyright=a.copyright),a.extras&&(l.extras=a.extras),r.extras!==void 0&&i.getRoot().setExtras(We({},r.extras));const c=r.extensionsUsed||[],u=r.extensionsRequired||[];s.extensions.sort((b,v)=>b.EXTENSION_NAME>v.EXTENSION_NAME?1:-1);for(const b of s.extensions)if(c.includes(b.EXTENSION_NAME)){const v=i.createExtension(b).setRequired(u.includes(b.EXTENSION_NAME)),T=v.prereadTypes.filter(A=>!by.has(A));T.length&&s.logger.warn(`Preread hooks for some types (${T.join()}), requested by extension ${v.extensionName}, are unsupported. Please file an issue or a PR.`);for(const A of v.readDependencies)v.install(A,s.dependencies[A])}const f=r.buffers||[];i.getRoot().listExtensionsUsed().filter(b=>b.prereadTypes.includes(Z.BUFFER)).forEach(b=>b.preread(o,Z.BUFFER)),o.buffers=f.map(b=>{const v=i.createBuffer(b.name);return b.extras&&v.setExtras(b.extras),b.uri&&b.uri.indexOf("__")!==0&&v.setURI(b.uri),v});const h=r.bufferViews||[];o.bufferViewBuffers=h.map((b,v)=>{if(!o.bufferViews[v]){const T=e.json.buffers[b.buffer],A=T.uri?e.resources[T.uri]:e.resources[Ir],O=b.byteOffset||0;o.bufferViews[v]=ie.toView(A,O,b.byteLength)}return o.buffers[b.buffer]});const p=r.accessors||[];o.accessors=p.map(b=>{const v=o.bufferViewBuffers[b.bufferView],T=i.createAccessor(b.name,v).setType(b.type);return b.extras&&T.setExtras(b.extras),b.normalized!==void 0&&T.setNormalized(b.normalized),b.bufferView===void 0||T.setArray(wr(b,o)),T});const y=r.images||[],g=r.textures||[];i.getRoot().listExtensionsUsed().filter(b=>b.prereadTypes.includes(Z.TEXTURE)).forEach(b=>b.preread(o,Z.TEXTURE)),o.textures=y.map(b=>{const v=i.createTexture(b.name);if(b.extras&&v.setExtras(b.extras),b.bufferView!==void 0){const T=r.bufferViews[b.bufferView],A=e.json.buffers[T.buffer],O=A.uri?e.resources[A.uri]:e.resources[Ir],N=T.byteOffset||0,M=T.byteLength,R=O.slice(N,N+M);v.setImage(R)}else b.uri!==void 0&&(v.setImage(e.resources[b.uri]),b.uri.indexOf("__")!==0&&v.setURI(b.uri));if(b.mimeType!==void 0)v.setMimeType(b.mimeType);else if(b.uri){const T=ns.extension(b.uri);v.setMimeType(En.extensionToMimeType(T))}return v}),i.getRoot().listExtensionsUsed().filter(b=>b.prereadTypes.includes(Z.MATERIAL)).forEach(b=>b.preread(o,Z.MATERIAL));const w=r.materials||[];o.materials=w.map(b=>{const v=i.createMaterial(b.name);b.extras&&v.setExtras(b.extras),b.alphaMode!==void 0&&v.setAlphaMode(b.alphaMode),b.alphaCutoff!==void 0&&v.setAlphaCutoff(b.alphaCutoff),b.doubleSided!==void 0&&v.setDoubleSided(b.doubleSided);const T=b.pbrMetallicRoughness||{};if(T.baseColorFactor!==void 0&&v.setBaseColorFactor(T.baseColorFactor),b.emissiveFactor!==void 0&&v.setEmissiveFactor(b.emissiveFactor),T.metallicFactor!==void 0&&v.setMetallicFactor(T.metallicFactor),T.roughnessFactor!==void 0&&v.setRoughnessFactor(T.roughnessFactor),T.baseColorTexture!==void 0){const A=T.baseColorTexture,O=o.textures[g[A.index].source];v.setBaseColorTexture(O),o.setTextureInfo(v.getBaseColorTextureInfo(),A)}if(b.emissiveTexture!==void 0){const A=b.emissiveTexture,O=o.textures[g[A.index].source];v.setEmissiveTexture(O),o.setTextureInfo(v.getEmissiveTextureInfo(),A)}if(b.normalTexture!==void 0){const A=b.normalTexture,O=o.textures[g[A.index].source];v.setNormalTexture(O),o.setTextureInfo(v.getNormalTextureInfo(),A),b.normalTexture.scale!==void 0&&v.setNormalScale(b.normalTexture.scale)}if(b.occlusionTexture!==void 0){const A=b.occlusionTexture,O=o.textures[g[A.index].source];v.setOcclusionTexture(O),o.setTextureInfo(v.getOcclusionTextureInfo(),A),b.occlusionTexture.strength!==void 0&&v.setOcclusionStrength(b.occlusionTexture.strength)}if(T.metallicRoughnessTexture!==void 0){const A=T.metallicRoughnessTexture,O=o.textures[g[A.index].source];v.setMetallicRoughnessTexture(O),o.setTextureInfo(v.getMetallicRoughnessTextureInfo(),A)}return v}),i.getRoot().listExtensionsUsed().filter(b=>b.prereadTypes.includes(Z.MESH)).forEach(b=>b.preread(o,Z.MESH));const m=r.meshes||[];i.getRoot().listExtensionsUsed().filter(b=>b.prereadTypes.includes(Z.PRIMITIVE)).forEach(b=>b.preread(o,Z.PRIMITIVE)),o.meshes=m.map(b=>{const v=i.createMesh(b.name);return b.extras&&v.setExtras(b.extras),b.weights!==void 0&&v.setWeights(b.weights),(b.primitives||[]).forEach(A=>{const O=i.createPrimitive();A.extras&&O.setExtras(A.extras),A.material!==void 0&&O.setMaterial(o.materials[A.material]),A.mode!==void 0&&O.setMode(A.mode);for(const[R,j]of Object.entries(A.attributes||{}))O.setAttribute(R,o.accessors[j]);A.indices!==void 0&&O.setIndices(o.accessors[A.indices]);const N=b.extras&&b.extras.targetNames||[];(A.targets||[]).forEach((R,j)=>{const P=N[j]||j.toString(),L=i.createPrimitiveTarget(P);for(const[U,z]of Object.entries(R))L.setAttribute(U,o.accessors[z]);O.addTarget(L)}),v.addPrimitive(O)}),v});const S=r.cameras||[];o.cameras=S.map(b=>{const v=i.createCamera(b.name).setType(b.type);if(b.extras&&v.setExtras(b.extras),b.type===Cn.Type.PERSPECTIVE){const T=b.perspective;v.setYFov(T.yfov),v.setZNear(T.znear),T.zfar!==void 0&&v.setZFar(T.zfar),T.aspectRatio!==void 0&&v.setAspectRatio(T.aspectRatio)}else{const T=b.orthographic;v.setZNear(T.znear).setZFar(T.zfar).setXMag(T.xmag).setYMag(T.ymag)}return v});const x=r.nodes||[];i.getRoot().listExtensionsUsed().filter(b=>b.prereadTypes.includes(Z.NODE)).forEach(b=>b.preread(o,Z.NODE)),o.nodes=x.map(b=>{const v=i.createNode(b.name);if(b.extras&&v.setExtras(b.extras),b.translation!==void 0&&v.setTranslation(b.translation),b.rotation!==void 0&&v.setRotation(b.rotation),b.scale!==void 0&&v.setScale(b.scale),b.matrix!==void 0){const T=[0,0,0],A=[0,0,0,1],O=[1,1,1];ve.decompose(b.matrix,T,A,O),v.setTranslation(T),v.setRotation(A),v.setScale(O)}return b.weights!==void 0&&v.setWeights(b.weights),v});const _=r.skins||[];o.skins=_.map(b=>{const v=i.createSkin(b.name);b.extras&&v.setExtras(b.extras),b.inverseBindMatrices!==void 0&&v.setInverseBindMatrices(o.accessors[b.inverseBindMatrices]),b.skeleton!==void 0&&v.setSkeleton(o.nodes[b.skeleton]);for(const T of b.joints)v.addJoint(o.nodes[T]);return v}),x.map((b,v)=>{const T=o.nodes[v];(b.children||[]).forEach(O=>T.addChild(o.nodes[O])),b.mesh!==void 0&&T.setMesh(o.meshes[b.mesh]),b.camera!==void 0&&T.setCamera(o.cameras[b.camera]),b.skin!==void 0&&T.setSkin(o.skins[b.skin])});const E=r.animations||[];o.animations=E.map(b=>{const v=i.createAnimation(b.name);b.extras&&v.setExtras(b.extras);const A=(b.samplers||[]).map(N=>{const M=i.createAnimationSampler().setInput(o.accessors[N.input]).setOutput(o.accessors[N.output]).setInterpolation(N.interpolation||zs.Interpolation.LINEAR);return N.extras&&M.setExtras(N.extras),v.addSampler(M),M});return(b.channels||[]).forEach(N=>{const M=i.createAnimationChannel().setSampler(A[N.sampler]).setTargetPath(N.target.path);N.target.node!==void 0&&M.setTargetNode(o.nodes[N.target.node]),N.extras&&M.setExtras(N.extras),v.addChannel(M)}),v});const k=r.scenes||[];return i.getRoot().listExtensionsUsed().filter(b=>b.prereadTypes.includes(Z.SCENE)).forEach(b=>b.preread(o,Z.SCENE)),o.scenes=k.map(b=>{const v=i.createScene(b.name);return b.extras&&v.setExtras(b.extras),(b.nodes||[]).map(A=>o.nodes[A]).forEach(A=>v.addChild(A)),v}),r.scene!==void 0&&i.getRoot().setDefaultScene(o.scenes[r.scene]),i.getRoot().listExtensionsUsed().forEach(b=>b.read(o)),p.forEach((b,v)=>{const T=o.accessors[v],A=!!b.sparse,O=!b.bufferView&&!T.getArray();(A||O)&&T.setSparse(!0).setArray(xy(b,o))}),i}static validate(e,n){const s=e.json;if(s.asset.version!=="2.0")throw new Error(`Unsupported glTF version, "${s.asset.version}".`);if(s.extensionsRequired){for(const r of s.extensionsRequired)if(!n.extensions.find(i=>i.EXTENSION_NAME===r))throw new Error(`Missing required extension, "${r}".`)}if(s.extensionsUsed)for(const r of s.extensionsUsed)n.extensions.find(i=>i.EXTENSION_NAME===r)||n.logger.warn(`Missing optional extension, "${r}".`)}}function vy(t,e){const n=e.jsonDoc,s=e.bufferViews[t.bufferView],r=n.json.bufferViews[t.bufferView],i=qr[t.componentType],o=W.getElementSize(t.type),a=i.BYTES_PER_ELEMENT,l=t.byteOffset||0,c=new i(t.count*o),u=new DataView(s.buffer,s.byteOffset,s.byteLength),f=r.byteStride;for(let h=0;h<t.count;h++)for(let p=0;p<o;p++){const y=l+h*f+p*a;let g;switch(t.componentType){case W.ComponentType.FLOAT:g=u.getFloat32(y,!0);break;case W.ComponentType.UNSIGNED_INT:g=u.getUint32(y,!0);break;case W.ComponentType.UNSIGNED_SHORT:g=u.getUint16(y,!0);break;case W.ComponentType.UNSIGNED_BYTE:g=u.getUint8(y);break;case W.ComponentType.SHORT:g=u.getInt16(y,!0);break;case W.ComponentType.BYTE:g=u.getInt8(y);break;default:throw new Error(`Unexpected componentType "${t.componentType}".`)}c[h*o+p]=g}return c}function wr(t,e){const n=e.jsonDoc,s=e.bufferViews[t.bufferView],r=n.json.bufferViews[t.bufferView],i=qr[t.componentType],o=W.getElementSize(t.type),a=i.BYTES_PER_ELEMENT,l=o*a;if(r.byteStride!==void 0&&r.byteStride!==l)return vy(t,e);const c=s.byteOffset+(t.byteOffset||0),u=t.count*o*a;return new i(s.buffer.slice(c,c+u))}function xy(t,e){const n=qr[t.componentType],s=W.getElementSize(t.type);let r;t.bufferView!==void 0?r=wr(t,e):r=new n(t.count*s);const i=t.sparse;if(!i)return r;const o=i.count,a=We({},t,i.indices,{count:o,type:"SCALAR"}),l=We({},t,i.values,{count:o}),c=wr(a,e),u=wr(l,e);for(let f=0;f<a.count;f++)for(let h=0;h<s;h++)r[c[f]*s+h]=u[f*s+h];return r}var Cs;(function(t){t[t.ARRAY_BUFFER=34962]="ARRAY_BUFFER",t[t.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER"})(Cs||(Cs={}));class Sn{constructor(e,n,s){this._doc=void 0,this.jsonDoc=void 0,this.options=void 0,this.accessorIndexMap=new Map,this.animationIndexMap=new Map,this.bufferIndexMap=new Map,this.cameraIndexMap=new Map,this.skinIndexMap=new Map,this.materialIndexMap=new Map,this.meshIndexMap=new Map,this.nodeIndexMap=new Map,this.imageIndexMap=new Map,this.textureDefIndexMap=new Map,this.textureInfoDefMap=new Map,this.samplerDefIndexMap=new Map,this.sceneIndexMap=new Map,this.imageBufferViews=[],this.otherBufferViews=new Map,this.otherBufferViewsIndexMap=new Map,this.extensionData={},this.bufferURIGenerator=void 0,this.imageURIGenerator=void 0,this.logger=void 0,this._accessorUsageMap=new Map,this.accessorUsageGroupedByParent=new Set(["ARRAY_BUFFER"]),this.accessorParents=new Map,this._doc=e,this.jsonDoc=n,this.options=s;const r=e.getRoot(),i=r.listBuffers().length,o=r.listTextures().length;this.bufferURIGenerator=new La(i>1,()=>s.basename||"buffer"),this.imageURIGenerator=new La(o>1,a=>_y(e,a)||s.basename||"texture"),this.logger=e.getLogger()}createTextureInfoDef(e,n){const s={magFilter:n.getMagFilter()||void 0,minFilter:n.getMinFilter()||void 0,wrapS:n.getWrapS(),wrapT:n.getWrapT()},r=JSON.stringify(s);this.samplerDefIndexMap.has(r)||(this.samplerDefIndexMap.set(r,this.jsonDoc.json.samplers.length),this.jsonDoc.json.samplers.push(s));const i={source:this.imageIndexMap.get(e),sampler:this.samplerDefIndexMap.get(r)},o=JSON.stringify(i);this.textureDefIndexMap.has(o)||(this.textureDefIndexMap.set(o,this.jsonDoc.json.textures.length),this.jsonDoc.json.textures.push(i));const a={index:this.textureDefIndexMap.get(o)};return n.getTexCoord()!==0&&(a.texCoord=n.getTexCoord()),Object.keys(n.getExtras()).length>0&&(a.extras=n.getExtras()),this.textureInfoDefMap.set(n,a),a}createPropertyDef(e){const n={};return e.getName()&&(n.name=e.getName()),Object.keys(e.getExtras()).length>0&&(n.extras=e.getExtras()),n}createAccessorDef(e){const n=this.createPropertyDef(e);return n.type=e.getType(),n.componentType=e.getComponentType(),n.count=e.getCount(),this._doc.getGraph().listParentEdges(e).some(r=>r.getName()==="attributes"&&r.getAttributes().key==="POSITION"||r.getName()==="input")&&(n.max=e.getMax([]).map(Math.fround),n.min=e.getMin([]).map(Math.fround)),e.getNormalized()&&(n.normalized=e.getNormalized()),n}createImageData(e,n,s){if(this.options.format===Jt.GLB)this.imageBufferViews.push(n),e.bufferView=this.jsonDoc.json.bufferViews.length,this.jsonDoc.json.bufferViews.push({buffer:0,byteOffset:-1,byteLength:n.byteLength});else{const r=En.mimeTypeToExtension(s.getMimeType());e.uri=this.imageURIGenerator.createURI(s,r),this.assignResourceURI(e.uri,n,!1)}}assignResourceURI(e,n,s){const r=this.jsonDoc.resources;if(!(e in r)){r[e]=n;return}if(n===r[e]){this.logger.warn(`Duplicate resource URI, "${e}".`);return}const i=`Resource URI "${e}" already assigned to different data.`;if(!s){this.logger.warn(i);return}throw new Error(i)}getAccessorUsage(e){const n=this._accessorUsageMap.get(e);if(n)return n;if(e.getSparse())return st.SPARSE;for(const s of this._doc.getGraph().listParentEdges(e)){const{usage:r}=s.getAttributes();if(r)return r;s.getParent().propertyType!==Z.ROOT&&this.logger.warn(`Missing attribute ".usage" on edge, "${s.getName()}".`)}return st.OTHER}addAccessorToUsageGroup(e,n){const s=this._accessorUsageMap.get(e);if(s&&s!==n)throw new Error(`Accessor with usage "${s}" cannot be reused as "${n}".`);return this._accessorUsageMap.set(e,n),this}}Sn.BufferViewTarget=Cs;Sn.BufferViewUsage=st;Sn.USAGE_TO_TARGET={[st.ARRAY_BUFFER]:Cs.ARRAY_BUFFER,[st.ELEMENT_ARRAY_BUFFER]:Cs.ELEMENT_ARRAY_BUFFER};class La{constructor(e,n){this.multiple=void 0,this.basename=void 0,this.counter={},this.multiple=e,this.basename=n}createURI(e,n){if(e.getURI())return e.getURI();if(this.multiple){const s=this.basename(e);return this.counter[s]=this.counter[s]||1,`${s}_${this.counter[s]++}.${n}`}else return`${this.basename(e)}.${n}`}}function _y(t,e){const n=t.getGraph().listParentEdges(e).find(s=>s.getParent()!==t.getRoot());return n?n.getName().replace(/texture$/i,""):""}const{BufferViewUsage:rr}=Sn,{UNSIGNED_INT:Ey,UNSIGNED_SHORT:Sy,UNSIGNED_BYTE:ky}=W.ComponentType,Ty=new Set([Z.ACCESSOR,Z.BUFFER,Z.MATERIAL,Z.MESH]);class Ay{static write(e,n){const s=e.getGraph(),r=e.getRoot(),i={asset:We({generator:`glTF-Transform ${Rc}`},r.getAsset()),extras:We({},r.getExtras())},o={json:i,resources:{}},a=new Sn(e,o,n),l=n.logger||it.DEFAULT_INSTANCE,c=new Set(n.extensions.map(m=>m.EXTENSION_NAME)),u=e.getRoot().listExtensionsUsed().filter(m=>c.has(m.extensionName)).sort((m,S)=>m.extensionName>S.extensionName?1:-1),f=e.getRoot().listExtensionsRequired().filter(m=>c.has(m.extensionName)).sort((m,S)=>m.extensionName>S.extensionName?1:-1);u.length<e.getRoot().listExtensionsUsed().length&&l.warn("Some extensions were not registered for I/O, and will not be written.");for(const m of u){const S=m.prewriteTypes.filter(x=>!Ty.has(x));S.length&&l.warn(`Prewrite hooks for some types (${S.join()}), requested by extension ${m.extensionName}, are unsupported. Please file an issue or a PR.`);for(const x of m.writeDependencies)m.install(x,n.dependencies[x])}function h(m,S,x,_){const E=[];let k=0;for(const T of m){const A=a.createAccessorDef(T);A.bufferView=i.bufferViews.length;const O=T.getArray(),N=ie.pad(ie.toView(O));A.byteOffset=k,k+=N.byteLength,E.push(N),a.accessorIndexMap.set(T,i.accessors.length),i.accessors.push(A)}const b=ie.concat(E),v={buffer:S,byteOffset:x,byteLength:b.byteLength};return _&&(v.target=_),i.bufferViews.push(v),{buffers:E,byteLength:k}}function p(m,S,x){const _=m[0].getCount();let E=0;for(const A of m){const O=a.createAccessorDef(A);O.bufferView=i.bufferViews.length,O.byteOffset=E;const N=A.getElementSize(),M=A.getComponentSize();E+=ie.padNumber(N*M),a.accessorIndexMap.set(A,i.accessors.length),i.accessors.push(O)}const k=_*E,b=new ArrayBuffer(k),v=new DataView(b);for(let A=0;A<_;A++){let O=0;for(const N of m){const M=N.getElementSize(),R=N.getComponentSize(),j=N.getComponentType(),P=N.getArray();for(let L=0;L<M;L++){const U=A*E+O+L*R,z=P[A*M+L];switch(j){case W.ComponentType.FLOAT:v.setFloat32(U,z,!0);break;case W.ComponentType.BYTE:v.setInt8(U,z);break;case W.ComponentType.SHORT:v.setInt16(U,z,!0);break;case W.ComponentType.UNSIGNED_BYTE:v.setUint8(U,z);break;case W.ComponentType.UNSIGNED_SHORT:v.setUint16(U,z,!0);break;case W.ComponentType.UNSIGNED_INT:v.setUint32(U,z,!0);break;default:throw new Error("Unexpected component type: "+j)}}O+=ie.padNumber(M*R)}}const T={buffer:S,byteOffset:x,byteLength:k,byteStride:E,target:Sn.BufferViewTarget.ARRAY_BUFFER};return i.bufferViews.push(T),{byteLength:k,buffers:[new Uint8Array(b)]}}function y(m,S,x){const _=[];let E=0;const k=new Map;let b=-1/0,v=!1;for(const j of m){const P=a.createAccessorDef(j);i.accessors.push(P),a.accessorIndexMap.set(j,i.accessors.length-1);const L=[],U=[],z=[],ne=new Array(j.getElementSize()).fill(0);for(let Q=0,J=j.getCount();Q<J;Q++)if(j.getElement(Q,z),!ve.eq(z,ne,0)){b=Math.max(Q,b),L.push(Q);for(let he=0;he<z.length;he++)U.push(z[he])}const G=L.length,ee={accessorDef:P,count:G};if(k.set(j,ee),G===0)continue;G>j.getCount()/2&&(v=!0);const Y=qr[j.getComponentType()];ee.indices=L,ee.values=new Y(U)}if(!Number.isFinite(b))return{buffers:_,byteLength:E};v&&l.warn("Some sparse accessors have >50% non-zero elements, which may increase file size.");const T=b<255?Uint8Array:b<65535?Uint16Array:Uint32Array,A=b<255?ky:b<65535?Sy:Ey,O={buffer:S,byteOffset:x+E,byteLength:0};for(const j of m){const P=k.get(j);if(P.count===0)continue;P.indicesByteOffset=O.byteLength;const L=ie.pad(ie.toView(new T(P.indices)));_.push(L),E+=L.byteLength,O.byteLength+=L.byteLength}i.bufferViews.push(O);const N=i.bufferViews.length-1,M={buffer:S,byteOffset:x+E,byteLength:0};for(const j of m){const P=k.get(j);if(P.count===0)continue;P.valuesByteOffset=M.byteLength;const L=ie.pad(ie.toView(P.values));_.push(L),E+=L.byteLength,M.byteLength+=L.byteLength}i.bufferViews.push(M);const R=i.bufferViews.length-1;for(const j of m){const P=k.get(j);P.count!==0&&(P.accessorDef.sparse={count:P.count,indices:{bufferView:N,byteOffset:P.indicesByteOffset,componentType:A},values:{bufferView:R,byteOffset:P.valuesByteOffset}})}return{buffers:_,byteLength:E}}if(i.accessors=[],i.bufferViews=[],i.samplers=[],i.textures=[],i.images=r.listTextures().map((m,S)=>{const x=a.createPropertyDef(m);m.getMimeType()&&(x.mimeType=m.getMimeType());const _=m.getImage();return _&&a.createImageData(x,_,m),a.imageIndexMap.set(m,S),x}),u.filter(m=>m.prewriteTypes.includes(Z.ACCESSOR)).forEach(m=>m.prewrite(a,Z.ACCESSOR)),r.listAccessors().forEach(m=>{const S=a.accessorUsageGroupedByParent,x=a.accessorParents;if(a.accessorIndexMap.has(m))return;const _=a.getAccessorUsage(m);if(a.addAccessorToUsageGroup(m,_),S.has(_)){const E=s.listParents(m).find(k=>k.propertyType!==Z.ROOT);x.set(m,E)}}),u.filter(m=>m.prewriteTypes.includes(Z.BUFFER)).forEach(m=>m.prewrite(a,Z.BUFFER)),(r.listAccessors().length>0||a.otherBufferViews.size>0||r.listTextures().length>0&&n.format===Jt.GLB)&&r.listBuffers().length===0)throw new Error("Buffer required for Document resources, but none was found.");i.buffers=[],r.listBuffers().forEach((m,S)=>{const x=a.createPropertyDef(m),_=a.accessorUsageGroupedByParent,E=m.listParents().filter(M=>M instanceof W),k=new Set(E.map(M=>a.accessorParents.get(M))),b=new Map(Array.from(k).map((M,R)=>[M,R])),v={};for(const M of E){var T;if(a.accessorIndexMap.has(M))continue;const R=a.getAccessorUsage(M);let j=R;if(_.has(R)){const P=a.accessorParents.get(M);j+=`:${b.get(P)}`}v[T=j]||(v[T]={usage:R,accessors:[]}),v[j].accessors.push(M)}const A=[],O=i.buffers.length;let N=0;for(const{usage:M,accessors:R}of Object.values(v))if(M===rr.ARRAY_BUFFER&&n.vertexLayout===Mr.INTERLEAVED){const j=p(R,O,N);N+=j.byteLength;for(const P of j.buffers)A.push(P)}else if(M===rr.ARRAY_BUFFER)for(const j of R){const P=p([j],O,N);N+=P.byteLength;for(const L of P.buffers)A.push(L)}else if(M===rr.SPARSE){const j=y(R,O,N);N+=j.byteLength;for(const P of j.buffers)A.push(P)}else if(M===rr.ELEMENT_ARRAY_BUFFER){const j=Sn.BufferViewTarget.ELEMENT_ARRAY_BUFFER,P=h(R,O,N,j);N+=P.byteLength;for(const L of P.buffers)A.push(L)}else{const j=h(R,O,N);N+=j.byteLength;for(const P of j.buffers)A.push(P)}if(a.imageBufferViews.length&&S===0){for(let M=0;M<a.imageBufferViews.length;M++)if(i.bufferViews[i.images[M].bufferView].byteOffset=N,N+=a.imageBufferViews[M].byteLength,A.push(a.imageBufferViews[M]),N%8){const R=8-N%8;N+=R,A.push(new Uint8Array(R))}}if(a.otherBufferViews.has(m))for(const M of a.otherBufferViews.get(m))i.bufferViews.push({buffer:O,byteOffset:N,byteLength:M.byteLength}),a.otherBufferViewsIndexMap.set(M,i.bufferViews.length-1),N+=M.byteLength,A.push(M);if(N){let M;n.format===Jt.GLB?M=Ir:(M=a.bufferURIGenerator.createURI(m,"bin"),x.uri=M),x.byteLength=N,a.assignResourceURI(M,ie.concat(A),!0)}i.buffers.push(x),a.bufferIndexMap.set(m,S)}),r.listAccessors().find(m=>!m.getBuffer())&&l.warn("Skipped writing one or more Accessors: no Buffer assigned."),u.filter(m=>m.prewriteTypes.includes(Z.MATERIAL)).forEach(m=>m.prewrite(a,Z.MATERIAL)),i.materials=r.listMaterials().map((m,S)=>{const x=a.createPropertyDef(m);if(m.getAlphaMode()!==Tn.AlphaMode.OPAQUE&&(x.alphaMode=m.getAlphaMode()),m.getAlphaMode()===Tn.AlphaMode.MASK&&(x.alphaCutoff=m.getAlphaCutoff()),m.getDoubleSided()&&(x.doubleSided=!0),x.pbrMetallicRoughness={},ve.eq(m.getBaseColorFactor(),[1,1,1,1])||(x.pbrMetallicRoughness.baseColorFactor=m.getBaseColorFactor()),ve.eq(m.getEmissiveFactor(),[0,0,0])||(x.emissiveFactor=m.getEmissiveFactor()),m.getRoughnessFactor()!==1&&(x.pbrMetallicRoughness.roughnessFactor=m.getRoughnessFactor()),m.getMetallicFactor()!==1&&(x.pbrMetallicRoughness.metallicFactor=m.getMetallicFactor()),m.getBaseColorTexture()){const _=m.getBaseColorTexture(),E=m.getBaseColorTextureInfo();x.pbrMetallicRoughness.baseColorTexture=a.createTextureInfoDef(_,E)}if(m.getEmissiveTexture()){const _=m.getEmissiveTexture(),E=m.getEmissiveTextureInfo();x.emissiveTexture=a.createTextureInfoDef(_,E)}if(m.getNormalTexture()){const _=m.getNormalTexture(),E=m.getNormalTextureInfo(),k=a.createTextureInfoDef(_,E);m.getNormalScale()!==1&&(k.scale=m.getNormalScale()),x.normalTexture=k}if(m.getOcclusionTexture()){const _=m.getOcclusionTexture(),E=m.getOcclusionTextureInfo(),k=a.createTextureInfoDef(_,E);m.getOcclusionStrength()!==1&&(k.strength=m.getOcclusionStrength()),x.occlusionTexture=k}if(m.getMetallicRoughnessTexture()){const _=m.getMetallicRoughnessTexture(),E=m.getMetallicRoughnessTextureInfo();x.pbrMetallicRoughness.metallicRoughnessTexture=a.createTextureInfoDef(_,E)}return a.materialIndexMap.set(m,S),x}),u.filter(m=>m.prewriteTypes.includes(Z.MESH)).forEach(m=>m.prewrite(a,Z.MESH)),i.meshes=r.listMeshes().map((m,S)=>{const x=a.createPropertyDef(m);let _=null;return x.primitives=m.listPrimitives().map(E=>{const k={attributes:{}};k.mode=E.getMode();const b=E.getMaterial();b&&(k.material=a.materialIndexMap.get(b)),Object.keys(E.getExtras()).length&&(k.extras=E.getExtras());const v=E.getIndices();v&&(k.indices=a.accessorIndexMap.get(v));for(const T of E.listSemantics())k.attributes[T]=a.accessorIndexMap.get(E.getAttribute(T));for(const T of E.listTargets()){const A={};for(const O of T.listSemantics())A[O]=a.accessorIndexMap.get(T.getAttribute(O));k.targets=k.targets||[],k.targets.push(A)}return E.listTargets().length&&!_&&(_=E.listTargets().map(T=>T.getName())),k}),m.getWeights().length&&(x.weights=m.getWeights()),_&&(x.extras=x.extras||{},x.extras.targetNames=_),a.meshIndexMap.set(m,S),x}),i.cameras=r.listCameras().map((m,S)=>{const x=a.createPropertyDef(m);if(x.type=m.getType(),x.type===Cn.Type.PERSPECTIVE){x.perspective={znear:m.getZNear(),zfar:m.getZFar(),yfov:m.getYFov()};const _=m.getAspectRatio();_!==null&&(x.perspective.aspectRatio=_)}else x.orthographic={znear:m.getZNear(),zfar:m.getZFar(),xmag:m.getXMag(),ymag:m.getYMag()};return a.cameraIndexMap.set(m,S),x}),i.nodes=r.listNodes().map((m,S)=>{const x=a.createPropertyDef(m);return ve.eq(m.getTranslation(),[0,0,0])||(x.translation=m.getTranslation()),ve.eq(m.getRotation(),[0,0,0,1])||(x.rotation=m.getRotation()),ve.eq(m.getScale(),[1,1,1])||(x.scale=m.getScale()),m.getWeights().length&&(x.weights=m.getWeights()),a.nodeIndexMap.set(m,S),x}),i.skins=r.listSkins().map((m,S)=>{const x=a.createPropertyDef(m),_=m.getInverseBindMatrices();_&&(x.inverseBindMatrices=a.accessorIndexMap.get(_));const E=m.getSkeleton();return E&&(x.skeleton=a.nodeIndexMap.get(E)),x.joints=m.listJoints().map(k=>a.nodeIndexMap.get(k)),a.skinIndexMap.set(m,S),x}),r.listNodes().forEach((m,S)=>{const x=i.nodes[S],_=m.getMesh();_&&(x.mesh=a.meshIndexMap.get(_));const E=m.getCamera();E&&(x.camera=a.cameraIndexMap.get(E));const k=m.getSkin();k&&(x.skin=a.skinIndexMap.get(k)),m.listChildren().length>0&&(x.children=m.listChildren().map(b=>a.nodeIndexMap.get(b)))}),i.animations=r.listAnimations().map((m,S)=>{const x=a.createPropertyDef(m),_=new Map;return x.samplers=m.listSamplers().map((E,k)=>{const b=a.createPropertyDef(E);return b.input=a.accessorIndexMap.get(E.getInput()),b.output=a.accessorIndexMap.get(E.getOutput()),b.interpolation=E.getInterpolation(),_.set(E,k),b}),x.channels=m.listChannels().map(E=>{const k=a.createPropertyDef(E);return k.sampler=_.get(E.getSampler()),k.target={node:a.nodeIndexMap.get(E.getTargetNode()),path:E.getTargetPath()},k}),a.animationIndexMap.set(m,S),x}),i.scenes=r.listScenes().map((m,S)=>{const x=a.createPropertyDef(m);return x.nodes=m.listChildren().map(_=>a.nodeIndexMap.get(_)),a.sceneIndexMap.set(m,S),x});const w=r.getDefaultScene();return w&&(i.scene=r.listScenes().indexOf(w)),i.extensionsUsed=u.map(m=>m.extensionName),i.extensionsRequired=f.map(m=>m.extensionName),u.forEach(m=>m.write(a)),Ny(i),o}}function Ny(t){const e=[];for(const n in t){const s=t[n];(Array.isArray(s)&&s.length===0||s===null||s===""||s&&typeof s=="object"&&Object.keys(s).length===0)&&e.push(n)}for(const n of e)delete t[n]}var Rr;(function(t){t[t.JSON=1313821514]="JSON",t[t.BIN=5130562]="BIN"})(Rr||(Rr={}));class Oy{constructor(){this._logger=it.DEFAULT_INSTANCE,this._extensions=new Set,this._dependencies={},this._vertexLayout=Mr.INTERLEAVED,this.lastReadBytes=0,this.lastWriteBytes=0}setLogger(e){return this._logger=e,this}registerExtensions(e){for(const n of e)this._extensions.add(n),n.register();return this}registerDependencies(e){return Object.assign(this._dependencies,e),this}setVertexLayout(e){return this._vertexLayout=e,this}async read(e){return await this.readJSON(await this.readAsJSON(e))}async readAsJSON(e){const n=await this.readURI(e,"view");this.lastReadBytes=n.byteLength;const s=za(n)?this._binaryToJSON(n):{json:JSON.parse(ie.decodeText(n)),resources:{}};return await this._readResourcesExternal(s,this.dirname(e)),this._readResourcesInternal(s),s}async readJSON(e){return e=this._copyJSON(e),this._readResourcesInternal(e),wy.read(e,{extensions:Array.from(this._extensions),dependencies:this._dependencies,logger:this._logger})}async binaryToJSON(e){const n=this._binaryToJSON(ie.assertView(e));this._readResourcesInternal(n);const s=n.json;if(s.buffers&&s.buffers.some(r=>Cy(n,r)))throw new Error("Cannot resolve external buffers with binaryToJSON().");if(s.images&&s.images.some(r=>Iy(n,r)))throw new Error("Cannot resolve external images with binaryToJSON().");return n}async readBinary(e){return this.readJSON(await this.binaryToJSON(ie.assertView(e)))}async writeJSON(e,n={}){if(n.format===Jt.GLB&&e.getRoot().listBuffers().length>1)throw new Error("GLB must have 0–1 buffers.");return Ay.write(e,{format:n.format||Jt.GLTF,basename:n.basename||"",logger:this._logger,vertexLayout:this._vertexLayout,dependencies:We({},this._dependencies),extensions:Array.from(this._extensions)})}async writeBinary(e){const{json:n,resources:s}=await this.writeJSON(e,{format:Jt.GLB}),r=new Uint32Array([1179937895,2,12]),i=JSON.stringify(n),o=ie.pad(ie.encodeText(i),32),a=ie.toView(new Uint32Array([o.byteLength,1313821514])),l=ie.concat([a,o]);r[r.length-1]+=l.byteLength;const c=Object.values(s)[0];if(!c||!c.byteLength)return ie.concat([ie.toView(r),l]);const u=ie.pad(c,0),f=ie.toView(new Uint32Array([u.byteLength,5130562])),h=ie.concat([f,u]);return r[r.length-1]+=h.byteLength,ie.concat([ie.toView(r),l,h])}async _readResourcesExternal(e,n){var s=this;const r=e.json.images||[],i=e.json.buffers||[],o=[...r,...i].map(async function(a){const l=a.uri;if(!l||l.match(/data:/))return Promise.resolve();e.resources[l]=await s.readURI(s.resolve(n,l),"view"),s.lastReadBytes+=e.resources[l].byteLength});await Promise.all(o)}_readResourcesInternal(e){function n(i){if(i.uri){if(i.uri in e.resources){ie.assertView(e.resources[i.uri]);return}if(i.uri.match(/data:/)){const o=`__${uy()}.${ns.extension(i.uri)}`;e.resources[o]=ie.createBufferFromDataURI(i.uri),i.uri=o}}}(e.json.images||[]).forEach(i=>{if(i.bufferView===void 0&&i.uri===void 0)throw new Error("Missing resource URI or buffer view.");n(i)}),(e.json.buffers||[]).forEach(n)}_copyJSON(e){const{images:n,buffers:s}=e.json;return e={json:We({},e.json),resources:We({},e.resources)},n&&(e.json.images=n.map(r=>We({},r))),s&&(e.json.buffers=s.map(r=>We({},r))),e}_binaryToJSON(e){if(!za(e))throw new Error("Invalid glTF 2.0 binary.");const n=new Uint32Array(e.buffer,e.byteOffset+12,2);if(n[1]!==Rr.JSON)throw new Error("Missing required GLB JSON chunk.");const s=20,r=n[0],i=ie.decodeText(ie.toView(e,s,r)),o=JSON.parse(i),a=s+r;if(e.byteLength<=a)return{json:o,resources:{}};const l=new Uint32Array(e.buffer,e.byteOffset+a,2);if(l[1]!==Rr.BIN)return{json:o,resources:{}};const c=l[0],u=ie.toView(e,a+8,c);return{json:o,resources:{[Ir]:u}}}}function Cy(t,e){return e.uri!==void 0&&!(e.uri in t.resources)}function Iy(t,e){return e.uri!==void 0&&!(e.uri in t.resources)&&e.bufferView===void 0}function za(t){if(t.byteLength<3*Uint32Array.BYTES_PER_ELEMENT)return!1;const e=new Uint32Array(t.buffer,t.byteOffset,3);return e[0]===1179937895&&e[1]===2}class My extends Oy{constructor(e=xs.DEFAULT_INIT){super(),this._fetchConfig=void 0,this._fetchConfig=e}async readURI(e,n){const s=await fetch(e,this._fetchConfig);switch(n){case"view":return new Uint8Array(await s.arrayBuffer());case"text":return s.text()}}resolve(e,n){return xs.resolve(e,n)}dirname(e){return xs.dirname(e)}}async function qc(t){const e=URL.createObjectURL(new Blob([t])),n=new My,s=await n.read(e);return await n.writeBinary(s)}var mi,Fa;function jy(){return Fa||(Fa=1,mi=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var s,r,i;if(Array.isArray(e)){if(s=e.length,s!=n.length)return!1;for(r=s;r--!==0;)if(!t(e[r],n[r]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(i=Object.keys(e),s=i.length,s!==Object.keys(n).length)return!1;for(r=s;r--!==0;)if(!Object.prototype.hasOwnProperty.call(n,i[r]))return!1;for(r=s;r--!==0;){var o=i[r];if(!t(e[o],n[o]))return!1}return!0}return e!==e&&n!==n}),mi}var Ry=jy();const Py=yh(Ry),dn=ks("🦊🚂🎬"),ir=0;function Ba(t){if(!t)return[];const e=new Set;function n(r){if(r&&typeof r=="object"&&"minecraft:custom_model_data"in r){const i=r["minecraft:custom_model_data"];if(i?.floats)for(const o of i.floats)e.add(o)}}function s(r){for(const i of Object.keys(r)){const o=r[i];n(o.item?.components),o.attachments&&s(o.attachments)}}return t.model&&(n(t.model.item?.components),t.model.attachments&&s(t.model.attachments)),Array.from(e).sort((r,i)=>r-i)}const ct=oo((t,e)=>{const n=s=>{const r=typeof s=="function"?s(e()):s,i=e(),o={...r};let a=!1;if("metadata"in o&&o.metadata){const l={...i.metadata},c={...o.metadata};delete l.orbitControls,delete c.orbitControls,Py(l,c)||(a=!0)}return"saved"in o&&o.saved===!0?o.saved=!0:a&&(o.saved=!1),t(o)};return{saved:!1,metadata:{schemaVersion:ir,projectName:"",createdAt:null,lastModifiedAt:null,orbitControls:void 0},cart:null,modelIds:[],modelFiles:new Map,selectedObjectPath:void 0,setSelectedObjectPath:s=>n({selectedObjectPath:s}),setMetadata:s=>n({metadata:s}),setProjectName:s=>n(r=>({metadata:{...r.metadata,projectName:s}})),setCart:s=>n({cart:s,modelIds:Ba(s)}),clearCart:()=>n({cart:null}),saveProject:async s=>{const r=ct.getState();if(!r.cart)throw new Error("No cart data to save.");const i=`${r.metadata.projectName||"TCA-Project"}.tcaproj`,o={...r.metadata,createdAt:r.metadata.createdAt||new Date},a={"metadata.json":ks(X.stringify(o)),"cart.json":ks(X.stringify(r.cart))};for(const p of r.modelIds){const y=r.modelFiles.get(p);if(!y)continue;const g=new Uint8Array(y.slice(0,4));let w=".gltf";if(g[0]===103&&g[1]===108&&g[2]===84&&g[3]===70&&(w=".glb"),w===".gltf"){const m=await qc(y);a[`models/${p}.glb`]=m}else a[`models/${p}.glb`]=new Uint8Array(y)}const l=Kd(a,{level:9,mem:8}),c=new Uint8Array(dn.length+l.length);c.set(dn),c.set(l,dn.length);const u=new Uint8Array(c.length);u.set(c);const f=new Blob([u],{type:"application/binary"}),h=r.fileHandle;if(!h||s){const p=await yn.promise(Promise.race([md(f,{fileName:i,extensions:[".tcaproj"],mimeTypes:["application/binary"],id:"tca-project"}),new Promise((y,g)=>setTimeout(()=>g(new Error("Save timed out.")),15e3))]),{loading:"Saving project...",success:"Project saved successfully!",error:"Failed to save the project."}).unwrap();p&&(n({saved:!0,fileHandle:p,metadata:{...o}}),p.name!==i&&n({metadata:{...o,lastModifiedAt:new Date,projectName:p.name.replace(/\.tcaproj$/,"")}}))}else await yn.promise(Promise.race([h.createWritable().then(async y=>(await y.write(u),await y.close(),!0)).catch(()=>!1),new Promise((y,g)=>setTimeout(()=>g(new Error("Save timed out.")),15e3))]),{loading:"Saving project...",success:"Project saved successfully!",error:"Failed to save the project."}).unwrap()&&n({saved:!0,fileHandle:h,metadata:{...o,lastModifiedAt:new Date}})},loadProjectFromFile:async()=>{const s=await uo({description:"Select a TCA-Project file",extensions:[".tcaproj"],mimeTypes:["application/binary"],id:"tca-project",startIn:"documents"}).catch(()=>null);if(!s)throw new Error("No file selected.");const r=await s.arrayBuffer(),i=new Uint8Array(dn.length);if(i.set(dn),!new Uint8Array(r.slice(0,dn.length)).every((c,u)=>c===i[u]))throw new Error("Invalid TCA-Project file format.");const a=new Uint8Array(r.slice(dn.length)),l=await Hd(a);for(const[c,u]of Object.entries(l))if(c==="metadata.json"){const f=X.parse(zi(u)),h=g1.safeParse(f);if(!h.success){console.error("Invalid metadata in project:",h.error),yn.error("We couldn't load your project. The metadata is invalid. See the browser console for more details.",{duration:1e4}),n({metadata:{schemaVersion:ir,projectName:"",createdAt:null,lastModifiedAt:null},cart:null,fileHandle:void 0});continue}n({metadata:h.data})}else if(c==="cart.json"){const f=X.parse(zi(u)),h=yc.safeParse(f);if(!h.success){console.error("Invalid cart data in project:",h.error),yn.error("We couldn't load your project. The cart data is invalid. See the browser console for more details.",{duration:1e4}),n({metadata:{schemaVersion:ir,projectName:"",createdAt:null,lastModifiedAt:null},cart:null,fileHandle:void 0});continue}n({cart:h.data,modelIds:Ba(h.data)})}else if(c.startsWith("models/")&&c.endsWith(".glb")){const f=parseInt(c.replace("models/","").replace(".glb",""));isNaN(f)||n(h=>{const p=new Map(h.modelFiles);return p.set(f,Tl(u.buffer)),{modelFiles:p}})}else console.warn(`Unknown file in TCA-Project: ${c}`);n({saved:!0,fileHandle:s.handle})},reset:()=>n({metadata:{schemaVersion:ir,projectName:"",createdAt:null,lastModifiedAt:null},cart:null,fileHandle:void 0}),setModelFile:(s,r)=>{n(i=>{const o=new Map(i.modelFiles);return r?o.set(s,r):o.delete(s),{modelFiles:o,saved:!1}})},removeModelFile:s=>{n(r=>{const i=new Map(r.modelFiles);return i.delete(s),{modelFiles:i,saved:!1}})},logState:()=>{const s=e();console.log("ProjectStore state:",s)}}});function $y(){const t=$.c(56),e=ct(),[n,s]=F.useState(document.fullscreenElement),[r,i]=F.useState(!1),[o,a]=F.useState(!1),l=Ly;let c,u;t[0]===Symbol.for("react.memo_cache_sentinel")?(c=()=>{const ee=()=>{s(document.fullscreenElement)};return document.addEventListener("fullscreenchange",ee),()=>{document.removeEventListener("fullscreenchange",ee)}},u=[],t[0]=c,t[1]=u):(c=t[0],u=t[1]),F.useEffect(c,u);let f;t[2]!==e?(f=async()=>{i(!0),await e.saveProject(),e.reset(),i(!1)},t[2]=e,t[3]=f):f=t[3];const h=f;let p,y;t[4]!==e?(p=()=>{const ee=Y=>{Y.key==="s"&&(Y.ctrlKey||Y.metaKey)&&e.cart?(Y.preventDefault(),e.saveProject().catch(Dy)):Y.key===","&&(Y.ctrlKey||Y.metaKey)&&(Y.preventDefault(),a(!0))};return window.addEventListener("keydown",ee),()=>{window.removeEventListener("keydown",ee)}},y=[e],t[4]=e,t[5]=p,t[6]=y):(p=t[5],y=t[6]),F.useEffect(p,y);const g=e.metadata.projectName||"Untitled Project";let w;t[7]!==e.saved?(w=e.saved?d.jsx(vl,{}):d.jsx("span",{style:{display:"inline-block",width:10,height:10,borderRadius:"50%",background:"currentColor",marginRight:4,aspectRatio:"1 / 1"}}),t[7]=e.saved,t[8]=w):w=t[8];let m;t[9]!==h||t[10]!==r||t[11]!==w?(m=d.jsx(nt,{className:"h-4 w-4",variant:"ghost",size:"icon",disabled:r,onClick:h,children:w}),t[9]=h,t[10]=r,t[11]=w,t[12]=m):m=t[12];let S;t[13]!==g||t[14]!==m?(S=d.jsxs("div",{className:"bg-card flex items-center gap-2 px-2",children:[g,m]}),t[13]=g,t[14]=m,t[15]=S):S=t[15];let x;t[16]===Symbol.for("react.memo_cache_sentinel")?(x=d.jsx(Yh,{children:"File"}),t[16]=x):x=t[16];let _;t[17]!==e?(_=async()=>e.saveProject(),t[17]=e,t[18]=_):_=t[18];let E;t[19]===Symbol.for("react.memo_cache_sentinel")?(E=d.jsx(Qo,{children:"CTRL + S"}),t[19]=E):E=t[19];let k;t[20]!==r||t[21]!==_?(k=d.jsxs(Pn,{disabled:r,onClick:_,children:["Save Project ",E]}),t[20]=r,t[21]=_,t[22]=k):k=t[22];let b;t[23]!==e?(b=async()=>e.saveProject(!0),t[23]=e,t[24]=b):b=t[24];let v;t[25]!==r||t[26]!==b?(v=d.jsx(Pn,{disabled:r,onClick:b,children:"Save Project As"}),t[25]=r,t[26]=b,t[27]=v):v=t[27];let T;t[28]===Symbol.for("react.memo_cache_sentinel")?(T=d.jsx(li,{}),t[28]=T):T=t[28];let A;t[29]!==e?(A=async()=>e.loadProjectFromFile(),t[29]=e,t[30]=A):A=t[30];let O;t[31]!==r||t[32]!==A?(O=d.jsx(Pn,{disabled:r,onClick:A,children:"Load Project"}),t[31]=r,t[32]=A,t[33]=O):O=t[33];let N;t[34]!==h||t[35]!==r?(N=d.jsx(Pn,{disabled:r,onClick:h,children:"New Project"}),t[34]=h,t[35]=r,t[36]=N):N=t[36];let M;t[37]===Symbol.for("react.memo_cache_sentinel")?(M=d.jsx(li,{}),t[37]=M):M=t[37];let R;t[38]===Symbol.for("react.memo_cache_sentinel")?(R=()=>a(!0),t[38]=R):R=t[38];let j,P,L;t[39]===Symbol.for("react.memo_cache_sentinel")?(j=d.jsxs(Pn,{onClick:R,children:["Preferences",d.jsx(Qo,{children:"CTRL + ,"})]}),P=d.jsx(li,{}),L=d.jsx(Pn,{children:"Print"}),t[39]=j,t[40]=P,t[41]=L):(j=t[39],P=t[40],L=t[41]);let U;t[42]!==k||t[43]!==v||t[44]!==O||t[45]!==N?(U=d.jsxs(Xo,{children:[x,d.jsxs(Gh,{children:[k,v,T,O,N,M,j,P,L]})]}),t[42]=k,t[43]=v,t[44]=O,t[45]=N,t[46]=U):U=t[46];let z;t[47]!==n?(z=d.jsx(Xo,{children:d.jsx(nt,{className:"ml-auto",variant:"ghost",size:"icon",onClick:l,children:n?d.jsx(ef,{}):d.jsx(Ju,{})})}),t[47]=n,t[48]=z):z=t[48];let ne;t[49]!==o?(ne=d.jsx(By,{open:o,setOpen:a}),t[49]=o,t[50]=ne):ne=t[50];let G;return t[51]!==U||t[52]!==z||t[53]!==ne||t[54]!==S?(G=d.jsxs(Wh,{className:"rounded-none",children:[S,U,z,ne]}),t[51]=U,t[52]=z,t[53]=ne,t[54]=S,t[55]=G):G=t[55],G}function Dy(t){console.error("Save failed:",t)}function Ly(){document.fullscreenElement?document.exitFullscreen().catch(zy):document.documentElement.requestFullscreen().catch(Fy)}function zy(t){console.error("Error exiting fullscreen mode:",t)}function Fy(t){console.error("Error entering fullscreen mode:",t)}function By(t){const e=$.c(61),{open:n,setOpen:s}=t,r=$s();let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i=d.jsx(Zh,{children:"Preferences"}),e[0]=i):i=e[0];let o;e[1]===Symbol.for("react.memo_cache_sentinel")?(o=d.jsx(yt,{htmlFor:"theme-select",children:"Theme:"}),e[1]=o):o=e[1];let a;e[2]!==r?(a=z=>{if(z!=="light"&&z!=="dark"){console.warn("Invalid theme selected:",z);return}r.setTheme(z)},e[2]=r,e[3]=a):a=e[3];let l;e[4]===Symbol.for("react.memo_cache_sentinel")?(l=d.jsx(Ni,{className:"h-10 w-full",id:"theme-select",children:d.jsx(Ai,{placeholder:"Select theme"})}),e[4]=l):l=e[4];let c;e[5]===Symbol.for("react.memo_cache_sentinel")?(c=d.jsx(Oi,{children:d.jsxs(Ti,{children:[d.jsx(Ci,{children:"Available Themes"}),d.jsx(Tr,{value:"light",children:"Light"}),d.jsx(Tr,{value:"dark",children:"Dark"})]})}),e[5]=c):c=e[5];let u;e[6]!==r.theme||e[7]!==a?(u=d.jsxs("div",{className:"flex flex-col",children:[o,d.jsxs(ki,{value:r.theme,onValueChange:a,children:[l,c]})]}),e[6]=r.theme,e[7]=a,e[8]=u):u=e[8];let f;e[9]===Symbol.for("react.memo_cache_sentinel")?(f=d.jsx(yt,{htmlFor:"save-interval",children:"Auto-save Interval (seconds):"}),e[9]=f):f=e[9];let h;e[10]!==r?(h=z=>{const ne=parseInt(z.target.value,10);if(isNaN(ne)||ne<1){console.warn("Invalid save interval:",z.target.value);return}r.setSaveInterval(ne)},e[10]=r,e[11]=h):h=e[11];let p;e[12]!==r.saveInterval||e[13]!==h?(p=d.jsxs("div",{className:"flex flex-col",children:[f,d.jsx(Cl,{id:"save-interval",type:"number",min:1,value:r.saveInterval,onChange:h,className:"h-10 w-full"})]}),e[12]=r.saveInterval,e[13]=h,e[14]=p):p=e[14];let y;e[15]===Symbol.for("react.memo_cache_sentinel")?(y=d.jsx(yt,{htmlFor:"grid-color",className:"mb-2 block",children:"Grid Color:"}),e[15]=y):y=e[15];let g;e[16]!==r?(g=z=>{r.setGridColor(z.hex)},e[16]=r,e[17]=g):g=e[17];let w;e[18]!==r.gridColor||e[19]!==g?(w=d.jsxs("div",{className:"flex flex-col",children:[y,d.jsx(Jh,{defaultColor:r.gridColor,onChangeComplete:g})]}),e[18]=r.gridColor,e[19]=g,e[20]=w):w=e[20];let m;e[21]===Symbol.for("react.memo_cache_sentinel")?(m=d.jsx(Kt,{asChild:!0,children:d.jsx(qs,{className:"mr-[0.5] inline h-3"})}),e[21]=m):m=e[21];let S;e[22]===Symbol.for("react.memo_cache_sentinel")?(S=d.jsxs(yt,{htmlFor:"debug-text",className:"mb-2 block",children:[d.jsxs(Gt,{children:[m,d.jsx(Ht,{children:d.jsx("p",{children:"Debug text displays additional information about the 3D scene, such as object coordinates and rendering details. It can be useful for troubleshooting but may clutter the view."})})]}),"Debug Text:"]}),e[22]=S):S=e[22];let x;e[23]!==r?(x=z=>r.setDebugText(z),e[23]=r,e[24]=x):x=e[24];let _;e[25]!==r.debugText||e[26]!==x?(_=d.jsxs("div",{className:"flex flex-row gap-2",children:[S,d.jsx(Gs,{id:"debug-text",checked:r.debugText,onCheckedChange:x})]}),e[25]=r.debugText,e[26]=x,e[27]=_):_=e[27];let E;e[28]===Symbol.for("react.memo_cache_sentinel")?(E=d.jsx(Kt,{asChild:!0,children:d.jsx(qs,{className:"mr-[0.5] inline h-3"})}),e[28]=E):E=e[28];let k;e[29]===Symbol.for("react.memo_cache_sentinel")?(k=d.jsxs(yt,{htmlFor:"ssao-enabled",className:"mb-2 block",children:[d.jsxs(Gt,{children:[E,d.jsx(Ht,{children:d.jsx("p",{children:"Screen Space Ambient Occlusion (SSAO) is a shading method that adds soft shadows to enhance depth perception in 3D scenes. It can improve visual realism but may impact performance."})})]}),"SSAO Enabled:"]}),e[29]=k):k=e[29];let b;e[30]!==r?(b=z=>r.setSSAOEnabled(z),e[30]=r,e[31]=b):b=e[31];let v;e[32]!==r.SSAOEnabled||e[33]!==b?(v=d.jsxs("div",{className:"flex flex-row gap-2",children:[k,d.jsx(Gs,{id:"ssao-enabled",checked:r.SSAOEnabled,onCheckedChange:b})]}),e[32]=r.SSAOEnabled,e[33]=b,e[34]=v):v=e[34];let T;e[35]===Symbol.for("react.memo_cache_sentinel")?(T=d.jsx(Kt,{asChild:!0,children:d.jsx(qs,{className:"mr-[0.5] inline h-3"})}),e[35]=T):T=e[35];let A;e[36]===Symbol.for("react.memo_cache_sentinel")?(A=d.jsxs(yt,{htmlFor:"dof-enabled",className:"mb-2 block",children:[d.jsxs(Gt,{children:[T,d.jsx(Ht,{children:d.jsx("p",{children:"Depth of Field (DOF) creates a blurred effect on objects outside the focus area, simulating camera lens behavior. It enhances realism but can be resource-intensive and may affect performance."})})]}),"Depth of Field Enabled:"]}),e[36]=A):A=e[36];let O;e[37]!==r?(O=z=>r.setDOFEnabled(z),e[37]=r,e[38]=O):O=e[38];let N;e[39]!==r.DOFEnabled||e[40]!==O?(N=d.jsxs("div",{className:"flex flex-row gap-2",children:[A,d.jsx(Gs,{id:"dof-enabled",checked:r.DOFEnabled,onCheckedChange:O})]}),e[39]=r.DOFEnabled,e[40]=O,e[41]=N):N=e[41];let M;e[42]===Symbol.for("react.memo_cache_sentinel")?(M=d.jsx(Kt,{asChild:!0,children:d.jsx(qs,{className:"mr-[0.5] inline h-3"})}),e[42]=M):M=e[42];let R;e[43]===Symbol.for("react.memo_cache_sentinel")?(R=d.jsxs(yt,{htmlFor:"control-damping-enabled",className:"mb-2 block",children:[d.jsxs(Gt,{children:[M,d.jsx(Ht,{children:d.jsx("p",{children:"Enabling control damping makes camera movements smoother by adding inertia. This results in a more natural feel when orbiting or panning the view, but may introduce a slight delay in responsiveness."})})]}),"Orbit Controls Damping:"]}),e[43]=R):R=e[43];let j;e[44]!==r?(j=z=>r.setControlDamping(z),e[44]=r,e[45]=j):j=e[45];let P;e[46]!==r.controlDamping||e[47]!==j?(P=d.jsxs("div",{className:"flex flex-row gap-2",children:[R,d.jsx(Gs,{id:"control-damping",checked:r.controlDamping,onCheckedChange:j})]}),e[46]=r.controlDamping,e[47]=j,e[48]=P):P=e[48];let L;e[49]!==w||e[50]!==_||e[51]!==v||e[52]!==N||e[53]!==P||e[54]!==u||e[55]!==p?(L=d.jsx(Bh,{children:d.jsxs(Uh,{children:[i,d.jsx(Vh,{asChild:!0,children:d.jsxs("div",{children:["Here you can adjust your preferences for the application.",d.jsxs("div",{className:"mt-4 flex flex-col gap-4",children:[u,p,w,_,v,N,P]})]})})]})}),e[49]=w,e[50]=_,e[51]=v,e[52]=N,e[53]=P,e[54]=u,e[55]=p,e[56]=L):L=e[56];let U;return e[57]!==n||e[58]!==s||e[59]!==L?(U=d.jsx(Lh,{open:n,onOpenChange:s,children:L}),e[57]=n,e[58]=s,e[59]=L,e[60]=U):U=e[60],U}function Uy(t){const e=$.c(8);let n,s;e[0]!==t?({className:n,...s}=t,e[0]=t,e[1]=n,e[2]=s):(n=e[1],s=e[2]);let r;e[3]!==n?(r=V("flex flex-col gap-2",n),e[3]=n,e[4]=r):r=e[4];let i;return e[5]!==s||e[6]!==r?(i=d.jsx(Qf,{"data-slot":"tabs",className:r,...s}),e[5]=s,e[6]=r,e[7]=i):i=e[7],i}function Zy(t){const e=$.c(8);let n,s;e[0]!==t?({className:n,...s}=t,e[0]=t,e[1]=n,e[2]=s):(n=e[1],s=e[2]);let r;e[3]!==n?(r=V("bg-muted text-muted-foreground inline-flex flex-wrap w-fit items-center justify-center rounded-lg p-[3px]",n),e[3]=n,e[4]=r):r=e[4];let i;return e[5]!==s||e[6]!==r?(i=d.jsx(Jf,{"data-slot":"tabs-list",className:r,...s}),e[5]=s,e[6]=r,e[7]=i):i=e[7],i}function or(t){const e=$.c(8);let n,s;e[0]!==t?({className:n,...s}=t,e[0]=t,e[1]=n,e[2]=s):(n=e[1],s=e[2]);let r;e[3]!==n?(r=V("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-9  items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 flex-1",n),e[3]=n,e[4]=r):r=e[4];let i;return e[5]!==s||e[6]!==r?(i=d.jsx(eh,{"data-slot":"tabs-trigger",className:r,...s}),e[5]=s,e[6]=r,e[7]=i):i=e[7],i}function ar(t){const e=$.c(8);let n,s;e[0]!==t?({className:n,...s}=t,e[0]=t,e[1]=n,e[2]=s):(n=e[1],s=e[2]);let r;e[3]!==n?(r=V("flex-1 outline-none",n),e[3]=n,e[4]=r):r=e[4];let i;return e[5]!==s||e[6]!==r?(i=d.jsx(th,{"data-slot":"tabs-content",className:r,...s}),e[5]=s,e[6]=r,e[7]=i):i=e[7],i}function Vy(t){const e=$.c(8);let n,s;e[0]!==t?({className:n,...s}=t,e[0]=t,e[1]=n,e[2]=s):(n=e[1],s=e[2]);let r;e[3]!==n?(r=V("w-full caption-bottom text-sm",n),e[3]=n,e[4]=r):r=e[4];let i;return e[5]!==s||e[6]!==r?(i=d.jsx("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:d.jsx("table",{"data-slot":"table",className:r,...s})}),e[5]=s,e[6]=r,e[7]=i):i=e[7],i}function Wy(t){const e=$.c(8);let n,s;e[0]!==t?({className:n,...s}=t,e[0]=t,e[1]=n,e[2]=s):(n=e[1],s=e[2]);let r;e[3]!==n?(r=V("[&_tr]:border-b",n),e[3]=n,e[4]=r):r=e[4];let i;return e[5]!==s||e[6]!==r?(i=d.jsx("thead",{"data-slot":"table-header",className:r,...s}),e[5]=s,e[6]=r,e[7]=i):i=e[7],i}function qy(t){const e=$.c(8);let n,s;e[0]!==t?({className:n,...s}=t,e[0]=t,e[1]=n,e[2]=s):(n=e[1],s=e[2]);let r;e[3]!==n?(r=V("[&_tr:last-child]:border-0",n),e[3]=n,e[4]=r):r=e[4];let i;return e[5]!==s||e[6]!==r?(i=d.jsx("tbody",{"data-slot":"table-body",className:r,...s}),e[5]=s,e[6]=r,e[7]=i):i=e[7],i}function Ua(t){const e=$.c(8);let n,s;e[0]!==t?({className:n,...s}=t,e[0]=t,e[1]=n,e[2]=s):(n=e[1],s=e[2]);let r;e[3]!==n?(r=V("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",n),e[3]=n,e[4]=r):r=e[4];let i;return e[5]!==s||e[6]!==r?(i=d.jsx("tr",{"data-slot":"table-row",className:r,...s}),e[5]=s,e[6]=r,e[7]=i):i=e[7],i}function Za(t){const e=$.c(8);let n,s;e[0]!==t?({className:n,...s}=t,e[0]=t,e[1]=n,e[2]=s):(n=e[1],s=e[2]);let r;e[3]!==n?(r=V("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",n),e[3]=n,e[4]=r):r=e[4];let i;return e[5]!==s||e[6]!==r?(i=d.jsx("th",{"data-slot":"table-head",className:r,...s}),e[5]=s,e[6]=r,e[7]=i):i=e[7],i}function Va(t){const e=$.c(8);let n,s;e[0]!==t?({className:n,...s}=t,e[0]=t,e[1]=n,e[2]=s):(n=e[1],s=e[2]);let r;e[3]!==n?(r=V("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",n),e[3]=n,e[4]=r):r=e[4];let i;return e[5]!==s||e[6]!==r?(i=d.jsx("td",{"data-slot":"table-cell",className:r,...s}),e[5]=s,e[6]=r,e[7]=i):i=e[7],i}class Yy{add(e,n,s){if(typeof arguments[0]!="string")for(let r in arguments[0])this.add(r,arguments[0][r],arguments[1]);else(Array.isArray(e)?e:[e]).forEach(function(r){this[r]=this[r]||[],n&&this[r][s?"unshift":"push"](n)},this)}run(e,n){this[e]=this[e]||[],this[e].forEach(function(s){s.call(n&&n.context?n.context:n,n)})}}class Gy{constructor(e){this.jsep=e,this.registered={}}register(){for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];n.forEach(r=>{if(typeof r!="object"||!r.name||!r.init)throw new Error("Invalid JSEP plugin format");this.registered[r.name]||(r.init(this.jsep),this.registered[r.name]=r)})}}class C{static get version(){return"1.4.0"}static toString(){return"JavaScript Expression Parser (JSEP) v"+C.version}static addUnaryOp(e){return C.max_unop_len=Math.max(e.length,C.max_unop_len),C.unary_ops[e]=1,C}static addBinaryOp(e,n,s){return C.max_binop_len=Math.max(e.length,C.max_binop_len),C.binary_ops[e]=n,s?C.right_associative.add(e):C.right_associative.delete(e),C}static addIdentifierChar(e){return C.additional_identifier_chars.add(e),C}static addLiteral(e,n){return C.literals[e]=n,C}static removeUnaryOp(e){return delete C.unary_ops[e],e.length===C.max_unop_len&&(C.max_unop_len=C.getMaxKeyLen(C.unary_ops)),C}static removeAllUnaryOps(){return C.unary_ops={},C.max_unop_len=0,C}static removeIdentifierChar(e){return C.additional_identifier_chars.delete(e),C}static removeBinaryOp(e){return delete C.binary_ops[e],e.length===C.max_binop_len&&(C.max_binop_len=C.getMaxKeyLen(C.binary_ops)),C.right_associative.delete(e),C}static removeAllBinaryOps(){return C.binary_ops={},C.max_binop_len=0,C}static removeLiteral(e){return delete C.literals[e],C}static removeAllLiterals(){return C.literals={},C}get char(){return this.expr.charAt(this.index)}get code(){return this.expr.charCodeAt(this.index)}constructor(e){this.expr=e,this.index=0}static parse(e){return new C(e).parse()}static getMaxKeyLen(e){return Math.max(0,...Object.keys(e).map(n=>n.length))}static isDecimalDigit(e){return e>=48&&e<=57}static binaryPrecedence(e){return C.binary_ops[e]||0}static isIdentifierStart(e){return e>=65&&e<=90||e>=97&&e<=122||e>=128&&!C.binary_ops[String.fromCharCode(e)]||C.additional_identifier_chars.has(String.fromCharCode(e))}static isIdentifierPart(e){return C.isIdentifierStart(e)||C.isDecimalDigit(e)}throwError(e){const n=new Error(e+" at character "+this.index);throw n.index=this.index,n.description=e,n}runHook(e,n){if(C.hooks[e]){const s={context:this,node:n};return C.hooks.run(e,s),s.node}return n}searchHook(e){if(C.hooks[e]){const n={context:this};return C.hooks[e].find(function(s){return s.call(n.context,n),n.node}),n.node}}gobbleSpaces(){let e=this.code;for(;e===C.SPACE_CODE||e===C.TAB_CODE||e===C.LF_CODE||e===C.CR_CODE;)e=this.expr.charCodeAt(++this.index);this.runHook("gobble-spaces")}parse(){this.runHook("before-all");const e=this.gobbleExpressions(),n=e.length===1?e[0]:{type:C.COMPOUND,body:e};return this.runHook("after-all",n)}gobbleExpressions(e){let n=[],s,r;for(;this.index<this.expr.length;)if(s=this.code,s===C.SEMCOL_CODE||s===C.COMMA_CODE)this.index++;else if(r=this.gobbleExpression())n.push(r);else if(this.index<this.expr.length){if(s===e)break;this.throwError('Unexpected "'+this.char+'"')}return n}gobbleExpression(){const e=this.searchHook("gobble-expression")||this.gobbleBinaryExpression();return this.gobbleSpaces(),this.runHook("after-expression",e)}gobbleBinaryOp(){this.gobbleSpaces();let e=this.expr.substr(this.index,C.max_binop_len),n=e.length;for(;n>0;){if(C.binary_ops.hasOwnProperty(e)&&(!C.isIdentifierStart(this.code)||this.index+e.length<this.expr.length&&!C.isIdentifierPart(this.expr.charCodeAt(this.index+e.length))))return this.index+=n,e;e=e.substr(0,--n)}return!1}gobbleBinaryExpression(){let e,n,s,r,i,o,a,l,c;if(o=this.gobbleToken(),!o||(n=this.gobbleBinaryOp(),!n))return o;for(i={value:n,prec:C.binaryPrecedence(n),right_a:C.right_associative.has(n)},a=this.gobbleToken(),a||this.throwError("Expected expression after "+n),r=[o,i,a];n=this.gobbleBinaryOp();){if(s=C.binaryPrecedence(n),s===0){this.index-=n.length;break}i={value:n,prec:s,right_a:C.right_associative.has(n)},c=n;const u=f=>i.right_a&&f.right_a?s>f.prec:s<=f.prec;for(;r.length>2&&u(r[r.length-2]);)a=r.pop(),n=r.pop().value,o=r.pop(),e={type:C.BINARY_EXP,operator:n,left:o,right:a},r.push(e);e=this.gobbleToken(),e||this.throwError("Expected expression after "+c),r.push(i,e)}for(l=r.length-1,e=r[l];l>1;)e={type:C.BINARY_EXP,operator:r[l-1].value,left:r[l-2],right:e},l-=2;return e}gobbleToken(){let e,n,s,r;if(this.gobbleSpaces(),r=this.searchHook("gobble-token"),r)return this.runHook("after-token",r);if(e=this.code,C.isDecimalDigit(e)||e===C.PERIOD_CODE)return this.gobbleNumericLiteral();if(e===C.SQUOTE_CODE||e===C.DQUOTE_CODE)r=this.gobbleStringLiteral();else if(e===C.OBRACK_CODE)r=this.gobbleArray();else{for(n=this.expr.substr(this.index,C.max_unop_len),s=n.length;s>0;){if(C.unary_ops.hasOwnProperty(n)&&(!C.isIdentifierStart(this.code)||this.index+n.length<this.expr.length&&!C.isIdentifierPart(this.expr.charCodeAt(this.index+n.length)))){this.index+=s;const i=this.gobbleToken();return i||this.throwError("missing unaryOp argument"),this.runHook("after-token",{type:C.UNARY_EXP,operator:n,argument:i,prefix:!0})}n=n.substr(0,--s)}C.isIdentifierStart(e)?(r=this.gobbleIdentifier(),C.literals.hasOwnProperty(r.name)?r={type:C.LITERAL,value:C.literals[r.name],raw:r.name}:r.name===C.this_str&&(r={type:C.THIS_EXP})):e===C.OPAREN_CODE&&(r=this.gobbleGroup())}return r?(r=this.gobbleTokenProperty(r),this.runHook("after-token",r)):this.runHook("after-token",!1)}gobbleTokenProperty(e){this.gobbleSpaces();let n=this.code;for(;n===C.PERIOD_CODE||n===C.OBRACK_CODE||n===C.OPAREN_CODE||n===C.QUMARK_CODE;){let s;if(n===C.QUMARK_CODE){if(this.expr.charCodeAt(this.index+1)!==C.PERIOD_CODE)break;s=!0,this.index+=2,this.gobbleSpaces(),n=this.code}this.index++,n===C.OBRACK_CODE?(e={type:C.MEMBER_EXP,computed:!0,object:e,property:this.gobbleExpression()},e.property||this.throwError('Unexpected "'+this.char+'"'),this.gobbleSpaces(),n=this.code,n!==C.CBRACK_CODE&&this.throwError("Unclosed ["),this.index++):n===C.OPAREN_CODE?e={type:C.CALL_EXP,arguments:this.gobbleArguments(C.CPAREN_CODE),callee:e}:(n===C.PERIOD_CODE||s)&&(s&&this.index--,this.gobbleSpaces(),e={type:C.MEMBER_EXP,computed:!1,object:e,property:this.gobbleIdentifier()}),s&&(e.optional=!0),this.gobbleSpaces(),n=this.code}return e}gobbleNumericLiteral(){let e="",n,s;for(;C.isDecimalDigit(this.code);)e+=this.expr.charAt(this.index++);if(this.code===C.PERIOD_CODE)for(e+=this.expr.charAt(this.index++);C.isDecimalDigit(this.code);)e+=this.expr.charAt(this.index++);if(n=this.char,n==="e"||n==="E"){for(e+=this.expr.charAt(this.index++),n=this.char,(n==="+"||n==="-")&&(e+=this.expr.charAt(this.index++));C.isDecimalDigit(this.code);)e+=this.expr.charAt(this.index++);C.isDecimalDigit(this.expr.charCodeAt(this.index-1))||this.throwError("Expected exponent ("+e+this.char+")")}return s=this.code,C.isIdentifierStart(s)?this.throwError("Variable names cannot start with a number ("+e+this.char+")"):(s===C.PERIOD_CODE||e.length===1&&e.charCodeAt(0)===C.PERIOD_CODE)&&this.throwError("Unexpected period"),{type:C.LITERAL,value:parseFloat(e),raw:e}}gobbleStringLiteral(){let e="";const n=this.index,s=this.expr.charAt(this.index++);let r=!1;for(;this.index<this.expr.length;){let i=this.expr.charAt(this.index++);if(i===s){r=!0;break}else if(i==="\\")switch(i=this.expr.charAt(this.index++),i){case"n":e+=`
`;break;case"r":e+="\r";break;case"t":e+="	";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:e+=i}else e+=i}return r||this.throwError('Unclosed quote after "'+e+'"'),{type:C.LITERAL,value:e,raw:this.expr.substring(n,this.index)}}gobbleIdentifier(){let e=this.code,n=this.index;for(C.isIdentifierStart(e)?this.index++:this.throwError("Unexpected "+this.char);this.index<this.expr.length&&(e=this.code,C.isIdentifierPart(e));)this.index++;return{type:C.IDENTIFIER,name:this.expr.slice(n,this.index)}}gobbleArguments(e){const n=[];let s=!1,r=0;for(;this.index<this.expr.length;){this.gobbleSpaces();let i=this.code;if(i===e){s=!0,this.index++,e===C.CPAREN_CODE&&r&&r>=n.length&&this.throwError("Unexpected token "+String.fromCharCode(e));break}else if(i===C.COMMA_CODE){if(this.index++,r++,r!==n.length){if(e===C.CPAREN_CODE)this.throwError("Unexpected token ,");else if(e===C.CBRACK_CODE)for(let o=n.length;o<r;o++)n.push(null)}}else if(n.length!==r&&r!==0)this.throwError("Expected comma");else{const o=this.gobbleExpression();(!o||o.type===C.COMPOUND)&&this.throwError("Expected comma"),n.push(o)}}return s||this.throwError("Expected "+String.fromCharCode(e)),n}gobbleGroup(){this.index++;let e=this.gobbleExpressions(C.CPAREN_CODE);if(this.code===C.CPAREN_CODE)return this.index++,e.length===1?e[0]:e.length?{type:C.SEQUENCE_EXP,expressions:e}:!1;this.throwError("Unclosed (")}gobbleArray(){return this.index++,{type:C.ARRAY_EXP,elements:this.gobbleArguments(C.CBRACK_CODE)}}}const Ky=new Yy;Object.assign(C,{hooks:Ky,plugins:new Gy(C),COMPOUND:"Compound",SEQUENCE_EXP:"SequenceExpression",IDENTIFIER:"Identifier",MEMBER_EXP:"MemberExpression",LITERAL:"Literal",THIS_EXP:"ThisExpression",CALL_EXP:"CallExpression",UNARY_EXP:"UnaryExpression",BINARY_EXP:"BinaryExpression",ARRAY_EXP:"ArrayExpression",TAB_CODE:9,LF_CODE:10,CR_CODE:13,SPACE_CODE:32,PERIOD_CODE:46,COMMA_CODE:44,SQUOTE_CODE:39,DQUOTE_CODE:34,OPAREN_CODE:40,CPAREN_CODE:41,OBRACK_CODE:91,CBRACK_CODE:93,QUMARK_CODE:63,SEMCOL_CODE:59,COLON_CODE:58,unary_ops:{"-":1,"!":1,"~":1,"+":1},binary_ops:{"||":1,"??":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10,"**":11},right_associative:new Set(["**"]),additional_identifier_chars:new Set(["$","_"]),literals:{true:!0,false:!1,null:null},this_str:"this"});C.max_unop_len=C.getMaxKeyLen(C.unary_ops);C.max_binop_len=C.getMaxKeyLen(C.binary_ops);const zt=t=>new C(t).parse(),Hy=Object.getOwnPropertyNames(class{});Object.getOwnPropertyNames(C).filter(t=>!Hy.includes(t)&&zt[t]===void 0).forEach(t=>{zt[t]=C[t]});zt.Jsep=C;const Xy="ConditionalExpression";var Qy={name:"ternary",init(t){t.hooks.add("after-expression",function(n){if(n.node&&this.code===t.QUMARK_CODE){this.index++;const s=n.node,r=this.gobbleExpression();if(r||this.throwError("Expected expression"),this.gobbleSpaces(),this.code===t.COLON_CODE){this.index++;const i=this.gobbleExpression();if(i||this.throwError("Expected expression"),n.node={type:Xy,test:s,consequent:r,alternate:i},s.operator&&t.binary_ops[s.operator]<=.9){let o=s;for(;o.right.operator&&t.binary_ops[o.right.operator]<=.9;)o=o.right;n.node.test=o.right,o.right=n.node,n.node=s}}else this.throwError("Expected :")}})}};zt.plugins.register(Qy);const Wa=47,Jy=92;var eb={name:"regex",init(t){t.hooks.add("gobble-token",function(n){if(this.code===Wa){const s=++this.index;let r=!1;for(;this.index<this.expr.length;){if(this.code===Wa&&!r){const i=this.expr.slice(s,this.index);let o="";for(;++this.index<this.expr.length;){const l=this.code;if(l>=97&&l<=122||l>=65&&l<=90||l>=48&&l<=57)o+=this.char;else break}let a;try{a=new RegExp(i,o)}catch(l){this.throwError(l.message)}return n.node={type:t.LITERAL,value:a,raw:this.expr.slice(s-1,this.index)},n.node=this.gobbleTokenProperty(n.node),n.node}this.code===t.OBRACK_CODE?r=!0:r&&this.code===t.CBRACK_CODE&&(r=!1),this.index+=this.code===Jy?2:1}this.throwError("Unclosed Regex")}})}};const gi=43,tb=45,zn={name:"assignment",assignmentOperators:new Set(["=","*=","**=","/=","%=","+=","-=","<<=",">>=",">>>=","&=","^=","|=","||=","&&=","??="]),updateOperators:[gi,tb],assignmentPrecedence:.9,init(t){const e=[t.IDENTIFIER,t.MEMBER_EXP];zn.assignmentOperators.forEach(s=>t.addBinaryOp(s,zn.assignmentPrecedence,!0)),t.hooks.add("gobble-token",function(r){const i=this.code;zn.updateOperators.some(o=>o===i&&o===this.expr.charCodeAt(this.index+1))&&(this.index+=2,r.node={type:"UpdateExpression",operator:i===gi?"++":"--",argument:this.gobbleTokenProperty(this.gobbleIdentifier()),prefix:!0},(!r.node.argument||!e.includes(r.node.argument.type))&&this.throwError(`Unexpected ${r.node.operator}`))}),t.hooks.add("after-token",function(r){if(r.node){const i=this.code;zn.updateOperators.some(o=>o===i&&o===this.expr.charCodeAt(this.index+1))&&(e.includes(r.node.type)||this.throwError(`Unexpected ${r.node.operator}`),this.index+=2,r.node={type:"UpdateExpression",operator:i===gi?"++":"--",argument:r.node,prefix:!1})}}),t.hooks.add("after-expression",function(r){r.node&&n(r.node)});function n(s){zn.assignmentOperators.has(s.operator)?(s.type="AssignmentExpression",n(s.left),n(s.right)):s.operator||Object.values(s).forEach(r=>{r&&typeof r=="object"&&n(r)})}}};zt.plugins.register(eb,zn);zt.addUnaryOp("typeof");zt.addLiteral("null",null);zt.addLiteral("undefined",void 0);const nb=new Set(["constructor","__proto__","__defineGetter__","__defineSetter__"]),ue={evalAst(t,e){switch(t.type){case"BinaryExpression":case"LogicalExpression":return ue.evalBinaryExpression(t,e);case"Compound":return ue.evalCompound(t,e);case"ConditionalExpression":return ue.evalConditionalExpression(t,e);case"Identifier":return ue.evalIdentifier(t,e);case"Literal":return ue.evalLiteral(t,e);case"MemberExpression":return ue.evalMemberExpression(t,e);case"UnaryExpression":return ue.evalUnaryExpression(t,e);case"ArrayExpression":return ue.evalArrayExpression(t,e);case"CallExpression":return ue.evalCallExpression(t,e);case"AssignmentExpression":return ue.evalAssignmentExpression(t,e);default:throw SyntaxError("Unexpected expression",t)}},evalBinaryExpression(t,e){return{"||":(s,r)=>s||r(),"&&":(s,r)=>s&&r(),"|":(s,r)=>s|r(),"^":(s,r)=>s^r(),"&":(s,r)=>s&r(),"==":(s,r)=>s==r(),"!=":(s,r)=>s!=r(),"===":(s,r)=>s===r(),"!==":(s,r)=>s!==r(),"<":(s,r)=>s<r(),">":(s,r)=>s>r(),"<=":(s,r)=>s<=r(),">=":(s,r)=>s>=r(),"<<":(s,r)=>s<<r(),">>":(s,r)=>s>>r(),">>>":(s,r)=>s>>>r(),"+":(s,r)=>s+r(),"-":(s,r)=>s-r(),"*":(s,r)=>s*r(),"/":(s,r)=>s/r(),"%":(s,r)=>s%r()}[t.operator](ue.evalAst(t.left,e),()=>ue.evalAst(t.right,e))},evalCompound(t,e){let n;for(let s=0;s<t.body.length;s++){t.body[s].type==="Identifier"&&["var","let","const"].includes(t.body[s].name)&&t.body[s+1]&&t.body[s+1].type==="AssignmentExpression"&&(s+=1);const r=t.body[s];n=ue.evalAst(r,e)}return n},evalConditionalExpression(t,e){return ue.evalAst(t.test,e)?ue.evalAst(t.consequent,e):ue.evalAst(t.alternate,e)},evalIdentifier(t,e){if(Object.hasOwn(e,t.name))return e[t.name];throw ReferenceError(`${t.name} is not defined`)},evalLiteral(t){return t.value},evalMemberExpression(t,e){const n=String(t.computed?ue.evalAst(t.property):t.property.name),s=ue.evalAst(t.object,e);if(s==null)throw TypeError(`Cannot read properties of ${s} (reading '${n}')`);if(!Object.hasOwn(s,n)&&nb.has(n))throw TypeError(`Cannot read properties of ${s} (reading '${n}')`);const r=s[n];return typeof r=="function"?r.bind(s):r},evalUnaryExpression(t,e){return{"-":s=>-ue.evalAst(s,e),"!":s=>!ue.evalAst(s,e),"~":s=>~ue.evalAst(s,e),"+":s=>+ue.evalAst(s,e),typeof:s=>typeof ue.evalAst(s,e)}[t.operator](t.argument)},evalArrayExpression(t,e){return t.elements.map(n=>ue.evalAst(n,e))},evalCallExpression(t,e){const n=t.arguments.map(r=>ue.evalAst(r,e));return ue.evalAst(t.callee,e)(...n)},evalAssignmentExpression(t,e){if(t.left.type!=="Identifier")throw SyntaxError("Invalid left-hand side in assignment");const n=t.left.name,s=ue.evalAst(t.right,e);return e[n]=s,e[n]}};class sb{constructor(e){this.code=e,this.ast=zt(this.code)}runInNewContext(e){const n=Object.assign(Object.create(null),e);return ue.evalAst(this.ast,n)}}function Wt(t,e){return t=t.slice(),t.push(e),t}function Ji(t,e){return e=e.slice(),e.unshift(t),e}class rb extends Error{constructor(e){super('JSONPath should not be called with "new" (it prevents return of (unwrapped) scalar values)'),this.avoidNew=!0,this.value=e,this.name="NewError"}}function re(t,e,n,s,r){if(!(this instanceof re))try{return new re(t,e,n,s,r)}catch(o){if(!o.avoidNew)throw o;return o.value}typeof t=="string"&&(r=s,s=n,n=e,e=t,t=null);const i=t&&typeof t=="object";if(t=t||{},this.json=t.json||n,this.path=t.path||e,this.resultType=t.resultType||"value",this.flatten=t.flatten||!1,this.wrap=Object.hasOwn(t,"wrap")?t.wrap:!0,this.sandbox=t.sandbox||{},this.eval=t.eval===void 0?"safe":t.eval,this.ignoreEvalErrors=typeof t.ignoreEvalErrors>"u"?!1:t.ignoreEvalErrors,this.parent=t.parent||null,this.parentProperty=t.parentProperty||null,this.callback=t.callback||s||null,this.otherTypeCallback=t.otherTypeCallback||r||function(){throw new TypeError("You must supply an otherTypeCallback callback option with the @other() operator.")},t.autostart!==!1){const o={path:i?t.path:e};i?"json"in t&&(o.json=t.json):o.json=n;const a=this.evaluate(o);if(!a||typeof a!="object")throw new rb(a);return a}}re.prototype.evaluate=function(t,e,n,s){let r=this.parent,i=this.parentProperty,{flatten:o,wrap:a}=this;if(this.currResultType=this.resultType,this.currEval=this.eval,this.currSandbox=this.sandbox,n=n||this.callback,this.currOtherTypeCallback=s||this.otherTypeCallback,e=e||this.json,t=t||this.path,t&&typeof t=="object"&&!Array.isArray(t)){if(!t.path&&t.path!=="")throw new TypeError('You must supply a "path" property when providing an object argument to JSONPath.evaluate().');if(!Object.hasOwn(t,"json"))throw new TypeError('You must supply a "json" property when providing an object argument to JSONPath.evaluate().');({json:e}=t),o=Object.hasOwn(t,"flatten")?t.flatten:o,this.currResultType=Object.hasOwn(t,"resultType")?t.resultType:this.currResultType,this.currSandbox=Object.hasOwn(t,"sandbox")?t.sandbox:this.currSandbox,a=Object.hasOwn(t,"wrap")?t.wrap:a,this.currEval=Object.hasOwn(t,"eval")?t.eval:this.currEval,n=Object.hasOwn(t,"callback")?t.callback:n,this.currOtherTypeCallback=Object.hasOwn(t,"otherTypeCallback")?t.otherTypeCallback:this.currOtherTypeCallback,r=Object.hasOwn(t,"parent")?t.parent:r,i=Object.hasOwn(t,"parentProperty")?t.parentProperty:i,t=t.path}if(r=r||null,i=i||null,Array.isArray(t)&&(t=re.toPathString(t)),!t&&t!==""||!e)return;const l=re.toPathArray(t);l[0]==="$"&&l.length>1&&l.shift(),this._hasParentSelector=null;const c=this._trace(l,e,["$"],r,i,n).filter(function(u){return u&&!u.isParentSelector});return c.length?!a&&c.length===1&&!c[0].hasArrExpr?this._getPreferredOutput(c[0]):c.reduce((u,f)=>{const h=this._getPreferredOutput(f);return o&&Array.isArray(h)?u=u.concat(h):u.push(h),u},[]):a?[]:void 0};re.prototype._getPreferredOutput=function(t){const e=this.currResultType;switch(e){case"all":{const n=Array.isArray(t.path)?t.path:re.toPathArray(t.path);return t.pointer=re.toPointer(n),t.path=typeof t.path=="string"?t.path:re.toPathString(t.path),t}case"value":case"parent":case"parentProperty":return t[e];case"path":return re.toPathString(t[e]);case"pointer":return re.toPointer(t.path);default:throw new TypeError("Unknown result type")}};re.prototype._handleCallback=function(t,e,n){if(e){const s=this._getPreferredOutput(t);t.path=typeof t.path=="string"?t.path:re.toPathString(t.path),e(s,n,t)}};re.prototype._trace=function(t,e,n,s,r,i,o,a){let l;if(!t.length)return l={path:n,value:e,parent:s,parentProperty:r,hasArrExpr:o},this._handleCallback(l,i,"value"),l;const c=t[0],u=t.slice(1),f=[];function h(p){Array.isArray(p)?p.forEach(y=>{f.push(y)}):f.push(p)}if((typeof c!="string"||a)&&e&&Object.hasOwn(e,c))h(this._trace(u,e[c],Wt(n,c),e,c,i,o));else if(c==="*")this._walk(e,p=>{h(this._trace(u,e[p],Wt(n,p),e,p,i,!0,!0))});else if(c==="..")h(this._trace(u,e,n,s,r,i,o)),this._walk(e,p=>{typeof e[p]=="object"&&h(this._trace(t.slice(),e[p],Wt(n,p),e,p,i,!0))});else{if(c==="^")return this._hasParentSelector=!0,{path:n.slice(0,-1),expr:u,isParentSelector:!0};if(c==="~")return l={path:Wt(n,c),value:r,parent:s,parentProperty:null},this._handleCallback(l,i,"property"),l;if(c==="$")h(this._trace(u,e,n,null,null,i,o));else if(/^(-?\d*):(-?\d*):?(\d*)$/u.test(c))h(this._slice(c,u,e,n,s,r,i));else if(c.indexOf("?(")===0){if(this.currEval===!1)throw new Error("Eval [?(expr)] prevented in JSONPath expression.");const p=c.replace(/^\?\((.*?)\)$/u,"$1"),y=/@.?([^?]*)[['](\??\(.*?\))(?!.\)\])[\]']/gu.exec(p);y?this._walk(e,g=>{const w=[y[2]],m=y[1]?e[g][y[1]]:e[g];this._trace(w,m,n,s,r,i,!0).length>0&&h(this._trace(u,e[g],Wt(n,g),e,g,i,!0))}):this._walk(e,g=>{this._eval(p,e[g],g,n,s,r)&&h(this._trace(u,e[g],Wt(n,g),e,g,i,!0))})}else if(c[0]==="("){if(this.currEval===!1)throw new Error("Eval [(expr)] prevented in JSONPath expression.");h(this._trace(Ji(this._eval(c,e,n.at(-1),n.slice(0,-1),s,r),u),e,n,s,r,i,o))}else if(c[0]==="@"){let p=!1;const y=c.slice(1,-2);switch(y){case"scalar":(!e||!["object","function"].includes(typeof e))&&(p=!0);break;case"boolean":case"string":case"undefined":case"function":typeof e===y&&(p=!0);break;case"integer":Number.isFinite(e)&&!(e%1)&&(p=!0);break;case"number":Number.isFinite(e)&&(p=!0);break;case"nonFinite":typeof e=="number"&&!Number.isFinite(e)&&(p=!0);break;case"object":e&&typeof e===y&&(p=!0);break;case"array":Array.isArray(e)&&(p=!0);break;case"other":p=this.currOtherTypeCallback(e,n,s,r);break;case"null":e===null&&(p=!0);break;default:throw new TypeError("Unknown value type "+y)}if(p)return l={path:n,value:e,parent:s,parentProperty:r},this._handleCallback(l,i,"value"),l}else if(c[0]==="`"&&e&&Object.hasOwn(e,c.slice(1))){const p=c.slice(1);h(this._trace(u,e[p],Wt(n,p),e,p,i,o,!0))}else if(c.includes(",")){const p=c.split(",");for(const y of p)h(this._trace(Ji(y,u),e,n,s,r,i,!0))}else!a&&e&&Object.hasOwn(e,c)&&h(this._trace(u,e[c],Wt(n,c),e,c,i,o,!0))}if(this._hasParentSelector)for(let p=0;p<f.length;p++){const y=f[p];if(y&&y.isParentSelector){const g=this._trace(y.expr,e,y.path,s,r,i,o);if(Array.isArray(g)){f[p]=g[0];const w=g.length;for(let m=1;m<w;m++)p++,f.splice(p,0,g[m])}else f[p]=g}}return f};re.prototype._walk=function(t,e){if(Array.isArray(t)){const n=t.length;for(let s=0;s<n;s++)e(s)}else t&&typeof t=="object"&&Object.keys(t).forEach(n=>{e(n)})};re.prototype._slice=function(t,e,n,s,r,i,o){if(!Array.isArray(n))return;const a=n.length,l=t.split(":"),c=l[2]&&Number.parseInt(l[2])||1;let u=l[0]&&Number.parseInt(l[0])||0,f=l[1]&&Number.parseInt(l[1])||a;u=u<0?Math.max(0,u+a):Math.min(a,u),f=f<0?Math.max(0,f+a):Math.min(a,f);const h=[];for(let p=u;p<f;p+=c)this._trace(Ji(p,e),n,s,r,i,o,!0).forEach(g=>{h.push(g)});return h};re.prototype._eval=function(t,e,n,s,r,i){this.currSandbox._$_parentProperty=i,this.currSandbox._$_parent=r,this.currSandbox._$_property=n,this.currSandbox._$_root=this.json,this.currSandbox._$_v=e;const o=t.includes("@path");o&&(this.currSandbox._$_path=re.toPathString(s.concat([n])));const a=this.currEval+"Script:"+t;if(!re.cache[a]){let l=t.replaceAll("@parentProperty","_$_parentProperty").replaceAll("@parent","_$_parent").replaceAll("@property","_$_property").replaceAll("@root","_$_root").replaceAll(/@([.\s)[])/gu,"_$_v$1");if(o&&(l=l.replaceAll("@path","_$_path")),this.currEval==="safe"||this.currEval===!0||this.currEval===void 0)re.cache[a]=new this.safeVm.Script(l);else if(this.currEval==="native")re.cache[a]=new this.vm.Script(l);else if(typeof this.currEval=="function"&&this.currEval.prototype&&Object.hasOwn(this.currEval.prototype,"runInNewContext")){const c=this.currEval;re.cache[a]=new c(l)}else if(typeof this.currEval=="function")re.cache[a]={runInNewContext:c=>this.currEval(l,c)};else throw new TypeError(`Unknown "eval" property "${this.currEval}"`)}try{return re.cache[a].runInNewContext(this.currSandbox)}catch(l){if(this.ignoreEvalErrors)return!1;throw new Error("jsonPath: "+l.message+": "+t)}};re.cache={};re.toPathString=function(t){const e=t,n=e.length;let s="$";for(let r=1;r<n;r++)/^(~|\^|@.*?\(\))$/u.test(e[r])||(s+=/^[0-9*]+$/u.test(e[r])?"["+e[r]+"]":"['"+e[r]+"']");return s};re.toPointer=function(t){const e=t,n=e.length;let s="";for(let r=1;r<n;r++)/^(~|\^|@.*?\(\))$/u.test(e[r])||(s+="/"+e[r].toString().replaceAll("~","~0").replaceAll("/","~1"));return s};re.toPathArray=function(t){const{cache:e}=re;if(e[t])return e[t].concat();const n=[],r=t.replaceAll(/@(?:null|boolean|number|string|integer|undefined|nonFinite|scalar|array|object|function|other)\(\)/gu,";$&;").replaceAll(/[['](\??\(.*?\))[\]'](?!.\])/gu,function(i,o){return"[#"+(n.push(o)-1)+"]"}).replaceAll(/\[['"]([^'\]]*)['"]\]/gu,function(i,o){return"['"+o.replaceAll(".","%@%").replaceAll("~","%%@@%%")+"']"}).replaceAll("~",";~;").replaceAll(/['"]?\.['"]?(?![^[]*\])|\[['"]?/gu,";").replaceAll("%@%",".").replaceAll("%%@@%%","~").replaceAll(/(?:;)?(\^+)(?:;)?/gu,function(i,o){return";"+o.split("").join(";")+";"}).replaceAll(/;;;|;;/gu,";..;").replaceAll(/;$|'?\]|'$/gu,"").split(";").map(function(i){const o=i.match(/#(\d+)/u);return!o||!o[1]?i:n[o[1]]});return e[t]=r,e[t].concat()};re.prototype.safeVm={Script:sb};const ib=function(t,e,n){const s=t.length;for(let r=0;r<s;r++){const i=t[r];n(i)&&e.push(t.splice(r--,1)[0])}};class ob{constructor(e){this.code=e}runInNewContext(e){let n=this.code;const s=Object.keys(e),r=[];ib(s,r,c=>typeof e[c]=="function");const i=s.map(c=>e[c]);n=r.reduce((c,u)=>{let f=e[u].toString();return/function/u.test(f)||(f="function "+f),"var "+u+"="+f+";"+c},"")+n,!/(['"])use strict\1/u.test(n)&&!s.includes("arguments")&&(n="var arguments = undefined;"+n),n=n.replace(/;\s*$/u,"");const a=n.lastIndexOf(";"),l=a!==-1?n.slice(0,a+1)+" return "+n.slice(a+1):" return "+n;return new Function(...s,l)(...i)}}re.prototype.vm={Script:ob};const ab="/tc-animator/assets/blockbench-settings-G7FDEJl4.png";function lb(){const t=$.c(31),{modelIds:e,selectedObjectPath:n,cart:s,modelFiles:r,setModelFile:i}=ct();let o;e:{if(!n||!s){let T;t[0]===Symbol.for("react.memo_cache_sentinel")?(T=[],t[0]=T):T=t[0],o=T;break e}let b;if(t[1]!==s||t[2]!==n){const T=re({path:n,json:s,resultType:"value"});if(T.length===0){let N;t[5]===Symbol.for("react.memo_cache_sentinel")?(N=[],t[5]=N):N=t[5],o=N;break e}const A=T[0];if(!A||typeof A!="object"){let N;t[6]===Symbol.for("react.memo_cache_sentinel")?(N=[],t[6]=N):N=t[6],o=N;break e}b=new Set;const O=function(M){if(!M)return;const R=M["minecraft:custom_model_data"];if(R&&typeof R=="object"&&"floats"in R){const j=R.floats;Array.isArray(j)&&j.forEach(P=>b.add(P))}};if("item"in A){const N=A.item;O(N?.components)}t[1]=s,t[2]=n,t[3]=b,t[4]=o}else b=t[3],o=t[4];let v;t[7]!==b?(v=Array.from(b),t[7]=b,t[8]=v):v=t[8],o=v}const a=o;let l;t[9]!==i?(l=async b=>{try{const v=await uo({mimeTypes:["model/gltf+json","model/gltf-binary"],extensions:[".gltf",".glb"],multiple:!1,description:"3D Model (GLTF/GLB)",id:"tca-models"}),T=await v.arrayBuffer();let A=T;if(v.name.toLowerCase().endsWith(".gltf"))try{const O=await qc(T);A=Tl(O.buffer)}catch(O){console.error("Failed to convert GLTF to GLB:",O),alert("Failed to convert GLTF to GLB. See console for details."),i(b,A)}i(b,A)}catch(v){const T=v;T.name!=="AbortError"&&(console.error("Error loading model file:",T),alert("Error loading model file. See console for details."))}},t[9]=i,t[10]=l):l=t[10];const c=l;let u,f;t[11]===Symbol.for("react.memo_cache_sentinel")?(u=d.jsx("br",{}),f=d.jsx("br",{}),t[11]=u,t[12]=f):(u=t[11],f=t[12]);let h;t[13]===Symbol.for("react.memo_cache_sentinel")?(h=d.jsx("b",{children:"GLTF"}),t[13]=h):h=t[13];let p;t[14]===Symbol.for("react.memo_cache_sentinel")?(p=d.jsx("b",{children:"GLB"}),t[14]=p):p=t[14];let y;t[15]===Symbol.for("react.memo_cache_sentinel")?(y=d.jsx(Kt,{className:"mx-1 cursor-help font-bold underline underline-offset-2",children:"Blockbench"}),t[15]=y):y=t[15];let g;t[16]===Symbol.for("react.memo_cache_sentinel")?(g=d.jsxs(Gt,{children:[y,d.jsxs(Ht,{children:[d.jsx("p",{className:"mb-2",children:"Use these settings when exporting from Blockbench:"}),d.jsx("img",{src:ab,alt:"Blockbench export settings"})]})]}),t[16]=g):g=t[16];let w,m;t[17]===Symbol.for("react.memo_cache_sentinel")?(w=d.jsx("br",{}),m=d.jsx("br",{}),t[17]=w,t[18]=m):(w=t[17],m=t[18]);let S,x;t[19]===Symbol.for("react.memo_cache_sentinel")?(S=d.jsxs("p",{className:"text-muted-foreground mb-4",children:["You can replace the default cubes with your own 3D models to make the cart look like it would in-game with a resourcepack.",u,f,"Models must be in ",h," or ",p," format. These can be exported from",g,"or most 3D software.",w,m,"Below, you'll see each ",d.jsx("b",{children:"Custom Model ID"})," for your attachments. Select an attachment in the 3D view to highlight the corresponding ID if it has one. Upload your model next to the matching ID to apply it in TC Animator."]}),x=d.jsx("hr",{className:"my-4"}),t[19]=S,t[20]=x):(S=t[19],x=t[20]);let _;t[21]!==e.length?(_=e.length===0&&d.jsx("p",{className:"text-muted-foreground text-sm",children:"No custom models required for this cart."}),t[21]=e.length,t[22]=_):_=t[22];let E;t[23]!==c||t[24]!==r||t[25]!==e||t[26]!==a?(E=e.length>0&&d.jsxs(Vy,{children:[d.jsx(Wy,{children:d.jsxs(Ua,{children:[d.jsx(Za,{children:"Custom Model ID"}),d.jsx(Za,{children:"Upload Model"})]})}),d.jsx(qy,{children:e.map(b=>d.jsxs(Ua,{children:[d.jsx(Va,{className:a.includes(b)?"font-bold text-yellow-500":"",children:b}),d.jsx(Va,{children:d.jsx(nt,{variant:"secondary",size:"sm",onClick:()=>c(b),children:r.get(b)?"Change Model":"Upload Model"})})]},b))})]}),t[23]=c,t[24]=r,t[25]=e,t[26]=a,t[27]=E):E=t[27];let k;return t[28]!==_||t[29]!==E?(k=d.jsxs(d.Fragment,{children:[S,x,_,E]}),t[28]=_,t[29]=E,t[30]=k):k=t[30],k}function qa(t){const e=$.c(8);let n,s;e[0]!==t?({className:n,...s}=t,e[0]=t,e[1]=n,e[2]=s):(n=e[1],s=e[2]);let r;e[3]!==n?(r=V("bg-accent animate-pulse rounded-md",n),e[3]=n,e[4]=r):r=e[4];let i;return e[5]!==s||e[6]!==r?(i=d.jsx("div",{"data-slot":"skeleton",className:r,...s}),e[5]=s,e[6]=r,e[7]=i):i=e[7],i}const Ya=F.lazy(()=>bh(()=>import("./monaco-B23_F8Sm.js"),__vite__mapDeps([0,1,2])));function cb(){const t=ct(),e=F.useMemo(()=>({...t,cart:void 0,modelFiles:void 0,fileHandle:void 0}),[t]);return d.jsxs(Uy,{defaultValue:"object-controls",className:"-mt-4 h-full w-full",children:[d.jsxs(Zy,{className:"w-full rounded-none",children:[d.jsx(or,{value:"object-controls",children:"Object Controls"}),d.jsx(or,{value:"custom-models",children:"Custom Models"}),d.jsx(or,{value:"cart-debug",children:"Cart Debug"}),d.jsx(or,{value:"project-debug",children:"Project Debug"})]}),d.jsx(ar,{value:"object-controls",className:"px-4",children:"W.I.P."}),d.jsx(ar,{value:"custom-models",className:"px-4",children:d.jsx(lb,{})}),d.jsx(ar,{value:"cart-debug",children:d.jsx(F.Suspense,{fallback:d.jsx(qa,{className:"h-full w-full"}),children:d.jsx(Ya,{language:"json",theme:"vs-dark",value:JSON.stringify(t.cart,null,2),options:{minimap:{enabled:!0},scrollbar:{alwaysConsumeMouseWheel:!1},wordWrap:"on",automaticLayout:!0},onChange:n=>{if(n)try{const s=JSON.parse(n);t.setCart(s)}catch(s){console.error("Failed to parse JSON:",s)}}})})}),d.jsx(ar,{value:"project-debug",children:d.jsxs(F.Suspense,{fallback:d.jsx(qa,{className:"h-full w-full"}),children:[d.jsx(nt,{className:"mb-2 block w-full",onClick:()=>t.logState(),children:"Log State to Console"}),d.jsx(Ya,{language:"json",theme:"vs-dark",value:JSON.stringify(e,null,2),options:{minimap:{enabled:!1},scrollbar:{alwaysConsumeMouseWheel:!1},wordWrap:"off",automaticLayout:!0,readOnly:!0}})]})})]})}let vr=[],xr=[];function ub(t){return vr.push(t),()=>{vr=vr.filter(e=>e!==t)}}function fb(t){return xr.push(t),()=>{xr=xr.filter(e=>e!==t)}}function hb(){const t=$.c(3),e=F.useRef(0);let n;t[0]===Symbol.for("react.memo_cache_sentinel")?(n=performance.now(),t[0]=n):n=t[0];const s=F.useRef(n),{gl:r}=zr();let i;return t[1]!==r?(i=()=>{e.current=e.current+1;const o=performance.now(),a=o-s.current;if(a>500){const l=Math.round(e.current*1e3/a);e.current=0,s.current=o,vr.forEach(u=>u(l));const c=r.info;xr.forEach(u=>u(c.render))}},t[1]=r,t[2]=i):i=t[2],ao(i),null}function db(t){const e=$.c(24),{position:n}=t,s=n===void 0?"top-right":n,r=$s(),[i,o]=F.useState(0);let a;e[0]===Symbol.for("react.memo_cache_sentinel")?(a={calls:0,frame:0,lines:0,points:0,triangles:0},e[0]=a):a=e[0];const[l,c]=F.useState(a);let u,f;e[1]===Symbol.for("react.memo_cache_sentinel")?(u=()=>ub(o),f=[],e[1]=u,e[2]=f):(u=e[1],f=e[2]),F.useEffect(u,f);let h,p;e[3]===Symbol.for("react.memo_cache_sentinel")?(h=()=>fb(c),p=[],e[3]=h,e[4]=p):(h=e[3],p=e[4]),F.useEffect(h,p);const y=s.includes("top")?8:void 0,g=s.includes("bottom")?8:void 0,w=s.includes("left")?8:void 0,m=s.includes("right")?8:void 0;let S;e[5]!==m||e[6]!==y||e[7]!==g||e[8]!==w?(S={top:y,bottom:g,left:w,right:m},e[5]=m,e[6]=y,e[7]=g,e[8]=w,e[9]=S):S=e[9];const x=S;let _;e[10]!==x?(_={...x},e[10]=x,e[11]=_):_=e[11];let E;e[12]!==i?(E=d.jsxs("p",{children:[i," FPS"]}),e[12]=i,e[13]=E):E=e[13];let k;e[14]!==r.DOFEnabled||e[15]!==r.SSAOEnabled||e[16]!==r.controlDamping||e[17]!==r.debugText||e[18]!==l?(k=r.debugText&&d.jsxs(d.Fragment,{children:[d.jsx("hr",{className:"border-border my-1 border-t"}),d.jsxs("p",{children:["Draw Calls: ",l.calls]}),d.jsxs("p",{children:["Frame: ",l.frame]}),d.jsxs("p",{children:["Triangles: ",l.triangles]}),d.jsxs("p",{children:["Lines: ",l.lines]}),d.jsxs("p",{children:["Points: ",l.points]}),d.jsx("hr",{className:"border-border my-1 border-t"}),d.jsxs("p",{children:["Debug Text: ",r.debugText?"On":"Off"]}),d.jsxs("p",{children:["SSAO: ",r.SSAOEnabled?"On":"Off"]}),d.jsxs("p",{children:["Depth of Field: ",r.DOFEnabled?"On":"Off"]}),d.jsxs("p",{children:["Control Damping:"," ",r.controlDamping?"On":"Off"]})]}),e[14]=r.DOFEnabled,e[15]=r.SSAOEnabled,e[16]=r.controlDamping,e[17]=r.debugText,e[18]=l,e[19]=k):k=e[19];let b;return e[20]!==_||e[21]!==E||e[22]!==k?(b=d.jsxs("div",{className:"text-muted-foreground pointer-events-none absolute z-10 text-right font-mono text-sm",style:_,children:[E,k]}),e[20]=_,e[21]=E,e[22]=k,e[23]=b):b=e[23],b}const pb="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAAAXNSR0IArs4c6QAAAHpJREFUOI21kjEKACEMBNdD/IGV/39abMwL0uSKgIiCyRVnETFsMrJsUlWEDxFlu0opIuJWZn4ABNUiAiADuChaawDGGNYB4BDs6yvhuRNsYJ3/n5DXd611c9khbPt8wtw33YwSps5x6dSdhKSq8Sz13r9niYiYOZ7wF+cqCUwV0Ir/AAAAAElFTkSuQmCC",lr=[],mb=5;function gb(){const t=Math.floor(Math.random()*360),e=70+Math.random()*10,n=80+Math.random()*10;return`hsl(${t}, ${e}%, ${n}%)`}function yb(){let t="",e=0;do t=gb(),e++;while(lr.includes(t)&&e<10);return lr.push(t),lr.length>mb&&lr.shift(),t}const Is=F.forwardRef((t,e)=>{const n=$.c(14),s=wh(pb);let r,i;n[0]!==s?(i=s.clone(),i.magFilter=qo,i.minFilter=qo,n[0]=s,n[1]=i):i=n[1],r=i;const o=r;let a,l;n[2]===Symbol.for("react.memo_cache_sentinel")?(l=yb(),n[2]=l):l=n[2],a=l;const c=a,[u,f]=F.useState(!1);let h,p,y;n[3]===Symbol.for("react.memo_cache_sentinel")?(h=x=>{x.stopPropagation(),f(!0)},p=()=>f(!1),y=d.jsx("boxGeometry",{args:[1,1,1]}),n[3]=h,n[4]=p,n[5]=y):(h=n[3],p=n[4],y=n[5]);const g=u?c:"#000",w=u?.5:0;let m;n[6]!==g||n[7]!==w||n[8]!==o?(m=d.jsx("meshStandardMaterial",{map:o,color:c,emissive:g,emissiveIntensity:w}),n[6]=g,n[7]=w,n[8]=o,n[9]=m):m=n[9];let S;return n[10]!==t||n[11]!==e||n[12]!==m?(S=d.jsxs("mesh",{ref:e,...t,castShadow:!0,receiveShadow:!0,onPointerOver:h,onPointerOut:p,children:[y,m]}),n[10]=t,n[11]=e,n[12]=m,n[13]=S):S=n[13],S}),Pr=new Map;function bb(t,e){const n=Pr.get(t);if(n&&n.buffer===e)return n.url;n&&URL.revokeObjectURL(n.url);const s=new Blob([e]),r=URL.createObjectURL(s);return Pr.set(t,{buffer:e,url:r}),r}function Ga(t){const e=Pr.get(t);e&&(URL.revokeObjectURL(e.url),Pr.delete(t))}function Yc({jsonPath:t}){const{cart:e,modelFiles:n}=ct(),s=F.useMemo(()=>{if(!t||!e)return[];const r=re({path:t,json:e,resultType:"value"});if(r.length===0)return[];const i=r[0];if(!i||typeof i!="object")return[];const o=new Set;function a(l){if(!l)return;const c=l["minecraft:custom_model_data"];if(c&&typeof c=="object"&&"floats"in c){const u=c.floats;Array.isArray(u)&&u.forEach(f=>o.add(f))}}if("item"in i){const l=i.item;a(l?.components)}return Array.from(o)},[t,e]);return d.jsx(d.Fragment,{children:s.map(r=>{if(!n)return d.jsx(Is,{},r);const i=n.get(r);return i?d.jsx(wb,{modelId:r,arrayBuffer:i},r):d.jsx(Is,{},r)})})}function wb(t){const e=$.c(9),{modelId:n,arrayBuffer:s}=t,[r,i]=F.useState(void 0);let o,a;if(e[0]!==s||e[1]!==n?(o=()=>{if(!s){i(void 0),Ga(n);return}const c=bb(n,s);return i(c),()=>{Ga(n)}},a=[n,s],e[0]=s,e[1]=n,e[2]=o,e[3]=a):(o=e[2],a=e[3]),F.useEffect(o,a),!r){let c;return e[4]!==n?(c=d.jsx(Is,{},n),e[4]=n,e[5]=c):c=e[5],c}let l;return e[6]!==r||e[7]!==n?(l=d.jsx(vb,{modelId:n,blobUrl:r}),e[6]=r,e[7]=n,e[8]=l):l=e[8],l}function vb({modelId:t,blobUrl:e,scale:n=1,position:s=new Ce(0,0,0)}){const{scene:r}=lo(e),i=F.useMemo(()=>{if(!r)return null;const o=_l(r);o.updateWorldMatrix(!0,!0);const a=new kr().setFromObject(o),l=new Ce;a.getCenter(l);const c=new Ce;a.getSize(c);const u=new Ce(l.x,a.min.y,l.z),f=new Rh;return o.traverse(h=>{h.isMesh&&h.position.sub(u)}),f.add(o),f},[r]);return i?d.jsx(d.Fragment,{children:d.jsx("primitive",{object:i,scale:n,position:s,rotation:[0,Ot(180),0],castShadow:!0,receiveShadow:!0})}):d.jsx(Is,{},t)}const Gc="/tc-animator/assets/dummy-DI_pM9Uk.glb";lo.preload(Gc);function xb({scale:t=1,position:e=new Ce(0,0,0)}){const{scene:n}=lo(Gc),s=F.useMemo(()=>n?_l(n):null,[n]);return s?d.jsx("primitive",{object:s,scale:t,position:e,castShadow:!0,receiveShadow:!0,rotation:[0,Ot(180),0]}):d.jsx(Is,{})}function Ka(t){const e=$.c(14),n=F.useRef(null),{camera:s}=zr();let r;e[0]!==s?(r=()=>{if(!n.current)return;const g=n.current.getWorldPosition(new Ce),w=s.position.clone();w.y=g.y;const m=w.sub(g).normalize();let S=Math.atan2(m.x,m.z);if(n.current.parent){const x=new El;n.current.parent.getWorldQuaternion(x);const E=new co().setFromQuaternion(x,"YXZ").y;S=S-E+Math.PI}else S=S+Math.PI;n.current.rotation.set(0,S+Ot(180),0)},e[0]=s,e[1]=r):r=e[1],ao(r);let i;e[2]===Symbol.for("react.memo_cache_sentinel")?(i=[.3,.3,.3],e[2]=i):i=e[2];let o,a=0,l=0,c=-.1;const u=t.position;Array.isArray(u)&&u.length===3?(a=u[0]??0,l=u[1]??0,c=(u[2]??0)-.1):u&&typeof u=="object"&&"x"in u&&"y"in u&&"z"in u?(a=u.x??0,l=u.y??0,c=(u.z??0)-.1):typeof u=="number"&&(a=u);let f;e[3]!==a||e[4]!==l||e[5]!==c?(f=new Ce(a,l,c),e[3]=a,e[4]=l,e[5]=c,e[6]=f):f=e[6],o=f;let h;e[7]!==o?(h=d.jsx(xh,{castShadow:!0,receiveShadow:!0,args:i,position:o}),e[7]=o,e[8]=h):h=e[8];let p;e[9]!==t?(p=d.jsx(vh,{ref:n,...t,renderOrder:9999,children:t.children}),e[9]=t,e[10]=p):p=e[10];let y;return e[11]!==h||e[12]!==p?(y=d.jsxs(d.Fragment,{children:[h,p]}),e[11]=h,e[12]=p,e[13]=y):y=e[13],y}function _b(t){const e=$.c(33),{onSelect:n,onHover:s}=t,{cart:r,setSelectedObjectPath:i}=ct(),o=F.useRef(null);if(!r?.model)return null;const{position:a}=r.model,l=a?.posX||0,c=a?.posY||0,u=a?.posZ||0;let f;e[0]!==l||e[1]!==c||e[2]!==u?(f=new Ce(l,c,u),e[0]=l,e[1]=c,e[2]=u,e[3]=f):f=e[3];const h=f,p=a?.rotX||0;let y;e[4]!==a?.rotY||e[5]!==a?.rotZ||e[6]!==p?(y=new co(Ot(p),Ot(a?.rotY||0),Ot(a?.rotZ||0)),e[4]=a?.rotY,e[5]=a?.rotZ,e[6]=p,e[7]=y):y=e[7];const g=y,w=a?.sizeX||1,m=a?.sizeY||1,S=a?.sizeZ||1;let x;e[8]!==w||e[9]!==m||e[10]!==S?(x=new Ce(w,m,S),e[8]=w,e[9]=m,e[10]=S,e[11]=x):x=e[11];const _=x;let E,k;e[12]!==s?(E=N=>{N.stopPropagation(),o.current&&s(o.current)},k=N=>{N.stopPropagation(),s(null)},e[12]=s,e[13]=E,e[14]=k):(E=e[13],k=e[14]);let b;e[15]!==n||e[16]!==i?(b=N=>{N.stopPropagation(),o.current&&(n(o.current),i("$.model"))},e[15]=n,e[16]=i,e[17]=b):b=e[17];let v;e[18]===Symbol.for("react.memo_cache_sentinel")?(v=d.jsx(Yc,{jsonPath:"$.model"}),e[18]=v):v=e[18];let T;e[19]!==_?(T=d.jsx("group",{scale:_,children:v}),e[19]=_,e[20]=T):T=e[20];let A;e[21]!==r.model||e[22]!==s||e[23]!==n?(A=d.jsx(Kc,{attachments:r.model,onSelect:n,onHover:s,jsonPath:"$.model"}),e[21]=r.model,e[22]=s,e[23]=n,e[24]=A):A=e[24];let O;return e[25]!==h||e[26]!==g||e[27]!==E||e[28]!==k||e[29]!==b||e[30]!==T||e[31]!==A?(O=d.jsxs("group",{ref:o,position:h,rotation:g,onPointerOver:E,onPointerOut:k,onClick:b,children:[T,A]}),e[25]=h,e[26]=g,e[27]=E,e[28]=k,e[29]=b,e[30]=T,e[31]=A,e[32]=O):O=e[32],O}function Eb(t){const e=$.c(61),{attachment:n,onSelect:s,onHover:r,jsonPath:i}=t,o=$s(),{setSelectedObjectPath:a}=ct(),l=F.useRef(null),c=n.position?.posX||0,u=n.position?.posY||0,f=n.position?.posZ||0;let h,p,y,g,w,m,S,x;if(e[0]!==n.names||e[1]!==n.position?.rotX||e[2]!==n.position?.rotY||e[3]!==n.position?.rotZ||e[4]!==n.position?.sizeX||e[5]!==n.position?.sizeY||e[6]!==n.position?.sizeZ||e[7]!==n.type||e[8]!==i||e[9]!==r||e[10]!==s||e[11]!==o.debugText||e[12]!==a||e[13]!==c||e[14]!==u||e[15]!==f){const k=new Ce(c,u,f),b=new co(Ot(n.position?.rotX||0),Ot(n.position?.rotY||0),Ot(n.position?.rotZ||0)),v=n.position?.sizeX||1,T=n.position?.sizeY||1,A=n.position?.sizeZ||1;let O;e[24]!==v||e[25]!==T||e[26]!==A?(O=new Ce(v,T,A),e[24]=v,e[25]=T,e[26]=A,e[27]=O):O=e[27];const N=O;y=l,g=k,w=b,e[28]!==n.type||e[29]!==r?(m=R=>{l.current&&!["SEAT","HITBOX"].includes(n.type)&&(R.stopPropagation(),r(l.current))},e[28]=n.type,e[29]=r,e[30]=m):m=e[30],e[31]!==r?(S=R=>{R.stopPropagation(),r(null)},e[31]=r,e[32]=S):S=e[32],e[33]!==n.type||e[34]!==i||e[35]!==s||e[36]!==a?(x=R=>{l.current&&!["SEAT","HITBOX"].includes(n.type)&&(R.stopPropagation(),s(l.current),a(i))},e[33]=n.type,e[34]=i,e[35]=s,e[36]=a,e[37]=x):x=e[37];let M;e:switch(n.type){case"SEAT":{const R=o.debugText&&d.jsx(Ka,{fontSize:.3,color:"white",anchorX:"center",anchorY:"middle",outlineWidth:.05,outlineColor:"black",position:[0,3.5,0],children:`${n.names&&Array.isArray(n.names)&&n.names.length>0?n.names[0]:"Seat"}
Pos:${k.toArray().map(Nb)}`});let j;e[38]===Symbol.for("react.memo_cache_sentinel")?(j=d.jsx(xb,{}),e[38]=j):j=e[38];let P;e[39]!==R?(P=d.jsxs(d.Fragment,{children:[R,j]}),e[39]=R,e[40]=P):P=e[40],M=P;break e}case"HITBOX":{M=null;break e}default:{let R;e[41]!==i?(R=d.jsx(Yc,{jsonPath:i}),e[41]=i,e[42]=R):R=e[42],M=R}}e[43]!==N||e[44]!==M?(h=d.jsx("group",{scale:N,children:M}),e[43]=N,e[44]=M,e[45]=h):h=e[45],p=o.debugText&&!["SEAT","HITBOX"].includes(n.type)&&d.jsx(Ka,{position:[0,1.5,0],fontSize:.3,color:"yellow",anchorX:"center",anchorY:"middle",scale:[1,1,1],outlineWidth:.05,outlineColor:"black",children:`${n.names&&Array.isArray(n.names)&&n.names.length>0?n.names[0]:""}
Pos:${k.toArray().map(Ab)}
rot:${b.toArray().filter(Tb).map(kb)}
scale:${N.toArray().map(Sb)}`}),e[0]=n.names,e[1]=n.position?.rotX,e[2]=n.position?.rotY,e[3]=n.position?.rotZ,e[4]=n.position?.sizeX,e[5]=n.position?.sizeY,e[6]=n.position?.sizeZ,e[7]=n.type,e[8]=i,e[9]=r,e[10]=s,e[11]=o.debugText,e[12]=a,e[13]=c,e[14]=u,e[15]=f,e[16]=h,e[17]=p,e[18]=y,e[19]=g,e[20]=w,e[21]=m,e[22]=S,e[23]=x}else h=e[16],p=e[17],y=e[18],g=e[19],w=e[20],m=e[21],S=e[22],x=e[23];let _;e[46]!==n||e[47]!==i||e[48]!==r||e[49]!==s?(_=n.attachments&&d.jsx(Kc,{attachments:n,onSelect:s,onHover:r,jsonPath:`${i}`}),e[46]=n,e[47]=i,e[48]=r,e[49]=s,e[50]=_):_=e[50];let E;return e[51]!==h||e[52]!==p||e[53]!==_||e[54]!==y||e[55]!==g||e[56]!==w||e[57]!==m||e[58]!==S||e[59]!==x?(E=d.jsxs("group",{ref:y,position:g,rotation:w,onPointerOver:m,onPointerOut:S,onClick:x,children:[h,p,_]}),e[51]=h,e[52]=p,e[53]=_,e[54]=y,e[55]=g,e[56]=w,e[57]=m,e[58]=S,e[59]=x,e[60]=E):E=e[60],E}function Sb(t){return t.toFixed(2)}function kb(t){return t.toFixed(2)}function Tb(t){return typeof t=="number"}function Ab(t){return t.toFixed(2)}function Nb(t){return`
${t.toFixed(2)}`}function Kc({attachments:t,onSelect:e,onHover:n,jsonPath:s}){return Object.entries(t.attachments||{}).map(([r,i])=>d.jsx(Eb,{attachment:i,onSelect:e,onHover:n,jsonPath:`${s}.attachments.${r}`},r))}function Ha(t){const e=$.c(13),{selection:n,color:s,scaleFactor:r}=t,i=s===void 0?16753920:s,o=r===void 0?1.05:r,{scene:a}=zr(),l=F.useRef(null);let c;e:{if(!n){let g;e[0]===Symbol.for("react.memo_cache_sentinel")?(g=new Ce(1,1,1),e[0]=g):g=e[0],c=g;break e}let y;if(e[1]!==o||e[2]!==n){const g=n.clone(!0);g.rotation.set(0,0,0),g.updateWorldMatrix(!0,!0),y=new kr().setFromObject(g).getSize(new Ce).multiplyScalar(o),g.remove(),e[1]=o,e[2]=n,e[3]=y}else y=e[3];c=y}const u=c;let f,h;e[4]!==u||e[5]!==i||e[6]!==a||e[7]!==n?(f=()=>{if(n){if(!l.current){const y=new Yo(new Go(u.x,u.y,u.z)),g=new Ph({color:i});l.current=new $h(y,g),a.add(l.current)}return()=>{l.current&&(a.remove(l.current),l.current.geometry.dispose(),l.current=null)}}},h=[n,a,i,u],e[4]=u,e[5]=i,e[6]=a,e[7]=n,e[8]=f,e[9]=h):(f=e[8],h=e[9]),F.useEffect(f,h);let p;return e[10]!==u||e[11]!==n?(p=()=>{if(!l.current||!n)return;const y=new kr().setFromObject(n).getCenter(new Ce);l.current.geometry.dispose(),l.current.geometry=new Yo(new Go(u.x,u.y,u.z)),l.current.position.copy(y),l.current.quaternion.copy(n.getWorldQuaternion(new El))},e[10]=u,e[11]=n,e[12]=p):p=e[12],ao(p),null}function Ob(t){const e=$.c(26);let n,s,r,i,o,a;e[0]!==t?({className:n,defaultValue:s,value:a,min:i,max:o,...r}=t,e[0]=t,e[1]=n,e[2]=s,e[3]=r,e[4]=i,e[5]=o,e[6]=a):(n=e[1],s=e[2],r=e[3],i=e[4],o=e[5],a=e[6]);const l=i===void 0?0:i,c=o===void 0?100:o;let u,f;e[7]!==s||e[8]!==c||e[9]!==l||e[10]!==a?(f=Array.isArray(a)?a:Array.isArray(s)?s:[l,c],e[7]=s,e[8]=c,e[9]=l,e[10]=a,e[11]=f):f=e[11],u=f;const h=u;let p;e[12]!==n?(p=V("relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",n),e[12]=n,e[13]=p):p=e[13];let y;e[14]===Symbol.for("react.memo_cache_sentinel")?(y=V("bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-1.5 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5"),e[14]=y):y=e[14];let g;e[15]===Symbol.for("react.memo_cache_sentinel")?(g=d.jsx(nh,{"data-slot":"slider-track",className:y,children:d.jsx(sh,{"data-slot":"slider-range",className:V("bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full")})}),e[15]=g):g=e[15];let w;e[16]!==h.length?(w=Array.from({length:h.length},Cb),e[16]=h.length,e[17]=w):w=e[17];let m;return e[18]!==s||e[19]!==c||e[20]!==l||e[21]!==r||e[22]!==p||e[23]!==w||e[24]!==a?(m=d.jsxs(rh,{"data-slot":"slider",defaultValue:s,value:a,min:l,max:c,className:p,...r,children:[g,w]}),e[18]=s,e[19]=c,e[20]=l,e[21]=r,e[22]=p,e[23]=w,e[24]=a,e[25]=m):m=e[25],m}function Cb(t,e){return d.jsx(ih,{"data-slot":"slider-thumb",className:"border-primary bg-background ring-ring/50 block size-4 shrink-0 rounded-full border shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"},e)}function Ib(t){const e=$.c(17),{value:n,onChange:s}=t,r=n===void 0?0:n;let i;e[0]===Symbol.for("react.memo_cache_sentinel")?(i=[0,1,5,11.25,15,22.5,30,45],e[0]=i):i=e[0];const o=i,[a,l]=F.useState(r||0);let c;e[1]!==s?(c=_=>{l(_),s(_)},e[1]=s,e[2]=c):c=e[2];const u=c;let f;e[3]===Symbol.for("react.memo_cache_sentinel")?(f=_=>o.reduce((E,k)=>Math.abs(k-_)<Math.abs(E-_)?k:E),e[3]=f):f=e[3];const h=f;let p;e[4]===Symbol.for("react.memo_cache_sentinel")?(p={minWidth:"5ch"},e[4]=p):p=e[4];const y=a>0?`${a}°`:"Off";let g;e[5]!==y?(g=d.jsxs(yt,{className:"flex items-center gap-1 font-semibold whitespace-nowrap",children:["Angle Snap:",d.jsx("span",{className:"inline-block",style:p,children:y})]}),e[5]=y,e[6]=g):g=e[6];let w;e[7]!==a?(w=[a],e[7]=a,e[8]=w):w=e[8];let m;e[9]!==u?(m=_=>{const E=h(_[0]);u(E)},e[9]=u,e[10]=m):m=e[10];let S;e[11]!==w||e[12]!==m?(S=d.jsx(Ob,{min:0,max:45,step:.1,value:w,onValueChange:m,className:"w-full"}),e[11]=w,e[12]=m,e[13]=S):S=e[13];let x;return e[14]!==S||e[15]!==g?(x=d.jsxs("div",{className:"flex w-sm flex-row items-center gap-2",children:[g,S]}),e[14]=S,e[15]=g,e[16]=x):x=e[16],x}const Mb=Al("inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium hover:bg-muted hover:text-muted-foreground disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 [&_svg]:shrink-0 focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] outline-none transition-[color,box-shadow] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive whitespace-nowrap",{variants:{variant:{default:"bg-card",outline:"border border-input bg-card shadow-xs hover:bg-accent hover:text-accent-foreground"},size:{default:"h-9 px-2 min-w-9",sm:"h-8 px-1.5 min-w-8",lg:"h-10 px-2.5 min-w-10"}},defaultVariants:{variant:"default",size:"default"}});function Xa(t){const e=$.c(12);let n,s,r,i;e[0]!==t?({className:n,variant:i,size:r,...s}=t,e[0]=t,e[1]=n,e[2]=s,e[3]=r,e[4]=i):(n=e[1],s=e[2],r=e[3],i=e[4]);let o;e[5]!==n||e[6]!==r||e[7]!==i?(o=V(Mb({variant:i,size:r,className:n})),e[5]=n,e[6]=r,e[7]=i,e[8]=o):o=e[8];let a;return e[9]!==s||e[10]!==o?(a=d.jsx(oh,{"data-slot":"toggle",className:o,...s}),e[9]=s,e[10]=o,e[11]=a):a=e[11],a}function jb({controlsRef:t}){const e=ct(),{camera:n}=zr();return F.useEffect(()=>{const s=t.current,r=e.metadata.orbitControls;!s||!r||(n.position.copy(new Ce(...r.position)),s.target.copy(new Ce(...r.target)),r.zoom&&"zoom"in n&&(n.zoom=r.zoom,n.updateProjectionMatrix()),s.update())},[e.metadata.orbitControls,n,t]),F.useEffect(()=>{const s=t.current;if(!s)return;const r=()=>{e.setMetadata({...e.metadata,orbitControls:{position:n.position.toArray(),target:s.target.toArray(),zoom:n.zoom}})};return s.addEventListener("change",r),()=>s.removeEventListener("change",r)},[n,e,t]),null}function Rb(){const t=$.c(100),e=$s(),n=ct(),s=F.useRef(null),[r,i]=F.useState(null),[o,a]=F.useState(null),[l,c]=F.useState("translate"),[u,f]=F.useState("world");let h,p;t[0]!==n||t[1]!==r||t[2]!==u?(h=()=>{const et=je=>{if(!(je.target&&je.target.isContentEditable))if(je.key==="v"||je.key==="V")c("translate");else if(je.key==="r"||je.key==="R")c("rotate");else if(je.key==="x"||je.key==="X")f(u==="world"?"local":"world");else if(je.key==="f"||je.key==="F"){if(r){const fn=new kr().setFromObject(r),Mn=fn.getSize(new Ce).length(),kt=fn.getCenter(new Ce),Zt=Mn*1.5,hn=s.current?.object;if(hn){const us=new Ce().subVectors(hn.position,kt).normalize().multiplyScalar(Zt);hn.position.copy(us.add(kt)),s.current?.target.copy(kt),s.current?.update()}}}else je.key==="Escape"&&(n.setSelectedObjectPath(void 0),i(null))};return window.addEventListener("keydown",et),()=>{window.removeEventListener("keydown",et)}},p=[u,n,r],t[0]=n,t[1]=r,t[2]=u,t[3]=h,t[4]=p):(h=t[3],p=t[4]),F.useEffect(h,p);let y,g;if(t[5]!==n.cart||t[6]!==r?(y=()=>{r&&(n.cart||i(null))},g=[n.cart,r],t[5]=n.cart,t[6]=r,t[7]=y,t[8]=g):(y=t[7],g=t[8]),F.useEffect(y,g),!n.cart){let et;return t[9]===Symbol.for("react.memo_cache_sentinel")?(et=d.jsx("div",{className:"flex h-full w-full items-center justify-center bg-black",children:d.jsx("p",{className:"text-muted-foreground",children:"No cart selected. Please create or open a project."})}),t[9]=et):et=t[9],et}let w;t[10]===Symbol.for("react.memo_cache_sentinel")?(w=d.jsx(Th,{},"smaa"),t[10]=w):w=t[10];let m;t[11]!==e.SSAOEnabled?(m=e.SSAOEnabled&&d.jsx(_h,{},"ssao"),t[11]=e.SSAOEnabled,t[12]=m):m=t[12];let S;t[13]!==e.DOFEnabled?(S=e.DOFEnabled&&d.jsx(Eh,{focusDistance:2,focalLength:5,bokehScale:2},"dof"),t[13]=e.DOFEnabled,t[14]=S):S=t[14];let x;t[15]!==m||t[16]!==S?(x=[w,m,S].filter(Boolean),t[15]=m,t[16]=S,t[17]=x):x=t[17];const _=x,E=`three-bg ${o?"cursor-pointer":"cursor-default"}`;let k;t[18]===Symbol.for("react.memo_cache_sentinel")?(k={position:[3,3,3],fov:45},t[18]=k):k=t[18];let b,v;t[19]===Symbol.for("react.memo_cache_sentinel")?(b=[1,2],v={toneMapping:0,powerPreference:"high-performance",alpha:!1,antialias:!0,stencil:!1,autoClear:!1,depth:!0},t[19]=b,t[20]=v):(b=t[19],v=t[20]);let T;t[21]!==n?(T=et=>{et.type==="click"&&(n.setSelectedObjectPath(void 0),i(null))},t[21]=n,t[22]=T):T=t[22];let A;t[23]!==_?(A=d.jsx(Ah,{enabled:!0,enableNormalPass:!0,depthBuffer:!0,stencilBuffer:!0,children:_}),t[23]=_,t[24]=A):A=t[24];let O,N,M,R;t[25]===Symbol.for("react.memo_cache_sentinel")?(O=d.jsx(hb,{}),N=d.jsx(Nh,{all:!0}),M=d.jsx("ambientLight",{intensity:2}),R=d.jsx("directionalLight",{position:[5,5,5],intensity:3,castShadow:!0}),t[25]=O,t[26]=N,t[27]=M,t[28]=R):(O=t[25],N=t[26],M=t[27],R=t[28]);let j;t[29]===Symbol.for("react.memo_cache_sentinel")?(j=d.jsx(F.Suspense,{fallback:d.jsx(Oh,{center:!0,children:"Loading..."}),children:d.jsx(_b,{onSelect:i,onHover:a})}),t[29]=j):j=t[29];let P;t[30]===Symbol.for("react.memo_cache_sentinel")?(P=[.5,-.501,.5],t[30]=P):P=t[30];const L=e.gridColor;let U;t[31]!==e?(U=e.getComplementaryGridColor(),t[31]=e,t[32]=U):U=t[32];let z;t[33]!==e.gridColor||t[34]!==U?(z=d.jsx(Ch,{position:P,cellSize:.0625,sectionSize:1,cellThickness:.5,sectionThickness:1.5,cellColor:L,sectionColor:U,infiniteGrid:!0,side:Dh}),t[33]=e.gridColor,t[34]=U,t[35]=z):z=t[35];let ne;t[36]!==e.angleSnap||t[37]!==e.distanceSnap||t[38]!==r||t[39]!==l||t[40]!==u?(ne=r&&d.jsx(Sh,{object:r,mode:l,rotationSnap:Ot(e.angleSnap),translationSnap:e.distanceSnap,onMouseDown:()=>s.current.enabled=!1,onMouseUp:()=>s.current.enabled=!0,space:u}),t[36]=e.angleSnap,t[37]=e.distanceSnap,t[38]=r,t[39]=l,t[40]=u,t[41]=ne):ne=t[41];let G;t[42]!==e.controlDamping?(G=d.jsx(kh,{ref:s,makeDefault:!0,enableDamping:e.controlDamping}),t[42]=e.controlDamping,t[43]=G):G=t[43];let ee;t[44]===Symbol.for("react.memo_cache_sentinel")?(ee=[80,80],t[44]=ee):ee=t[44];let Y,Q;t[45]===Symbol.for("react.memo_cache_sentinel")?(Y=d.jsx(Ih,{alignment:"bottom-right",margin:ee,children:d.jsx(Mh,{axisColors:["#9d4b4b","#2f7f4f","#3b5b9d"],labelColor:"white"})}),Q=d.jsx(jb,{controlsRef:s}),t[45]=Y,t[46]=Q):(Y=t[45],Q=t[46]);let J;t[47]!==o?(J=o&&d.jsx(Ha,{selection:o,color:16753920,scaleFactor:1.1}),t[47]=o,t[48]=J):J=t[48];let he;t[49]!==r?(he=r&&d.jsx(Ha,{selection:r,color:65535,scaleFactor:1.1}),t[49]=r,t[50]=he):he=t[50];let Ie;t[51]!==T||t[52]!==A||t[53]!==z||t[54]!==ne||t[55]!==G||t[56]!==J||t[57]!==he||t[58]!==E?(Ie=d.jsxs(jh,{className:E,camera:k,shadows:!0,dpr:b,gl:v,onPointerMissed:T,children:[A,O,N,M,R,j,z,ne,G,Y,Q,J,he]}),t[51]=T,t[52]=A,t[53]=z,t[54]=ne,t[55]=G,t[56]=J,t[57]=he,t[58]=E,t[59]=Ie):Ie=t[59];let Be;t[60]===Symbol.for("react.memo_cache_sentinel")?(Be=d.jsx(db,{}),t[60]=Be):Be=t[60];let Ue;t[61]!==u?(Ue=()=>{f(u==="world"?"local":"world")},t[61]=u,t[62]=Ue):Ue=t[62];let Me;t[63]!==u?(Me=d.jsx(Kt,{children:u==="world"?d.jsx(tf,{}):d.jsx(nf,{})}),t[63]=u,t[64]=Me):Me=t[64];let Ae;t[65]!==Ue||t[66]!==Me?(Ae=d.jsx(nt,{variant:"secondary",size:"icon",asChild:!0,onClick:Ue,children:Me}),t[65]=Ue,t[66]=Me,t[67]=Ae):Ae=t[67];const ze=u==="world"?"World Space":"Local Space";let Fe;t[68]===Symbol.for("react.memo_cache_sentinel")?(Fe=d.jsx("kbd",{className:"text-muted-foreground ml-1",children:"X"}),t[68]=Fe):Fe=t[68];let $e;t[69]!==ze?($e=d.jsxs(Ht,{children:[ze,Fe]}),t[69]=ze,t[70]=$e):$e=t[70];let He;t[71]!==Ae||t[72]!==$e?(He=d.jsxs(Gt,{children:[Ae,$e]}),t[71]=Ae,t[72]=$e,t[73]=He):He=t[73];const Ft=l==="translate";let ut;t[74]===Symbol.for("react.memo_cache_sentinel")?(ut=()=>c("translate"),t[74]=ut):ut=t[74];let jt;t[75]===Symbol.for("react.memo_cache_sentinel")?(jt=d.jsx(Kt,{children:d.jsx(sf,{})}),t[75]=jt):jt=t[75];let Xe;t[76]!==Ft?(Xe=d.jsx(Xa,{pressed:Ft,onClick:ut,asChild:!0,children:jt}),t[76]=Ft,t[77]=Xe):Xe=t[77];let Rt;t[78]===Symbol.for("react.memo_cache_sentinel")?(Rt=d.jsxs(Ht,{children:["Translate Mode",d.jsx("kbd",{className:"text-muted-foreground ml-1",children:"V"})]}),t[78]=Rt):Rt=t[78];let ft;t[79]!==Xe?(ft=d.jsxs(Gt,{children:[Xe,Rt]}),t[79]=Xe,t[80]=ft):ft=t[80];const _t=l==="rotate";let Bt;t[81]===Symbol.for("react.memo_cache_sentinel")?(Bt=()=>c("rotate"),t[81]=Bt):Bt=t[81];let ht;t[82]===Symbol.for("react.memo_cache_sentinel")?(ht=d.jsx(Kt,{children:d.jsx(rf,{})}),t[82]=ht):ht=t[82];let Et;t[83]!==_t?(Et=d.jsx(Xa,{pressed:_t,onClick:Bt,asChild:!0,children:ht}),t[83]=_t,t[84]=Et):Et=t[84];let dt;t[85]===Symbol.for("react.memo_cache_sentinel")?(dt=d.jsxs(Ht,{children:["Rotate Mode",d.jsx("kbd",{className:"text-muted-foreground ml-1",children:"R"})]}),t[85]=dt):dt=t[85];let Qe;t[86]!==Et?(Qe=d.jsxs(Gt,{children:[Et,dt]}),t[86]=Et,t[87]=Qe):Qe=t[87];let Je;t[88]!==e.angleSnap||t[89]!==e.setAngleSnap||t[90]!==l?(Je=l==="rotate"&&d.jsx(Ib,{value:e.angleSnap,onChange:e.setAngleSnap}),t[88]=e.angleSnap,t[89]=e.setAngleSnap,t[90]=l,t[91]=Je):Je=t[91];let St;t[92]!==He||t[93]!==ft||t[94]!==Qe||t[95]!==Je?(St=d.jsxs("div",{className:"absolute top-[8px] left-[8px] flex flex-row gap-[8px]",children:[He,ft,Qe,Je]}),t[92]=He,t[93]=ft,t[94]=Qe,t[95]=Je,t[96]=St):St=t[96];let Ut;return t[97]!==Ie||t[98]!==St?(Ut=d.jsxs("div",{className:"relative h-full w-full",children:[Ie,Be,St]}),t[97]=Ie,t[98]=St,t[99]=Ut):Ut=t[99],Ut}function Pb(t){const e=$.c(18),{keyframe:n,trackId:s,zoom:r,onUpdate:i}=t,[o,a]=F.useState(n.time*r);let l,c;e[0]!==n.time||e[1]!==r?(l=()=>{a(n.time*r)},c=[n.time,r],e[0]=n.time,e[1]=r,e[2]=l,e[3]=c):(l=e[2],c=e[3]),F.useEffect(l,c);let u;e[4]!==n.id||e[5]!==n.time||e[6]!==i||e[7]!==s||e[8]!==r?(u=m=>{let{movement:S,memo:x,first:_,last:E}=m;const[k]=S;_&&(x=n.time*r);let b=x+k;b=Math.max(0,b);const v=Math.round(b/r*10)/10;return a(v*r),E&&i(s,n.id,v),x},e[4]=n.id,e[5]=n.time,e[6]=i,e[7]=s,e[8]=r,e[9]=u):u=e[9];let f;e[10]===Symbol.for("react.memo_cache_sentinel")?(f={filterTaps:!0},e[10]=f):f=e[10];const h=Wu(u,f);let p;e[11]!==h?(p=h(),e[11]=h,e[12]=p):p=e[12];const y=`translateX(${o}px)`;let g;e[13]!==y?(g={transform:y,transition:"transform 0.02s ease"},e[13]=y,e[14]=g):g=e[14];let w;return e[15]!==p||e[16]!==g?(w=d.jsx("div",{...p,className:"absolute top-2 w-4 h-4 bg-blue-500 rounded cursor-grab",style:g}),e[15]=p,e[16]=g,e[17]=w):w=e[17],w}const Hc=6048e5,$b=864e5,Qa=Symbol.for("constructDateFrom");function cn(t,e){return typeof t=="function"?t(e):t&&typeof t=="object"&&Qa in t?t[Qa](e):t instanceof Date?new t.constructor(e):new Date(e)}function vt(t,e){return cn(e||t,t)}let Db={};function Kr(){return Db}function Ms(t,e){const n=Kr(),s=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,r=vt(t,e?.in),i=r.getDay(),o=(i<s?7:0)+i-s;return r.setDate(r.getDate()-o),r.setHours(0,0,0,0),r}function $r(t,e){return Ms(t,{...e,weekStartsOn:1})}function Xc(t,e){const n=vt(t,e?.in),s=n.getFullYear(),r=cn(n,0);r.setFullYear(s+1,0,4),r.setHours(0,0,0,0);const i=$r(r),o=cn(n,0);o.setFullYear(s,0,4),o.setHours(0,0,0,0);const a=$r(o);return n.getTime()>=i.getTime()?s+1:n.getTime()>=a.getTime()?s:s-1}function Ja(t){const e=vt(t),n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return n.setUTCFullYear(e.getFullYear()),+t-+n}function Lb(t,...e){const n=cn.bind(null,e.find(s=>typeof s=="object"));return e.map(n)}function el(t,e){const n=vt(t,e?.in);return n.setHours(0,0,0,0),n}function zb(t,e,n){const[s,r]=Lb(n?.in,t,e),i=el(s),o=el(r),a=+i-Ja(i),l=+o-Ja(o);return Math.round((a-l)/$b)}function Fb(t,e){const n=Xc(t,e),s=cn(t,0);return s.setFullYear(n,0,4),s.setHours(0,0,0,0),$r(s)}function Bb(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function Ub(t){return!(!Bb(t)&&typeof t!="number"||isNaN(+vt(t)))}function Zb(t,e){const n=vt(t,e?.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}const Vb={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Wb=(t,e,n)=>{let s;const r=Vb[t];return typeof r=="string"?s=r:e===1?s=r.one:s=r.other.replace("{{count}}",e.toString()),n?.addSuffix?n.comparison&&n.comparison>0?"in "+s:s+" ago":s};function yi(t){return(e={})=>{const n=e.width?String(e.width):t.defaultWidth;return t.formats[n]||t.formats[t.defaultWidth]}}const qb={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Yb={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Gb={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Kb={date:yi({formats:qb,defaultWidth:"full"}),time:yi({formats:Yb,defaultWidth:"full"}),dateTime:yi({formats:Gb,defaultWidth:"full"})},Hb={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Xb=(t,e,n,s)=>Hb[t];function ps(t){return(e,n)=>{const s=n?.context?String(n.context):"standalone";let r;if(s==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,a=n?.width?String(n.width):o;r=t.formattingValues[a]||t.formattingValues[o]}else{const o=t.defaultWidth,a=n?.width?String(n.width):t.defaultWidth;r=t.values[a]||t.values[o]}const i=t.argumentCallback?t.argumentCallback(e):e;return r[i]}}const Qb={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Jb={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},ew={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},tw={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},nw={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},sw={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},rw=(t,e)=>{const n=Number(t),s=n%100;if(s>20||s<10)switch(s%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},iw={ordinalNumber:rw,era:ps({values:Qb,defaultWidth:"wide"}),quarter:ps({values:Jb,defaultWidth:"wide",argumentCallback:t=>t-1}),month:ps({values:ew,defaultWidth:"wide"}),day:ps({values:tw,defaultWidth:"wide"}),dayPeriod:ps({values:nw,defaultWidth:"wide",formattingValues:sw,defaultFormattingWidth:"wide"})};function ms(t){return(e,n={})=>{const s=n.width,r=s&&t.matchPatterns[s]||t.matchPatterns[t.defaultMatchWidth],i=e.match(r);if(!i)return null;const o=i[0],a=s&&t.parsePatterns[s]||t.parsePatterns[t.defaultParseWidth],l=Array.isArray(a)?aw(a,f=>f.test(o)):ow(a,f=>f.test(o));let c;c=t.valueCallback?t.valueCallback(l):l,c=n.valueCallback?n.valueCallback(c):c;const u=e.slice(o.length);return{value:c,rest:u}}}function ow(t,e){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&e(t[n]))return n}function aw(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return n}function lw(t){return(e,n={})=>{const s=e.match(t.matchPattern);if(!s)return null;const r=s[0],i=e.match(t.parsePattern);if(!i)return null;let o=t.valueCallback?t.valueCallback(i[0]):i[0];o=n.valueCallback?n.valueCallback(o):o;const a=e.slice(r.length);return{value:o,rest:a}}}const cw=/^(\d+)(th|st|nd|rd)?/i,uw=/\d+/i,fw={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},hw={any:[/^b/i,/^(a|c)/i]},dw={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},pw={any:[/1/i,/2/i,/3/i,/4/i]},mw={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},gw={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},yw={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},bw={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},ww={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},vw={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},xw={ordinalNumber:lw({matchPattern:cw,parsePattern:uw,valueCallback:t=>parseInt(t,10)}),era:ms({matchPatterns:fw,defaultMatchWidth:"wide",parsePatterns:hw,defaultParseWidth:"any"}),quarter:ms({matchPatterns:dw,defaultMatchWidth:"wide",parsePatterns:pw,defaultParseWidth:"any",valueCallback:t=>t+1}),month:ms({matchPatterns:mw,defaultMatchWidth:"wide",parsePatterns:gw,defaultParseWidth:"any"}),day:ms({matchPatterns:yw,defaultMatchWidth:"wide",parsePatterns:bw,defaultParseWidth:"any"}),dayPeriod:ms({matchPatterns:ww,defaultMatchWidth:"any",parsePatterns:vw,defaultParseWidth:"any"})},_w={code:"en-US",formatDistance:Wb,formatLong:Kb,formatRelative:Xb,localize:iw,match:xw,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Ew(t,e){const n=vt(t,e?.in);return zb(n,Zb(n))+1}function Sw(t,e){const n=vt(t,e?.in),s=+$r(n)-+Fb(n);return Math.round(s/Hc)+1}function Qc(t,e){const n=vt(t,e?.in),s=n.getFullYear(),r=Kr(),i=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,o=cn(e?.in||t,0);o.setFullYear(s+1,0,i),o.setHours(0,0,0,0);const a=Ms(o,e),l=cn(e?.in||t,0);l.setFullYear(s,0,i),l.setHours(0,0,0,0);const c=Ms(l,e);return+n>=+a?s+1:+n>=+c?s:s-1}function kw(t,e){const n=Kr(),s=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,r=Qc(t,e),i=cn(e?.in||t,0);return i.setFullYear(r,0,s),i.setHours(0,0,0,0),Ms(i,e)}function Tw(t,e){const n=vt(t,e?.in),s=+Ms(n,e)-+kw(n,e);return Math.round(s/Hc)+1}function le(t,e){const n=t<0?"-":"",s=Math.abs(t).toString().padStart(e,"0");return n+s}const qt={y(t,e){const n=t.getFullYear(),s=n>0?n:1-n;return le(e==="yy"?s%100:s,e.length)},M(t,e){const n=t.getMonth();return e==="M"?String(n+1):le(n+1,2)},d(t,e){return le(t.getDate(),e.length)},a(t,e){const n=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(t,e){return le(t.getHours()%12||12,e.length)},H(t,e){return le(t.getHours(),e.length)},m(t,e){return le(t.getMinutes(),e.length)},s(t,e){return le(t.getSeconds(),e.length)},S(t,e){const n=e.length,s=t.getMilliseconds(),r=Math.trunc(s*Math.pow(10,n-3));return le(r,e.length)}},$n={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},tl={G:function(t,e,n){const s=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return n.era(s,{width:"abbreviated"});case"GGGGG":return n.era(s,{width:"narrow"});case"GGGG":default:return n.era(s,{width:"wide"})}},y:function(t,e,n){if(e==="yo"){const s=t.getFullYear(),r=s>0?s:1-s;return n.ordinalNumber(r,{unit:"year"})}return qt.y(t,e)},Y:function(t,e,n,s){const r=Qc(t,s),i=r>0?r:1-r;if(e==="YY"){const o=i%100;return le(o,2)}return e==="Yo"?n.ordinalNumber(i,{unit:"year"}):le(i,e.length)},R:function(t,e){const n=Xc(t);return le(n,e.length)},u:function(t,e){const n=t.getFullYear();return le(n,e.length)},Q:function(t,e,n){const s=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(s);case"QQ":return le(s,2);case"Qo":return n.ordinalNumber(s,{unit:"quarter"});case"QQQ":return n.quarter(s,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(s,{width:"wide",context:"formatting"})}},q:function(t,e,n){const s=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(s);case"qq":return le(s,2);case"qo":return n.ordinalNumber(s,{unit:"quarter"});case"qqq":return n.quarter(s,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(s,{width:"wide",context:"standalone"})}},M:function(t,e,n){const s=t.getMonth();switch(e){case"M":case"MM":return qt.M(t,e);case"Mo":return n.ordinalNumber(s+1,{unit:"month"});case"MMM":return n.month(s,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(s,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(s,{width:"wide",context:"formatting"})}},L:function(t,e,n){const s=t.getMonth();switch(e){case"L":return String(s+1);case"LL":return le(s+1,2);case"Lo":return n.ordinalNumber(s+1,{unit:"month"});case"LLL":return n.month(s,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(s,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(s,{width:"wide",context:"standalone"})}},w:function(t,e,n,s){const r=Tw(t,s);return e==="wo"?n.ordinalNumber(r,{unit:"week"}):le(r,e.length)},I:function(t,e,n){const s=Sw(t);return e==="Io"?n.ordinalNumber(s,{unit:"week"}):le(s,e.length)},d:function(t,e,n){return e==="do"?n.ordinalNumber(t.getDate(),{unit:"date"}):qt.d(t,e)},D:function(t,e,n){const s=Ew(t);return e==="Do"?n.ordinalNumber(s,{unit:"dayOfYear"}):le(s,e.length)},E:function(t,e,n){const s=t.getDay();switch(e){case"E":case"EE":case"EEE":return n.day(s,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(s,{width:"short",context:"formatting"});case"EEEE":default:return n.day(s,{width:"wide",context:"formatting"})}},e:function(t,e,n,s){const r=t.getDay(),i=(r-s.weekStartsOn+8)%7||7;switch(e){case"e":return String(i);case"ee":return le(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(r,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(r,{width:"short",context:"formatting"});case"eeee":default:return n.day(r,{width:"wide",context:"formatting"})}},c:function(t,e,n,s){const r=t.getDay(),i=(r-s.weekStartsOn+8)%7||7;switch(e){case"c":return String(i);case"cc":return le(i,e.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(r,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(r,{width:"narrow",context:"standalone"});case"cccccc":return n.day(r,{width:"short",context:"standalone"});case"cccc":default:return n.day(r,{width:"wide",context:"standalone"})}},i:function(t,e,n){const s=t.getDay(),r=s===0?7:s;switch(e){case"i":return String(r);case"ii":return le(r,e.length);case"io":return n.ordinalNumber(r,{unit:"day"});case"iii":return n.day(s,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(s,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(s,{width:"short",context:"formatting"});case"iiii":default:return n.day(s,{width:"wide",context:"formatting"})}},a:function(t,e,n){const r=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(t,e,n){const s=t.getHours();let r;switch(s===12?r=$n.noon:s===0?r=$n.midnight:r=s/12>=1?"pm":"am",e){case"b":case"bb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(t,e,n){const s=t.getHours();let r;switch(s>=17?r=$n.evening:s>=12?r=$n.afternoon:s>=4?r=$n.morning:r=$n.night,e){case"B":case"BB":case"BBB":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(t,e,n){if(e==="ho"){let s=t.getHours()%12;return s===0&&(s=12),n.ordinalNumber(s,{unit:"hour"})}return qt.h(t,e)},H:function(t,e,n){return e==="Ho"?n.ordinalNumber(t.getHours(),{unit:"hour"}):qt.H(t,e)},K:function(t,e,n){const s=t.getHours()%12;return e==="Ko"?n.ordinalNumber(s,{unit:"hour"}):le(s,e.length)},k:function(t,e,n){let s=t.getHours();return s===0&&(s=24),e==="ko"?n.ordinalNumber(s,{unit:"hour"}):le(s,e.length)},m:function(t,e,n){return e==="mo"?n.ordinalNumber(t.getMinutes(),{unit:"minute"}):qt.m(t,e)},s:function(t,e,n){return e==="so"?n.ordinalNumber(t.getSeconds(),{unit:"second"}):qt.s(t,e)},S:function(t,e){return qt.S(t,e)},X:function(t,e,n){const s=t.getTimezoneOffset();if(s===0)return"Z";switch(e){case"X":return sl(s);case"XXXX":case"XX":return pn(s);case"XXXXX":case"XXX":default:return pn(s,":")}},x:function(t,e,n){const s=t.getTimezoneOffset();switch(e){case"x":return sl(s);case"xxxx":case"xx":return pn(s);case"xxxxx":case"xxx":default:return pn(s,":")}},O:function(t,e,n){const s=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+nl(s,":");case"OOOO":default:return"GMT"+pn(s,":")}},z:function(t,e,n){const s=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+nl(s,":");case"zzzz":default:return"GMT"+pn(s,":")}},t:function(t,e,n){const s=Math.trunc(+t/1e3);return le(s,e.length)},T:function(t,e,n){return le(+t,e.length)}};function nl(t,e=""){const n=t>0?"-":"+",s=Math.abs(t),r=Math.trunc(s/60),i=s%60;return i===0?n+String(r):n+String(r)+e+le(i,2)}function sl(t,e){return t%60===0?(t>0?"-":"+")+le(Math.abs(t)/60,2):pn(t,e)}function pn(t,e=""){const n=t>0?"-":"+",s=Math.abs(t),r=le(Math.trunc(s/60),2),i=le(s%60,2);return n+r+e+i}const rl=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},Jc=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},Aw=(t,e)=>{const n=t.match(/(P+)(p+)?/)||[],s=n[1],r=n[2];if(!r)return rl(t,e);let i;switch(s){case"P":i=e.dateTime({width:"short"});break;case"PP":i=e.dateTime({width:"medium"});break;case"PPP":i=e.dateTime({width:"long"});break;case"PPPP":default:i=e.dateTime({width:"full"});break}return i.replace("{{date}}",rl(s,e)).replace("{{time}}",Jc(r,e))},Nw={p:Jc,P:Aw},Ow=/^D+$/,Cw=/^Y+$/,Iw=["D","DD","YY","YYYY"];function Mw(t){return Ow.test(t)}function jw(t){return Cw.test(t)}function Rw(t,e,n){const s=Pw(t,e,n);if(console.warn(s),Iw.includes(t))throw new RangeError(s)}function Pw(t,e,n){const s=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${s} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const $w=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Dw=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Lw=/^'([^]*?)'?$/,zw=/''/g,Fw=/[a-zA-Z]/;function il(t,e,n){const s=Kr(),r=s.locale??_w,i=s.firstWeekContainsDate??s.locale?.options?.firstWeekContainsDate??1,o=s.weekStartsOn??s.locale?.options?.weekStartsOn??0,a=vt(t,n?.in);if(!Ub(a))throw new RangeError("Invalid time value");let l=e.match(Dw).map(u=>{const f=u[0];if(f==="p"||f==="P"){const h=Nw[f];return h(u,r.formatLong)}return u}).join("").match($w).map(u=>{if(u==="''")return{isToken:!1,value:"'"};const f=u[0];if(f==="'")return{isToken:!1,value:Bw(u)};if(tl[f])return{isToken:!0,value:u};if(f.match(Fw))throw new RangeError("Format string contains an unescaped latin alphabet character `"+f+"`");return{isToken:!1,value:u}});r.localize.preprocessor&&(l=r.localize.preprocessor(a,l));const c={firstWeekContainsDate:i,weekStartsOn:o,locale:r};return l.map(u=>{if(!u.isToken)return u.value;const f=u.value;(jw(f)||Mw(f))&&Rw(f,e,String(t));const h=tl[f[0]];return h(a,f,r.localize,c)}).join("")}function Bw(t){const e=t.match(Lw);return e?e[1].replace(zw,"'"):t}function Le(t,e,n,s){return new(n||(n=Promise))((function(r,i){function o(c){try{l(s.next(c))}catch(u){i(u)}}function a(c){try{l(s.throw(c))}catch(u){i(u)}}function l(c){var u;c.done?r(c.value):(u=c.value,u instanceof n?u:new n((function(f){f(u)}))).then(o,a)}l((s=s.apply(t,e||[])).next())}))}class Fs{constructor(){this.listeners={}}on(e,n,s){if(this.listeners[e]||(this.listeners[e]=new Set),s?.once){const r=(...i)=>{this.un(e,r),n(...i)};return this.listeners[e].add(r),()=>this.un(e,r)}return this.listeners[e].add(n),()=>this.un(e,n)}un(e,n){var s;(s=this.listeners[e])===null||s===void 0||s.delete(n)}once(e,n){return this.on(e,n,{once:!0})}unAll(){this.listeners={}}emit(e,...n){this.listeners[e]&&this.listeners[e].forEach((s=>s(...n)))}}const cr={decode:function(t,e){return Le(this,void 0,void 0,(function*(){const n=new AudioContext({sampleRate:e});try{return yield n.decodeAudioData(t)}finally{n.close()}}))},createBuffer:function(t,e){if(!t||t.length===0)throw new Error("channelData must be a non-empty array");if(e<=0)throw new Error("duration must be greater than 0");if(typeof t[0]=="number"&&(t=[t]),!t[0]||t[0].length===0)throw new Error("channelData must contain non-empty channel arrays");return(function(n){const s=n[0];if(s.some((r=>r>1||r<-1))){const r=s.length;let i=0;for(let o=0;o<r;o++){const a=Math.abs(s[o]);a>i&&(i=a)}for(const o of n)for(let a=0;a<r;a++)o[a]/=i}})(t),{duration:e,length:t[0].length,sampleRate:t[0].length/e,numberOfChannels:t.length,getChannelData:n=>t?.[n],copyFromChannel:AudioBuffer.prototype.copyFromChannel,copyToChannel:AudioBuffer.prototype.copyToChannel}}};function eu(t,e){const n=e.xmlns?document.createElementNS(e.xmlns,t):document.createElement(t);for(const[s,r]of Object.entries(e))if(s==="children"&&r)for(const[i,o]of Object.entries(r))o instanceof Node?n.appendChild(o):typeof o=="string"?n.appendChild(document.createTextNode(o)):n.appendChild(eu(i,o));else s==="style"?Object.assign(n.style,r):s==="textContent"?n.textContent=r:n.setAttribute(s,r.toString());return n}function ol(t,e,n){const s=eu(t,e||{});return n?.appendChild(s),s}var Uw=Object.freeze({__proto__:null,createElement:ol,default:ol});const Zw={fetchBlob:function(t,e,n){return Le(this,void 0,void 0,(function*(){const s=yield fetch(t,n);if(s.status>=400)throw new Error(`Failed to fetch ${t}: ${s.status} (${s.statusText})`);return(function(r,i){Le(this,void 0,void 0,(function*(){if(!r.body||!r.headers)return;const o=r.body.getReader(),a=Number(r.headers.get("Content-Length"))||0;let l=0,c=0;const u=h=>Le(this,void 0,void 0,(function*(){l+=h?.length||0;const p=Math.round(l/a*100);i(p)})),f=()=>Le(this,void 0,void 0,(function*(){if(c++>1e5)return void console.error("Fetcher: Maximum iterations reached, stopping read loop");let h;try{h=yield o.read()}catch{return}h.done||(u(h.value),yield f())}));f()}))})(s.clone(),e),s.blob()}))}};class Vw extends Fs{constructor(e){super(),this.isExternalMedia=!1,e.media?(this.media=e.media,this.isExternalMedia=!0):this.media=document.createElement("audio"),e.mediaControls&&(this.media.controls=!0),e.autoplay&&(this.media.autoplay=!0),e.playbackRate!=null&&this.onMediaEvent("canplay",(()=>{e.playbackRate!=null&&(this.media.playbackRate=e.playbackRate)}),{once:!0})}onMediaEvent(e,n,s){return this.media.addEventListener(e,n,s),()=>this.media.removeEventListener(e,n,s)}getSrc(){return this.media.currentSrc||this.media.src||""}revokeSrc(){const e=this.getSrc();e.startsWith("blob:")&&URL.revokeObjectURL(e)}canPlayType(e){return this.media.canPlayType(e)!==""}setSrc(e,n){const s=this.getSrc();if(e&&s===e)return;this.revokeSrc();const r=n instanceof Blob&&(this.canPlayType(n.type)||!e)?URL.createObjectURL(n):e;if(s&&this.media.removeAttribute("src"),r||e)try{this.media.src=r}catch{this.media.src=e}}destroy(){this.isExternalMedia||(this.media.pause(),this.revokeSrc(),this.media.removeAttribute("src"),this.media.load(),this.media.remove())}setMediaElement(e){this.media=e}play(){return Le(this,void 0,void 0,(function*(){try{return yield this.media.play()}catch(e){if(e instanceof DOMException&&e.name==="AbortError")return;throw e}}))}pause(){this.media.pause()}isPlaying(){return!this.media.paused&&!this.media.ended}setTime(e){this.media.currentTime=Math.max(0,Math.min(e,this.getDuration()))}getDuration(){return this.media.duration}getCurrentTime(){return this.media.currentTime}getVolume(){return this.media.volume}setVolume(e){this.media.volume=e}getMuted(){return this.media.muted}setMuted(e){this.media.muted=e}getPlaybackRate(){return this.media.playbackRate}isSeeking(){return this.media.seeking}setPlaybackRate(e,n){n!=null&&(this.media.preservesPitch=n),this.media.playbackRate=e}getMediaElement(){return this.media}setSinkId(e){return this.media.setSinkId(e)}}class ss extends Fs{constructor(e,n){super(),this.timeouts=[],this.isScrollable=!1,this.audioData=null,this.resizeObserver=null,this.lastContainerWidth=0,this.isDragging=!1,this.subscriptions=[],this.unsubscribeOnScroll=[],this.dragUnsubscribe=null,this.subscriptions=[],this.options=e;const s=this.parentFromOptionsContainer(e.container);this.parent=s;const[r,i]=this.initHtml();s.appendChild(r),this.container=r,this.scrollContainer=i.querySelector(".scroll"),this.wrapper=i.querySelector(".wrapper"),this.canvasWrapper=i.querySelector(".canvases"),this.progressWrapper=i.querySelector(".progress"),this.cursor=i.querySelector(".cursor"),n&&i.appendChild(n),this.initEvents()}parentFromOptionsContainer(e){let n;if(typeof e=="string"?n=document.querySelector(e):e instanceof HTMLElement&&(n=e),!n)throw new Error("Container not found");return n}initEvents(){const e=n=>{const s=this.wrapper.getBoundingClientRect(),r=n.clientX-s.left,i=n.clientY-s.top;return[r/s.width,i/s.height]};if(this.wrapper.addEventListener("click",(n=>{const[s,r]=e(n);this.emit("click",s,r)})),this.wrapper.addEventListener("dblclick",(n=>{const[s,r]=e(n);this.emit("dblclick",s,r)})),this.options.dragToSeek!==!0&&typeof this.options.dragToSeek!="object"||this.initDrag(),this.scrollContainer.addEventListener("scroll",(()=>{const{scrollLeft:n,scrollWidth:s,clientWidth:r}=this.scrollContainer,i=n/s,o=(n+r)/s;this.emit("scroll",i,o,n,n+r)})),typeof ResizeObserver=="function"){const n=this.createDelay(100);this.resizeObserver=new ResizeObserver((()=>{n().then((()=>this.onContainerResize())).catch((()=>{}))})),this.resizeObserver.observe(this.scrollContainer)}}onContainerResize(){const e=this.parent.clientWidth;e===this.lastContainerWidth&&this.options.height!=="auto"||(this.lastContainerWidth=e,this.reRender())}initDrag(){this.dragUnsubscribe||(this.dragUnsubscribe=(function(e,n,s,r,i=3,o=0,a=100){if(!e)return()=>{};const l=matchMedia("(pointer: coarse)").matches;let c=()=>{};const u=f=>{if(f.button!==o)return;f.preventDefault(),f.stopPropagation();let h=f.clientX,p=f.clientY,y=!1;const g=Date.now(),w=E=>{if(E.preventDefault(),E.stopPropagation(),l&&Date.now()-g<a)return;const k=E.clientX,b=E.clientY,v=k-h,T=b-p;if(y||Math.abs(v)>i||Math.abs(T)>i){const A=e.getBoundingClientRect(),{left:O,top:N}=A;y||(s?.(h-O,p-N),y=!0),n(v,T,k-O,b-N),h=k,p=b}},m=E=>{if(y){const k=E.clientX,b=E.clientY,v=e.getBoundingClientRect(),{left:T,top:A}=v;r?.(k-T,b-A)}c()},S=E=>{E.relatedTarget&&E.relatedTarget!==document.documentElement||m(E)},x=E=>{y&&(E.stopPropagation(),E.preventDefault())},_=E=>{y&&E.preventDefault()};document.addEventListener("pointermove",w),document.addEventListener("pointerup",m),document.addEventListener("pointerout",S),document.addEventListener("pointercancel",S),document.addEventListener("touchmove",_,{passive:!1}),document.addEventListener("click",x,{capture:!0}),c=()=>{document.removeEventListener("pointermove",w),document.removeEventListener("pointerup",m),document.removeEventListener("pointerout",S),document.removeEventListener("pointercancel",S),document.removeEventListener("touchmove",_),setTimeout((()=>{document.removeEventListener("click",x,{capture:!0})}),10)}};return e.addEventListener("pointerdown",u),()=>{c(),e.removeEventListener("pointerdown",u)}})(this.wrapper,((e,n,s)=>{this.emit("drag",Math.max(0,Math.min(1,s/this.wrapper.getBoundingClientRect().width)))}),(e=>{this.isDragging=!0,this.emit("dragstart",Math.max(0,Math.min(1,e/this.wrapper.getBoundingClientRect().width)))}),(e=>{this.isDragging=!1,this.emit("dragend",Math.max(0,Math.min(1,e/this.wrapper.getBoundingClientRect().width)))})),this.subscriptions.push(this.dragUnsubscribe))}getHeight(e,n){var s;const r=((s=this.audioData)===null||s===void 0?void 0:s.numberOfChannels)||1;if(e==null)return 128;if(!isNaN(Number(e)))return Number(e);if(e==="auto"){const i=this.parent.clientHeight||128;return n?.every((o=>!o.overlay))?i/r:i}return 128}initHtml(){const e=document.createElement("div"),n=e.attachShadow({mode:"open"}),s=this.options.cspNonce&&typeof this.options.cspNonce=="string"?this.options.cspNonce.replace(/"/g,""):"";return n.innerHTML=`
      <style${s?` nonce="${s}"`:""}>
        :host {
          user-select: none;
          min-width: 1px;
        }
        :host audio {
          display: block;
          width: 100%;
        }
        :host .scroll {
          overflow-x: auto;
          overflow-y: hidden;
          width: 100%;
          position: relative;
        }
        :host .noScrollbar {
          scrollbar-color: transparent;
          scrollbar-width: none;
        }
        :host .noScrollbar::-webkit-scrollbar {
          display: none;
          -webkit-appearance: none;
        }
        :host .wrapper {
          position: relative;
          overflow: visible;
          z-index: 2;
        }
        :host .canvases {
          min-height: ${this.getHeight(this.options.height,this.options.splitChannels)}px;
        }
        :host .canvases > div {
          position: relative;
        }
        :host canvas {
          display: block;
          position: absolute;
          top: 0;
          image-rendering: pixelated;
        }
        :host .progress {
          pointer-events: none;
          position: absolute;
          z-index: 2;
          top: 0;
          left: 0;
          width: 0;
          height: 100%;
          overflow: hidden;
        }
        :host .progress > div {
          position: relative;
        }
        :host .cursor {
          pointer-events: none;
          position: absolute;
          z-index: 5;
          top: 0;
          left: 0;
          height: 100%;
          border-radius: 2px;
        }
      </style>

      <div class="scroll" part="scroll">
        <div class="wrapper" part="wrapper">
          <div class="canvases" part="canvases"></div>
          <div class="progress" part="progress"></div>
          <div class="cursor" part="cursor"></div>
        </div>
      </div>
    `,[e,n]}setOptions(e){if(this.options.container!==e.container){const n=this.parentFromOptionsContainer(e.container);n.appendChild(this.container),this.parent=n}e.dragToSeek!==!0&&typeof this.options.dragToSeek!="object"||this.initDrag(),this.options=e,this.reRender()}getWrapper(){return this.wrapper}getWidth(){return this.scrollContainer.clientWidth}getScroll(){return this.scrollContainer.scrollLeft}setScroll(e){this.scrollContainer.scrollLeft=e}setScrollPercentage(e){const{scrollWidth:n}=this.scrollContainer,s=n*e;this.setScroll(s)}destroy(){var e;this.subscriptions.forEach((n=>n())),this.container.remove(),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),(e=this.unsubscribeOnScroll)===null||e===void 0||e.forEach((n=>n())),this.unsubscribeOnScroll=[]}createDelay(e=10){let n,s;const r=()=>{n&&(clearTimeout(n),n=void 0),s&&(s(),s=void 0)};return this.timeouts.push(r),()=>new Promise(((i,o)=>{r(),s=o,n=setTimeout((()=>{n=void 0,s=void 0,i()}),e)}))}convertColorValues(e){if(!Array.isArray(e))return e||"";if(e.length===0)return"#999";if(e.length<2)return e[0]||"";const n=document.createElement("canvas"),s=n.getContext("2d"),r=n.height*(window.devicePixelRatio||1),i=s.createLinearGradient(0,0,0,r),o=1/(e.length-1);return e.forEach(((a,l)=>{const c=l*o;i.addColorStop(c,a)})),i}getPixelRatio(){return Math.max(1,window.devicePixelRatio||1)}renderBarWaveform(e,n,s,r){const i=e[0],o=e[1]||e[0],a=i.length,{width:l,height:c}=s.canvas,u=c/2,f=this.getPixelRatio(),h=n.barWidth?n.barWidth*f:1,p=n.barGap?n.barGap*f:n.barWidth?h/2:0,y=n.barRadius||0,g=l/(h+p)/a,w=y&&"roundRect"in s?"roundRect":"rect";s.beginPath();let m=0,S=0,x=0;for(let _=0;_<=a;_++){const E=Math.round(_*g);if(E>m){const v=Math.round(S*u*r),T=v+Math.round(x*u*r)||1;let A=u-v;n.barAlign==="top"?A=0:n.barAlign==="bottom"&&(A=c-T),s[w](m*(h+p),A,h,T,y),m=E,S=0,x=0}const k=Math.abs(i[_]||0),b=Math.abs(o[_]||0);k>S&&(S=k),b>x&&(x=b)}s.fill(),s.closePath()}renderLineWaveform(e,n,s,r){const i=o=>{const a=e[o]||e[0],l=a.length,{height:c}=s.canvas,u=c/2,f=s.canvas.width/l;s.moveTo(0,u);let h=0,p=0;for(let y=0;y<=l;y++){const g=Math.round(y*f);if(g>h){const m=u+(Math.round(p*u*r)||1)*(o===0?-1:1);s.lineTo(h,m),h=g,p=0}const w=Math.abs(a[y]||0);w>p&&(p=w)}s.lineTo(h,u)};s.beginPath(),i(0),i(1),s.fill(),s.closePath()}renderWaveform(e,n,s){if(s.fillStyle=this.convertColorValues(n.waveColor),n.renderFunction)return void n.renderFunction(e,s);let r=n.barHeight||1;if(n.normalize){const i=Array.from(e[0]).reduce(((o,a)=>Math.max(o,Math.abs(a))),0);r=i?r/i:r}n.barWidth||n.barGap||n.barAlign?this.renderBarWaveform(e,n,s,r):this.renderLineWaveform(e,n,s,r)}renderSingleCanvas(e,n,s,r,i,o,a){const l=this.getPixelRatio(),c=document.createElement("canvas");c.width=Math.round(s*l),c.height=Math.round(r*l),c.style.width=`${s}px`,c.style.height=`${r}px`,c.style.left=`${Math.round(i)}px`,o.appendChild(c);const u=c.getContext("2d");if(this.renderWaveform(e,n,u),c.width>0&&c.height>0){const f=c.cloneNode(),h=f.getContext("2d");h.drawImage(c,0,0),h.globalCompositeOperation="source-in",h.fillStyle=this.convertColorValues(n.progressColor),h.fillRect(0,0,c.width,c.height),a.appendChild(f)}}renderMultiCanvas(e,n,s,r,i,o){const a=this.getPixelRatio(),{clientWidth:l}=this.scrollContainer,c=s/a;let u=Math.min(ss.MAX_CANVAS_WIDTH,l,c),f={};if(n.barWidth||n.barGap){const w=n.barWidth||.5,m=w+(n.barGap||w/2);u%m!=0&&(u=Math.floor(u/m)*m)}if(u===0)return;const h=w=>{if(w<0||w>=p||f[w])return;f[w]=!0;const m=w*u;let S=Math.min(c-m,u);if(n.barWidth||n.barGap){const _=n.barWidth||.5,E=_+(n.barGap||_/2);S=Math.floor(S/E)*E}if(S<=0)return;const x=e.map((_=>{const E=Math.floor(m/c*_.length),k=Math.floor((m+S)/c*_.length);return _.slice(E,k)}));this.renderSingleCanvas(x,n,S,r,m,i,o)},p=Math.ceil(c/u);if(!this.isScrollable){for(let w=0;w<p;w++)h(w);return}const y=this.scrollContainer.scrollLeft/c,g=Math.floor(y*p);if(h(g-1),h(g),h(g+1),p>1){const w=this.on("scroll",(()=>{const{scrollLeft:m}=this.scrollContainer,S=Math.floor(m/c*p);Object.keys(f).length>ss.MAX_NODES&&(i.innerHTML="",o.innerHTML="",f={}),h(S-1),h(S),h(S+1)}));this.unsubscribeOnScroll.push(w)}}renderChannel(e,n,s,r){var{overlay:i}=n,o=(function(u,f){var h={};for(var p in u)Object.prototype.hasOwnProperty.call(u,p)&&f.indexOf(p)<0&&(h[p]=u[p]);if(u!=null&&typeof Object.getOwnPropertySymbols=="function"){var y=0;for(p=Object.getOwnPropertySymbols(u);y<p.length;y++)f.indexOf(p[y])<0&&Object.prototype.propertyIsEnumerable.call(u,p[y])&&(h[p[y]]=u[p[y]])}return h})(n,["overlay"]);const a=document.createElement("div"),l=this.getHeight(o.height,o.splitChannels);a.style.height=`${l}px`,i&&r>0&&(a.style.marginTop=`-${l}px`),this.canvasWrapper.style.minHeight=`${l}px`,this.canvasWrapper.appendChild(a);const c=a.cloneNode();this.progressWrapper.appendChild(c),this.renderMultiCanvas(e,o,s,l,a,c)}render(e){return Le(this,void 0,void 0,(function*(){var n;this.timeouts.forEach((l=>l())),this.timeouts=[],this.canvasWrapper.innerHTML="",this.progressWrapper.innerHTML="",this.options.width!=null&&(this.scrollContainer.style.width=typeof this.options.width=="number"?`${this.options.width}px`:this.options.width);const s=this.getPixelRatio(),r=this.scrollContainer.clientWidth,i=Math.ceil(e.duration*(this.options.minPxPerSec||0));this.isScrollable=i>r;const o=this.options.fillParent&&!this.isScrollable,a=(o?r:i)*s;if(this.wrapper.style.width=o?"100%":`${i}px`,this.scrollContainer.style.overflowX=this.isScrollable?"auto":"hidden",this.scrollContainer.classList.toggle("noScrollbar",!!this.options.hideScrollbar),this.cursor.style.backgroundColor=`${this.options.cursorColor||this.options.progressColor}`,this.cursor.style.width=`${this.options.cursorWidth}px`,this.audioData=e,this.emit("render"),this.options.splitChannels)for(let l=0;l<e.numberOfChannels;l++){const c=Object.assign(Object.assign({},this.options),(n=this.options.splitChannels)===null||n===void 0?void 0:n[l]);this.renderChannel([e.getChannelData(l)],c,a,l)}else{const l=[e.getChannelData(0)];e.numberOfChannels>1&&l.push(e.getChannelData(1)),this.renderChannel(l,this.options,a,0)}Promise.resolve().then((()=>this.emit("rendered")))}))}reRender(){if(this.unsubscribeOnScroll.forEach((s=>s())),this.unsubscribeOnScroll=[],!this.audioData)return;const{scrollWidth:e}=this.scrollContainer,{right:n}=this.progressWrapper.getBoundingClientRect();if(this.render(this.audioData),this.isScrollable&&e!==this.scrollContainer.scrollWidth){const{right:s}=this.progressWrapper.getBoundingClientRect();let r=s-n;r*=2,r=r<0?Math.floor(r):Math.ceil(r),r/=2,this.scrollContainer.scrollLeft+=r}}zoom(e){this.options.minPxPerSec=e,this.reRender()}scrollIntoView(e,n=!1){const{scrollLeft:s,scrollWidth:r,clientWidth:i}=this.scrollContainer,o=e*r,a=s,l=s+i,c=i/2;if(this.isDragging)o+30>l?this.scrollContainer.scrollLeft+=30:o-30<a&&(this.scrollContainer.scrollLeft-=30);else{(o<a||o>l)&&(this.scrollContainer.scrollLeft=o-(this.options.autoCenter?c:0));const u=o-s-c;n&&this.options.autoCenter&&u>0&&(this.scrollContainer.scrollLeft+=Math.min(u,10))}{const u=this.scrollContainer.scrollLeft,f=u/r,h=(u+i)/r;this.emit("scroll",f,h,u,u+i)}}renderProgress(e,n){if(isNaN(e))return;const s=100*e;this.canvasWrapper.style.clipPath=`polygon(${s}% 0%, 100% 0%, 100% 100%, ${s}% 100%)`,this.progressWrapper.style.width=`${s}%`,this.cursor.style.left=`${s}%`,this.cursor.style.transform=this.options.cursorWidth?`translateX(-${e*this.options.cursorWidth}px)`:"",this.isScrollable&&this.options.autoScroll&&this.scrollIntoView(e,n)}exportImage(e,n,s){return Le(this,void 0,void 0,(function*(){const r=this.canvasWrapper.querySelectorAll("canvas");if(!r.length)throw new Error("No waveform data");if(s==="dataURL"){const i=Array.from(r).map((o=>o.toDataURL(e,n)));return Promise.resolve(i)}return Promise.all(Array.from(r).map((i=>new Promise(((o,a)=>{i.toBlob((l=>{l?o(l):a(new Error("Could not export image"))}),e,n)})))))}))}}ss.MAX_CANVAS_WIDTH=8e3,ss.MAX_NODES=10;class Ww extends Fs{constructor(){super(...arguments),this.animationFrameId=null,this.isRunning=!1}start(){if(this.isRunning)return;this.isRunning=!0;const e=()=>{this.isRunning&&(this.emit("tick"),this.animationFrameId=requestAnimationFrame(e))};e()}stop(){this.isRunning=!1,this.animationFrameId!==null&&(cancelAnimationFrame(this.animationFrameId),this.animationFrameId=null)}destroy(){this.stop()}}class bi extends Fs{constructor(e=new AudioContext){super(),this.bufferNode=null,this.playStartTime=0,this.playedDuration=0,this._muted=!1,this._playbackRate=1,this._duration=void 0,this.buffer=null,this.currentSrc="",this.paused=!0,this.crossOrigin=null,this.seeking=!1,this.autoplay=!1,this.addEventListener=this.on,this.removeEventListener=this.un,this.audioContext=e,this.gainNode=this.audioContext.createGain(),this.gainNode.connect(this.audioContext.destination)}load(){return Le(this,void 0,void 0,(function*(){}))}get src(){return this.currentSrc}set src(e){if(this.currentSrc=e,this._duration=void 0,!e)return this.buffer=null,void this.emit("emptied");fetch(e).then((n=>{if(n.status>=400)throw new Error(`Failed to fetch ${e}: ${n.status} (${n.statusText})`);return n.arrayBuffer()})).then((n=>this.currentSrc!==e?null:this.audioContext.decodeAudioData(n))).then((n=>{this.currentSrc===e&&(this.buffer=n,this.emit("loadedmetadata"),this.emit("canplay"),this.autoplay&&this.play())}))}_play(){if(!this.paused)return;this.paused=!1,this.bufferNode&&(this.bufferNode.onended=null,this.bufferNode.disconnect()),this.bufferNode=this.audioContext.createBufferSource(),this.buffer&&(this.bufferNode.buffer=this.buffer),this.bufferNode.playbackRate.value=this._playbackRate,this.bufferNode.connect(this.gainNode);let e=this.playedDuration*this._playbackRate;(e>=this.duration||e<0)&&(e=0,this.playedDuration=0),this.bufferNode.start(this.audioContext.currentTime,e),this.playStartTime=this.audioContext.currentTime,this.bufferNode.onended=()=>{this.currentTime>=this.duration&&(this.pause(),this.emit("ended"))}}_pause(){var e;this.paused=!0,(e=this.bufferNode)===null||e===void 0||e.stop(),this.playedDuration+=this.audioContext.currentTime-this.playStartTime}play(){return Le(this,void 0,void 0,(function*(){this.paused&&(this._play(),this.emit("play"))}))}pause(){this.paused||(this._pause(),this.emit("pause"))}stopAt(e){const n=e-this.currentTime,s=this.bufferNode;s?.stop(this.audioContext.currentTime+n),s?.addEventListener("ended",(()=>{s===this.bufferNode&&(this.bufferNode=null,this.pause())}),{once:!0})}setSinkId(e){return Le(this,void 0,void 0,(function*(){return this.audioContext.setSinkId(e)}))}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e,this.bufferNode&&(this.bufferNode.playbackRate.value=e)}get currentTime(){return(this.paused?this.playedDuration:this.playedDuration+(this.audioContext.currentTime-this.playStartTime))*this._playbackRate}set currentTime(e){const n=!this.paused;n&&this._pause(),this.playedDuration=e/this._playbackRate,n&&this._play(),this.emit("seeking"),this.emit("timeupdate")}get duration(){var e,n;return(e=this._duration)!==null&&e!==void 0?e:((n=this.buffer)===null||n===void 0?void 0:n.duration)||0}set duration(e){this._duration=e}get volume(){return this.gainNode.gain.value}set volume(e){this.gainNode.gain.value=e,this.emit("volumechange")}get muted(){return this._muted}set muted(e){this._muted!==e&&(this._muted=e,this._muted?this.gainNode.disconnect():this.gainNode.connect(this.audioContext.destination))}canPlayType(e){return/^(audio|video)\//.test(e)}getGainNode(){return this.gainNode}getChannelData(){const e=[];if(!this.buffer)return e;const n=this.buffer.numberOfChannels;for(let s=0;s<n;s++)e.push(this.buffer.getChannelData(s));return e}removeAttribute(e){switch(e){case"src":this.src="";break;case"playbackRate":this.playbackRate=0;break;case"currentTime":this.currentTime=0;break;case"duration":this.duration=0;break;case"volume":this.volume=0;break;case"muted":this.muted=!1}}}const qw={waveColor:"#999",progressColor:"#555",cursorWidth:1,minPxPerSec:0,fillParent:!0,interact:!0,dragToSeek:!1,autoScroll:!0,autoCenter:!0,sampleRate:8e3};class js extends Vw{static create(e){return new js(e)}constructor(e){const n=e.media||(e.backend==="WebAudio"?new bi:void 0);super({media:n,mediaControls:e.mediaControls,autoplay:e.autoplay,playbackRate:e.audioRate}),this.plugins=[],this.decodedData=null,this.stopAtPosition=null,this.subscriptions=[],this.mediaSubscriptions=[],this.abortController=null,this.options=Object.assign({},qw,e),this.timer=new Ww;const s=n?void 0:this.getMediaElement();this.renderer=new ss(this.options,s),this.initPlayerEvents(),this.initRendererEvents(),this.initTimerEvents(),this.initPlugins();const r=this.options.url||this.getSrc()||"";Promise.resolve().then((()=>{this.emit("init");const{peaks:i,duration:o}=this.options;(r||i&&o)&&this.load(r,i,o).catch((a=>{console.error("WaveSurfer initial load error:",a)}))}))}updateProgress(e=this.getCurrentTime()){return this.renderer.renderProgress(e/this.getDuration(),this.isPlaying()),e}initTimerEvents(){this.subscriptions.push(this.timer.on("tick",(()=>{if(!this.isSeeking()){const e=this.updateProgress();this.emit("timeupdate",e),this.emit("audioprocess",e),this.stopAtPosition!=null&&this.isPlaying()&&e>=this.stopAtPosition&&this.pause()}})))}initPlayerEvents(){this.isPlaying()&&(this.emit("play"),this.timer.start()),this.mediaSubscriptions.push(this.onMediaEvent("timeupdate",(()=>{const e=this.updateProgress();this.emit("timeupdate",e)})),this.onMediaEvent("play",(()=>{this.emit("play"),this.timer.start()})),this.onMediaEvent("pause",(()=>{this.emit("pause"),this.timer.stop(),this.stopAtPosition=null})),this.onMediaEvent("emptied",(()=>{this.timer.stop(),this.stopAtPosition=null})),this.onMediaEvent("ended",(()=>{this.emit("timeupdate",this.getDuration()),this.emit("finish"),this.stopAtPosition=null})),this.onMediaEvent("seeking",(()=>{this.emit("seeking",this.getCurrentTime())})),this.onMediaEvent("error",(()=>{var e;this.emit("error",(e=this.getMediaElement().error)!==null&&e!==void 0?e:new Error("Media error")),this.stopAtPosition=null})))}initRendererEvents(){this.subscriptions.push(this.renderer.on("click",((e,n)=>{this.options.interact&&(this.seekTo(e),this.emit("interaction",e*this.getDuration()),this.emit("click",e,n))})),this.renderer.on("dblclick",((e,n)=>{this.emit("dblclick",e,n)})),this.renderer.on("scroll",((e,n,s,r)=>{const i=this.getDuration();this.emit("scroll",e*i,n*i,s,r)})),this.renderer.on("render",(()=>{this.emit("redraw")})),this.renderer.on("rendered",(()=>{this.emit("redrawcomplete")})),this.renderer.on("dragstart",(e=>{this.emit("dragstart",e)})),this.renderer.on("dragend",(e=>{this.emit("dragend",e)})));{let e;const n=this.renderer.on("drag",(s=>{if(!this.options.interact)return;let r;this.renderer.renderProgress(s),clearTimeout(e),this.isPlaying()?r=0:this.options.dragToSeek===!0?r=200:typeof this.options.dragToSeek=="object"&&this.options.dragToSeek!==void 0&&(r=this.options.dragToSeek.debounceTime),e=setTimeout((()=>{this.seekTo(s)}),r),this.emit("interaction",s*this.getDuration()),this.emit("drag",s)}));this.subscriptions.push((()=>{clearTimeout(e),n()}))}}initPlugins(){var e;!((e=this.options.plugins)===null||e===void 0)&&e.length&&this.options.plugins.forEach((n=>{this.registerPlugin(n)}))}unsubscribePlayerEvents(){this.mediaSubscriptions.forEach((e=>e())),this.mediaSubscriptions=[]}setOptions(e){this.options=Object.assign({},this.options,e),e.duration&&!e.peaks&&(this.decodedData=cr.createBuffer(this.exportPeaks(),e.duration)),e.peaks&&e.duration&&(this.decodedData=cr.createBuffer(e.peaks,e.duration)),this.renderer.setOptions(this.options),e.audioRate&&this.setPlaybackRate(e.audioRate),e.mediaControls!=null&&(this.getMediaElement().controls=e.mediaControls)}registerPlugin(e){if(this.plugins.includes(e))return e;e._init(this),this.plugins.push(e);const n=e.once("destroy",(()=>{this.plugins=this.plugins.filter((s=>s!==e)),this.subscriptions=this.subscriptions.filter((s=>s!==n))}));return this.subscriptions.push(n),e}unregisterPlugin(e){this.plugins=this.plugins.filter((n=>n!==e)),e.destroy()}getWrapper(){return this.renderer.getWrapper()}getWidth(){return this.renderer.getWidth()}getScroll(){return this.renderer.getScroll()}setScroll(e){return this.renderer.setScroll(e)}setScrollTime(e){const n=e/this.getDuration();this.renderer.setScrollPercentage(n)}getActivePlugins(){return this.plugins}loadAudio(e,n,s,r){return Le(this,void 0,void 0,(function*(){var i;if(this.emit("load",e),!this.options.media&&this.isPlaying()&&this.pause(),this.decodedData=null,this.stopAtPosition=null,(i=this.abortController)===null||i===void 0||i.abort(),this.abortController=null,!n&&!s){const a=this.options.fetchParams||{};window.AbortController&&!a.signal&&(this.abortController=new AbortController,a.signal=this.abortController.signal);const l=u=>this.emit("loading",u);n=yield Zw.fetchBlob(e,l,a);const c=this.options.blobMimeType;c&&(n=new Blob([n],{type:c}))}this.setSrc(e,n);const o=yield new Promise((a=>{const l=r||this.getDuration();l?a(l):this.mediaSubscriptions.push(this.onMediaEvent("loadedmetadata",(()=>a(this.getDuration())),{once:!0}))}));if(!e&&!n){const a=this.getMediaElement();a instanceof bi&&(a.duration=o)}if(s)this.decodedData=cr.createBuffer(s,o||0);else if(n){const a=yield n.arrayBuffer();this.decodedData=yield cr.decode(a,this.options.sampleRate)}this.decodedData&&(this.emit("decode",this.getDuration()),this.renderer.render(this.decodedData)),this.emit("ready",this.getDuration())}))}load(e,n,s){return Le(this,void 0,void 0,(function*(){try{return yield this.loadAudio(e,void 0,n,s)}catch(r){throw this.emit("error",r),r}}))}loadBlob(e,n,s){return Le(this,void 0,void 0,(function*(){try{return yield this.loadAudio("",e,n,s)}catch(r){throw this.emit("error",r),r}}))}zoom(e){if(!this.decodedData)throw new Error("No audio loaded");this.renderer.zoom(e),this.emit("zoom",e)}getDecodedData(){return this.decodedData}exportPeaks({channels:e=2,maxLength:n=8e3,precision:s=1e4}={}){if(!this.decodedData)throw new Error("The audio has not been decoded yet");const r=Math.min(e,this.decodedData.numberOfChannels),i=[];for(let o=0;o<r;o++){const a=this.decodedData.getChannelData(o),l=[],c=a.length/n;for(let u=0;u<n;u++){const f=a.slice(Math.floor(u*c),Math.ceil((u+1)*c));let h=0;for(let p=0;p<f.length;p++){const y=f[p];Math.abs(y)>Math.abs(h)&&(h=y)}l.push(Math.round(h*s)/s)}i.push(l)}return i}getDuration(){let e=super.getDuration()||0;return e!==0&&e!==1/0||!this.decodedData||(e=this.decodedData.duration),e}toggleInteraction(e){this.options.interact=e}setTime(e){this.stopAtPosition=null,super.setTime(e),this.updateProgress(e),this.emit("timeupdate",e)}seekTo(e){const n=this.getDuration()*e;this.setTime(n)}play(e,n){const s=Object.create(null,{play:{get:()=>super.play}});return Le(this,void 0,void 0,(function*(){e!=null&&this.setTime(e);const r=yield s.play.call(this);return n!=null&&(this.media instanceof bi?this.media.stopAt(n):this.stopAtPosition=n),r}))}playPause(){return Le(this,void 0,void 0,(function*(){return this.isPlaying()?this.pause():this.play()}))}stop(){this.pause(),this.setTime(0)}skip(e){this.setTime(this.getCurrentTime()+e)}empty(){this.load("",[[0]],.001)}setMediaElement(e){this.unsubscribePlayerEvents(),super.setMediaElement(e),this.initPlayerEvents()}exportImage(){return Le(this,arguments,void 0,(function*(e="image/png",n=1,s="dataURL"){return this.renderer.exportImage(e,n,s)}))}destroy(){var e;this.emit("destroy"),(e=this.abortController)===null||e===void 0||e.abort(),this.plugins.forEach((n=>n.destroy())),this.subscriptions.forEach((n=>n())),this.unsubscribePlayerEvents(),this.timer.destroy(),this.renderer.destroy(),super.destroy()}}js.BasePlugin=class extends Fs{constructor(t){super(),this.subscriptions=[],this.isDestroyed=!1,this.options=t}onInit(){}_init(t){this.isDestroyed&&(this.subscriptions=[],this.isDestroyed=!1),this.wavesurfer=t,this.onInit()}destroy(){this.emit("destroy"),this.subscriptions.forEach((t=>t())),this.subscriptions=[],this.isDestroyed=!0,this.wavesurfer=void 0}},js.dom=Uw;const Yw=[{id:"track3",name:"Audio",type:"audio",audioUrl:"./sample.mp3"},{id:"track1",name:"Position X",type:"animation",keyframes:[{id:"kf1",time:0,value:0},{id:"kf2",time:2,value:100}]},{id:"track2",name:"Opacity",type:"animation",keyframes:[{id:"kf3",time:1,value:0},{id:"kf4",time:3,value:1}]}],mt=100,al=64,ll=24,Gw=20,Kw=400,Hw=()=>{const t=$.c(96),[e,n]=F.useState(Yw),[s,r]=F.useState(0),[i,o]=F.useState(100),[a,l]=F.useState(5),[c,u]=F.useState(!1),[f,h]=F.useState(!1),[p,y]=F.useState(!0),g=F.useRef(null),w=F.useRef(null),m=F.useRef(null),S=F.useRef(null);let x;t[0]!==a||t[1]!==p?(x=(H,ce)=>{o(K=>{const de=K,Ge=Math.max(Gw,Math.min(Kw,K*H));if(!m.current)return Ge;const me=m.current;if(p&&ce!==void 0){const Vo=me.getBoundingClientRect(),fs=ce-Vo.left-mt,oi=a*de,Wo=Math.max(0,Math.min(fs,oi));let ai=(me.scrollLeft+Wo)/de*Ge-Wo;const zu=Math.max(0,a*Ge-me.clientWidth);ai=Math.max(0,Math.min(ai,zu)),me.scrollLeft=ai}else{let fs=(me.scrollLeft+me.clientWidth/2-mt)/de*Ge-me.clientWidth/2+mt;const oi=Math.max(0,a*Ge-me.clientWidth);fs=Math.max(0,Math.min(fs,oi)),me.scrollLeft=fs}return Ge})},t[0]=a,t[1]=p,t[2]=x):x=t[2];const _=x;let E;t[3]!==a||t[4]!==i?(E=H=>{if(!S.current)return;const ce=S.current.getBoundingClientRect();let K=H-ce.left-mt;K=Math.max(0,K);let de=K/i;de=Math.max(0,Math.min(a,de)),r(de),w.current?.seekTo(de/a)},t[3]=a,t[4]=i,t[5]=E):E=t[5];const k=E;let b,v;t[6]!==e?(b=()=>{const H=e.find(Xw);if(!H?.audioUrl||!g.current)return;const ce=getComputedStyle(document.documentElement).getPropertyValue("--waveform-color").trim()||"#888",K=getComputedStyle(document.documentElement).getPropertyValue("--waveform-progress-color").trim()||"#f0f";return w.current=js.create({container:g.current,waveColor:ce,progressColor:K,height:55,barWidth:2,cursorColor:"transparent"}),w.current.load(H.audioUrl),w.current.on("ready",()=>l(w.current.getDuration())),w.current.on("interaction",()=>r(w.current.getCurrentTime())),w.current.on("audioprocess",()=>r(w.current.getCurrentTime())),()=>{w.current?.destroy(),w.current=null}},v=[e],t[6]=e,t[7]=b,t[8]=v):(b=t[7],v=t[8]),F.useEffect(b,v);let T,A;t[9]!==s||t[10]!==f||t[11]!==i?(T=()=>{if(!f)return;const H=m.current;if(!H)return;const ce=mt+s*i,K=H.scrollLeft+mt,de=K+H.clientWidth-mt;(ce<K||ce>de)&&(H.scrollLeft=ce-H.clientWidth/2)},A=[s,i,f],t[9]=s,t[10]=f,t[11]=i,t[12]=T,t[13]=A):(T=t[12],A=t[13]),F.useEffect(T,A);let O;t[14]===Symbol.for("react.memo_cache_sentinel")?(O=(H,ce,K)=>{n(de=>de.map(Ge=>Ge.id===H?{...Ge,keyframes:Ge.keyframes?.map(me=>me.id===ce?{...me,time:K}:me)}:Ge))},t[14]=O):O=t[14];const N=O;let M;t[15]===Symbol.for("react.memo_cache_sentinel")?(M=()=>{w.current&&w.current.play()},t[15]=M):M=t[15];const R=M;let j;t[16]===Symbol.for("react.memo_cache_sentinel")?(j=()=>{w.current?.pause()},t[16]=j):j=t[16];const P=j;let L,U;t[17]===Symbol.for("react.memo_cache_sentinel")?(U=()=>{if(!w.current)return;const H=()=>h(!0),ce=()=>h(!1),K=()=>h(!1);return w.current.on("play",H),w.current.on("pause",ce),w.current.on("finish",K),()=>{w.current?.un("play",H),w.current?.un("pause",ce),w.current?.un("finish",K)}},L=[],t[17]=L,t[18]=U):(L=t[17],U=t[18]),F.useEffect(U,L);let z;t[19]===Symbol.for("react.memo_cache_sentinel")?(z=H=>{u(!0),H.preventDefault()},t[19]=z):z=t[19];const ne=z;let G;t[20]!==a||t[21]!==c||t[22]!==i?(G=H=>{if(!c||!S.current)return;const ce=S.current.getBoundingClientRect();let K=H.clientX-ce.left-mt;K=Math.max(0,K);let de=K/i;de=Math.max(0,Math.min(a,de)),r(de),w.current?.seekTo(de/a)},t[20]=a,t[21]=c,t[22]=i,t[23]=G):G=t[23];const ee=G;let Y,Q;t[24]!==c||t[25]!==ee?(Y=()=>(c&&(window.addEventListener("mousemove",ee),window.addEventListener("mouseup",()=>u(!1))),()=>{window.removeEventListener("mousemove",ee),window.removeEventListener("mouseup",()=>u(!1))}),Q=[c,ee],t[24]=c,t[25]=ee,t[26]=Y,t[27]=Q):(Y=t[26],Q=t[27]),F.useEffect(Y,Q);let J,he;t[28]!==_?(J=()=>{const H=m.current;if(!H)return;const ce=K=>{if(K.altKey){K.preventDefault();const de=K.deltaY<0?1.1:.9090909090909091;_(de,K.clientX);return}if(K.ctrlKey||K.metaKey){K.preventDefault(),H.scrollTop=H.scrollTop+K.deltaY;return}K.preventDefault(),H.scrollLeft=H.scrollLeft+K.deltaY};return H.addEventListener("wheel",ce,{passive:!1}),()=>H.removeEventListener("wheel",ce)},he=[_],t[28]=_,t[29]=J,t[30]=he):(J=t[29],he=t[30]),F.useEffect(J,he);let Ie;t[31]!==a||t[32]!==k||t[33]!==i?(Ie=()=>{const H=a*i,ce=Math.floor(H/40);let K=a/ce;K=[.05,.1,.25,.5,1,2,5,10,20,50,100].find(me=>me>=K)||K;const Ge=[];for(let me=0;me<=a;me=me+K,me)Ge.push(d.jsx("div",{className:"absolute top-0 h-5 border-l border-border text-xs text-muted-foreground",style:{left:`${me*i}px`},children:d.jsxs("span",{className:"absolute left-1 top-0",children:[me.toFixed(K<1?2:1),"s"]})},me));return d.jsx("div",{className:"relative h-5 w-full cursor-pointer",onClick:me=>k(me.clientX),children:Ge})},t[31]=a,t[32]=k,t[33]=i,t[34]=Ie):Ie=t[34];const Be=Ie,Ue=f?P:R;let Me;t[35]!==f?(Me=f?d.jsxs(d.Fragment,{children:[d.jsx(of,{}),"Pause"]}):d.jsxs(d.Fragment,{children:[d.jsx(af,{}),"Play"]}),t[35]=f,t[36]=Me):Me=t[36];let Ae;t[37]!==Ue||t[38]!==Me?(Ae=d.jsx(nt,{onClick:Ue,children:Me}),t[37]=Ue,t[38]=Me,t[39]=Ae):Ae=t[39];let ze;t[40]!==_?(ze=()=>_(1.2),t[40]=_,t[41]=ze):ze=t[41];let Fe;t[42]===Symbol.for("react.memo_cache_sentinel")?(Fe=d.jsx(lf,{}),t[42]=Fe):Fe=t[42];let $e;t[43]!==ze?($e=d.jsxs(nt,{onClick:ze,children:[Fe," Zoom In"]}),t[43]=ze,t[44]=$e):$e=t[44];let He;t[45]!==_?(He=()=>_(.8333333333333334),t[45]=_,t[46]=He):He=t[46];let Ft;t[47]===Symbol.for("react.memo_cache_sentinel")?(Ft=d.jsx(cf,{}),t[47]=Ft):Ft=t[47];let ut;t[48]!==He?(ut=d.jsxs(nt,{onClick:He,children:[Ft," Zoom Out"]}),t[48]=He,t[49]=ut):ut=t[49];let jt;t[50]===Symbol.for("react.memo_cache_sentinel")?(jt=H=>y(H.target.checked),t[50]=jt):jt=t[50];let Xe;t[51]!==p?(Xe=d.jsx("input",{type:"checkbox",checked:p,onChange:jt,className:"mr-1 accent-primary"}),t[51]=p,t[52]=Xe):Xe=t[52];let Rt;t[53]===Symbol.for("react.memo_cache_sentinel")?(Rt=d.jsx("kbd",{children:"Alt"}),t[53]=Rt):Rt=t[53];let ft;t[54]===Symbol.for("react.memo_cache_sentinel")?(ft=d.jsxs("span",{children:["[EXPERIMENTAL] Zoom to mouse ",Rt,"+",d.jsx("kbd",{children:"Wheel"})]}),t[54]=ft):ft=t[54];let _t;t[55]!==Xe?(_t=d.jsx("div",{className:"flex items-center space-x-2",children:d.jsxs("label",{className:"flex items-center text-xs select-none cursor-pointer",children:[Xe,ft]})}),t[55]=Xe,t[56]=_t):_t=t[56];const Bt=s*1e3;let ht;t[57]!==Bt?(ht=il(Bt,"mm:ss.SS"),t[57]=Bt,t[58]=ht):ht=t[58];const Et=a*1e3;let dt;t[59]!==Et?(dt=il(Et,"mm:ss.SS"),t[59]=Et,t[60]=dt):dt=t[60];let Qe;t[61]!==ht||t[62]!==dt?(Qe=d.jsx("div",{className:"flex-1 flex items-center justify-center",children:d.jsxs("p",{className:"text-sm text-muted-foreground",children:[ht," /"," ",dt]})}),t[61]=ht,t[62]=dt,t[63]=Qe):Qe=t[63];let Je;t[64]!==Ae||t[65]!==$e||t[66]!==ut||t[67]!==_t||t[68]!==Qe?(Je=d.jsxs("div",{className:"flex space-x-2 m-2",children:[Ae,$e,ut,_t,Qe]}),t[64]=Ae,t[65]=$e,t[66]=ut,t[67]=_t,t[68]=Qe,t[69]=Je):Je=t[69];const St=`minmax(${mt}px, 1fr) ${a*i}px`,Ut=`${ll}px repeat(${e.length}, ${al}px)`,et=`${mt+a*i}px`;let je;t[70]!==St||t[71]!==Ut||t[72]!==et?(je={gridTemplateColumns:St,gridTemplateRows:Ut,minWidth:et},t[70]=St,t[71]=Ut,t[72]=et,t[73]=je):je=t[73];let fn;t[74]===Symbol.for("react.memo_cache_sentinel")?(fn=d.jsx("div",{className:"h-6 sticky left-0 bg-card z-20",style:{gridColumn:"1 / 2",gridRow:"1"}}),t[74]=fn):fn=t[74];let Mn;t[75]===Symbol.for("react.memo_cache_sentinel")?(Mn={gridColumn:"2 / 3",gridRow:"1"},t[75]=Mn):Mn=t[75];let kt;t[76]!==Be?(kt=d.jsx("div",{className:"relative border-b border-border bg-card-foreground/10",style:Mn,children:Be()}),t[76]=Be,t[77]=kt):kt=t[77];let Zt;if(t[78]!==k||t[79]!==e||t[80]!==i){let H;t[82]!==k||t[83]!==i?(H=(ce,K)=>d.jsxs(qu.Fragment,{children:[d.jsx("div",{className:"flex items-center h-16 px-2 border-b border-border text-xs text-muted-foreground sticky left-0 bg-card z-20",style:{gridColumn:"1 / 2",gridRow:`${K+2}`},children:ce.name}),d.jsx("div",{className:"relative h-16 border-b border-border flex items-center justify-center cursor-pointer",style:{gridColumn:"2 / 3",gridRow:`${K+2}`},onClick:de=>k(de.clientX),children:ce.type==="audio"?d.jsx("div",{ref:g,className:"absolute left-0 w-full",style:{top:"50%",transform:"translateY(-50%)",height:"55px",pointerEvents:"none"}}):ce.keyframes?.map(de=>d.jsx("div",{style:{position:"absolute",left:`${de.time*i}px`,top:"50%",transform:"translateY(-50%)"},children:d.jsx(Pb,{keyframe:de,trackId:ce.id,zoom:i,onUpdate:N})},de.id))})]},ce.id),t[82]=k,t[83]=i,t[84]=H):H=t[84],Zt=[...e].sort(Qw).map(H),t[78]=k,t[79]=e,t[80]=i,t[81]=Zt}else Zt=t[81];const hn=`${mt+s*i}px`,us=`${e.length*al}px`;let jn;t[85]!==hn||t[86]!==us?(jn=d.jsx("div",{className:"absolute w-[2px] bg-primary cursor-ew-resize z-10 hover:bg-primary/80",style:{left:hn,top:`${ll}px`,height:us},onMouseDown:ne}),t[85]=hn,t[86]=us,t[87]=jn):jn=t[87];let Rn;t[88]!==je||t[89]!==kt||t[90]!==Zt||t[91]!==jn?(Rn=d.jsx("div",{className:"w-full flex-1 overflow-x-auto relative",ref:m,children:d.jsxs("div",{ref:S,className:"grid w-full relative",style:je,children:[fn,kt,Zt,jn]})}),t[88]=je,t[89]=kt,t[90]=Zt,t[91]=jn,t[92]=Rn):Rn=t[92];let Ws;return t[93]!==Je||t[94]!==Rn?(Ws=d.jsxs("div",{className:"flex flex-col w-full h-full space-y-2 bg-card",children:[Je,Rn]}),t[93]=Je,t[94]=Rn,t[95]=Ws):Ws=t[95],Ws};function Xw(t){return t.type==="audio"}function Qw(t,e){return t.type==="audio"?-1:e.type==="audio"?1:0}function Jw(){const t=$.c(15),e=$s(),n=ct();let s,r;t[0]!==e.theme?(s=()=>{const y=window.document.documentElement;y.classList.remove("light","dark"),y.classList.add(e.theme)},r=[e.theme],t[0]=e.theme,t[1]=s,t[2]=r):(s=t[1],r=t[2]),F.useEffect(s,r);let i,o;t[3]!==n?(i=()=>{const y=g=>{n.saved||!n.cart||(g.preventDefault(),g.returnValue="")};return window.addEventListener("beforeunload",y),()=>{window.removeEventListener("beforeunload",y)}},o=[n],t[3]=n,t[4]=i,t[5]=o):(i=t[4],o=t[5]),F.useEffect(i,o);let a,l;t[6]!==e.saveInterval||t[7]!==n?(a=()=>{const y=setInterval(()=>{!n.saved&&n.cart&&n.saveProject().catch(ev)},e.saveInterval*1e3);return()=>{clearInterval(y)}},l=[n,e.saveInterval],t[6]=e.saveInterval,t[7]=n,t[8]=a,t[9]=l):(a=t[8],l=t[9]),F.useEffect(a,l);let c,u;t[10]===Symbol.for("react.memo_cache_sentinel")?(c=d.jsxs(Ys,{minSize:5,defaultSize:25,className:"bg-card flex flex-col gap-4",children:[d.jsx($y,{}),d.jsx(cb,{})]}),u=d.jsx(Ho,{}),t[10]=c,t[11]=u):(c=t[10],u=t[11]);let f,h;t[12]===Symbol.for("react.memo_cache_sentinel")?(f=d.jsx(Ys,{minSize:5,defaultSize:80,children:d.jsxs(Ko,{direction:"horizontal",autoSaveId:"tca-preview",autoSave:"true",children:[c,u,d.jsx(Ys,{minSize:5,defaultSize:75,children:d.jsx(Rb,{})})]})}),h=d.jsx(Ho,{}),t[12]=f,t[13]=h):(f=t[12],h=t[13]);let p;return t[14]===Symbol.for("react.memo_cache_sentinel")?(p=d.jsx("div",{className:"h-screen w-screen",children:d.jsxs(Ko,{direction:"vertical",autoSaveId:"tca-project",autoSave:"true",children:[f,h,d.jsx(Ys,{minSize:5,defaultSize:20,children:d.jsx(Hw,{})})]})}),t[14]=p):p=t[14],p}function ev(t){console.error("Auto-save failed:",t)}function Eo(t){const e=$.c(4);let n;e[0]!==t?({...n}=t,e[0]=t,e[1]=n):n=e[1];let s;return e[2]!==n?(s=d.jsx(fh,{"data-slot":"alert-dialog",...n}),e[2]=n,e[3]=s):s=e[3],s}function tv(t){const e=$.c(4);let n;e[0]!==t?({...n}=t,e[0]=t,e[1]=n):n=e[1];let s;return e[2]!==n?(s=d.jsx(hh,{"data-slot":"alert-dialog-portal",...n}),e[2]=n,e[3]=s):s=e[3],s}function nv(t){const e=$.c(8);let n,s;e[0]!==t?({className:n,...s}=t,e[0]=t,e[1]=n,e[2]=s):(n=e[1],s=e[2]);let r;e[3]!==n?(r=V("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50 backdrop-blur",n),e[3]=n,e[4]=r):r=e[4];let i;return e[5]!==s||e[6]!==r?(i=d.jsx(dh,{"data-slot":"alert-dialog-overlay",className:r,...s}),e[5]=s,e[6]=r,e[7]=i):i=e[7],i}function So(t){const e=$.c(9);let n,s;e[0]!==t?({className:n,...s}=t,e[0]=t,e[1]=n,e[2]=s):(n=e[1],s=e[2]);let r;e[3]===Symbol.for("react.memo_cache_sentinel")?(r=d.jsx(nv,{}),e[3]=r):r=e[3];let i;e[4]!==n?(i=V("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",n),e[4]=n,e[5]=i):i=e[5];let o;return e[6]!==s||e[7]!==i?(o=d.jsxs(tv,{children:[r,d.jsx(uh,{"data-slot":"alert-dialog-content",className:i,...s})]}),e[6]=s,e[7]=i,e[8]=o):o=e[8],o}function ko(t){const e=$.c(8);let n,s;e[0]!==t?({className:n,...s}=t,e[0]=t,e[1]=n,e[2]=s):(n=e[1],s=e[2]);let r;e[3]!==n?(r=V("flex flex-col gap-2 text-center sm:text-left",n),e[3]=n,e[4]=r):r=e[4];let i;return e[5]!==s||e[6]!==r?(i=d.jsx("div",{"data-slot":"alert-dialog-header",className:r,...s}),e[5]=s,e[6]=r,e[7]=i):i=e[7],i}function To(t){const e=$.c(8);let n,s;e[0]!==t?({className:n,...s}=t,e[0]=t,e[1]=n,e[2]=s):(n=e[1],s=e[2]);let r;e[3]!==n?(r=V("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",n),e[3]=n,e[4]=r):r=e[4];let i;return e[5]!==s||e[6]!==r?(i=d.jsx("div",{"data-slot":"alert-dialog-footer",className:r,...s}),e[5]=s,e[6]=r,e[7]=i):i=e[7],i}function Ao(t){const e=$.c(8);let n,s;e[0]!==t?({className:n,...s}=t,e[0]=t,e[1]=n,e[2]=s):(n=e[1],s=e[2]);let r;e[3]!==n?(r=V("text-lg font-semibold",n),e[3]=n,e[4]=r):r=e[4];let i;return e[5]!==s||e[6]!==r?(i=d.jsx(lh,{"data-slot":"alert-dialog-title",className:r,...s}),e[5]=s,e[6]=r,e[7]=i):i=e[7],i}function No(t){const e=$.c(8);let n,s;e[0]!==t?({className:n,...s}=t,e[0]=t,e[1]=n,e[2]=s):(n=e[1],s=e[2]);let r;e[3]!==n?(r=V("text-muted-foreground text-sm",n),e[3]=n,e[4]=r):r=e[4];let i;return e[5]!==s||e[6]!==r?(i=d.jsx(ch,{"data-slot":"alert-dialog-description",className:r,...s}),e[5]=s,e[6]=r,e[7]=i):i=e[7],i}function sv(t){const e=$.c(8);let n,s;e[0]!==t?({className:n,...s}=t,e[0]=t,e[1]=n,e[2]=s):(n=e[1],s=e[2]);let r;e[3]!==n?(r=V(Nl({variant:"outline"}),n),e[3]=n,e[4]=r):r=e[4];let i;return e[5]!==s||e[6]!==r?(i=d.jsx(ah,{className:r,...s}),e[5]=s,e[6]=r,e[7]=i):i=e[7],i}function rv(){const t=[],e=document.createElement("canvas");return!!(e.getContext("webgl")||e.getContext("experimental-webgl"))||t.push("WebGL / 3D Graphics"),"AudioContext"in window||"webkitAudioContext"in window||t.push("Web Audio API (AudioContext)"),"requestAnimationFrame"in window||t.push("Animation Frame API (requestAnimationFrame)"),t}const iv=()=>{const t=$.c(22);let e;t[0]===Symbol.for("react.memo_cache_sentinel")?(e=[],t[0]=e):e=t[0];const[n,s]=F.useState(e),[r,i]=F.useState(!1);let o,a;if(t[1]===Symbol.for("react.memo_cache_sentinel")?(o=()=>{const x=rv();(x.length>0||!Gn)&&(s(x),setTimeout(()=>{i(!0)},10))},a=[],t[1]=o,t[2]=a):(o=t[1],a=t[2]),F.useEffect(o,a),!r)return null;let l;t[3]===Symbol.for("react.memo_cache_sentinel")?(l=d.jsx(Ao,{children:"Missing Browser Capabilities"}),t[3]=l):l=t[3];let c;t[4]!==n?(c=n.map(ov),t[4]=n,t[5]=c):c=t[5];let u;t[6]===Symbol.for("react.memo_cache_sentinel")?(u=!Gn&&d.jsxs("li",{children:["File System Access API",d.jsx("br",{}),d.jsx("span",{className:"text-xs text-muted-foreground",children:"Used for autosave and loading files directly. Without it, you'll need to manually download and upload your files each time."})]}),t[6]=u):u=t[6];let f;t[7]!==c?(f=d.jsxs("ul",{className:"my-2 list-disc list-inside",children:[c,u]}),t[7]=c,t[8]=f):f=t[8];let h;t[9]===Symbol.for("react.memo_cache_sentinel")?(h=d.jsx("strong",{children:"Chrome"}),t[9]=h):h=t[9];let p;t[10]===Symbol.for("react.memo_cache_sentinel")?(p=d.jsx("strong",{children:"Edge"}),t[10]=p):p=t[10];let y;t[11]===Symbol.for("react.memo_cache_sentinel")?(y=d.jsx("strong",{children:"Brave"}),t[11]=y):y=t[11];let g;t[12]!==f?(g=d.jsxs(ko,{children:[l,d.jsxs(No,{children:["This app requires certain browser features to work correctly. Your current browser is missing the following capabilities:",f,"To use all features, switch to a modern Chromium-based browser like ",h,","," ",p,", or ",y,"."]})]}),t[12]=f,t[13]=g):g=t[13];let w;t[14]!==n.length?(w=!Gn&&n.length===0&&d.jsx(To,{children:d.jsx(sv,{children:"Acknowledge"})}),t[14]=n.length,t[15]=w):w=t[15];let m;t[16]!==g||t[17]!==w?(m=d.jsxs(So,{children:[g,w]}),t[16]=g,t[17]=w,t[18]=m):m=t[18];let S;return t[19]!==r||t[20]!==m?(S=d.jsx(Eo,{open:r,onOpenChange:i,children:m}),t[19]=r,t[20]=m,t[21]=S):S=t[21],S};function ov(t){return d.jsx("li",{children:t},t)}const Oo=Symbol.for("yaml.alias"),eo=Symbol.for("yaml.document"),en=Symbol.for("yaml.map"),tu=Symbol.for("yaml.pair"),Mt=Symbol.for("yaml.scalar"),os=Symbol.for("yaml.seq"),at=Symbol.for("yaml.node.type"),In=t=>!!t&&typeof t=="object"&&t[at]===Oo,Hr=t=>!!t&&typeof t=="object"&&t[at]===eo,Bs=t=>!!t&&typeof t=="object"&&t[at]===en,Te=t=>!!t&&typeof t=="object"&&t[at]===tu,pe=t=>!!t&&typeof t=="object"&&t[at]===Mt,Us=t=>!!t&&typeof t=="object"&&t[at]===os;function Se(t){if(t&&typeof t=="object")switch(t[at]){case en:case os:return!0}return!1}function ke(t){if(t&&typeof t=="object")switch(t[at]){case Oo:case en:case Mt:case os:return!0}return!1}const nu=t=>(pe(t)||Se(t))&&!!t.anchor,mn=Symbol("break visit"),av=Symbol("skip children"),_s=Symbol("remove node");function as(t,e){const n=lv(e);Hr(t)?Zn(null,t.contents,n,Object.freeze([t]))===_s&&(t.contents=null):Zn(null,t,n,Object.freeze([]))}as.BREAK=mn;as.SKIP=av;as.REMOVE=_s;function Zn(t,e,n,s){const r=cv(t,e,n,s);if(ke(r)||Te(r))return uv(t,s,r),Zn(t,r,n,s);if(typeof r!="symbol"){if(Se(e)){s=Object.freeze(s.concat(e));for(let i=0;i<e.items.length;++i){const o=Zn(i,e.items[i],n,s);if(typeof o=="number")i=o-1;else{if(o===mn)return mn;o===_s&&(e.items.splice(i,1),i-=1)}}}else if(Te(e)){s=Object.freeze(s.concat(e));const i=Zn("key",e.key,n,s);if(i===mn)return mn;i===_s&&(e.key=null);const o=Zn("value",e.value,n,s);if(o===mn)return mn;o===_s&&(e.value=null)}}return r}function lv(t){return typeof t=="object"&&(t.Collection||t.Node||t.Value)?Object.assign({Alias:t.Node,Map:t.Node,Scalar:t.Node,Seq:t.Node},t.Value&&{Map:t.Value,Scalar:t.Value,Seq:t.Value},t.Collection&&{Map:t.Collection,Seq:t.Collection},t):t}function cv(t,e,n,s){if(typeof n=="function")return n(t,e,s);if(Bs(e))return n.Map?.(t,e,s);if(Us(e))return n.Seq?.(t,e,s);if(Te(e))return n.Pair?.(t,e,s);if(pe(e))return n.Scalar?.(t,e,s);if(In(e))return n.Alias?.(t,e,s)}function uv(t,e,n){const s=e[e.length-1];if(Se(s))s.items[t]=n;else if(Te(s))t==="key"?s.key=n:s.value=n;else if(Hr(s))s.contents=n;else{const r=In(s)?"alias":"scalar";throw new Error(`Cannot replace node with ${r} parent`)}}const fv={"!":"%21",",":"%2C","[":"%5B","]":"%5D","{":"%7B","}":"%7D"},hv=t=>t.replace(/[!,[\]{}]/g,e=>fv[e]);class Ve{constructor(e,n){this.docStart=null,this.docEnd=!1,this.yaml=Object.assign({},Ve.defaultYaml,e),this.tags=Object.assign({},Ve.defaultTags,n)}clone(){const e=new Ve(this.yaml,this.tags);return e.docStart=this.docStart,e}atDocument(){const e=new Ve(this.yaml,this.tags);switch(this.yaml.version){case"1.1":this.atNextDocument=!0;break;case"1.2":this.atNextDocument=!1,this.yaml={explicit:Ve.defaultYaml.explicit,version:"1.2"},this.tags=Object.assign({},Ve.defaultTags);break}return e}add(e,n){this.atNextDocument&&(this.yaml={explicit:Ve.defaultYaml.explicit,version:"1.1"},this.tags=Object.assign({},Ve.defaultTags),this.atNextDocument=!1);const s=e.trim().split(/[ \t]+/),r=s.shift();switch(r){case"%TAG":{if(s.length!==2&&(n(0,"%TAG directive should contain exactly two parts"),s.length<2))return!1;const[i,o]=s;return this.tags[i]=o,!0}case"%YAML":{if(this.yaml.explicit=!0,s.length!==1)return n(0,"%YAML directive should contain exactly one part"),!1;const[i]=s;if(i==="1.1"||i==="1.2")return this.yaml.version=i,!0;{const o=/^\d+\.\d+$/.test(i);return n(6,`Unsupported YAML version ${i}`,o),!1}}default:return n(0,`Unknown directive ${r}`,!0),!1}}tagName(e,n){if(e==="!")return"!";if(e[0]!=="!")return n(`Not a valid tag: ${e}`),null;if(e[1]==="<"){const o=e.slice(2,-1);return o==="!"||o==="!!"?(n(`Verbatim tags aren't resolved, so ${e} is invalid.`),null):(e[e.length-1]!==">"&&n("Verbatim tags must end with a >"),o)}const[,s,r]=e.match(/^(.*!)([^!]*)$/s);r||n(`The ${e} tag has no suffix`);const i=this.tags[s];if(i)try{return i+decodeURIComponent(r)}catch(o){return n(String(o)),null}return s==="!"?e:(n(`Could not resolve tag: ${e}`),null)}tagString(e){for(const[n,s]of Object.entries(this.tags))if(e.startsWith(s))return n+hv(e.substring(s.length));return e[0]==="!"?e:`!<${e}>`}toString(e){const n=this.yaml.explicit?[`%YAML ${this.yaml.version||"1.2"}`]:[],s=Object.entries(this.tags);let r;if(e&&s.length>0&&ke(e.contents)){const i={};as(e.contents,(o,a)=>{ke(a)&&a.tag&&(i[a.tag]=!0)}),r=Object.keys(i)}else r=[];for(const[i,o]of s)i==="!!"&&o==="tag:yaml.org,2002:"||(!e||r.some(a=>a.startsWith(o)))&&n.push(`%TAG ${i} ${o}`);return n.join(`
`)}}Ve.defaultYaml={explicit:!1,version:"1.2"};Ve.defaultTags={"!!":"tag:yaml.org,2002:"};function su(t){if(/[\x00-\x19\s,[\]{}]/.test(t)){const n=`Anchor must not contain whitespace or control characters: ${JSON.stringify(t)}`;throw new Error(n)}return!0}function ru(t){const e=new Set;return as(t,{Value(n,s){s.anchor&&e.add(s.anchor)}}),e}function iu(t,e){for(let n=1;;++n){const s=`${t}${n}`;if(!e.has(s))return s}}function dv(t,e){const n=[],s=new Map;let r=null;return{onAnchor:i=>{n.push(i),r??(r=ru(t));const o=iu(e,r);return r.add(o),o},setAnchors:()=>{for(const i of n){const o=s.get(i);if(typeof o=="object"&&o.anchor&&(pe(o.node)||Se(o.node)))o.node.anchor=o.anchor;else{const a=new Error("Failed to resolve repeated object (this should not happen)");throw a.source=i,a}}},sourceObjects:s}}function Vn(t,e,n,s){if(s&&typeof s=="object")if(Array.isArray(s))for(let r=0,i=s.length;r<i;++r){const o=s[r],a=Vn(t,s,String(r),o);a===void 0?delete s[r]:a!==o&&(s[r]=a)}else if(s instanceof Map)for(const r of Array.from(s.keys())){const i=s.get(r),o=Vn(t,s,r,i);o===void 0?s.delete(r):o!==i&&s.set(r,o)}else if(s instanceof Set)for(const r of Array.from(s)){const i=Vn(t,s,r,r);i===void 0?s.delete(r):i!==r&&(s.delete(r),s.add(i))}else for(const[r,i]of Object.entries(s)){const o=Vn(t,s,r,i);o===void 0?delete s[r]:o!==i&&(s[r]=o)}return t.call(e,n,s)}function ot(t,e,n){if(Array.isArray(t))return t.map((s,r)=>ot(s,String(r),n));if(t&&typeof t.toJSON=="function"){if(!n||!nu(t))return t.toJSON(e,n);const s={aliasCount:0,count:1,res:void 0};n.anchors.set(t,s),n.onCreate=i=>{s.res=i,delete n.onCreate};const r=t.toJSON(e,n);return n.onCreate&&n.onCreate(r),r}return typeof t=="bigint"&&!n?.keep?Number(t):t}class Co{constructor(e){Object.defineProperty(this,at,{value:e})}clone(){const e=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return this.range&&(e.range=this.range.slice()),e}toJS(e,{mapAsMap:n,maxAliasCount:s,onAnchor:r,reviver:i}={}){if(!Hr(e))throw new TypeError("A document argument is required");const o={anchors:new Map,doc:e,keep:!0,mapAsMap:n===!0,mapKeyWarned:!1,maxAliasCount:typeof s=="number"?s:100},a=ot(this,"",o);if(typeof r=="function")for(const{count:l,res:c}of o.anchors.values())r(c,l);return typeof i=="function"?Vn(i,{"":a},"",a):a}}class Io extends Co{constructor(e){super(Oo),this.source=e,Object.defineProperty(this,"tag",{set(){throw new Error("Alias nodes cannot have tags")}})}resolve(e,n){let s;n?.aliasResolveCache?s=n.aliasResolveCache:(s=[],as(e,{Node:(i,o)=>{(In(o)||nu(o))&&s.push(o)}}),n&&(n.aliasResolveCache=s));let r;for(const i of s){if(i===this)break;i.anchor===this.source&&(r=i)}return r}toJSON(e,n){if(!n)return{source:this.source};const{anchors:s,doc:r,maxAliasCount:i}=n,o=this.resolve(r,n);if(!o){const l=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new ReferenceError(l)}let a=s.get(o);if(a||(ot(o,null,n),a=s.get(o)),!a||a.res===void 0){const l="This should not happen: Alias anchor was not resolved?";throw new ReferenceError(l)}if(i>=0&&(a.count+=1,a.aliasCount===0&&(a.aliasCount=_r(r,o,s)),a.count*a.aliasCount>i)){const l="Excessive alias count indicates a resource exhaustion attack";throw new ReferenceError(l)}return a.res}toString(e,n,s){const r=`*${this.source}`;if(e){if(su(this.source),e.options.verifyAliasOrder&&!e.anchors.has(this.source)){const i=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new Error(i)}if(e.implicitKey)return`${r} `}return r}}function _r(t,e,n){if(In(e)){const s=e.resolve(t),r=n&&s&&n.get(s);return r?r.count*r.aliasCount:0}else if(Se(e)){let s=0;for(const r of e.items){const i=_r(t,r,n);i>s&&(s=i)}return s}else if(Te(e)){const s=_r(t,e.key,n),r=_r(t,e.value,n);return Math.max(s,r)}return 1}const ou=t=>!t||typeof t!="function"&&typeof t!="object";class q extends Co{constructor(e){super(Mt),this.value=e}toJSON(e,n){return n?.keep?this.value:ot(this.value,e,n)}toString(){return String(this.value)}}q.BLOCK_FOLDED="BLOCK_FOLDED";q.BLOCK_LITERAL="BLOCK_LITERAL";q.PLAIN="PLAIN";q.QUOTE_DOUBLE="QUOTE_DOUBLE";q.QUOTE_SINGLE="QUOTE_SINGLE";const pv="tag:yaml.org,2002:";function mv(t,e,n){if(e){const s=n.filter(i=>i.tag===e),r=s.find(i=>!i.format)??s[0];if(!r)throw new Error(`Tag ${e} not found`);return r}return n.find(s=>s.identify?.(t)&&!s.format)}function Rs(t,e,n){if(Hr(t)&&(t=t.contents),ke(t))return t;if(Te(t)){const f=n.schema[en].createNode?.(n.schema,null,n);return f.items.push(t),f}(t instanceof String||t instanceof Number||t instanceof Boolean||typeof BigInt<"u"&&t instanceof BigInt)&&(t=t.valueOf());const{aliasDuplicateObjects:s,onAnchor:r,onTagObj:i,schema:o,sourceObjects:a}=n;let l;if(s&&t&&typeof t=="object"){if(l=a.get(t),l)return l.anchor??(l.anchor=r(t)),new Io(l.anchor);l={anchor:null,node:null},a.set(t,l)}e?.startsWith("!!")&&(e=pv+e.slice(2));let c=mv(t,e,o.tags);if(!c){if(t&&typeof t.toJSON=="function"&&(t=t.toJSON()),!t||typeof t!="object"){const f=new q(t);return l&&(l.node=f),f}c=t instanceof Map?o[en]:Symbol.iterator in Object(t)?o[os]:o[en]}i&&(i(c),delete n.onTagObj);const u=c?.createNode?c.createNode(n.schema,t,n):typeof c?.nodeClass?.from=="function"?c.nodeClass.from(n.schema,t,n):new q(t);return e?u.tag=e:c.default||(u.tag=c.tag),l&&(l.node=u),u}function Dr(t,e,n){let s=n;for(let r=e.length-1;r>=0;--r){const i=e[r];if(typeof i=="number"&&Number.isInteger(i)&&i>=0){const o=[];o[i]=s,s=o}else s=new Map([[i,s]])}return Rs(s,void 0,{aliasDuplicateObjects:!1,keepUndefined:!1,onAnchor:()=>{throw new Error("This should not happen, please report a bug.")},schema:t,sourceObjects:new Map})}const ys=t=>t==null||typeof t=="object"&&!!t[Symbol.iterator]().next().done;class au extends Co{constructor(e,n){super(e),Object.defineProperty(this,"schema",{value:n,configurable:!0,enumerable:!1,writable:!0})}clone(e){const n=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return e&&(n.schema=e),n.items=n.items.map(s=>ke(s)||Te(s)?s.clone(e):s),this.range&&(n.range=this.range.slice()),n}addIn(e,n){if(ys(e))this.add(n);else{const[s,...r]=e,i=this.get(s,!0);if(Se(i))i.addIn(r,n);else if(i===void 0&&this.schema)this.set(s,Dr(this.schema,r,n));else throw new Error(`Expected YAML collection at ${s}. Remaining path: ${r}`)}}deleteIn(e){const[n,...s]=e;if(s.length===0)return this.delete(n);const r=this.get(n,!0);if(Se(r))return r.deleteIn(s);throw new Error(`Expected YAML collection at ${n}. Remaining path: ${s}`)}getIn(e,n){const[s,...r]=e,i=this.get(s,!0);return r.length===0?!n&&pe(i)?i.value:i:Se(i)?i.getIn(r,n):void 0}hasAllNullValues(e){return this.items.every(n=>{if(!Te(n))return!1;const s=n.value;return s==null||e&&pe(s)&&s.value==null&&!s.commentBefore&&!s.comment&&!s.tag})}hasIn(e){const[n,...s]=e;if(s.length===0)return this.has(n);const r=this.get(n,!0);return Se(r)?r.hasIn(s):!1}setIn(e,n){const[s,...r]=e;if(r.length===0)this.set(s,n);else{const i=this.get(s,!0);if(Se(i))i.setIn(r,n);else if(i===void 0&&this.schema)this.set(s,Dr(this.schema,r,n));else throw new Error(`Expected YAML collection at ${s}. Remaining path: ${r}`)}}}const gv=t=>t.replace(/^(?!$)(?: $)?/gm,"#");function $t(t,e){return/^\n+$/.test(t)?t.substring(1):e?t.replace(/^(?! *$)/gm,e):t}const vn=(t,e,n)=>t.endsWith(`
`)?$t(n,e):n.includes(`
`)?`
`+$t(n,e):(t.endsWith(" ")?"":" ")+n,lu="flow",to="block",Er="quoted";function Xr(t,e,n="flow",{indentAtStart:s,lineWidth:r=80,minContentWidth:i=20,onFold:o,onOverflow:a}={}){if(!r||r<0)return t;r<i&&(i=0);const l=Math.max(1+i,1+r-e.length);if(t.length<=l)return t;const c=[],u={};let f=r-e.length;typeof s=="number"&&(s>r-Math.max(2,i)?c.push(0):f=r-s);let h,p,y=!1,g=-1,w=-1,m=-1;n===to&&(g=cl(t,g,e.length),g!==-1&&(f=g+l));for(let x;x=t[g+=1];){if(n===Er&&x==="\\"){switch(w=g,t[g+1]){case"x":g+=3;break;case"u":g+=5;break;case"U":g+=9;break;default:g+=1}m=g}if(x===`
`)n===to&&(g=cl(t,g,e.length)),f=g+e.length+l,h=void 0;else{if(x===" "&&p&&p!==" "&&p!==`
`&&p!=="	"){const _=t[g+1];_&&_!==" "&&_!==`
`&&_!=="	"&&(h=g)}if(g>=f)if(h)c.push(h),f=h+l,h=void 0;else if(n===Er){for(;p===" "||p==="	";)p=x,x=t[g+=1],y=!0;const _=g>m+1?g-2:w-1;if(u[_])return t;c.push(_),u[_]=!0,f=_+l,h=void 0}else y=!0}p=x}if(y&&a&&a(),c.length===0)return t;o&&o();let S=t.slice(0,c[0]);for(let x=0;x<c.length;++x){const _=c[x],E=c[x+1]||t.length;_===0?S=`
${e}${t.slice(0,E)}`:(n===Er&&u[_]&&(S+=`${t[_]}\\`),S+=`
${e}${t.slice(_+1,E)}`)}return S}function cl(t,e,n){let s=e,r=e+1,i=t[r];for(;i===" "||i==="	";)if(e<r+n)i=t[++e];else{do i=t[++e];while(i&&i!==`
`);s=e,r=e+1,i=t[r]}return s}const Qr=(t,e)=>({indentAtStart:e?t.indent.length:t.indentAtStart,lineWidth:t.options.lineWidth,minContentWidth:t.options.minContentWidth}),Jr=t=>/^(%|---|\.\.\.)/m.test(t);function yv(t,e,n){if(!e||e<0)return!1;const s=e-n,r=t.length;if(r<=s)return!1;for(let i=0,o=0;i<r;++i)if(t[i]===`
`){if(i-o>s)return!0;if(o=i+1,r-o<=s)return!1}return!0}function Es(t,e){const n=JSON.stringify(t);if(e.options.doubleQuotedAsJSON)return n;const{implicitKey:s}=e,r=e.options.doubleQuotedMinMultiLineLength,i=e.indent||(Jr(t)?"  ":"");let o="",a=0;for(let l=0,c=n[l];c;c=n[++l])if(c===" "&&n[l+1]==="\\"&&n[l+2]==="n"&&(o+=n.slice(a,l)+"\\ ",l+=1,a=l,c="\\"),c==="\\")switch(n[l+1]){case"u":{o+=n.slice(a,l);const u=n.substr(l+2,4);switch(u){case"0000":o+="\\0";break;case"0007":o+="\\a";break;case"000b":o+="\\v";break;case"001b":o+="\\e";break;case"0085":o+="\\N";break;case"00a0":o+="\\_";break;case"2028":o+="\\L";break;case"2029":o+="\\P";break;default:u.substr(0,2)==="00"?o+="\\x"+u.substr(2):o+=n.substr(l,6)}l+=5,a=l+1}break;case"n":if(s||n[l+2]==='"'||n.length<r)l+=1;else{for(o+=n.slice(a,l)+`

`;n[l+2]==="\\"&&n[l+3]==="n"&&n[l+4]!=='"';)o+=`
`,l+=2;o+=i,n[l+2]===" "&&(o+="\\"),l+=1,a=l+1}break;default:l+=1}return o=a?o+n.slice(a):n,s?o:Xr(o,i,Er,Qr(e,!1))}function no(t,e){if(e.options.singleQuote===!1||e.implicitKey&&t.includes(`
`)||/[ \t]\n|\n[ \t]/.test(t))return Es(t,e);const n=e.indent||(Jr(t)?"  ":""),s="'"+t.replace(/'/g,"''").replace(/\n+/g,`$&
${n}`)+"'";return e.implicitKey?s:Xr(s,n,lu,Qr(e,!1))}function Wn(t,e){const{singleQuote:n}=e.options;let s;if(n===!1)s=Es;else{const r=t.includes('"'),i=t.includes("'");r&&!i?s=no:i&&!r?s=Es:s=n?no:Es}return s(t,e)}let so;try{so=new RegExp(`(^|(?<!
))
+(?!
|$)`,"g")}catch{so=/\n+(?!\n|$)/g}function Sr({comment:t,type:e,value:n},s,r,i){const{blockQuote:o,commentString:a,lineWidth:l}=s.options;if(!o||/\n[\t ]+$/.test(n))return Wn(n,s);const c=s.indent||(s.forceBlockIndent||Jr(n)?"  ":""),u=o==="literal"?!0:o==="folded"||e===q.BLOCK_FOLDED?!1:e===q.BLOCK_LITERAL?!0:!yv(n,l,c.length);if(!n)return u?`|
`:`>
`;let f,h;for(h=n.length;h>0;--h){const E=n[h-1];if(E!==`
`&&E!=="	"&&E!==" ")break}let p=n.substring(h);const y=p.indexOf(`
`);y===-1?f="-":n===p||y!==p.length-1?(f="+",i&&i()):f="",p&&(n=n.slice(0,-p.length),p[p.length-1]===`
`&&(p=p.slice(0,-1)),p=p.replace(so,`$&${c}`));let g=!1,w,m=-1;for(w=0;w<n.length;++w){const E=n[w];if(E===" ")g=!0;else if(E===`
`)m=w;else break}let S=n.substring(0,m<w?m+1:w);S&&(n=n.substring(S.length),S=S.replace(/\n+/g,`$&${c}`));let _=(g?c?"2":"1":"")+f;if(t&&(_+=" "+a(t.replace(/ ?[\r\n]+/g," ")),r&&r()),!u){const E=n.replace(/\n+/g,`
$&`).replace(/(?:^|\n)([\t ].*)(?:([\n\t ]*)\n(?![\n\t ]))?/g,"$1$2").replace(/\n+/g,`$&${c}`);let k=!1;const b=Qr(s,!0);o!=="folded"&&e!==q.BLOCK_FOLDED&&(b.onOverflow=()=>{k=!0});const v=Xr(`${S}${E}${p}`,c,to,b);if(!k)return`>${_}
${c}${v}`}return n=n.replace(/\n+/g,`$&${c}`),`|${_}
${c}${S}${n}${p}`}function bv(t,e,n,s){const{type:r,value:i}=t,{actualString:o,implicitKey:a,indent:l,indentStep:c,inFlow:u}=e;if(a&&i.includes(`
`)||u&&/[[\]{},]/.test(i))return Wn(i,e);if(/^[\n\t ,[\]{}#&*!|>'"%@`]|^[?-]$|^[?-][ \t]|[\n:][ \t]|[ \t]\n|[\n\t ]#|[\n\t :]$/.test(i))return a||u||!i.includes(`
`)?Wn(i,e):Sr(t,e,n,s);if(!a&&!u&&r!==q.PLAIN&&i.includes(`
`))return Sr(t,e,n,s);if(Jr(i)){if(l==="")return e.forceBlockIndent=!0,Sr(t,e,n,s);if(a&&l===c)return Wn(i,e)}const f=i.replace(/\n+/g,`$&
${l}`);if(o){const h=g=>g.default&&g.tag!=="tag:yaml.org,2002:str"&&g.test?.test(f),{compat:p,tags:y}=e.doc.schema;if(y.some(h)||p?.some(h))return Wn(i,e)}return a?f:Xr(f,l,lu,Qr(e,!1))}function Mo(t,e,n,s){const{implicitKey:r,inFlow:i}=e,o=typeof t.value=="string"?t:Object.assign({},t,{value:String(t.value)});let{type:a}=t;a!==q.QUOTE_DOUBLE&&/[\x00-\x08\x0b-\x1f\x7f-\x9f\u{D800}-\u{DFFF}]/u.test(o.value)&&(a=q.QUOTE_DOUBLE);const l=u=>{switch(u){case q.BLOCK_FOLDED:case q.BLOCK_LITERAL:return r||i?Wn(o.value,e):Sr(o,e,n,s);case q.QUOTE_DOUBLE:return Es(o.value,e);case q.QUOTE_SINGLE:return no(o.value,e);case q.PLAIN:return bv(o,e,n,s);default:return null}};let c=l(a);if(c===null){const{defaultKeyType:u,defaultStringType:f}=e.options,h=r&&u||f;if(c=l(h),c===null)throw new Error(`Unsupported default string type ${h}`)}return c}function cu(t,e){const n=Object.assign({blockQuote:!0,commentString:gv,defaultKeyType:null,defaultStringType:"PLAIN",directives:null,doubleQuotedAsJSON:!1,doubleQuotedMinMultiLineLength:40,falseStr:"false",flowCollectionPadding:!0,indentSeq:!0,lineWidth:80,minContentWidth:20,nullStr:"null",simpleKeys:!1,singleQuote:null,trueStr:"true",verifyAliasOrder:!0},t.schema.toStringOptions,e);let s;switch(n.collectionStyle){case"block":s=!1;break;case"flow":s=!0;break;default:s=null}return{anchors:new Set,doc:t,flowCollectionPadding:n.flowCollectionPadding?" ":"",indent:"",indentStep:typeof n.indent=="number"?" ".repeat(n.indent):"  ",inFlow:s,options:n}}function wv(t,e){if(e.tag){const r=t.filter(i=>i.tag===e.tag);if(r.length>0)return r.find(i=>i.format===e.format)??r[0]}let n,s;if(pe(e)){s=e.value;let r=t.filter(i=>i.identify?.(s));if(r.length>1){const i=r.filter(o=>o.test);i.length>0&&(r=i)}n=r.find(i=>i.format===e.format)??r.find(i=>!i.format)}else s=e,n=t.find(r=>r.nodeClass&&s instanceof r.nodeClass);if(!n){const r=s?.constructor?.name??(s===null?"null":typeof s);throw new Error(`Tag not resolved for ${r} value`)}return n}function vv(t,e,{anchors:n,doc:s}){if(!s.directives)return"";const r=[],i=(pe(t)||Se(t))&&t.anchor;i&&su(i)&&(n.add(i),r.push(`&${i}`));const o=t.tag??(e.default?null:e.tag);return o&&r.push(s.directives.tagString(o)),r.join(" ")}function rs(t,e,n,s){if(Te(t))return t.toString(e,n,s);if(In(t)){if(e.doc.directives)return t.toString(e);if(e.resolvedAliases?.has(t))throw new TypeError("Cannot stringify circular structure without alias nodes");e.resolvedAliases?e.resolvedAliases.add(t):e.resolvedAliases=new Set([t]),t=t.resolve(e.doc)}let r;const i=ke(t)?t:e.doc.createNode(t,{onTagObj:l=>r=l});r??(r=wv(e.doc.schema.tags,i));const o=vv(i,r,e);o.length>0&&(e.indentAtStart=(e.indentAtStart??0)+o.length+1);const a=typeof r.stringify=="function"?r.stringify(i,e,n,s):pe(i)?Mo(i,e,n,s):i.toString(e,n,s);return o?pe(i)||a[0]==="{"||a[0]==="["?`${o} ${a}`:`${o}
${e.indent}${a}`:a}function xv({key:t,value:e},n,s,r){const{allNullValues:i,doc:o,indent:a,indentStep:l,options:{commentString:c,indentSeq:u,simpleKeys:f}}=n;let h=ke(t)&&t.comment||null;if(f){if(h)throw new Error("With simple keys, key nodes cannot have comments");if(Se(t)||!ke(t)&&typeof t=="object"){const b="With simple keys, collection cannot be used as a key value";throw new Error(b)}}let p=!f&&(!t||h&&e==null&&!n.inFlow||Se(t)||(pe(t)?t.type===q.BLOCK_FOLDED||t.type===q.BLOCK_LITERAL:typeof t=="object"));n=Object.assign({},n,{allNullValues:!1,implicitKey:!p&&(f||!i),indent:a+l});let y=!1,g=!1,w=rs(t,n,()=>y=!0,()=>g=!0);if(!p&&!n.inFlow&&w.length>1024){if(f)throw new Error("With simple keys, single line scalar must not span more than 1024 characters");p=!0}if(n.inFlow){if(i||e==null)return y&&s&&s(),w===""?"?":p?`? ${w}`:w}else if(i&&!f||e==null&&p)return w=`? ${w}`,h&&!y?w+=vn(w,n.indent,c(h)):g&&r&&r(),w;y&&(h=null),p?(h&&(w+=vn(w,n.indent,c(h))),w=`? ${w}
${a}:`):(w=`${w}:`,h&&(w+=vn(w,n.indent,c(h))));let m,S,x;ke(e)?(m=!!e.spaceBefore,S=e.commentBefore,x=e.comment):(m=!1,S=null,x=null,e&&typeof e=="object"&&(e=o.createNode(e))),n.implicitKey=!1,!p&&!h&&pe(e)&&(n.indentAtStart=w.length+1),g=!1,!u&&l.length>=2&&!n.inFlow&&!p&&Us(e)&&!e.flow&&!e.tag&&!e.anchor&&(n.indent=n.indent.substring(2));let _=!1;const E=rs(e,n,()=>_=!0,()=>g=!0);let k=" ";if(h||m||S){if(k=m?`
`:"",S){const b=c(S);k+=`
${$t(b,n.indent)}`}E===""&&!n.inFlow?k===`
`&&(k=`

`):k+=`
${n.indent}`}else if(!p&&Se(e)){const b=E[0],v=E.indexOf(`
`),T=v!==-1,A=n.inFlow??e.flow??e.items.length===0;if(T||!A){let O=!1;if(T&&(b==="&"||b==="!")){let N=E.indexOf(" ");b==="&"&&N!==-1&&N<v&&E[N+1]==="!"&&(N=E.indexOf(" ",N+1)),(N===-1||v<N)&&(O=!0)}O||(k=`
${n.indent}`)}}else(E===""||E[0]===`
`)&&(k="");return w+=k+E,n.inFlow?_&&s&&s():x&&!_?w+=vn(w,n.indent,c(x)):g&&r&&r(),w}function uu(t,e){(t==="debug"||t==="warn")&&console.warn(e)}const ur="<<",Lt={identify:t=>t===ur||typeof t=="symbol"&&t.description===ur,default:"key",tag:"tag:yaml.org,2002:merge",test:/^<<$/,resolve:()=>Object.assign(new q(Symbol(ur)),{addToJSMap:fu}),stringify:()=>ur},_v=(t,e)=>(Lt.identify(e)||pe(e)&&(!e.type||e.type===q.PLAIN)&&Lt.identify(e.value))&&t?.doc.schema.tags.some(n=>n.tag===Lt.tag&&n.default);function fu(t,e,n){if(n=t&&In(n)?n.resolve(t.doc):n,Us(n))for(const s of n.items)wi(t,e,s);else if(Array.isArray(n))for(const s of n)wi(t,e,s);else wi(t,e,n)}function wi(t,e,n){const s=t&&In(n)?n.resolve(t.doc):n;if(!Bs(s))throw new Error("Merge sources must be maps or map aliases");const r=s.toJSON(null,t,Map);for(const[i,o]of r)e instanceof Map?e.has(i)||e.set(i,o):e instanceof Set?e.add(i):Object.prototype.hasOwnProperty.call(e,i)||Object.defineProperty(e,i,{value:o,writable:!0,enumerable:!0,configurable:!0});return e}function hu(t,e,{key:n,value:s}){if(ke(n)&&n.addToJSMap)n.addToJSMap(t,e,s);else if(_v(t,n))fu(t,e,s);else{const r=ot(n,"",t);if(e instanceof Map)e.set(r,ot(s,r,t));else if(e instanceof Set)e.add(r);else{const i=Ev(n,r,t),o=ot(s,i,t);i in e?Object.defineProperty(e,i,{value:o,writable:!0,enumerable:!0,configurable:!0}):e[i]=o}}return e}function Ev(t,e,n){if(e===null)return"";if(typeof e!="object")return String(e);if(ke(t)&&n?.doc){const s=cu(n.doc,{});s.anchors=new Set;for(const i of n.anchors.keys())s.anchors.add(i.anchor);s.inFlow=!0,s.inStringifyKey=!0;const r=t.toString(s);if(!n.mapKeyWarned){let i=JSON.stringify(r);i.length>40&&(i=i.substring(0,36)+'..."'),uu(n.doc.options.logLevel,`Keys with collection values will be stringified due to JS Object restrictions: ${i}. Set mapAsMap: true to use object keys.`),n.mapKeyWarned=!0}return r}return JSON.stringify(e)}function jo(t,e,n){const s=Rs(t,void 0,n),r=Rs(e,void 0,n);return new qe(s,r)}class qe{constructor(e,n=null){Object.defineProperty(this,at,{value:tu}),this.key=e,this.value=n}clone(e){let{key:n,value:s}=this;return ke(n)&&(n=n.clone(e)),ke(s)&&(s=s.clone(e)),new qe(n,s)}toJSON(e,n){const s=n?.mapAsMap?new Map:{};return hu(n,s,this)}toString(e,n,s){return e?.doc?xv(this,e,n,s):JSON.stringify(this)}}function du(t,e,n){return(e.inFlow??t.flow?kv:Sv)(t,e,n)}function Sv({comment:t,items:e},n,{blockItemPrefix:s,flowChars:r,itemIndent:i,onChompKeep:o,onComment:a}){const{indent:l,options:{commentString:c}}=n,u=Object.assign({},n,{indent:i,type:null});let f=!1;const h=[];for(let y=0;y<e.length;++y){const g=e[y];let w=null;if(ke(g))!f&&g.spaceBefore&&h.push(""),Lr(n,h,g.commentBefore,f),g.comment&&(w=g.comment);else if(Te(g)){const S=ke(g.key)?g.key:null;S&&(!f&&S.spaceBefore&&h.push(""),Lr(n,h,S.commentBefore,f))}f=!1;let m=rs(g,u,()=>w=null,()=>f=!0);w&&(m+=vn(m,i,c(w))),f&&w&&(f=!1),h.push(s+m)}let p;if(h.length===0)p=r.start+r.end;else{p=h[0];for(let y=1;y<h.length;++y){const g=h[y];p+=g?`
${l}${g}`:`
`}}return t?(p+=`
`+$t(c(t),l),a&&a()):f&&o&&o(),p}function kv({items:t},e,{flowChars:n,itemIndent:s}){const{indent:r,indentStep:i,flowCollectionPadding:o,options:{commentString:a}}=e;s+=i;const l=Object.assign({},e,{indent:s,inFlow:!0,type:null});let c=!1,u=0;const f=[];for(let y=0;y<t.length;++y){const g=t[y];let w=null;if(ke(g))g.spaceBefore&&f.push(""),Lr(e,f,g.commentBefore,!1),g.comment&&(w=g.comment);else if(Te(g)){const S=ke(g.key)?g.key:null;S&&(S.spaceBefore&&f.push(""),Lr(e,f,S.commentBefore,!1),S.comment&&(c=!0));const x=ke(g.value)?g.value:null;x?(x.comment&&(w=x.comment),x.commentBefore&&(c=!0)):g.value==null&&S?.comment&&(w=S.comment)}w&&(c=!0);let m=rs(g,l,()=>w=null);y<t.length-1&&(m+=","),w&&(m+=vn(m,s,a(w))),!c&&(f.length>u||m.includes(`
`))&&(c=!0),f.push(m),u=f.length}const{start:h,end:p}=n;if(f.length===0)return h+p;if(!c){const y=f.reduce((g,w)=>g+w.length+2,2);c=e.options.lineWidth>0&&y>e.options.lineWidth}if(c){let y=h;for(const g of f)y+=g?`
${i}${r}${g}`:`
`;return`${y}
${r}${p}`}else return`${h}${o}${f.join(" ")}${o}${p}`}function Lr({indent:t,options:{commentString:e}},n,s,r){if(s&&r&&(s=s.replace(/^\n+/,"")),s){const i=$t(e(s),t);n.push(i.trimStart())}}function xn(t,e){const n=pe(e)?e.value:e;for(const s of t)if(Te(s)&&(s.key===e||s.key===n||pe(s.key)&&s.key.value===n))return s}class rt extends au{static get tagName(){return"tag:yaml.org,2002:map"}constructor(e){super(en,e),this.items=[]}static from(e,n,s){const{keepUndefined:r,replacer:i}=s,o=new this(e),a=(l,c)=>{if(typeof i=="function")c=i.call(n,l,c);else if(Array.isArray(i)&&!i.includes(l))return;(c!==void 0||r)&&o.items.push(jo(l,c,s))};if(n instanceof Map)for(const[l,c]of n)a(l,c);else if(n&&typeof n=="object")for(const l of Object.keys(n))a(l,n[l]);return typeof e.sortMapEntries=="function"&&o.items.sort(e.sortMapEntries),o}add(e,n){let s;Te(e)?s=e:!e||typeof e!="object"||!("key"in e)?s=new qe(e,e?.value):s=new qe(e.key,e.value);const r=xn(this.items,s.key),i=this.schema?.sortMapEntries;if(r){if(!n)throw new Error(`Key ${s.key} already set`);pe(r.value)&&ou(s.value)?r.value.value=s.value:r.value=s.value}else if(i){const o=this.items.findIndex(a=>i(s,a)<0);o===-1?this.items.push(s):this.items.splice(o,0,s)}else this.items.push(s)}delete(e){const n=xn(this.items,e);return n?this.items.splice(this.items.indexOf(n),1).length>0:!1}get(e,n){const r=xn(this.items,e)?.value;return(!n&&pe(r)?r.value:r)??void 0}has(e){return!!xn(this.items,e)}set(e,n){this.add(new qe(e,n),!0)}toJSON(e,n,s){const r=s?new s:n?.mapAsMap?new Map:{};n?.onCreate&&n.onCreate(r);for(const i of this.items)hu(n,r,i);return r}toString(e,n,s){if(!e)return JSON.stringify(this);for(const r of this.items)if(!Te(r))throw new Error(`Map items must all be pairs; found ${JSON.stringify(r)} instead`);return!e.allNullValues&&this.hasAllNullValues(!1)&&(e=Object.assign({},e,{allNullValues:!0})),du(this,e,{blockItemPrefix:"",flowChars:{start:"{",end:"}"},itemIndent:e.indent||"",onChompKeep:s,onComment:n})}}const ls={collection:"map",default:!0,nodeClass:rt,tag:"tag:yaml.org,2002:map",resolve(t,e){return Bs(t)||e("Expected a mapping for this tag"),t},createNode:(t,e,n)=>rt.from(t,e,n)};class An extends au{static get tagName(){return"tag:yaml.org,2002:seq"}constructor(e){super(os,e),this.items=[]}add(e){this.items.push(e)}delete(e){const n=fr(e);return typeof n!="number"?!1:this.items.splice(n,1).length>0}get(e,n){const s=fr(e);if(typeof s!="number")return;const r=this.items[s];return!n&&pe(r)?r.value:r}has(e){const n=fr(e);return typeof n=="number"&&n<this.items.length}set(e,n){const s=fr(e);if(typeof s!="number")throw new Error(`Expected a valid index, not ${e}.`);const r=this.items[s];pe(r)&&ou(n)?r.value=n:this.items[s]=n}toJSON(e,n){const s=[];n?.onCreate&&n.onCreate(s);let r=0;for(const i of this.items)s.push(ot(i,String(r++),n));return s}toString(e,n,s){return e?du(this,e,{blockItemPrefix:"- ",flowChars:{start:"[",end:"]"},itemIndent:(e.indent||"")+"  ",onChompKeep:s,onComment:n}):JSON.stringify(this)}static from(e,n,s){const{replacer:r}=s,i=new this(e);if(n&&Symbol.iterator in Object(n)){let o=0;for(let a of n){if(typeof r=="function"){const l=n instanceof Set?a:String(o++);a=r.call(n,l,a)}i.items.push(Rs(a,void 0,s))}}return i}}function fr(t){let e=pe(t)?t.value:t;return e&&typeof e=="string"&&(e=Number(e)),typeof e=="number"&&Number.isInteger(e)&&e>=0?e:null}const cs={collection:"seq",default:!0,nodeClass:An,tag:"tag:yaml.org,2002:seq",resolve(t,e){return Us(t)||e("Expected a sequence for this tag"),t},createNode:(t,e,n)=>An.from(t,e,n)},ei={identify:t=>typeof t=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:t=>t,stringify(t,e,n,s){return e=Object.assign({actualString:!0},e),Mo(t,e,n,s)}},ti={identify:t=>t==null,createNode:()=>new q(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^(?:~|[Nn]ull|NULL)?$/,resolve:()=>new q(null),stringify:({source:t},e)=>typeof t=="string"&&ti.test.test(t)?t:e.options.nullStr},Ro={identify:t=>typeof t=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:[Tt]rue|TRUE|[Ff]alse|FALSE)$/,resolve:t=>new q(t[0]==="t"||t[0]==="T"),stringify({source:t,value:e},n){if(t&&Ro.test.test(t)){const s=t[0]==="t"||t[0]==="T";if(e===s)return t}return e?n.options.trueStr:n.options.falseStr}};function xt({format:t,minFractionDigits:e,tag:n,value:s}){if(typeof s=="bigint")return String(s);const r=typeof s=="number"?s:Number(s);if(!isFinite(r))return isNaN(r)?".nan":r<0?"-.inf":".inf";let i=JSON.stringify(s);if(!t&&e&&(!n||n==="tag:yaml.org,2002:float")&&/^\d/.test(i)){let o=i.indexOf(".");o<0&&(o=i.length,i+=".");let a=e-(i.length-o-1);for(;a-- >0;)i+="0"}return i}const pu={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:t=>t.slice(-3).toLowerCase()==="nan"?NaN:t[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:xt},mu={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:\.[0-9]+|[0-9]+(?:\.[0-9]*)?)[eE][-+]?[0-9]+$/,resolve:t=>parseFloat(t),stringify(t){const e=Number(t.value);return isFinite(e)?e.toExponential():xt(t)}},gu={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:\.[0-9]+|[0-9]+\.[0-9]*)$/,resolve(t){const e=new q(parseFloat(t)),n=t.indexOf(".");return n!==-1&&t[t.length-1]==="0"&&(e.minFractionDigits=t.length-n-1),e},stringify:xt},ni=t=>typeof t=="bigint"||Number.isInteger(t),Po=(t,e,n,{intAsBigInt:s})=>s?BigInt(t):parseInt(t.substring(e),n);function yu(t,e,n){const{value:s}=t;return ni(s)&&s>=0?n+s.toString(e):xt(t)}const bu={identify:t=>ni(t)&&t>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^0o[0-7]+$/,resolve:(t,e,n)=>Po(t,2,8,n),stringify:t=>yu(t,8,"0o")},wu={identify:ni,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9]+$/,resolve:(t,e,n)=>Po(t,0,10,n),stringify:xt},vu={identify:t=>ni(t)&&t>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^0x[0-9a-fA-F]+$/,resolve:(t,e,n)=>Po(t,2,16,n),stringify:t=>yu(t,16,"0x")},Tv=[ls,cs,ei,ti,Ro,bu,wu,vu,pu,mu,gu];function ul(t){return typeof t=="bigint"||Number.isInteger(t)}const hr=({value:t})=>JSON.stringify(t),Av=[{identify:t=>typeof t=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:t=>t,stringify:hr},{identify:t=>t==null,createNode:()=>new q(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^null$/,resolve:()=>null,stringify:hr},{identify:t=>typeof t=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^true$|^false$/,resolve:t=>t==="true",stringify:hr},{identify:ul,default:!0,tag:"tag:yaml.org,2002:int",test:/^-?(?:0|[1-9][0-9]*)$/,resolve:(t,e,{intAsBigInt:n})=>n?BigInt(t):parseInt(t,10),stringify:({value:t})=>ul(t)?t.toString():JSON.stringify(t)},{identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^-?(?:0|[1-9][0-9]*)(?:\.[0-9]*)?(?:[eE][-+]?[0-9]+)?$/,resolve:t=>parseFloat(t),stringify:hr}],Nv={default:!0,tag:"",test:/^/,resolve(t,e){return e(`Unresolved plain scalar ${JSON.stringify(t)}`),t}},Ov=[ls,cs].concat(Av,Nv),$o={identify:t=>t instanceof Uint8Array,default:!1,tag:"tag:yaml.org,2002:binary",resolve(t,e){if(typeof atob=="function"){const n=atob(t.replace(/[\n\r]/g,"")),s=new Uint8Array(n.length);for(let r=0;r<n.length;++r)s[r]=n.charCodeAt(r);return s}else return e("This environment does not support reading binary tags; either Buffer or atob is required"),t},stringify({comment:t,type:e,value:n},s,r,i){if(!n)return"";const o=n;let a;if(typeof btoa=="function"){let l="";for(let c=0;c<o.length;++c)l+=String.fromCharCode(o[c]);a=btoa(l)}else throw new Error("This environment does not support writing binary tags; either Buffer or btoa is required");if(e??(e=q.BLOCK_LITERAL),e!==q.QUOTE_DOUBLE){const l=Math.max(s.options.lineWidth-s.indent.length,s.options.minContentWidth),c=Math.ceil(a.length/l),u=new Array(c);for(let f=0,h=0;f<c;++f,h+=l)u[f]=a.substr(h,l);a=u.join(e===q.BLOCK_LITERAL?`
`:" ")}return Mo({comment:t,type:e,value:a},s,r,i)}};function xu(t,e){if(Us(t))for(let n=0;n<t.items.length;++n){let s=t.items[n];if(!Te(s)){if(Bs(s)){s.items.length>1&&e("Each pair must have its own sequence indicator");const r=s.items[0]||new qe(new q(null));if(s.commentBefore&&(r.key.commentBefore=r.key.commentBefore?`${s.commentBefore}
${r.key.commentBefore}`:s.commentBefore),s.comment){const i=r.value??r.key;i.comment=i.comment?`${s.comment}
${i.comment}`:s.comment}s=r}t.items[n]=Te(s)?s:new qe(s)}}else e("Expected a sequence for this tag");return t}function _u(t,e,n){const{replacer:s}=n,r=new An(t);r.tag="tag:yaml.org,2002:pairs";let i=0;if(e&&Symbol.iterator in Object(e))for(let o of e){typeof s=="function"&&(o=s.call(e,String(i++),o));let a,l;if(Array.isArray(o))if(o.length===2)a=o[0],l=o[1];else throw new TypeError(`Expected [key, value] tuple: ${o}`);else if(o&&o instanceof Object){const c=Object.keys(o);if(c.length===1)a=c[0],l=o[a];else throw new TypeError(`Expected tuple with one key, not ${c.length} keys`)}else a=o;r.items.push(jo(a,l,n))}return r}const Do={collection:"seq",default:!1,tag:"tag:yaml.org,2002:pairs",resolve:xu,createNode:_u};class Hn extends An{constructor(){super(),this.add=rt.prototype.add.bind(this),this.delete=rt.prototype.delete.bind(this),this.get=rt.prototype.get.bind(this),this.has=rt.prototype.has.bind(this),this.set=rt.prototype.set.bind(this),this.tag=Hn.tag}toJSON(e,n){if(!n)return super.toJSON(e);const s=new Map;n?.onCreate&&n.onCreate(s);for(const r of this.items){let i,o;if(Te(r)?(i=ot(r.key,"",n),o=ot(r.value,i,n)):i=ot(r,"",n),s.has(i))throw new Error("Ordered maps must not include duplicate keys");s.set(i,o)}return s}static from(e,n,s){const r=_u(e,n,s),i=new this;return i.items=r.items,i}}Hn.tag="tag:yaml.org,2002:omap";const Lo={collection:"seq",identify:t=>t instanceof Map,nodeClass:Hn,default:!1,tag:"tag:yaml.org,2002:omap",resolve(t,e){const n=xu(t,e),s=[];for(const{key:r}of n.items)pe(r)&&(s.includes(r.value)?e(`Ordered maps must not include duplicate keys: ${r.value}`):s.push(r.value));return Object.assign(new Hn,n)},createNode:(t,e,n)=>Hn.from(t,e,n)};function Eu({value:t,source:e},n){return e&&(t?Su:ku).test.test(e)?e:t?n.options.trueStr:n.options.falseStr}const Su={identify:t=>t===!0,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:Y|y|[Yy]es|YES|[Tt]rue|TRUE|[Oo]n|ON)$/,resolve:()=>new q(!0),stringify:Eu},ku={identify:t=>t===!1,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:N|n|[Nn]o|NO|[Ff]alse|FALSE|[Oo]ff|OFF)$/,resolve:()=>new q(!1),stringify:Eu},Cv={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:t=>t.slice(-3).toLowerCase()==="nan"?NaN:t[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:xt},Iv={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:[0-9][0-9_]*)?(?:\.[0-9_]*)?[eE][-+]?[0-9]+$/,resolve:t=>parseFloat(t.replace(/_/g,"")),stringify(t){const e=Number(t.value);return isFinite(e)?e.toExponential():xt(t)}},Mv={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:[0-9][0-9_]*)?\.[0-9_]*$/,resolve(t){const e=new q(parseFloat(t.replace(/_/g,""))),n=t.indexOf(".");if(n!==-1){const s=t.substring(n+1).replace(/_/g,"");s[s.length-1]==="0"&&(e.minFractionDigits=s.length)}return e},stringify:xt},Zs=t=>typeof t=="bigint"||Number.isInteger(t);function si(t,e,n,{intAsBigInt:s}){const r=t[0];if((r==="-"||r==="+")&&(e+=1),t=t.substring(e).replace(/_/g,""),s){switch(n){case 2:t=`0b${t}`;break;case 8:t=`0o${t}`;break;case 16:t=`0x${t}`;break}const o=BigInt(t);return r==="-"?BigInt(-1)*o:o}const i=parseInt(t,n);return r==="-"?-1*i:i}function zo(t,e,n){const{value:s}=t;if(Zs(s)){const r=s.toString(e);return s<0?"-"+n+r.substr(1):n+r}return xt(t)}const jv={identify:Zs,default:!0,tag:"tag:yaml.org,2002:int",format:"BIN",test:/^[-+]?0b[0-1_]+$/,resolve:(t,e,n)=>si(t,2,2,n),stringify:t=>zo(t,2,"0b")},Rv={identify:Zs,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^[-+]?0[0-7_]+$/,resolve:(t,e,n)=>si(t,1,8,n),stringify:t=>zo(t,8,"0")},Pv={identify:Zs,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9][0-9_]*$/,resolve:(t,e,n)=>si(t,0,10,n),stringify:xt},$v={identify:Zs,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^[-+]?0x[0-9a-fA-F_]+$/,resolve:(t,e,n)=>si(t,2,16,n),stringify:t=>zo(t,16,"0x")};class Xn extends rt{constructor(e){super(e),this.tag=Xn.tag}add(e){let n;Te(e)?n=e:e&&typeof e=="object"&&"key"in e&&"value"in e&&e.value===null?n=new qe(e.key,null):n=new qe(e,null),xn(this.items,n.key)||this.items.push(n)}get(e,n){const s=xn(this.items,e);return!n&&Te(s)?pe(s.key)?s.key.value:s.key:s}set(e,n){if(typeof n!="boolean")throw new Error(`Expected boolean value for set(key, value) in a YAML set, not ${typeof n}`);const s=xn(this.items,e);s&&!n?this.items.splice(this.items.indexOf(s),1):!s&&n&&this.items.push(new qe(e))}toJSON(e,n){return super.toJSON(e,n,Set)}toString(e,n,s){if(!e)return JSON.stringify(this);if(this.hasAllNullValues(!0))return super.toString(Object.assign({},e,{allNullValues:!0}),n,s);throw new Error("Set items must all have null values")}static from(e,n,s){const{replacer:r}=s,i=new this(e);if(n&&Symbol.iterator in Object(n))for(let o of n)typeof r=="function"&&(o=r.call(n,o,o)),i.items.push(jo(o,null,s));return i}}Xn.tag="tag:yaml.org,2002:set";const Fo={collection:"map",identify:t=>t instanceof Set,nodeClass:Xn,default:!1,tag:"tag:yaml.org,2002:set",createNode:(t,e,n)=>Xn.from(t,e,n),resolve(t,e){if(Bs(t)){if(t.hasAllNullValues(!0))return Object.assign(new Xn,t);e("Set items must all have null values")}else e("Expected a mapping for this tag");return t}};function Bo(t,e){const n=t[0],s=n==="-"||n==="+"?t.substring(1):t,r=o=>e?BigInt(o):Number(o),i=s.replace(/_/g,"").split(":").reduce((o,a)=>o*r(60)+r(a),r(0));return n==="-"?r(-1)*i:i}function Tu(t){let{value:e}=t,n=o=>o;if(typeof e=="bigint")n=o=>BigInt(o);else if(isNaN(e)||!isFinite(e))return xt(t);let s="";e<0&&(s="-",e*=n(-1));const r=n(60),i=[e%r];return e<60?i.unshift(0):(e=(e-i[0])/r,i.unshift(e%r),e>=60&&(e=(e-i[0])/r,i.unshift(e))),s+i.map(o=>String(o).padStart(2,"0")).join(":").replace(/000000\d*$/,"")}const Au={identify:t=>typeof t=="bigint"||Number.isInteger(t),default:!0,tag:"tag:yaml.org,2002:int",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+$/,resolve:(t,e,{intAsBigInt:n})=>Bo(t,n),stringify:Tu},Nu={identify:t=>typeof t=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\.[0-9_]*$/,resolve:t=>Bo(t,!1),stringify:Tu},ri={identify:t=>t instanceof Date,default:!0,tag:"tag:yaml.org,2002:timestamp",test:RegExp("^([0-9]{4})-([0-9]{1,2})-([0-9]{1,2})(?:(?:t|T|[ \\t]+)([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2}(\\.[0-9]+)?)(?:[ \\t]*(Z|[-+][012]?[0-9](?::[0-9]{2})?))?)?$"),resolve(t){const e=t.match(ri.test);if(!e)throw new Error("!!timestamp expects a date, starting with yyyy-mm-dd");const[,n,s,r,i,o,a]=e.map(Number),l=e[7]?Number((e[7]+"00").substr(1,3)):0;let c=Date.UTC(n,s-1,r,i||0,o||0,a||0,l);const u=e[8];if(u&&u!=="Z"){let f=Bo(u,!1);Math.abs(f)<30&&(f*=60),c-=6e4*f}return new Date(c)},stringify:({value:t})=>t?.toISOString().replace(/(T00:00:00)?\.000Z$/,"")??""},fl=[ls,cs,ei,ti,Su,ku,jv,Rv,Pv,$v,Cv,Iv,Mv,$o,Lt,Lo,Do,Fo,Au,Nu,ri],hl=new Map([["core",Tv],["failsafe",[ls,cs,ei]],["json",Ov],["yaml11",fl],["yaml-1.1",fl]]),dl={binary:$o,bool:Ro,float:gu,floatExp:mu,floatNaN:pu,floatTime:Nu,int:wu,intHex:vu,intOct:bu,intTime:Au,map:ls,merge:Lt,null:ti,omap:Lo,pairs:Do,seq:cs,set:Fo,timestamp:ri},Dv={"tag:yaml.org,2002:binary":$o,"tag:yaml.org,2002:merge":Lt,"tag:yaml.org,2002:omap":Lo,"tag:yaml.org,2002:pairs":Do,"tag:yaml.org,2002:set":Fo,"tag:yaml.org,2002:timestamp":ri};function vi(t,e,n){const s=hl.get(e);if(s&&!t)return n&&!s.includes(Lt)?s.concat(Lt):s.slice();let r=s;if(!r)if(Array.isArray(t))r=[];else{const i=Array.from(hl.keys()).filter(o=>o!=="yaml11").map(o=>JSON.stringify(o)).join(", ");throw new Error(`Unknown schema "${e}"; use one of ${i} or define customTags array`)}if(Array.isArray(t))for(const i of t)r=r.concat(i);else typeof t=="function"&&(r=t(r.slice()));return n&&(r=r.concat(Lt)),r.reduce((i,o)=>{const a=typeof o=="string"?dl[o]:o;if(!a){const l=JSON.stringify(o),c=Object.keys(dl).map(u=>JSON.stringify(u)).join(", ");throw new Error(`Unknown custom tag ${l}; use one of ${c}`)}return i.includes(a)||i.push(a),i},[])}const Lv=(t,e)=>t.key<e.key?-1:t.key>e.key?1:0;class Uo{constructor({compat:e,customTags:n,merge:s,resolveKnownTags:r,schema:i,sortMapEntries:o,toStringDefaults:a}){this.compat=Array.isArray(e)?vi(e,"compat"):e?vi(null,e):null,this.name=typeof i=="string"&&i||"core",this.knownTags=r?Dv:{},this.tags=vi(n,this.name,s),this.toStringOptions=a??null,Object.defineProperty(this,en,{value:ls}),Object.defineProperty(this,Mt,{value:ei}),Object.defineProperty(this,os,{value:cs}),this.sortMapEntries=typeof o=="function"?o:o===!0?Lv:null}clone(){const e=Object.create(Uo.prototype,Object.getOwnPropertyDescriptors(this));return e.tags=this.tags.slice(),e}}function zv(t,e){const n=[];let s=e.directives===!0;if(e.directives!==!1&&t.directives){const l=t.directives.toString(t);l?(n.push(l),s=!0):t.directives.docStart&&(s=!0)}s&&n.push("---");const r=cu(t,e),{commentString:i}=r.options;if(t.commentBefore){n.length!==1&&n.unshift("");const l=i(t.commentBefore);n.unshift($t(l,""))}let o=!1,a=null;if(t.contents){if(ke(t.contents)){if(t.contents.spaceBefore&&s&&n.push(""),t.contents.commentBefore){const u=i(t.contents.commentBefore);n.push($t(u,""))}r.forceBlockIndent=!!t.comment,a=t.contents.comment}const l=a?void 0:()=>o=!0;let c=rs(t.contents,r,()=>a=null,l);a&&(c+=vn(c,"",i(a))),(c[0]==="|"||c[0]===">")&&n[n.length-1]==="---"?n[n.length-1]=`--- ${c}`:n.push(c)}else n.push(rs(t.contents,r));if(t.directives?.docEnd)if(t.comment){const l=i(t.comment);l.includes(`
`)?(n.push("..."),n.push($t(l,""))):n.push(`... ${l}`)}else n.push("...");else{let l=t.comment;l&&o&&(l=l.replace(/^\n+/,"")),l&&((!o||a)&&n[n.length-1]!==""&&n.push(""),n.push($t(i(l),"")))}return n.join(`
`)+`
`}class ii{constructor(e,n,s){this.commentBefore=null,this.comment=null,this.errors=[],this.warnings=[],Object.defineProperty(this,at,{value:eo});let r=null;typeof n=="function"||Array.isArray(n)?r=n:s===void 0&&n&&(s=n,n=void 0);const i=Object.assign({intAsBigInt:!1,keepSourceTokens:!1,logLevel:"warn",prettyErrors:!0,strict:!0,stringKeys:!1,uniqueKeys:!0,version:"1.2"},s);this.options=i;let{version:o}=i;s?._directives?(this.directives=s._directives.atDocument(),this.directives.yaml.explicit&&(o=this.directives.yaml.version)):this.directives=new Ve({version:o}),this.setSchema(o,s),this.contents=e===void 0?null:this.createNode(e,r,s)}clone(){const e=Object.create(ii.prototype,{[at]:{value:eo}});return e.commentBefore=this.commentBefore,e.comment=this.comment,e.errors=this.errors.slice(),e.warnings=this.warnings.slice(),e.options=Object.assign({},this.options),this.directives&&(e.directives=this.directives.clone()),e.schema=this.schema.clone(),e.contents=ke(this.contents)?this.contents.clone(e.schema):this.contents,this.range&&(e.range=this.range.slice()),e}add(e){Dn(this.contents)&&this.contents.add(e)}addIn(e,n){Dn(this.contents)&&this.contents.addIn(e,n)}createAlias(e,n){if(!e.anchor){const s=ru(this);e.anchor=!n||s.has(n)?iu(n||"a",s):n}return new Io(e.anchor)}createNode(e,n,s){let r;if(typeof n=="function")e=n.call({"":e},"",e),r=n;else if(Array.isArray(n)){const w=S=>typeof S=="number"||S instanceof String||S instanceof Number,m=n.filter(w).map(String);m.length>0&&(n=n.concat(m)),r=n}else s===void 0&&n&&(s=n,n=void 0);const{aliasDuplicateObjects:i,anchorPrefix:o,flow:a,keepUndefined:l,onTagObj:c,tag:u}=s??{},{onAnchor:f,setAnchors:h,sourceObjects:p}=dv(this,o||"a"),y={aliasDuplicateObjects:i??!0,keepUndefined:l??!1,onAnchor:f,onTagObj:c,replacer:r,schema:this.schema,sourceObjects:p},g=Rs(e,u,y);return a&&Se(g)&&(g.flow=!0),h(),g}createPair(e,n,s={}){const r=this.createNode(e,null,s),i=this.createNode(n,null,s);return new qe(r,i)}delete(e){return Dn(this.contents)?this.contents.delete(e):!1}deleteIn(e){return ys(e)?this.contents==null?!1:(this.contents=null,!0):Dn(this.contents)?this.contents.deleteIn(e):!1}get(e,n){return Se(this.contents)?this.contents.get(e,n):void 0}getIn(e,n){return ys(e)?!n&&pe(this.contents)?this.contents.value:this.contents:Se(this.contents)?this.contents.getIn(e,n):void 0}has(e){return Se(this.contents)?this.contents.has(e):!1}hasIn(e){return ys(e)?this.contents!==void 0:Se(this.contents)?this.contents.hasIn(e):!1}set(e,n){this.contents==null?this.contents=Dr(this.schema,[e],n):Dn(this.contents)&&this.contents.set(e,n)}setIn(e,n){ys(e)?this.contents=n:this.contents==null?this.contents=Dr(this.schema,Array.from(e),n):Dn(this.contents)&&this.contents.setIn(e,n)}setSchema(e,n={}){typeof e=="number"&&(e=String(e));let s;switch(e){case"1.1":this.directives?this.directives.yaml.version="1.1":this.directives=new Ve({version:"1.1"}),s={resolveKnownTags:!1,schema:"yaml-1.1"};break;case"1.2":case"next":this.directives?this.directives.yaml.version=e:this.directives=new Ve({version:e}),s={resolveKnownTags:!0,schema:"core"};break;case null:this.directives&&delete this.directives,s=null;break;default:{const r=JSON.stringify(e);throw new Error(`Expected '1.1', '1.2' or null as first argument, but found: ${r}`)}}if(n.schema instanceof Object)this.schema=n.schema;else if(s)this.schema=new Uo(Object.assign(s,n));else throw new Error("With a null YAML version, the { schema: Schema } option is required")}toJS({json:e,jsonArg:n,mapAsMap:s,maxAliasCount:r,onAnchor:i,reviver:o}={}){const a={anchors:new Map,doc:this,keep:!e,mapAsMap:s===!0,mapKeyWarned:!1,maxAliasCount:typeof r=="number"?r:100},l=ot(this.contents,n??"",a);if(typeof i=="function")for(const{count:c,res:u}of a.anchors.values())i(u,c);return typeof o=="function"?Vn(o,{"":l},"",l):l}toJSON(e,n){return this.toJS({json:!0,jsonArg:e,mapAsMap:!1,onAnchor:n})}toString(e={}){if(this.errors.length>0)throw new Error("Document with errors cannot be stringified");if("indent"in e&&(!Number.isInteger(e.indent)||Number(e.indent)<=0)){const n=JSON.stringify(e.indent);throw new Error(`"indent" option must be a positive integer, not ${n}`)}return zv(this,e)}}function Dn(t){if(Se(t))return!0;throw new Error("Expected a YAML collection as document contents")}class Ou extends Error{constructor(e,n,s,r){super(),this.name=e,this.code=s,this.message=r,this.pos=n}}class bs extends Ou{constructor(e,n,s){super("YAMLParseError",e,n,s)}}class Fv extends Ou{constructor(e,n,s){super("YAMLWarning",e,n,s)}}const pl=(t,e)=>n=>{if(n.pos[0]===-1)return;n.linePos=n.pos.map(a=>e.linePos(a));const{line:s,col:r}=n.linePos[0];n.message+=` at line ${s}, column ${r}`;let i=r-1,o=t.substring(e.lineStarts[s-1],e.lineStarts[s]).replace(/[\n\r]+$/,"");if(i>=60&&o.length>80){const a=Math.min(i-39,o.length-79);o="…"+o.substring(a),i-=a-1}if(o.length>80&&(o=o.substring(0,79)+"…"),s>1&&/^ *$/.test(o.substring(0,i))){let a=t.substring(e.lineStarts[s-2],e.lineStarts[s-1]);a.length>80&&(a=a.substring(0,79)+`…
`),o=a+o}if(/[^ ]/.test(o)){let a=1;const l=n.linePos[1];l&&l.line===s&&l.col>r&&(a=Math.max(1,Math.min(l.col-r,80-i)));const c=" ".repeat(i)+"^".repeat(a);n.message+=`:

${o}
${c}
`}};function is(t,{flow:e,indicator:n,next:s,offset:r,onError:i,parentIndent:o,startOnNewline:a}){let l=!1,c=a,u=a,f="",h="",p=!1,y=!1,g=null,w=null,m=null,S=null,x=null,_=null,E=null;for(const v of t)switch(y&&(v.type!=="space"&&v.type!=="newline"&&v.type!=="comma"&&i(v.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),y=!1),g&&(c&&v.type!=="comment"&&v.type!=="newline"&&i(g,"TAB_AS_INDENT","Tabs are not allowed as indentation"),g=null),v.type){case"space":!e&&(n!=="doc-start"||s?.type!=="flow-collection")&&v.source.includes("	")&&(g=v),u=!0;break;case"comment":{u||i(v,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");const T=v.source.substring(1)||" ";f?f+=h+T:f=T,h="",c=!1;break}case"newline":c?f?f+=v.source:(!_||n!=="seq-item-ind")&&(l=!0):h+=v.source,c=!0,p=!0,(w||m)&&(S=v),u=!0;break;case"anchor":w&&i(v,"MULTIPLE_ANCHORS","A node can have at most one anchor"),v.source.endsWith(":")&&i(v.offset+v.source.length-1,"BAD_ALIAS","Anchor ending in : is ambiguous",!0),w=v,E??(E=v.offset),c=!1,u=!1,y=!0;break;case"tag":{m&&i(v,"MULTIPLE_TAGS","A node can have at most one tag"),m=v,E??(E=v.offset),c=!1,u=!1,y=!0;break}case n:(w||m)&&i(v,"BAD_PROP_ORDER",`Anchors and tags must be after the ${v.source} indicator`),_&&i(v,"UNEXPECTED_TOKEN",`Unexpected ${v.source} in ${e??"collection"}`),_=v,c=n==="seq-item-ind"||n==="explicit-key-ind",u=!1;break;case"comma":if(e){x&&i(v,"UNEXPECTED_TOKEN",`Unexpected , in ${e}`),x=v,c=!1,u=!1;break}default:i(v,"UNEXPECTED_TOKEN",`Unexpected ${v.type} token`),c=!1,u=!1}const k=t[t.length-1],b=k?k.offset+k.source.length:r;return y&&s&&s.type!=="space"&&s.type!=="newline"&&s.type!=="comma"&&(s.type!=="scalar"||s.source!=="")&&i(s.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),g&&(c&&g.indent<=o||s?.type==="block-map"||s?.type==="block-seq")&&i(g,"TAB_AS_INDENT","Tabs are not allowed as indentation"),{comma:x,found:_,spaceBefore:l,comment:f,hasNewline:p,anchor:w,tag:m,newlineAfterProp:S,end:b,start:E??b}}function Ps(t){if(!t)return null;switch(t.type){case"alias":case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":if(t.source.includes(`
`))return!0;if(t.end){for(const e of t.end)if(e.type==="newline")return!0}return!1;case"flow-collection":for(const e of t.items){for(const n of e.start)if(n.type==="newline")return!0;if(e.sep){for(const n of e.sep)if(n.type==="newline")return!0}if(Ps(e.key)||Ps(e.value))return!0}return!1;default:return!0}}function ro(t,e,n){if(e?.type==="flow-collection"){const s=e.end[0];s.indent===t&&(s.source==="]"||s.source==="}")&&Ps(e)&&n(s,"BAD_INDENT","Flow end indicator should be more indented than parent",!0)}}function Cu(t,e,n){const{uniqueKeys:s}=t.options;if(s===!1)return!1;const r=typeof s=="function"?s:(i,o)=>i===o||pe(i)&&pe(o)&&i.value===o.value;return e.some(i=>r(i.key,n))}const ml="All mapping items must start at the same column";function Bv({composeNode:t,composeEmptyNode:e},n,s,r,i){const o=i?.nodeClass??rt,a=new o(n.schema);n.atRoot&&(n.atRoot=!1);let l=s.offset,c=null;for(const u of s.items){const{start:f,key:h,sep:p,value:y}=u,g=is(f,{indicator:"explicit-key-ind",next:h??p?.[0],offset:l,onError:r,parentIndent:s.indent,startOnNewline:!0}),w=!g.found;if(w){if(h&&(h.type==="block-seq"?r(l,"BLOCK_AS_IMPLICIT_KEY","A block sequence may not be used as an implicit map key"):"indent"in h&&h.indent!==s.indent&&r(l,"BAD_INDENT",ml)),!g.anchor&&!g.tag&&!p){c=g.end,g.comment&&(a.comment?a.comment+=`
`+g.comment:a.comment=g.comment);continue}(g.newlineAfterProp||Ps(h))&&r(h??f[f.length-1],"MULTILINE_IMPLICIT_KEY","Implicit keys need to be on a single line")}else g.found?.indent!==s.indent&&r(l,"BAD_INDENT",ml);n.atKey=!0;const m=g.end,S=h?t(n,h,g,r):e(n,m,f,null,g,r);n.schema.compat&&ro(s.indent,h,r),n.atKey=!1,Cu(n,a.items,S)&&r(m,"DUPLICATE_KEY","Map keys must be unique");const x=is(p??[],{indicator:"map-value-ind",next:y,offset:S.range[2],onError:r,parentIndent:s.indent,startOnNewline:!h||h.type==="block-scalar"});if(l=x.end,x.found){w&&(y?.type==="block-map"&&!x.hasNewline&&r(l,"BLOCK_AS_IMPLICIT_KEY","Nested mappings are not allowed in compact mappings"),n.options.strict&&g.start<x.found.offset-1024&&r(S.range,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit block mapping key"));const _=y?t(n,y,x,r):e(n,l,p,null,x,r);n.schema.compat&&ro(s.indent,y,r),l=_.range[2];const E=new qe(S,_);n.options.keepSourceTokens&&(E.srcToken=u),a.items.push(E)}else{w&&r(S.range,"MISSING_CHAR","Implicit map keys need to be followed by map values"),x.comment&&(S.comment?S.comment+=`
`+x.comment:S.comment=x.comment);const _=new qe(S);n.options.keepSourceTokens&&(_.srcToken=u),a.items.push(_)}}return c&&c<l&&r(c,"IMPOSSIBLE","Map comment with trailing content"),a.range=[s.offset,l,c??l],a}function Uv({composeNode:t,composeEmptyNode:e},n,s,r,i){const o=i?.nodeClass??An,a=new o(n.schema);n.atRoot&&(n.atRoot=!1),n.atKey&&(n.atKey=!1);let l=s.offset,c=null;for(const{start:u,value:f}of s.items){const h=is(u,{indicator:"seq-item-ind",next:f,offset:l,onError:r,parentIndent:s.indent,startOnNewline:!0});if(!h.found)if(h.anchor||h.tag||f)f&&f.type==="block-seq"?r(h.end,"BAD_INDENT","All sequence items must start at the same column"):r(l,"MISSING_CHAR","Sequence item without - indicator");else{c=h.end,h.comment&&(a.comment=h.comment);continue}const p=f?t(n,f,h,r):e(n,h.end,u,null,h,r);n.schema.compat&&ro(s.indent,f,r),l=p.range[2],a.items.push(p)}return a.range=[s.offset,l,c??l],a}function Vs(t,e,n,s){let r="";if(t){let i=!1,o="";for(const a of t){const{source:l,type:c}=a;switch(c){case"space":i=!0;break;case"comment":{n&&!i&&s(a,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");const u=l.substring(1)||" ";r?r+=o+u:r=u,o="";break}case"newline":r&&(o+=l),i=!0;break;default:s(a,"UNEXPECTED_TOKEN",`Unexpected ${c} at node end`)}e+=l.length}}return{comment:r,offset:e}}const xi="Block collections are not allowed within flow collections",_i=t=>t&&(t.type==="block-map"||t.type==="block-seq");function Zv({composeNode:t,composeEmptyNode:e},n,s,r,i){const o=s.start.source==="{",a=o?"flow map":"flow sequence",l=i?.nodeClass??(o?rt:An),c=new l(n.schema);c.flow=!0;const u=n.atRoot;u&&(n.atRoot=!1),n.atKey&&(n.atKey=!1);let f=s.offset+s.start.source.length;for(let w=0;w<s.items.length;++w){const m=s.items[w],{start:S,key:x,sep:_,value:E}=m,k=is(S,{flow:a,indicator:"explicit-key-ind",next:x??_?.[0],offset:f,onError:r,parentIndent:s.indent,startOnNewline:!1});if(!k.found){if(!k.anchor&&!k.tag&&!_&&!E){w===0&&k.comma?r(k.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${a}`):w<s.items.length-1&&r(k.start,"UNEXPECTED_TOKEN",`Unexpected empty item in ${a}`),k.comment&&(c.comment?c.comment+=`
`+k.comment:c.comment=k.comment),f=k.end;continue}!o&&n.options.strict&&Ps(x)&&r(x,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line")}if(w===0)k.comma&&r(k.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${a}`);else if(k.comma||r(k.start,"MISSING_CHAR",`Missing , between ${a} items`),k.comment){let b="";e:for(const v of S)switch(v.type){case"comma":case"space":break;case"comment":b=v.source.substring(1);break e;default:break e}if(b){let v=c.items[c.items.length-1];Te(v)&&(v=v.value??v.key),v.comment?v.comment+=`
`+b:v.comment=b,k.comment=k.comment.substring(b.length+1)}}if(!o&&!_&&!k.found){const b=E?t(n,E,k,r):e(n,k.end,_,null,k,r);c.items.push(b),f=b.range[2],_i(E)&&r(b.range,"BLOCK_IN_FLOW",xi)}else{n.atKey=!0;const b=k.end,v=x?t(n,x,k,r):e(n,b,S,null,k,r);_i(x)&&r(v.range,"BLOCK_IN_FLOW",xi),n.atKey=!1;const T=is(_??[],{flow:a,indicator:"map-value-ind",next:E,offset:v.range[2],onError:r,parentIndent:s.indent,startOnNewline:!1});if(T.found){if(!o&&!k.found&&n.options.strict){if(_)for(const N of _){if(N===T.found)break;if(N.type==="newline"){r(N,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line");break}}k.start<T.found.offset-1024&&r(T.found,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit flow sequence key")}}else E&&("source"in E&&E.source&&E.source[0]===":"?r(E,"MISSING_CHAR",`Missing space after : in ${a}`):r(T.start,"MISSING_CHAR",`Missing , or : between ${a} items`));const A=E?t(n,E,T,r):T.found?e(n,T.end,_,null,T,r):null;A?_i(E)&&r(A.range,"BLOCK_IN_FLOW",xi):T.comment&&(v.comment?v.comment+=`
`+T.comment:v.comment=T.comment);const O=new qe(v,A);if(n.options.keepSourceTokens&&(O.srcToken=m),o){const N=c;Cu(n,N.items,v)&&r(b,"DUPLICATE_KEY","Map keys must be unique"),N.items.push(O)}else{const N=new rt(n.schema);N.flow=!0,N.items.push(O);const M=(A??v).range;N.range=[v.range[0],M[1],M[2]],c.items.push(N)}f=A?A.range[2]:T.end}}const h=o?"}":"]",[p,...y]=s.end;let g=f;if(p&&p.source===h)g=p.offset+p.source.length;else{const w=a[0].toUpperCase()+a.substring(1),m=u?`${w} must end with a ${h}`:`${w} in block collection must be sufficiently indented and end with a ${h}`;r(f,u?"MISSING_CHAR":"BAD_INDENT",m),p&&p.source.length!==1&&y.unshift(p)}if(y.length>0){const w=Vs(y,g,n.options.strict,r);w.comment&&(c.comment?c.comment+=`
`+w.comment:c.comment=w.comment),c.range=[s.offset,g,w.offset]}else c.range=[s.offset,g,g];return c}function Ei(t,e,n,s,r,i){const o=n.type==="block-map"?Bv(t,e,n,s,i):n.type==="block-seq"?Uv(t,e,n,s,i):Zv(t,e,n,s,i),a=o.constructor;return r==="!"||r===a.tagName?(o.tag=a.tagName,o):(r&&(o.tag=r),o)}function Vv(t,e,n,s,r){const i=s.tag,o=i?e.directives.tagName(i.source,h=>r(i,"TAG_RESOLVE_FAILED",h)):null;if(n.type==="block-seq"){const{anchor:h,newlineAfterProp:p}=s,y=h&&i?h.offset>i.offset?h:i:h??i;y&&(!p||p.offset<y.offset)&&r(y,"MISSING_CHAR","Missing newline after block sequence props")}const a=n.type==="block-map"?"map":n.type==="block-seq"?"seq":n.start.source==="{"?"map":"seq";if(!i||!o||o==="!"||o===rt.tagName&&a==="map"||o===An.tagName&&a==="seq")return Ei(t,e,n,r,o);let l=e.schema.tags.find(h=>h.tag===o&&h.collection===a);if(!l){const h=e.schema.knownTags[o];if(h&&h.collection===a)e.schema.tags.push(Object.assign({},h,{default:!1})),l=h;else return h?r(i,"BAD_COLLECTION_TYPE",`${h.tag} used for ${a} collection, but expects ${h.collection??"scalar"}`,!0):r(i,"TAG_RESOLVE_FAILED",`Unresolved tag: ${o}`,!0),Ei(t,e,n,r,o)}const c=Ei(t,e,n,r,o,l),u=l.resolve?.(c,h=>r(i,"TAG_RESOLVE_FAILED",h),e.options)??c,f=ke(u)?u:new q(u);return f.range=c.range,f.tag=o,l?.format&&(f.format=l.format),f}function Wv(t,e,n){const s=e.offset,r=qv(e,t.options.strict,n);if(!r)return{value:"",type:null,comment:"",range:[s,s,s]};const i=r.mode===">"?q.BLOCK_FOLDED:q.BLOCK_LITERAL,o=e.source?Yv(e.source):[];let a=o.length;for(let g=o.length-1;g>=0;--g){const w=o[g][1];if(w===""||w==="\r")a=g;else break}if(a===0){const g=r.chomp==="+"&&o.length>0?`
`.repeat(Math.max(1,o.length-1)):"";let w=s+r.length;return e.source&&(w+=e.source.length),{value:g,type:i,comment:r.comment,range:[s,w,w]}}let l=e.indent+r.indent,c=e.offset+r.length,u=0;for(let g=0;g<a;++g){const[w,m]=o[g];if(m===""||m==="\r")r.indent===0&&w.length>l&&(l=w.length);else{w.length<l&&n(c+w.length,"MISSING_CHAR","Block scalars with more-indented leading empty lines must use an explicit indentation indicator"),r.indent===0&&(l=w.length),u=g,l===0&&!t.atRoot&&n(c,"BAD_INDENT","Block scalar values in collections must be indented");break}c+=w.length+m.length+1}for(let g=o.length-1;g>=a;--g)o[g][0].length>l&&(a=g+1);let f="",h="",p=!1;for(let g=0;g<u;++g)f+=o[g][0].slice(l)+`
`;for(let g=u;g<a;++g){let[w,m]=o[g];c+=w.length+m.length+1;const S=m[m.length-1]==="\r";if(S&&(m=m.slice(0,-1)),m&&w.length<l){const _=`Block scalar lines must not be less indented than their ${r.indent?"explicit indentation indicator":"first line"}`;n(c-m.length-(S?2:1),"BAD_INDENT",_),w=""}i===q.BLOCK_LITERAL?(f+=h+w.slice(l)+m,h=`
`):w.length>l||m[0]==="	"?(h===" "?h=`
`:!p&&h===`
`&&(h=`

`),f+=h+w.slice(l)+m,h=`
`,p=!0):m===""?h===`
`?f+=`
`:h=`
`:(f+=h+m,h=" ",p=!1)}switch(r.chomp){case"-":break;case"+":for(let g=a;g<o.length;++g)f+=`
`+o[g][0].slice(l);f[f.length-1]!==`
`&&(f+=`
`);break;default:f+=`
`}const y=s+r.length+e.source.length;return{value:f,type:i,comment:r.comment,range:[s,y,y]}}function qv({offset:t,props:e},n,s){if(e[0].type!=="block-scalar-header")return s(e[0],"IMPOSSIBLE","Block scalar header not found"),null;const{source:r}=e[0],i=r[0];let o=0,a="",l=-1;for(let h=1;h<r.length;++h){const p=r[h];if(!a&&(p==="-"||p==="+"))a=p;else{const y=Number(p);!o&&y?o=y:l===-1&&(l=t+h)}}l!==-1&&s(l,"UNEXPECTED_TOKEN",`Block scalar header includes extra characters: ${r}`);let c=!1,u="",f=r.length;for(let h=1;h<e.length;++h){const p=e[h];switch(p.type){case"space":c=!0;case"newline":f+=p.source.length;break;case"comment":n&&!c&&s(p,"MISSING_CHAR","Comments must be separated from other tokens by white space characters"),f+=p.source.length,u=p.source.substring(1);break;case"error":s(p,"UNEXPECTED_TOKEN",p.message),f+=p.source.length;break;default:{const y=`Unexpected token in block scalar header: ${p.type}`;s(p,"UNEXPECTED_TOKEN",y);const g=p.source;g&&typeof g=="string"&&(f+=g.length)}}}return{mode:i,indent:o,chomp:a,comment:u,length:f}}function Yv(t){const e=t.split(/\n( *)/),n=e[0],s=n.match(/^( *)/),i=[s?.[1]?[s[1],n.slice(s[1].length)]:["",n]];for(let o=1;o<e.length;o+=2)i.push([e[o],e[o+1]]);return i}function Gv(t,e,n){const{offset:s,type:r,source:i,end:o}=t;let a,l;const c=(h,p,y)=>n(s+h,p,y);switch(r){case"scalar":a=q.PLAIN,l=Kv(i,c);break;case"single-quoted-scalar":a=q.QUOTE_SINGLE,l=Hv(i,c);break;case"double-quoted-scalar":a=q.QUOTE_DOUBLE,l=Xv(i,c);break;default:return n(t,"UNEXPECTED_TOKEN",`Expected a flow scalar value, but found: ${r}`),{value:"",type:null,comment:"",range:[s,s+i.length,s+i.length]}}const u=s+i.length,f=Vs(o,u,e,n);return{value:l,type:a,comment:f.comment,range:[s,u,f.offset]}}function Kv(t,e){let n="";switch(t[0]){case"	":n="a tab character";break;case",":n="flow indicator character ,";break;case"%":n="directive indicator character %";break;case"|":case">":{n=`block scalar indicator ${t[0]}`;break}case"@":case"`":{n=`reserved character ${t[0]}`;break}}return n&&e(0,"BAD_SCALAR_START",`Plain value cannot start with ${n}`),Iu(t)}function Hv(t,e){return(t[t.length-1]!=="'"||t.length===1)&&e(t.length,"MISSING_CHAR","Missing closing 'quote"),Iu(t.slice(1,-1)).replace(/''/g,"'")}function Iu(t){let e,n;try{e=new RegExp(`(.*?)(?<![ 	])[ 	]*\r?
`,"sy"),n=new RegExp(`[ 	]*(.*?)(?:(?<![ 	])[ 	]*)?\r?
`,"sy")}catch{e=/(.*?)[ \t]*\r?\n/sy,n=/[ \t]*(.*?)[ \t]*\r?\n/sy}let s=e.exec(t);if(!s)return t;let r=s[1],i=" ",o=e.lastIndex;for(n.lastIndex=o;s=n.exec(t);)s[1]===""?i===`
`?r+=i:i=`
`:(r+=i+s[1],i=" "),o=n.lastIndex;const a=/[ \t]*(.*)/sy;return a.lastIndex=o,s=a.exec(t),r+i+(s?.[1]??"")}function Xv(t,e){let n="";for(let s=1;s<t.length-1;++s){const r=t[s];if(!(r==="\r"&&t[s+1]===`
`))if(r===`
`){const{fold:i,offset:o}=Qv(t,s);n+=i,s=o}else if(r==="\\"){let i=t[++s];const o=Jv[i];if(o)n+=o;else if(i===`
`)for(i=t[s+1];i===" "||i==="	";)i=t[++s+1];else if(i==="\r"&&t[s+1]===`
`)for(i=t[++s+1];i===" "||i==="	";)i=t[++s+1];else if(i==="x"||i==="u"||i==="U"){const a={x:2,u:4,U:8}[i];n+=e2(t,s+1,a,e),s+=a}else{const a=t.substr(s-1,2);e(s-1,"BAD_DQ_ESCAPE",`Invalid escape sequence ${a}`),n+=a}}else if(r===" "||r==="	"){const i=s;let o=t[s+1];for(;o===" "||o==="	";)o=t[++s+1];o!==`
`&&!(o==="\r"&&t[s+2]===`
`)&&(n+=s>i?t.slice(i,s+1):r)}else n+=r}return(t[t.length-1]!=='"'||t.length===1)&&e(t.length,"MISSING_CHAR",'Missing closing "quote'),n}function Qv(t,e){let n="",s=t[e+1];for(;(s===" "||s==="	"||s===`
`||s==="\r")&&!(s==="\r"&&t[e+2]!==`
`);)s===`
`&&(n+=`
`),e+=1,s=t[e+1];return n||(n=" "),{fold:n,offset:e}}const Jv={0:"\0",a:"\x07",b:"\b",e:"\x1B",f:"\f",n:`
`,r:"\r",t:"	",v:"\v",N:"",_:" ",L:"\u2028",P:"\u2029"," ":" ",'"':'"',"/":"/","\\":"\\","	":"	"};function e2(t,e,n,s){const r=t.substr(e,n),o=r.length===n&&/^[0-9a-fA-F]+$/.test(r)?parseInt(r,16):NaN;if(isNaN(o)){const a=t.substr(e-2,n+2);return s(e-2,"BAD_DQ_ESCAPE",`Invalid escape sequence ${a}`),a}return String.fromCodePoint(o)}function Mu(t,e,n,s){const{value:r,type:i,comment:o,range:a}=e.type==="block-scalar"?Wv(t,e,s):Gv(e,t.options.strict,s),l=n?t.directives.tagName(n.source,f=>s(n,"TAG_RESOLVE_FAILED",f)):null;let c;t.options.stringKeys&&t.atKey?c=t.schema[Mt]:l?c=t2(t.schema,r,l,n,s):e.type==="scalar"?c=n2(t,r,e,s):c=t.schema[Mt];let u;try{const f=c.resolve(r,h=>s(n??e,"TAG_RESOLVE_FAILED",h),t.options);u=pe(f)?f:new q(f)}catch(f){const h=f instanceof Error?f.message:String(f);s(n??e,"TAG_RESOLVE_FAILED",h),u=new q(r)}return u.range=a,u.source=r,i&&(u.type=i),l&&(u.tag=l),c.format&&(u.format=c.format),o&&(u.comment=o),u}function t2(t,e,n,s,r){if(n==="!")return t[Mt];const i=[];for(const a of t.tags)if(!a.collection&&a.tag===n)if(a.default&&a.test)i.push(a);else return a;for(const a of i)if(a.test?.test(e))return a;const o=t.knownTags[n];return o&&!o.collection?(t.tags.push(Object.assign({},o,{default:!1,test:void 0})),o):(r(s,"TAG_RESOLVE_FAILED",`Unresolved tag: ${n}`,n!=="tag:yaml.org,2002:str"),t[Mt])}function n2({atKey:t,directives:e,schema:n},s,r,i){const o=n.tags.find(a=>(a.default===!0||t&&a.default==="key")&&a.test?.test(s))||n[Mt];if(n.compat){const a=n.compat.find(l=>l.default&&l.test?.test(s))??n[Mt];if(o.tag!==a.tag){const l=e.tagString(o.tag),c=e.tagString(a.tag),u=`Value may be parsed as either ${l} or ${c}`;i(r,"TAG_RESOLVE_FAILED",u,!0)}}return o}function s2(t,e,n){if(e){n??(n=e.length);for(let s=n-1;s>=0;--s){let r=e[s];switch(r.type){case"space":case"comment":case"newline":t-=r.source.length;continue}for(r=e[++s];r?.type==="space";)t+=r.source.length,r=e[++s];break}}return t}const r2={composeNode:ju,composeEmptyNode:Zo};function ju(t,e,n,s){const r=t.atKey,{spaceBefore:i,comment:o,anchor:a,tag:l}=n;let c,u=!0;switch(e.type){case"alias":c=i2(t,e,s),(a||l)&&s(e,"ALIAS_PROPS","An alias node must not specify any properties");break;case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"block-scalar":c=Mu(t,e,l,s),a&&(c.anchor=a.source.substring(1));break;case"block-map":case"block-seq":case"flow-collection":c=Vv(r2,t,e,n,s),a&&(c.anchor=a.source.substring(1));break;default:{const f=e.type==="error"?e.message:`Unsupported token (type: ${e.type})`;s(e,"UNEXPECTED_TOKEN",f),c=Zo(t,e.offset,void 0,null,n,s),u=!1}}return a&&c.anchor===""&&s(a,"BAD_ALIAS","Anchor cannot be an empty string"),r&&t.options.stringKeys&&(!pe(c)||typeof c.value!="string"||c.tag&&c.tag!=="tag:yaml.org,2002:str")&&s(l??e,"NON_STRING_KEY","With stringKeys, all keys must be strings"),i&&(c.spaceBefore=!0),o&&(e.type==="scalar"&&e.source===""?c.comment=o:c.commentBefore=o),t.options.keepSourceTokens&&u&&(c.srcToken=e),c}function Zo(t,e,n,s,{spaceBefore:r,comment:i,anchor:o,tag:a,end:l},c){const u={type:"scalar",offset:s2(e,n,s),indent:-1,source:""},f=Mu(t,u,a,c);return o&&(f.anchor=o.source.substring(1),f.anchor===""&&c(o,"BAD_ALIAS","Anchor cannot be an empty string")),r&&(f.spaceBefore=!0),i&&(f.comment=i,f.range[2]=l),f}function i2({options:t},{offset:e,source:n,end:s},r){const i=new Io(n.substring(1));i.source===""&&r(e,"BAD_ALIAS","Alias cannot be an empty string"),i.source.endsWith(":")&&r(e+n.length-1,"BAD_ALIAS","Alias ending in : is ambiguous",!0);const o=e+n.length,a=Vs(s,o,t.strict,r);return i.range=[e,o,a.offset],a.comment&&(i.comment=a.comment),i}function o2(t,e,{offset:n,start:s,value:r,end:i},o){const a=Object.assign({_directives:e},t),l=new ii(void 0,a),c={atKey:!1,atRoot:!0,directives:l.directives,options:l.options,schema:l.schema},u=is(s,{indicator:"doc-start",next:r??i?.[0],offset:n,onError:o,parentIndent:0,startOnNewline:!0});u.found&&(l.directives.docStart=!0,r&&(r.type==="block-map"||r.type==="block-seq")&&!u.hasNewline&&o(u.end,"MISSING_CHAR","Block collection cannot start on same line with directives-end marker")),l.contents=r?ju(c,r,u,o):Zo(c,u.end,s,null,u,o);const f=l.contents.range[2],h=Vs(i,f,!1,o);return h.comment&&(l.comment=h.comment),l.range=[n,f,h.offset],l}function gs(t){if(typeof t=="number")return[t,t+1];if(Array.isArray(t))return t.length===2?t:[t[0],t[1]];const{offset:e,source:n}=t;return[e,e+(typeof n=="string"?n.length:1)]}function gl(t){let e="",n=!1,s=!1;for(let r=0;r<t.length;++r){const i=t[r];switch(i[0]){case"#":e+=(e===""?"":s?`

`:`
`)+(i.substring(1)||" "),n=!0,s=!1;break;case"%":t[r+1]?.[0]!=="#"&&(r+=1),n=!1;break;default:n||(s=!0),n=!1}}return{comment:e,afterEmptyLine:s}}class a2{constructor(e={}){this.doc=null,this.atDirectives=!1,this.prelude=[],this.errors=[],this.warnings=[],this.onError=(n,s,r,i)=>{const o=gs(n);i?this.warnings.push(new Fv(o,s,r)):this.errors.push(new bs(o,s,r))},this.directives=new Ve({version:e.version||"1.2"}),this.options=e}decorate(e,n){const{comment:s,afterEmptyLine:r}=gl(this.prelude);if(s){const i=e.contents;if(n)e.comment=e.comment?`${e.comment}
${s}`:s;else if(r||e.directives.docStart||!i)e.commentBefore=s;else if(Se(i)&&!i.flow&&i.items.length>0){let o=i.items[0];Te(o)&&(o=o.key);const a=o.commentBefore;o.commentBefore=a?`${s}
${a}`:s}else{const o=i.commentBefore;i.commentBefore=o?`${s}
${o}`:s}}n?(Array.prototype.push.apply(e.errors,this.errors),Array.prototype.push.apply(e.warnings,this.warnings)):(e.errors=this.errors,e.warnings=this.warnings),this.prelude=[],this.errors=[],this.warnings=[]}streamInfo(){return{comment:gl(this.prelude).comment,directives:this.directives,errors:this.errors,warnings:this.warnings}}*compose(e,n=!1,s=-1){for(const r of e)yield*this.next(r);yield*this.end(n,s)}*next(e){switch(e.type){case"directive":this.directives.add(e.source,(n,s,r)=>{const i=gs(e);i[0]+=n,this.onError(i,"BAD_DIRECTIVE",s,r)}),this.prelude.push(e.source),this.atDirectives=!0;break;case"document":{const n=o2(this.options,this.directives,e,this.onError);this.atDirectives&&!n.directives.docStart&&this.onError(e,"MISSING_CHAR","Missing directives-end/doc-start indicator line"),this.decorate(n,!1),this.doc&&(yield this.doc),this.doc=n,this.atDirectives=!1;break}case"byte-order-mark":case"space":break;case"comment":case"newline":this.prelude.push(e.source);break;case"error":{const n=e.source?`${e.message}: ${JSON.stringify(e.source)}`:e.message,s=new bs(gs(e),"UNEXPECTED_TOKEN",n);this.atDirectives||!this.doc?this.errors.push(s):this.doc.errors.push(s);break}case"doc-end":{if(!this.doc){const s="Unexpected doc-end without preceding document";this.errors.push(new bs(gs(e),"UNEXPECTED_TOKEN",s));break}this.doc.directives.docEnd=!0;const n=Vs(e.end,e.offset+e.source.length,this.doc.options.strict,this.onError);if(this.decorate(this.doc,!0),n.comment){const s=this.doc.comment;this.doc.comment=s?`${s}
${n.comment}`:n.comment}this.doc.range[2]=n.offset;break}default:this.errors.push(new bs(gs(e),"UNEXPECTED_TOKEN",`Unsupported token ${e.type}`))}}*end(e=!1,n=-1){if(this.doc)this.decorate(this.doc,!0),yield this.doc,this.doc=null;else if(e){const s=Object.assign({_directives:this.directives},this.options),r=new ii(void 0,s);this.atDirectives&&this.onError(n,"MISSING_CHAR","Missing directives-end indicator line"),r.range=[0,n,n],this.decorate(r,!1),yield r}}}const Ru="\uFEFF",Pu="",$u="",io="";function l2(t){switch(t){case Ru:return"byte-order-mark";case Pu:return"doc-mode";case $u:return"flow-error-end";case io:return"scalar";case"---":return"doc-start";case"...":return"doc-end";case"":case`
`:case`\r
`:return"newline";case"-":return"seq-item-ind";case"?":return"explicit-key-ind";case":":return"map-value-ind";case"{":return"flow-map-start";case"}":return"flow-map-end";case"[":return"flow-seq-start";case"]":return"flow-seq-end";case",":return"comma"}switch(t[0]){case" ":case"	":return"space";case"#":return"comment";case"%":return"directive-line";case"*":return"alias";case"&":return"anchor";case"!":return"tag";case"'":return"single-quoted-scalar";case'"':return"double-quoted-scalar";case"|":case">":return"block-scalar-header"}return null}function gt(t){switch(t){case void 0:case" ":case`
`:case"\r":case"	":return!0;default:return!1}}const yl=new Set("0123456789ABCDEFabcdef"),c2=new Set("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-#;/?:@&=+$_.!~*'()"),dr=new Set(",[]{}"),u2=new Set(` ,[]{}
\r	`),Si=t=>!t||u2.has(t);class f2{constructor(){this.atEnd=!1,this.blockScalarIndent=-1,this.blockScalarKeep=!1,this.buffer="",this.flowKey=!1,this.flowLevel=0,this.indentNext=0,this.indentValue=0,this.lineEndPos=null,this.next=null,this.pos=0}*lex(e,n=!1){if(e){if(typeof e!="string")throw TypeError("source is not a string");this.buffer=this.buffer?this.buffer+e:e,this.lineEndPos=null}this.atEnd=!n;let s=this.next??"stream";for(;s&&(n||this.hasChars(1));)s=yield*this.parseNext(s)}atLineEnd(){let e=this.pos,n=this.buffer[e];for(;n===" "||n==="	";)n=this.buffer[++e];return!n||n==="#"||n===`
`?!0:n==="\r"?this.buffer[e+1]===`
`:!1}charAt(e){return this.buffer[this.pos+e]}continueScalar(e){let n=this.buffer[e];if(this.indentNext>0){let s=0;for(;n===" ";)n=this.buffer[++s+e];if(n==="\r"){const r=this.buffer[s+e+1];if(r===`
`||!r&&!this.atEnd)return e+s+1}return n===`
`||s>=this.indentNext||!n&&!this.atEnd?e+s:-1}if(n==="-"||n==="."){const s=this.buffer.substr(e,3);if((s==="---"||s==="...")&&gt(this.buffer[e+3]))return-1}return e}getLine(){let e=this.lineEndPos;return(typeof e!="number"||e!==-1&&e<this.pos)&&(e=this.buffer.indexOf(`
`,this.pos),this.lineEndPos=e),e===-1?this.atEnd?this.buffer.substring(this.pos):null:(this.buffer[e-1]==="\r"&&(e-=1),this.buffer.substring(this.pos,e))}hasChars(e){return this.pos+e<=this.buffer.length}setNext(e){return this.buffer=this.buffer.substring(this.pos),this.pos=0,this.lineEndPos=null,this.next=e,null}peek(e){return this.buffer.substr(this.pos,e)}*parseNext(e){switch(e){case"stream":return yield*this.parseStream();case"line-start":return yield*this.parseLineStart();case"block-start":return yield*this.parseBlockStart();case"doc":return yield*this.parseDocument();case"flow":return yield*this.parseFlowCollection();case"quoted-scalar":return yield*this.parseQuotedScalar();case"block-scalar":return yield*this.parseBlockScalar();case"plain-scalar":return yield*this.parsePlainScalar()}}*parseStream(){let e=this.getLine();if(e===null)return this.setNext("stream");if(e[0]===Ru&&(yield*this.pushCount(1),e=e.substring(1)),e[0]==="%"){let n=e.length,s=e.indexOf("#");for(;s!==-1;){const i=e[s-1];if(i===" "||i==="	"){n=s-1;break}else s=e.indexOf("#",s+1)}for(;;){const i=e[n-1];if(i===" "||i==="	")n-=1;else break}const r=(yield*this.pushCount(n))+(yield*this.pushSpaces(!0));return yield*this.pushCount(e.length-r),this.pushNewline(),"stream"}if(this.atLineEnd()){const n=yield*this.pushSpaces(!0);return yield*this.pushCount(e.length-n),yield*this.pushNewline(),"stream"}return yield Pu,yield*this.parseLineStart()}*parseLineStart(){const e=this.charAt(0);if(!e&&!this.atEnd)return this.setNext("line-start");if(e==="-"||e==="."){if(!this.atEnd&&!this.hasChars(4))return this.setNext("line-start");const n=this.peek(3);if((n==="---"||n==="...")&&gt(this.charAt(3)))return yield*this.pushCount(3),this.indentValue=0,this.indentNext=0,n==="---"?"doc":"stream"}return this.indentValue=yield*this.pushSpaces(!1),this.indentNext>this.indentValue&&!gt(this.charAt(1))&&(this.indentNext=this.indentValue),yield*this.parseBlockStart()}*parseBlockStart(){const[e,n]=this.peek(2);if(!n&&!this.atEnd)return this.setNext("block-start");if((e==="-"||e==="?"||e===":")&&gt(n)){const s=(yield*this.pushCount(1))+(yield*this.pushSpaces(!0));return this.indentNext=this.indentValue+1,this.indentValue+=s,yield*this.parseBlockStart()}return"doc"}*parseDocument(){yield*this.pushSpaces(!0);const e=this.getLine();if(e===null)return this.setNext("doc");let n=yield*this.pushIndicators();switch(e[n]){case"#":yield*this.pushCount(e.length-n);case void 0:return yield*this.pushNewline(),yield*this.parseLineStart();case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel=1,"flow";case"}":case"]":return yield*this.pushCount(1),"doc";case"*":return yield*this.pushUntil(Si),"doc";case'"':case"'":return yield*this.parseQuotedScalar();case"|":case">":return n+=yield*this.parseBlockScalarHeader(),n+=yield*this.pushSpaces(!0),yield*this.pushCount(e.length-n),yield*this.pushNewline(),yield*this.parseBlockScalar();default:return yield*this.parsePlainScalar()}}*parseFlowCollection(){let e,n,s=-1;do e=yield*this.pushNewline(),e>0?(n=yield*this.pushSpaces(!1),this.indentValue=s=n):n=0,n+=yield*this.pushSpaces(!0);while(e+n>0);const r=this.getLine();if(r===null)return this.setNext("flow");if((s!==-1&&s<this.indentNext&&r[0]!=="#"||s===0&&(r.startsWith("---")||r.startsWith("..."))&&gt(r[3]))&&!(s===this.indentNext-1&&this.flowLevel===1&&(r[0]==="]"||r[0]==="}")))return this.flowLevel=0,yield $u,yield*this.parseLineStart();let i=0;for(;r[i]===",";)i+=yield*this.pushCount(1),i+=yield*this.pushSpaces(!0),this.flowKey=!1;switch(i+=yield*this.pushIndicators(),r[i]){case void 0:return"flow";case"#":return yield*this.pushCount(r.length-i),"flow";case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel+=1,"flow";case"}":case"]":return yield*this.pushCount(1),this.flowKey=!0,this.flowLevel-=1,this.flowLevel?"flow":"doc";case"*":return yield*this.pushUntil(Si),"flow";case'"':case"'":return this.flowKey=!0,yield*this.parseQuotedScalar();case":":{const o=this.charAt(1);if(this.flowKey||gt(o)||o===",")return this.flowKey=!1,yield*this.pushCount(1),yield*this.pushSpaces(!0),"flow"}default:return this.flowKey=!1,yield*this.parsePlainScalar()}}*parseQuotedScalar(){const e=this.charAt(0);let n=this.buffer.indexOf(e,this.pos+1);if(e==="'")for(;n!==-1&&this.buffer[n+1]==="'";)n=this.buffer.indexOf("'",n+2);else for(;n!==-1;){let i=0;for(;this.buffer[n-1-i]==="\\";)i+=1;if(i%2===0)break;n=this.buffer.indexOf('"',n+1)}const s=this.buffer.substring(0,n);let r=s.indexOf(`
`,this.pos);if(r!==-1){for(;r!==-1;){const i=this.continueScalar(r+1);if(i===-1)break;r=s.indexOf(`
`,i)}r!==-1&&(n=r-(s[r-1]==="\r"?2:1))}if(n===-1){if(!this.atEnd)return this.setNext("quoted-scalar");n=this.buffer.length}return yield*this.pushToIndex(n+1,!1),this.flowLevel?"flow":"doc"}*parseBlockScalarHeader(){this.blockScalarIndent=-1,this.blockScalarKeep=!1;let e=this.pos;for(;;){const n=this.buffer[++e];if(n==="+")this.blockScalarKeep=!0;else if(n>"0"&&n<="9")this.blockScalarIndent=Number(n)-1;else if(n!=="-")break}return yield*this.pushUntil(n=>gt(n)||n==="#")}*parseBlockScalar(){let e=this.pos-1,n=0,s;e:for(let i=this.pos;s=this.buffer[i];++i)switch(s){case" ":n+=1;break;case`
`:e=i,n=0;break;case"\r":{const o=this.buffer[i+1];if(!o&&!this.atEnd)return this.setNext("block-scalar");if(o===`
`)break}default:break e}if(!s&&!this.atEnd)return this.setNext("block-scalar");if(n>=this.indentNext){this.blockScalarIndent===-1?this.indentNext=n:this.indentNext=this.blockScalarIndent+(this.indentNext===0?1:this.indentNext);do{const i=this.continueScalar(e+1);if(i===-1)break;e=this.buffer.indexOf(`
`,i)}while(e!==-1);if(e===-1){if(!this.atEnd)return this.setNext("block-scalar");e=this.buffer.length}}let r=e+1;for(s=this.buffer[r];s===" ";)s=this.buffer[++r];if(s==="	"){for(;s==="	"||s===" "||s==="\r"||s===`
`;)s=this.buffer[++r];e=r-1}else if(!this.blockScalarKeep)do{let i=e-1,o=this.buffer[i];o==="\r"&&(o=this.buffer[--i]);const a=i;for(;o===" ";)o=this.buffer[--i];if(o===`
`&&i>=this.pos&&i+1+n>a)e=i;else break}while(!0);return yield io,yield*this.pushToIndex(e+1,!0),yield*this.parseLineStart()}*parsePlainScalar(){const e=this.flowLevel>0;let n=this.pos-1,s=this.pos-1,r;for(;r=this.buffer[++s];)if(r===":"){const i=this.buffer[s+1];if(gt(i)||e&&dr.has(i))break;n=s}else if(gt(r)){let i=this.buffer[s+1];if(r==="\r"&&(i===`
`?(s+=1,r=`
`,i=this.buffer[s+1]):n=s),i==="#"||e&&dr.has(i))break;if(r===`
`){const o=this.continueScalar(s+1);if(o===-1)break;s=Math.max(s,o-2)}}else{if(e&&dr.has(r))break;n=s}return!r&&!this.atEnd?this.setNext("plain-scalar"):(yield io,yield*this.pushToIndex(n+1,!0),e?"flow":"doc")}*pushCount(e){return e>0?(yield this.buffer.substr(this.pos,e),this.pos+=e,e):0}*pushToIndex(e,n){const s=this.buffer.slice(this.pos,e);return s?(yield s,this.pos+=s.length,s.length):(n&&(yield""),0)}*pushIndicators(){switch(this.charAt(0)){case"!":return(yield*this.pushTag())+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"&":return(yield*this.pushUntil(Si))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"-":case"?":case":":{const e=this.flowLevel>0,n=this.charAt(1);if(gt(n)||e&&dr.has(n))return e?this.flowKey&&(this.flowKey=!1):this.indentNext=this.indentValue+1,(yield*this.pushCount(1))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators())}}return 0}*pushTag(){if(this.charAt(1)==="<"){let e=this.pos+2,n=this.buffer[e];for(;!gt(n)&&n!==">";)n=this.buffer[++e];return yield*this.pushToIndex(n===">"?e+1:e,!1)}else{let e=this.pos+1,n=this.buffer[e];for(;n;)if(c2.has(n))n=this.buffer[++e];else if(n==="%"&&yl.has(this.buffer[e+1])&&yl.has(this.buffer[e+2]))n=this.buffer[e+=3];else break;return yield*this.pushToIndex(e,!1)}}*pushNewline(){const e=this.buffer[this.pos];return e===`
`?yield*this.pushCount(1):e==="\r"&&this.charAt(1)===`
`?yield*this.pushCount(2):0}*pushSpaces(e){let n=this.pos-1,s;do s=this.buffer[++n];while(s===" "||e&&s==="	");const r=n-this.pos;return r>0&&(yield this.buffer.substr(this.pos,r),this.pos=n),r}*pushUntil(e){let n=this.pos,s=this.buffer[n];for(;!e(s);)s=this.buffer[++n];return yield*this.pushToIndex(n,!1)}}class h2{constructor(){this.lineStarts=[],this.addNewLine=e=>this.lineStarts.push(e),this.linePos=e=>{let n=0,s=this.lineStarts.length;for(;n<s;){const i=n+s>>1;this.lineStarts[i]<e?n=i+1:s=i}if(this.lineStarts[n]===e)return{line:n+1,col:1};if(n===0)return{line:0,col:e};const r=this.lineStarts[n-1];return{line:n,col:e-r+1}}}}function Yt(t,e){for(let n=0;n<t.length;++n)if(t[n].type===e)return!0;return!1}function bl(t){for(let e=0;e<t.length;++e)switch(t[e].type){case"space":case"comment":case"newline":break;default:return e}return-1}function Du(t){switch(t?.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"flow-collection":return!0;default:return!1}}function pr(t){switch(t.type){case"document":return t.start;case"block-map":{const e=t.items[t.items.length-1];return e.sep??e.start}case"block-seq":return t.items[t.items.length-1].start;default:return[]}}function Ln(t){if(t.length===0)return[];let e=t.length;e:for(;--e>=0;)switch(t[e].type){case"doc-start":case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":case"newline":break e}for(;t[++e]?.type==="space";);return t.splice(e,t.length)}function wl(t){if(t.start.type==="flow-seq-start")for(const e of t.items)e.sep&&!e.value&&!Yt(e.start,"explicit-key-ind")&&!Yt(e.sep,"map-value-ind")&&(e.key&&(e.value=e.key),delete e.key,Du(e.value)?e.value.end?Array.prototype.push.apply(e.value.end,e.sep):e.value.end=e.sep:Array.prototype.push.apply(e.start,e.sep),delete e.sep)}class d2{constructor(e){this.atNewLine=!0,this.atScalar=!1,this.indent=0,this.offset=0,this.onKeyLine=!1,this.stack=[],this.source="",this.type="",this.lexer=new f2,this.onNewLine=e}*parse(e,n=!1){this.onNewLine&&this.offset===0&&this.onNewLine(0);for(const s of this.lexer.lex(e,n))yield*this.next(s);n||(yield*this.end())}*next(e){if(this.source=e,this.atScalar){this.atScalar=!1,yield*this.step(),this.offset+=e.length;return}const n=l2(e);if(n)if(n==="scalar")this.atNewLine=!1,this.atScalar=!0,this.type="scalar";else{switch(this.type=n,yield*this.step(),n){case"newline":this.atNewLine=!0,this.indent=0,this.onNewLine&&this.onNewLine(this.offset+e.length);break;case"space":this.atNewLine&&e[0]===" "&&(this.indent+=e.length);break;case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":this.atNewLine&&(this.indent+=e.length);break;case"doc-mode":case"flow-error-end":return;default:this.atNewLine=!1}this.offset+=e.length}else{const s=`Not a YAML token: ${e}`;yield*this.pop({type:"error",offset:this.offset,message:s,source:e}),this.offset+=e.length}}*end(){for(;this.stack.length>0;)yield*this.pop()}get sourceToken(){return{type:this.type,offset:this.offset,indent:this.indent,source:this.source}}*step(){const e=this.peek(1);if(this.type==="doc-end"&&(!e||e.type!=="doc-end")){for(;this.stack.length>0;)yield*this.pop();this.stack.push({type:"doc-end",offset:this.offset,source:this.source});return}if(!e)return yield*this.stream();switch(e.type){case"document":return yield*this.document(e);case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return yield*this.scalar(e);case"block-scalar":return yield*this.blockScalar(e);case"block-map":return yield*this.blockMap(e);case"block-seq":return yield*this.blockSequence(e);case"flow-collection":return yield*this.flowCollection(e);case"doc-end":return yield*this.documentEnd(e)}yield*this.pop()}peek(e){return this.stack[this.stack.length-e]}*pop(e){const n=e??this.stack.pop();if(!n)yield{type:"error",offset:this.offset,source:"",message:"Tried to pop an empty stack"};else if(this.stack.length===0)yield n;else{const s=this.peek(1);switch(n.type==="block-scalar"?n.indent="indent"in s?s.indent:0:n.type==="flow-collection"&&s.type==="document"&&(n.indent=0),n.type==="flow-collection"&&wl(n),s.type){case"document":s.value=n;break;case"block-scalar":s.props.push(n);break;case"block-map":{const r=s.items[s.items.length-1];if(r.value){s.items.push({start:[],key:n,sep:[]}),this.onKeyLine=!0;return}else if(r.sep)r.value=n;else{Object.assign(r,{key:n,sep:[]}),this.onKeyLine=!r.explicitKey;return}break}case"block-seq":{const r=s.items[s.items.length-1];r.value?s.items.push({start:[],value:n}):r.value=n;break}case"flow-collection":{const r=s.items[s.items.length-1];!r||r.value?s.items.push({start:[],key:n,sep:[]}):r.sep?r.value=n:Object.assign(r,{key:n,sep:[]});return}default:yield*this.pop(),yield*this.pop(n)}if((s.type==="document"||s.type==="block-map"||s.type==="block-seq")&&(n.type==="block-map"||n.type==="block-seq")){const r=n.items[n.items.length-1];r&&!r.sep&&!r.value&&r.start.length>0&&bl(r.start)===-1&&(n.indent===0||r.start.every(i=>i.type!=="comment"||i.indent<n.indent))&&(s.type==="document"?s.end=r.start:s.items.push({start:r.start}),n.items.splice(-1,1))}}}*stream(){switch(this.type){case"directive-line":yield{type:"directive",offset:this.offset,source:this.source};return;case"byte-order-mark":case"space":case"comment":case"newline":yield this.sourceToken;return;case"doc-mode":case"doc-start":{const e={type:"document",offset:this.offset,start:[]};this.type==="doc-start"&&e.start.push(this.sourceToken),this.stack.push(e);return}}yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML stream`,source:this.source}}*document(e){if(e.value)return yield*this.lineEnd(e);switch(this.type){case"doc-start":{bl(e.start)!==-1?(yield*this.pop(),yield*this.step()):e.start.push(this.sourceToken);return}case"anchor":case"tag":case"space":case"comment":case"newline":e.start.push(this.sourceToken);return}const n=this.startBlockValue(e);n?this.stack.push(n):yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML document`,source:this.source}}*scalar(e){if(this.type==="map-value-ind"){const n=pr(this.peek(2)),s=Ln(n);let r;e.end?(r=e.end,r.push(this.sourceToken),delete e.end):r=[this.sourceToken];const i={type:"block-map",offset:e.offset,indent:e.indent,items:[{start:s,key:e,sep:r}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=i}else yield*this.lineEnd(e)}*blockScalar(e){switch(this.type){case"space":case"comment":case"newline":e.props.push(this.sourceToken);return;case"scalar":if(e.source=this.source,this.atNewLine=!0,this.indent=0,this.onNewLine){let n=this.source.indexOf(`
`)+1;for(;n!==0;)this.onNewLine(this.offset+n),n=this.source.indexOf(`
`,n)+1}yield*this.pop();break;default:yield*this.pop(),yield*this.step()}}*blockMap(e){const n=e.items[e.items.length-1];switch(this.type){case"newline":if(this.onKeyLine=!1,n.value){const s="end"in n.value?n.value.end:void 0;(Array.isArray(s)?s[s.length-1]:void 0)?.type==="comment"?s?.push(this.sourceToken):e.items.push({start:[this.sourceToken]})}else n.sep?n.sep.push(this.sourceToken):n.start.push(this.sourceToken);return;case"space":case"comment":if(n.value)e.items.push({start:[this.sourceToken]});else if(n.sep)n.sep.push(this.sourceToken);else{if(this.atIndentedComment(n.start,e.indent)){const r=e.items[e.items.length-2]?.value?.end;if(Array.isArray(r)){Array.prototype.push.apply(r,n.start),r.push(this.sourceToken),e.items.pop();return}}n.start.push(this.sourceToken)}return}if(this.indent>=e.indent){const s=!this.onKeyLine&&this.indent===e.indent,r=s&&(n.sep||n.explicitKey)&&this.type!=="seq-item-ind";let i=[];if(r&&n.sep&&!n.value){const o=[];for(let a=0;a<n.sep.length;++a){const l=n.sep[a];switch(l.type){case"newline":o.push(a);break;case"space":break;case"comment":l.indent>e.indent&&(o.length=0);break;default:o.length=0}}o.length>=2&&(i=n.sep.splice(o[1]))}switch(this.type){case"anchor":case"tag":r||n.value?(i.push(this.sourceToken),e.items.push({start:i}),this.onKeyLine=!0):n.sep?n.sep.push(this.sourceToken):n.start.push(this.sourceToken);return;case"explicit-key-ind":!n.sep&&!n.explicitKey?(n.start.push(this.sourceToken),n.explicitKey=!0):r||n.value?(i.push(this.sourceToken),e.items.push({start:i,explicitKey:!0})):this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken],explicitKey:!0}]}),this.onKeyLine=!0;return;case"map-value-ind":if(n.explicitKey)if(n.sep)if(n.value)e.items.push({start:[],key:null,sep:[this.sourceToken]});else if(Yt(n.sep,"map-value-ind"))this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:i,key:null,sep:[this.sourceToken]}]});else if(Du(n.key)&&!Yt(n.sep,"newline")){const o=Ln(n.start),a=n.key,l=n.sep;l.push(this.sourceToken),delete n.key,delete n.sep,this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:o,key:a,sep:l}]})}else i.length>0?n.sep=n.sep.concat(i,this.sourceToken):n.sep.push(this.sourceToken);else if(Yt(n.start,"newline"))Object.assign(n,{key:null,sep:[this.sourceToken]});else{const o=Ln(n.start);this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:o,key:null,sep:[this.sourceToken]}]})}else n.sep?n.value||r?e.items.push({start:i,key:null,sep:[this.sourceToken]}):Yt(n.sep,"map-value-ind")?this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[],key:null,sep:[this.sourceToken]}]}):n.sep.push(this.sourceToken):Object.assign(n,{key:null,sep:[this.sourceToken]});this.onKeyLine=!0;return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{const o=this.flowScalar(this.type);r||n.value?(e.items.push({start:i,key:o,sep:[]}),this.onKeyLine=!0):n.sep?this.stack.push(o):(Object.assign(n,{key:o,sep:[]}),this.onKeyLine=!0);return}default:{const o=this.startBlockValue(e);if(o){if(o.type==="block-seq"){if(!n.explicitKey&&n.sep&&!Yt(n.sep,"newline")){yield*this.pop({type:"error",offset:this.offset,message:"Unexpected block-seq-ind on same line with key",source:this.source});return}}else s&&e.items.push({start:i});this.stack.push(o);return}}}}yield*this.pop(),yield*this.step()}*blockSequence(e){const n=e.items[e.items.length-1];switch(this.type){case"newline":if(n.value){const s="end"in n.value?n.value.end:void 0;(Array.isArray(s)?s[s.length-1]:void 0)?.type==="comment"?s?.push(this.sourceToken):e.items.push({start:[this.sourceToken]})}else n.start.push(this.sourceToken);return;case"space":case"comment":if(n.value)e.items.push({start:[this.sourceToken]});else{if(this.atIndentedComment(n.start,e.indent)){const r=e.items[e.items.length-2]?.value?.end;if(Array.isArray(r)){Array.prototype.push.apply(r,n.start),r.push(this.sourceToken),e.items.pop();return}}n.start.push(this.sourceToken)}return;case"anchor":case"tag":if(n.value||this.indent<=e.indent)break;n.start.push(this.sourceToken);return;case"seq-item-ind":if(this.indent!==e.indent)break;n.value||Yt(n.start,"seq-item-ind")?e.items.push({start:[this.sourceToken]}):n.start.push(this.sourceToken);return}if(this.indent>e.indent){const s=this.startBlockValue(e);if(s){this.stack.push(s);return}}yield*this.pop(),yield*this.step()}*flowCollection(e){const n=e.items[e.items.length-1];if(this.type==="flow-error-end"){let s;do yield*this.pop(),s=this.peek(1);while(s&&s.type==="flow-collection")}else if(e.end.length===0){switch(this.type){case"comma":case"explicit-key-ind":!n||n.sep?e.items.push({start:[this.sourceToken]}):n.start.push(this.sourceToken);return;case"map-value-ind":!n||n.value?e.items.push({start:[],key:null,sep:[this.sourceToken]}):n.sep?n.sep.push(this.sourceToken):Object.assign(n,{key:null,sep:[this.sourceToken]});return;case"space":case"comment":case"newline":case"anchor":case"tag":!n||n.value?e.items.push({start:[this.sourceToken]}):n.sep?n.sep.push(this.sourceToken):n.start.push(this.sourceToken);return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{const r=this.flowScalar(this.type);!n||n.value?e.items.push({start:[],key:r,sep:[]}):n.sep?this.stack.push(r):Object.assign(n,{key:r,sep:[]});return}case"flow-map-end":case"flow-seq-end":e.end.push(this.sourceToken);return}const s=this.startBlockValue(e);s?this.stack.push(s):(yield*this.pop(),yield*this.step())}else{const s=this.peek(2);if(s.type==="block-map"&&(this.type==="map-value-ind"&&s.indent===e.indent||this.type==="newline"&&!s.items[s.items.length-1].sep))yield*this.pop(),yield*this.step();else if(this.type==="map-value-ind"&&s.type!=="flow-collection"){const r=pr(s),i=Ln(r);wl(e);const o=e.end.splice(1,e.end.length);o.push(this.sourceToken);const a={type:"block-map",offset:e.offset,indent:e.indent,items:[{start:i,key:e,sep:o}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=a}else yield*this.lineEnd(e)}}flowScalar(e){if(this.onNewLine){let n=this.source.indexOf(`
`)+1;for(;n!==0;)this.onNewLine(this.offset+n),n=this.source.indexOf(`
`,n)+1}return{type:e,offset:this.offset,indent:this.indent,source:this.source}}startBlockValue(e){switch(this.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return this.flowScalar(this.type);case"block-scalar-header":return{type:"block-scalar",offset:this.offset,indent:this.indent,props:[this.sourceToken],source:""};case"flow-map-start":case"flow-seq-start":return{type:"flow-collection",offset:this.offset,indent:this.indent,start:this.sourceToken,items:[],end:[]};case"seq-item-ind":return{type:"block-seq",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken]}]};case"explicit-key-ind":{this.onKeyLine=!0;const n=pr(e),s=Ln(n);return s.push(this.sourceToken),{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:s,explicitKey:!0}]}}case"map-value-ind":{this.onKeyLine=!0;const n=pr(e),s=Ln(n);return{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:s,key:null,sep:[this.sourceToken]}]}}}return null}atIndentedComment(e,n){return this.type!=="comment"||this.indent<=n?!1:e.every(s=>s.type==="newline"||s.type==="space")}*documentEnd(e){this.type!=="doc-mode"&&(e.end?e.end.push(this.sourceToken):e.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop()))}*lineEnd(e){switch(this.type){case"comma":case"doc-start":case"doc-end":case"flow-seq-end":case"flow-map-end":case"map-value-ind":yield*this.pop(),yield*this.step();break;case"newline":this.onKeyLine=!1;case"space":case"comment":default:e.end?e.end.push(this.sourceToken):e.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop())}}}function p2(t){const e=t.prettyErrors!==!1;return{lineCounter:t.lineCounter||e&&new h2||null,prettyErrors:e}}function m2(t,e={}){const{lineCounter:n,prettyErrors:s}=p2(e),r=new d2(n?.addNewLine),i=new a2(e);let o=null;for(const a of i.compose(r.parse(t),!0,t.length))if(!o)o=a;else if(o.options.logLevel!=="silent"){o.errors.push(new bs(a.range.slice(0,2),"MULTIPLE_DOCS","Source contains multiple documents; please use YAML.parseAllDocuments()"));break}return s&&n&&(o.errors.forEach(pl(t,n)),o.warnings.forEach(pl(t,n))),o}function g2(t,e,n){let s;const r=m2(t,n);if(!r)return null;if(r.warnings.forEach(i=>uu(r.options.logLevel,i)),r.errors.length>0){if(r.options.logLevel!=="silent")throw r.errors[0];r.errors=[]}return r.toJS(Object.assign({reviver:s},n))}const Lu=oo(t=>({trains:{},currentTrain:void 0,setTrainsFromYml:e=>{try{const n=g2(e),s=v1(n);s.valid?t({trains:bc.parse(n),parseErrors:void 0}):(console.error("Invalid YAML data:",s.errors),yn.error("We couldn't load your trains. Please check that you uploaded the SavedTrainProperties YAML file from TrainCarts. See the browser console for more details.",{duration:1e4}),t({trains:{},parseErrors:s.errors}))}catch(n){console.error("Error parsing YAML:",n),yn.error("We couldn't read your file. Please make sure it's a valid YAML and try again. See the browser console for more details.",{duration:1e4}),t({trains:{},parseErrors:["Failed to parse YAML.",String(n)]});return}},setTrains:e=>t({trains:e}),setCurrentTrain:e=>t({currentTrain:e}),clearCurrentTrain:()=>t({currentTrain:void 0}),reset:()=>t({trains:{},currentTrain:void 0,parseErrors:void 0})}));function y2(){const t=$.c(58),e=ct(),n=Lu(),[s,r]=F.useState(n.currentTrain),[i,o]=F.useState(e.cart),[a,l]=F.useState(e.metadata.projectName);let c;t[0]===Symbol.for("react.memo_cache_sentinel")?(c=d.jsx(Ao,{children:"New TCA-Project"}),t[0]=c):c=t[0];let u;t[1]===Symbol.for("react.memo_cache_sentinel")?(u=d.jsx(yt,{htmlFor:"projectName",children:"Project name"}),t[1]=u):u=t[1];let f,h,p,y;t[2]===Symbol.for("react.memo_cache_sentinel")?(f=d.jsx(Cl,{id:"projectName",placeholder:"My TCA Project",className:"mt-2",onChange:Y=>l(Y.target.value)}),h=d.jsx("hr",{className:"my-4"}),p=d.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"TC Animator lets you animate one cart from a single train per project. To work on a different train or cart, create a new project for each one."}),y=d.jsx(yt,{htmlFor:"train",children:"Train"}),t[2]=f,t[3]=h,t[4]=p,t[5]=y):(f=t[2],h=t[3],p=t[4],y=t[5]);let g;t[6]!==n.trains?(g=Y=>{const Q=n.trains[Y];Q&&(r(Q),o(null))},t[6]=n.trains,t[7]=g):g=t[7];let w;t[8]===Symbol.for("react.memo_cache_sentinel")?(w=d.jsx(Ni,{className:"w-full",id:"train",children:d.jsx(Ai,{placeholder:"Select a train"})}),t[8]=w):w=t[8];let m;t[9]===Symbol.for("react.memo_cache_sentinel")?(m=d.jsx(Ci,{children:"Trains"}),t[9]=m):m=t[9];let S;t[10]!==n.trains?(S=Object.values(n.trains).filter(v2).map(w2),t[10]=n.trains,t[11]=S):S=t[11];let x;t[12]!==S?(x=d.jsx(Oi,{children:d.jsxs(Ti,{children:[m,S]})}),t[12]=S,t[13]=x):x=t[13];let _;t[14]!==x||t[15]!==g?(_=d.jsxs(ki,{onValueChange:g,children:[w,x]}),t[14]=x,t[15]=g,t[16]=_):_=t[16];let E;t[17]===Symbol.for("react.memo_cache_sentinel")?(E=d.jsx(yt,{htmlFor:"cart",className:"mt-4",children:"Cart"}),t[17]=E):E=t[17];let k;t[18]!==i||t[19]!==s?(k=s?.carts?Object.entries(s.carts).find(Y=>{const[,Q]=Y;return Q===i})?.[0]??"":"",t[18]=i,t[19]=s,t[20]=k):k=t[20];const b=!s?.carts;let v;t[21]!==s?.carts?(v=Y=>{const Q=s?.carts?.[Y];Q&&o(Q)},t[21]=s?.carts,t[22]=v):v=t[22];let T;t[23]===Symbol.for("react.memo_cache_sentinel")?(T=d.jsx(Ni,{className:"w-full",id:"cart",children:d.jsx(Ai,{placeholder:"Select a cart"})}),t[23]=T):T=t[23];let A;t[24]===Symbol.for("react.memo_cache_sentinel")?(A=d.jsx(Ci,{children:"Carts"}),t[24]=A):A=t[24];let O;t[25]!==s?.carts?(O=Object.entries(s?.carts||{}).map(b2),t[25]=s?.carts,t[26]=O):O=t[26];let N;t[27]!==O?(N=d.jsx(Oi,{children:d.jsxs(Ti,{children:[A,O]})}),t[27]=O,t[28]=N):N=t[28];let M;t[29]!==k||t[30]!==b||t[31]!==v||t[32]!==N?(M=d.jsxs(ki,{value:k,disabled:b,onValueChange:v,children:[T,N]}),t[29]=k,t[30]=b,t[31]=v,t[32]=N,t[33]=M):M=t[33];let R;t[34]!==_||t[35]!==M?(R=d.jsxs(ko,{children:[c,d.jsx(No,{asChild:!0,children:d.jsxs("div",{children:[u,f,h,p,y,_,E,M]})})]}),t[34]=_,t[35]=M,t[36]=R):R=t[36];let j;t[37]!==e||t[38]!==n?(j=()=>{e.reset(),n.reset()},t[37]=e,t[38]=n,t[39]=j):j=t[39];let P;t[40]===Symbol.for("react.memo_cache_sentinel")?(P=d.jsx(df,{}),t[40]=P):P=t[40];let L;t[41]!==j?(L=d.jsxs(nt,{variant:"secondary",onClick:j,children:[P,"Back"]}),t[41]=j,t[42]=L):L=t[42];let U;t[43]!==i||t[44]!==s||t[45]!==a||t[46]!==e||t[47]!==n?(U=async()=>{a&&s&&i&&(e.setProjectName(a),n.setCurrentTrain(s),e.setCart(i),await e.saveProject())},t[43]=i,t[44]=s,t[45]=a,t[46]=e,t[47]=n,t[48]=U):U=t[48];const z=!(a&&s&&i);let ne;t[49]!==U||t[50]!==z?(ne=d.jsx(nt,{onClick:U,disabled:z,children:"Create Project"}),t[49]=U,t[50]=z,t[51]=ne):ne=t[51];let G;t[52]!==L||t[53]!==ne?(G=d.jsxs(To,{className:"flex justify-between",children:[L,ne]}),t[52]=L,t[53]=ne,t[54]=G):G=t[54];let ee;return t[55]!==R||t[56]!==G?(ee=d.jsx(Eo,{open:!0,children:d.jsxs(So,{children:[R,G]})}),t[55]=R,t[56]=G,t[57]=ee):ee=t[57],ee}function b2(t){const[e]=t;return d.jsx(Tr,{value:e,children:e},e)}function w2(t){return d.jsx(Tr,{value:t.savedName,children:t.savedName},t.savedName)}function v2(t){return t.carts}function x2(){const t=$.c(23),e=ct(),n=Lu(),[s,r]=F.useState(!1);let i;t[0]!==n?(i=async()=>{r(!0);const _=await uo({description:"Select a YAML file",mimeTypes:["application/x-yaml","text/yaml"],extensions:[".yaml",".yml"],id:"load-saved-train-properties",startIn:"documents"}).catch(_2);if(_){const E=await _.text();n.setTrainsFromYml(E),n.setCurrentTrain(Object.values(n.trains)[0])}r(!1)},t[0]=n,t[1]=i):i=t[1];const o=i;let a;t[2]!==e?(a=async()=>{r(!0),await yn.promise(e.loadProjectFromFile(),{loading:"Loading project...",success:"Project loaded successfully!",error:"Failed to load project."}).unwrap(),r(!1)},t[2]=e,t[3]=a):a=t[3];const l=a;if(s){let _;return t[4]===Symbol.for("react.memo_cache_sentinel")?(_=d.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur"}),t[4]=_):_=t[4],_}if(Object.entries(n.trains).length>0&&!e.metadata.createdAt){let _;return t[5]===Symbol.for("react.memo_cache_sentinel")?(_=d.jsx(y2,{}),t[5]=_):_=t[5],_}const c=!e.metadata.createdAt;let u;t[6]===Symbol.for("react.memo_cache_sentinel")?(u=d.jsx(Ao,{children:"Welcome to TC Animator!"}),t[6]=u):u=t[6];let f;t[7]===Symbol.for("react.memo_cache_sentinel")?(f=d.jsx("h3",{className:"text-lg",children:"Please import a SavedTrainProperties YAML file or open an existing project to get started."}),t[7]=f):f=t[7];let h;t[8]===Symbol.for("react.memo_cache_sentinel")?(h=d.jsx(uf,{className:"block size-24 mx-auto"}),t[8]=h):h=t[8];let p;t[9]!==o?(p=d.jsxs(nt,{variant:"secondary",className:"aspect-square w-full h-auto flex flex-col",onClick:o,children:[h,"Import SavedTrainProperties"]}),t[9]=o,t[10]=p):p=t[10];let y;t[11]===Symbol.for("react.memo_cache_sentinel")?(y=d.jsx(ff,{className:"block size-24 mx-auto"}),t[11]=y):y=t[11];let g;t[12]!==l?(g=d.jsxs(nt,{variant:"secondary",className:"aspect-square w-full h-auto flex flex-col",onClick:l,children:[y,"Open TCA-Project"]}),t[12]=l,t[13]=g):g=t[13];let w;t[14]!==p||t[15]!==g?(w=d.jsxs(ko,{children:[u,d.jsx(No,{asChild:!0,children:d.jsxs("div",{className:"flex flex-col items-center gap-4",children:[f,d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[p,g]})]})})]}),t[14]=p,t[15]=g,t[16]=w):w=t[16];let m;t[17]===Symbol.for("react.memo_cache_sentinel")?(m=d.jsx(To,{className:"text-sm text-muted-foreground",children:d.jsxs("a",{href:"https://foxxite.com",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1",children:["Made with ❤️ by Foxxite | Articca",d.jsx(hf,{className:"inline-block size-4"})]})}),t[17]=m):m=t[17];let S;t[18]!==w?(S=d.jsxs(So,{children:[w,m]}),t[18]=w,t[19]=S):S=t[19];let x;return t[20]!==S||t[21]!==c?(x=d.jsx(Eo,{open:c,children:S}),t[20]=S,t[21]=c,t[22]=x):x=t[22],x}function _2(){return null}Yu.createRoot(document.getElementById("root")).render(d.jsxs(F.StrictMode,{children:[d.jsx(iv,{}),d.jsx(x2,{}),d.jsx(Jw,{}),d.jsx(Gu,{position:"top-center",richColors:!0})]}));
